第三百零五节，Django框架，Views（视图函数），也就是逻辑处理函数里的各种方法与属性


			<div id="cnblogs_post_body" class="blogpost-body"><p><strong>Django框架，Views（视图函数），也就是逻辑处理函数里的各种方法与属性</strong></p>
<p>&nbsp;</p>
<p><strong><img src="https://images2015.cnblogs.com/blog/955761/201707/955761-20170709164402384-1389711402.png" alt=""></strong></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>Views（视图函数）逻辑处理，最终是围绕着两个对象实现的</strong></span></p>
<p><span style="color: #ff0000"><strong><img src="https://images2015.cnblogs.com/blog/955761/201707/955761-20170709165938790-737655812.png" alt=""></strong></span></p>
<p><strong>http请求中产生两个核心对象：</strong></p>
<p><strong>http请求：HttpRequest对象</strong></p>
<p><strong>http响应：HttpResponse对象</strong></p>
<p><strong>所在位置：django.http</strong></p>
<p><strong>之前我们用到的参数request就是HttpRequest &nbsp; &nbsp;</strong></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong>HttpRequest对象</strong></span></p>
<p><span style="color: #ff0000"><strong>逻辑处理函数的第一个形式参数，接收到的就是<strong>HttpRequest对象，这个对象里封装着用户的各种请求信息，通过<strong><strong>HttpRequest对象的方法或者属性，可以获取到响应的请求信息</strong></strong></strong></strong></span></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong><strong><strong><strong><strong>HttpRequest请求对象里的方法和属性如下：</strong></strong></strong></strong></strong></span></p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">path属性</span>，获取请求页面的全路径，不包括域名</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">from</span> django.shortcuts <span style="color: #0000ff">import</span><span style="color: #000000"> render,HttpResponse

</span><span style="color: #0000ff">def</span><span style="color: #000000"> special(<span style="background-color: #ff99cc">request</span>):
    </span><span style="color: #0000ff">print</span><span style="color: #000000">(<span style="background-color: #ff99cc">request.path</span>)
    </span><span style="color: #0000ff">return</span> render(request,<span style="color: #800000">'</span><span style="color: #800000">index.html</span><span style="color: #800000">'</span>)   <span style="color: #008000">#</span><span style="color: #008000">向用户显示一个html页面</span>

<span style="color: #008000">#</span><span style="color: #008000">返回：</span><span style="color: #008000">
#</span><span style="color: #008000">/bug/articles/5555</span></pre>
</div>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">method属性</span>，获取请求中使用的HTTP方式的字符串表示。全大写表示</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">from</span> django.shortcuts <span style="color: #0000ff">import</span><span style="color: #000000"> render,HttpResponse

</span><span style="color: #0000ff">def</span><span style="color: #000000"> special(<span style="background-color: #ff99cc">request</span>):
    </span><span style="color: #0000ff">print</span><span style="color: #000000">(<span style="background-color: #ff99cc">request.method</span>)
    </span><span style="color: #0000ff">return</span> render(request,<span style="color: #800000">'</span><span style="color: #800000">index.html</span><span style="color: #800000">'</span>)   <span style="color: #008000">#</span><span style="color: #008000">向用户显示一个html页面</span>

<span style="color: #008000">#</span><span style="color: #008000">返回：</span><span style="color: #008000">
#</span><span style="color: #008000">GET</span></pre>
</div>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">GET属性</span>，获取HTTP GET方式请求传参，的参数（字典类型）</strong></span><br><strong>如：http://127.0.0.1:8000/bug/articles/?mch=123 &amp; mim=456</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">from</span> django.shortcuts <span style="color: #0000ff">import</span><span style="color: #000000"> render,HttpResponse

</span><span style="color: #0000ff">def</span><span style="color: #000000"> special(<span style="background-color: #ff99cc">request</span>):
    </span><span style="color: #0000ff">print</span><span style="color: #000000">(<span style="background-color: #ff99cc">request.GET</span>)
    </span><span style="color: #0000ff">return</span> render(request,<span style="color: #800000">'</span><span style="color: #800000">index.html</span><span style="color: #800000">'</span>)   <span style="color: #008000">#</span><span style="color: #008000">向用户显示一个html页面</span>

<span style="color: #008000">#</span><span style="color: #008000">返回：</span><span style="color: #008000">
#</span><span style="color: #008000">&lt;QueryDict: {' mim': ['456'], 'mch': ['123 ']}&gt;</span></pre>
</div>
<p>&nbsp;</p>
<p><span style="background-color: #ffffff; color: #ff0000"><strong>更多</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000"> POST：       包含所有HTTP POST参数的类字典对象</span><span style="color: #008000">
#
#</span><span style="color: #008000">              服务器收到空的POST请求的情况也是可能发生的，也就是说，表单form通过</span><span style="color: #008000">
#</span><span style="color: #008000">              HTTP POST方法提交请求，但是表单中可能没有数据，因此不能使用</span><span style="color: #008000">
#</span><span style="color: #008000">              if req.POST来判断是否使用了HTTP POST 方法；应该使用  if req.method=="POST"</span><span style="color: #008000">
#
#
#
#</span><span style="color: #008000"> COOKIES:     包含所有cookies的标准Python字典对象；keys和values都是字符串。</span><span style="color: #008000">
#
#</span><span style="color: #008000"> FILES：      包含所有上传文件的类字典对象；FILES中的每一个Key都是&lt;input type="file" name="" /&gt;标签中name属性的值，FILES中的每一个value同时也是一个标准的python字典对象，包含下面三个Keys：</span><span style="color: #008000">
#
#</span><span style="color: #008000">             filename：      上传文件名，用字符串表示</span><span style="color: #008000">
#</span><span style="color: #008000">             content_type:   上传文件的Content Type</span><span style="color: #008000">
#</span><span style="color: #008000">             content：       上传文件的原始内容</span><span style="color: #008000">
#
#
#</span><span style="color: #008000"> user：       是一个django.contrib.auth.models.User对象，代表当前登陆的用户。如果访问用户当前</span><span style="color: #008000">
#</span><span style="color: #008000">              没有登陆，user将被初始化为django.contrib.auth.models.AnonymousUser的实例。你</span><span style="color: #008000">
#</span><span style="color: #008000">              可以通过user的is_authenticated()方法来辨别用户是否登陆：</span><span style="color: #008000">
#</span><span style="color: #008000">              if req.user.is_authenticated();只有激活Django中的AuthenticationMiddleware</span><span style="color: #008000">
#</span><span style="color: #008000">              时该属性才可用</span><span style="color: #008000">
#
#</span><span style="color: #008000"> session：    唯一可读写的属性，代表当前会话的字典对象；自己有激活Django中的session支持时该属性才可用。</span></pre>
</div>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">get_full_path()方法</span>，获取HTTP GET方式请求传参，的URL地址</strong></span><br><strong>比如：http://127.0.0.1:8000/index33/?name=123 </strong><br><strong>get_full_path()得到的结果就是/index33/?name=123</strong></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong>HttpResponse响应对象方法和属性如下：</strong></span></p>
<p><span style="color: #000000; background-color: #ffffff"><strong>对于HttpRequest请求对象来说，是由django自动创建的，但是，HttpResponse响应对象就必须我们自己创建。每个view请求处理方法必须返回一个HttpResponse响应对象。</strong></span></p>
<p><span style="color: #000000; background-color: #ffffff"><strong>HttpResponse类在django.http.HttpResponse</strong></span></p>
<p><span style="color: #ff0000"><strong>在HttpResponse对象上扩展的常用方法：</strong></span></p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">render(请求对象，'html文件和路径')</span>方法，将指定<strong>页面渲染后返回给浏览器，</strong></strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">from</span> django.shortcuts <span style="color: #0000ff">import</span><span style="color: #000000"> render

</span><span style="color: #0000ff">def</span><span style="color: #000000"> special(<span style="background-color: #ff99cc">request</span>):
    </span><span style="color: #0000ff">return</span> <span style="background-color: #ff99cc">render(request,<span style="color: #800000">'</span><span style="color: #800000">index.html</span><span style="color: #800000">'</span>)</span>   <span style="color: #008000">#</span><span style="color: #008000">向用户显示一个html页面</span></pre>
</div>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">render_to_response('html文件和路径')</span><strong>方法，将指定<strong>页面渲染后返回给浏览器，</strong></strong></strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">from</span> django.shortcuts <span style="color: #0000ff">import</span><span style="color: #000000"> render,<span style="background-color: #ff99cc">render_to_response
</span></span><span style="color: #0000ff">def</span><span style="color: #000000"> special(request):
    </span><span style="color: #0000ff">return</span> <span style="background-color: #ff99cc">render_to_response(<span style="color: #800000">'</span><span style="color: #800000">index.html</span><span style="color: #800000">'</span>)</span>   <span style="color: #008000">#</span><span style="color: #008000">向用户显示一个html页面</span></pre>
</div>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">redirect('跳转路径和名称')</span>方法，<strong>页面跳转</strong></strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">from</span> django.shortcuts <span style="color: #0000ff">import</span><span style="color: #000000"> render,render_to_response,<span style="background-color: #ff99cc">redirect
</span></span><span style="color: #0000ff">def</span><span style="color: #000000"> special(request):
    </span><span style="color: #0000ff">return</span> <span style="background-color: #ff99cc">redirect(<span style="color: #800000">'</span><span style="color: #800000">http://www.jxiou.com/</span><span style="color: #800000">'</span>)</span>   <span style="color: #008000">#</span><span style="color: #008000">跳转页面</span></pre>
</div>
<p>&nbsp;</p>
<p><strong><span style="color: #ff0000"><span style="color: #0000ff">locals(变量名称)</span>可以直接将逻辑处理函数中的所有变量传给模板 &nbsp;</span> &nbsp;</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">from</span> django.shortcuts <span style="color: #0000ff">import</span><span style="color: #000000"> render
</span><span style="color: #0000ff">def</span><span style="color: #000000"> special(request):

<span style="background-color: #ff99cc">    a1 </span></span><span style="background-color: #ff99cc">= 123<span style="color: #000000">
    a2 </span>= 456</span><span style="background-color: #ff99cc"><span style="color: #000000">
    a3 </span>= 789</span>
    <span style="color: #0000ff">return</span> render(request,<span style="color: #800000">'</span><span style="color: #800000">index.html</span><span style="color: #800000">'</span>,<span style="background-color: #ff99cc">locals()</span>)   <span style="color: #008000">#</span><span style="color: #008000">跳转页面</span></pre>
</div>
<p><strong><span style="color: #000000">html</span></strong></p>
<p>&nbsp;</p>
<div class="cnblogs_code">
<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=<span style="color: #800000">"</span><span style="color: #800000">en</span><span style="color: #800000">"</span>&gt;
&lt;head&gt;
    &lt;meta charset=<span style="color: #800000">"</span><span style="color: #800000">UTF-8</span><span style="color: #800000">"</span>&gt;
    &lt;title&gt;Title&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h1&gt;主页&lt;/h1&gt;
<span style="background-color: #ff99cc">&lt;p&gt;{{ a1 }}&lt;/p&gt;
&lt;p&gt;{{ a2 }}&lt;/p&gt;
&lt;p&gt;{{ a3 }}&lt;/p&gt;</span>
&lt;/body&gt;
&lt;/html&gt;</pre>
</div>
<p>&nbsp;</p></div>