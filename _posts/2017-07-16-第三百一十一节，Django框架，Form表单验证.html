第三百一十一节，Django框架，Form表单验证


			<div id="cnblogs_post_body" class="blogpost-body"><p><strong>第三百一十一节，Django框架，Form表单验证</strong></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong>表单提交</strong></span></p>
<p><span style="color: #0000ff"><strong>html</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">&lt;!</span><span style="color: #ff00ff">DOCTYPE html</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">html </span><span style="color: #ff0000">lang</span><span style="color: #0000ff">="en"</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">head</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">meta </span><span style="color: #ff0000">charset</span><span style="color: #0000ff">="UTF-8"</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">title</span><span style="color: #0000ff">&gt;</span>Title<span style="color: #0000ff">&lt;/</span><span style="color: #800000">title</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">link </span><span style="color: #ff0000">rel</span><span style="color: #0000ff">="stylesheet"</span><span style="color: #ff0000"> type</span><span style="color: #0000ff">="text/css"</span><span style="color: #ff0000"> href</span><span style="color: #0000ff">="/static/css/tou.css"</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">head</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">body</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">form </span><span style="color: #ff0000">action</span><span style="color: #0000ff">="<span style="background-color: #ff99cc">/bug<span style="background-color: #ffff00">articles</span>/</span>"</span><span style="color: #ff0000"> method</span><span style="color: #0000ff">="post"</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="text"</span><span style="color: #ff0000"> name</span><span style="color: #0000ff">="user"</span><span style="color: #0000ff">/&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="text"</span><span style="color: #ff0000"> name</span><span style="color: #0000ff">="pwd"</span><span style="color: #0000ff">/&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="submit"</span><span style="color: #ff0000"> value</span><span style="color: #0000ff">="提交"</span><span style="color: #0000ff">/&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">form</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">body</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">html</span><span style="color: #0000ff">&gt;</span></pre>
</div>
<p><span style="color: #0000ff"><strong>路由映射</strong></span></p>
<div class="cnblogs_code">
<pre>urlpatterns =<span style="color: #000000"> [
    url(r</span><span style="color: #800000">'</span><span style="color: #800000">admin/</span><span style="color: #800000">'</span>, admin.site.urls),   <span style="color: #008000">#</span><span style="color: #008000">路由映射admin数据库管理</span>
    url(r<span style="color: #800000">'</span><span style="color: #800000"><span style="background-color: #ffff00">articles</span>/</span><span style="color: #800000">'</span><span style="color: #000000">, <span style="background-color: #ffff00">views.special</span>)    
]</span></pre>
</div>
<p><span style="color: #0000ff"><strong>逻辑处理</strong></span></p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">method</span>属性获取用户请求方式，post或者get</strong></span><br><strong>使用方式：请求对象.method</strong></p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">POST</span>获取用户post请求方式的信息</strong></span><br><strong>使用方式：请求对象.POST</strong></p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">POST.get()</span>获取用户POST请求方式的表单name名称对应的值，参数是表单name名</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">from</span> django.shortcuts <span style="color: #0000ff">import</span><span style="color: #000000"> render
</span><span style="color: #0000ff">from</span> app1.models <span style="color: #0000ff">import</span> *    <span style="color: #008000">#</span><span style="color: #008000">导入数据库操作模块</span>

<span style="color: #008000">#</span><span style="color: #008000">逻辑处理模块</span>
<span style="color: #0000ff">def</span><span style="color: #000000"><span style="background-color: #ffff00"> special</span>(request):  　　　　　　　　　　　　　 <span style="color: #008080">#自定义参数接收用户请求对象
    </span></span><span style="color: #0000ff">if</span> request.method == <span style="color: #800000">"</span><span style="color: #800000">POST</span><span style="color: #800000">"</span><span style="color: #000000">:　　　　　　　　 <span style="color: #008080">#判断用户请求如果是post方式
        </span></span><span style="color: #0000ff">print</span>(request.POST.get(<span style="color: #800000">'</span><span style="color: #800000">user</span><span style="color: #800000">'</span>,None))  <span style="color: #008000">#</span><span style="color: #008000">接收用户表单提交的name名称对应的值</span>
        <span style="color: #0000ff">print</span>(request.POST.get(<span style="color: #800000">'</span><span style="color: #800000">pwd</span><span style="color: #800000">'</span>, None))  <span style="color: #008000">#</span><span style="color: #008000">接收用户表单提交的name名称对应的值</span>
    <span style="color: #0000ff">return</span> render(request, <span style="color: #800000">'</span><span style="color: #800000">app1/index.html</span><span style="color: #800000">'</span>, locals())  <span style="color: #008000">#</span><span style="color: #008000"> 打开页面</span></pre>
</div>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong>表单提交验证，获取数据与获取错误信息</strong></span></p>
<p><span style="color: #000000"><strong>1、创建表单验证模块，必须继承</strong><span style="color: #0000ff"><strong>Django的表单验证forms.Form类</strong></span></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> <span style="background-color: #ff99cc">django <span style="color: #0000ff">import</span> forms</span>        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(<span style="background-color: #ff99cc">forms.Form</span>):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    <span style="background-color: #ff99cc">user</span> = forms.CharField()    <span style="color: #008000">#</span><span style="color: #008000">接收逻辑处理时，创建yhbd类时传进来的POST对象，里的表单name名对应的值进行验证</span>
    <span style="background-color: #ff99cc">pwd</span> = forms.CharField()     <span style="color: #008000">#</span><span style="color: #008000">#接收逻辑处理时，创建yhbd类时传进来的POST对象，里的表单name名对应的值进行验证</span></pre>
</div>
<p><strong>2、逻辑处理，创建表单验证模块里的验证类，并将用户请求的<span style="color: #0000ff">POST对象</span>，传入验证类进行验证，验证后获取验证通过的提交信息，或者验证没通过的错误信息</strong></p>
<p><span style="color: #0000ff"><strong>如果出现错误，将错误信息对象以字典方式传到html页面</strong></span></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">is_valid()</span>返回验证是否通过的布尔值</strong></span><br><strong>使用方式：验证类.is_valid()</strong></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">cleaned_data</span>获取验证通过后的所有提交数据，返回字典</strong></span><br><strong>使用方式：验证类.cleaned_data</strong></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">errors</span>获取验证错误信息，返回所有表单的错误信息对象</strong></span><br><strong>使用方法：验证类.errors</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">from</span> django.shortcuts <span style="color: #0000ff">import</span><span style="color: #000000"> render
</span><span style="color: #0000ff">from</span> app1.models <span style="color: #0000ff">import</span> *    <span style="color: #008000">#</span><span style="color: #008000">导入数据库操作模块</span>
<span style="color: #0000ff">from</span> app1.biaodan <span style="color: #0000ff">import</span> *   <span style="color: #008000">#</span><span style="color: #008000">导入自定义表单验证模块</span><span style="color: #008000">
#</span><span style="color: #008000">逻辑处理模块</span>
<span style="color: #0000ff">def</span><span style="color: #000000"> special(request):
    </span><span style="color: #0000ff">if</span> request.method == <span style="color: #800000">'</span><span style="color: #800000">GET</span><span style="color: #800000">'</span><span style="color: #000000">:
        </span><span style="color: #0000ff">return</span> render(request, <span style="color: #800000">'</span><span style="color: #800000">app1/index.html</span><span style="color: #800000">'</span>, locals())  <span style="color: #008000">#</span><span style="color: #008000"> 打开页面</span>

    <span style="background-color: #ff99cc"><span style="color: #0000ff">if</span> request.method == <span style="color: #800000">"</span><span style="color: #800000">POST</span><span style="color: #800000">"</span><span style="color: #000000">:
        </span></span><span style="color: #008000">#</span><span style="color: #008000"> print(request.POST.get('user',None))          #接收用户表单提交的name名称对应的值</span>
        <span style="color: #008000">#</span><span style="color: #008000"> print(request.POST.get('pwd', None))          #接收用户表单提交的name名称对应的值</span>
<span style="background-color: #ff99cc"><span style="color: #000000">
        f </span>= yhbd(request.POST)</span>                          <span style="color: #008000">#</span><span style="color: #008000">创建验证表单类，将用户请求POST对象传进表单验证类进行验证</span>

        <span style="color: #008000">#</span><span style="color: #008000"> ret = f.is_valid()                            #返回验证是否通过</span>
        <span style="color: #008000">#</span><span style="color: #008000"> print(ret)                                    #返回布尔值</span>

       <span style="background-color: #ff99cc"> <span style="color: #0000ff">if</span> f.is_valid():</span>                                <span style="color: #008000">#</span><span style="color: #008000">判断验证如果通过</span>
            <span style="background-color: #ff99cc"><span style="color: #0000ff">print</span>(f.cleaned_data)</span>                       <span style="color: #008000">#</span><span style="color: #008000">获取到用户提交信息,字典方式</span>
        <span style="color: #0000ff">else</span>:                                           <span style="color: #008000">#</span><span style="color: #008000">如果没通过</span>
            <span style="background-color: #ff99cc"><span style="color: #0000ff">print</span>(f.errors)</span>                             <span style="color: #008000">#</span><span style="color: #008000">获取错误对象</span>

        <span style="color: #0000ff">return</span> render(request, <span style="color: #800000">'</span><span style="color: #800000">app1/index.html</span><span style="color: #800000">'</span>,<span style="background-color: #ff99cc">{<span style="color: #800000">'</span><span style="color: #800000">cuow</span><span style="color: #800000">'</span>:f.errors}</span>)  <span style="color: #008000">#</span><span style="color: #008000"> 打开页面，将错误信息用字典方式传到html页面</span></pre>
</div>
<p><strong>3、在html页面接收逻辑处理<span style="color: #0000ff">以字典形式</span>传过来的错误对象，分别获取不同表单的错误信息</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">&lt;!</span><span style="color: #ff00ff">DOCTYPE html</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">html </span><span style="color: #ff0000">lang</span><span style="color: #0000ff">="en"</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">head</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">meta </span><span style="color: #ff0000">charset</span><span style="color: #0000ff">="UTF-8"</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">title</span><span style="color: #0000ff">&gt;</span>Title<span style="color: #0000ff">&lt;/</span><span style="color: #800000">title</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">link </span><span style="color: #ff0000">rel</span><span style="color: #0000ff">="stylesheet"</span><span style="color: #ff0000"> type</span><span style="color: #0000ff">="text/css"</span><span style="color: #ff0000"> href</span><span style="color: #0000ff">="/static/css/tou.css"</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">head</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">body</span><span style="color: #0000ff">&gt;</span>

<span style="color: #0000ff">&lt;</span><span style="color: #800000">form </span><span style="color: #ff0000">action</span><span style="color: #0000ff">="/bugarticles/"</span><span style="color: #ff0000"> method</span><span style="color: #0000ff">="post"</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="text"</span><span style="color: #ff0000"> name</span><span style="color: #0000ff">="user"</span><span style="color: #0000ff">/&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span><span style="background-color: #ff99cc">{{ cuow.user.0 }}</span><span style="color: #0000ff">&lt;/</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span>     <span style="color: #008000">&lt;!--</span><span style="color: #008000"> 接收错误信息里的user的错误信息 </span><span style="color: #008000">--&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="text"</span><span style="color: #ff0000"> name</span><span style="color: #0000ff">="pwd"</span><span style="color: #0000ff">/&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span><span style="background-color: #ff99cc">{{ cuow.pwd.0 }}</span><span style="color: #0000ff">&lt;/</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span>      <span style="color: #008000">&lt;!--</span><span style="color: #008000"> 接收错误信息里的pwd的错误信息 </span><span style="color: #008000">--&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="submit"</span><span style="color: #ff0000"> value</span><span style="color: #0000ff">="提交"</span><span style="color: #0000ff">/&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">form</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">body</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">html</span><span style="color: #0000ff">&gt;</span></pre>
</div>
<p>&nbsp;<img src="https://images2015.cnblogs.com/blog/955761/201707/955761-20170716170032722-817776133.png" alt=""></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong>利用表单类自动创建表单标签</strong></span></p>
<p><span style="background-color: #ffffff"><strong>以上表单的&lt;input&gt;是我们自己手动写的，还可以用表单类来自动创建表单标签，好处是不用自己写表单标签，还有就是当用户填写的表单不合法提交时提示错误信息不清空表单</strong></span></p>
<p>&nbsp;</p>
<p><span style="background-color: #ffff00; color: #0000ff"><strong>注意：表单类根据字段创建的表单标签，当用户输入内容时，首先要经过浏览器默认行为的表单验证，如果浏览器<strong>默认行为的表单验证都没有通过那么将无法提交</strong></strong></span></p>
<p><span style="background-color: #ffff00; color: #0000ff"><strong><strong><strong>浏览器<strong>默认行为的表单验证，通过了在进行我们定义的表单类验证，验证合法获取用户提交信息，不合法返回错误信息</strong></strong></strong></strong></span></p>
<p><span style="background-color: #ffffff; color: #0000ff"><strong><strong><strong><strong>利用表单类自动创建表单标签</strong></strong></strong></strong></span></p>
<p><span style="background-color: #ffffff"><strong><strong><strong><strong>1、首先在get访问页面时，创建表单类不传参数，然后把这个表单类传到html页面，在html页面通过，<span style="color: #ff0000">表单类.字段名称</span>，来自动创建表单标签</strong></strong></strong></strong></span></p>
<p><span style="background-color: #ffffff"><strong><strong><strong><strong>　　每一种表单字段类型，都有一个默认的表单标签，这个标签是可以更改的，所以表单类可以创建任何表单标签</strong></strong></strong></strong></span></p>
<p><span style="background-color: #ffffff"><strong><strong><strong><strong>2、在post访问时，再次创建表单类需要传参，将post请求对象传入表单类进行验证表单，如果表单不合法，将错误信息对象传到html显示错误信息，将这次创建的表单类传到html页面替换get时创建的表单类</strong></strong></strong></strong></span></p>
<p><span style="color: #0000ff; background-color: #ffffff"><strong>逻辑处理</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">from</span> django.shortcuts <span style="color: #0000ff">import</span><span style="color: #000000"> render
</span><span style="color: #0000ff">from</span> app1.models <span style="color: #0000ff">import</span> *    <span style="color: #008000">#</span><span style="color: #008000">导入数据库操作模块</span>
<span style="color: #0000ff">from</span> app1.biaodan <span style="color: #0000ff">import</span> *   <span style="color: #008000">#</span><span style="color: #008000">导入自定义表单验证模块</span><span style="color: #008000">
#</span><span style="color: #008000">逻辑处理模块</span>
<span style="color: #0000ff">def</span><span style="color: #000000"> special(request):
    </span><span style="color: #0000ff">if</span> request.method == <span style="color: #800000">'</span><span style="color: #800000; background-color: #ffff00">GET</span><span style="color: #800000">'</span><span style="color: #000000">:
        <span style="background-color: #ffff00">f </span></span><span style="background-color: #ffff00">= yhbd()</span>                                            <span style="color: #008000">#</span><span style="color: #008000">创建表单验证类，不传参</span>
        <span style="color: #0000ff">return</span> render(request, <span style="color: #800000">'</span><span style="color: #800000">app1/index.html</span><span style="color: #800000">'</span>,{<span style="background-color: #ffff00"><span style="color: #800000">'</span><span style="color: #800000">form</span><span style="color: #800000">'</span>:f</span>})  <span style="color: #008000">#</span><span style="color: #008000"> 打开页面，并将表单验证类传到html生成表单标签</span>

    <span style="color: #0000ff">if</span> request.method == <span style="color: #800000">"</span><span style="color: #800000; background-color: #ff99cc">POST</span><span style="color: #800000">"</span><span style="color: #000000">:
        <span style="background-color: #ff99cc">f </span></span><span style="background-color: #ff99cc">= yhbd(request.POST)</span>                          <span style="color: #008000">#</span><span style="color: #008000">创建验证表单类，将用户请求POST对象传进表单验证类进行验证</span>

        <span style="background-color: #ff99cc"><span style="color: #0000ff">if</span> f.is_valid():</span>                                <span style="color: #008000">#</span><span style="color: #008000">判断验证如果通过</span>
            <span style="background-color: #ff99cc"><span style="color: #0000ff">print</span>(f.cleaned_data)</span>                       <span style="color: #008000">#</span><span style="color: #008000">获取到用户提交信息,字典方式</span>
        <span style="color: #0000ff">else</span>:                                           <span style="color: #008000">#</span><span style="color: #008000">如果没通过</span>
            <span style="color: #008000">#</span><span style="color: #008000"><span style="background-color: #ff99cc"> print(f.errors)</span>                           #获取错误对象</span>
            <span style="color: #0000ff">pass</span>

        <span style="color: #0000ff">return</span> render(request, <span style="color: #800000">'</span><span style="color: #800000">app1/index.html</span><span style="color: #800000">'</span>,{<span style="background-color: #ff99cc"><span style="color: #800000">'</span><span style="color: #800000">cuow</span><span style="color: #800000">'</span>:f.errors</span>,<span style="background-color: #ff99cc"><span style="color: #800000">'</span><span style="color: #800000">form</span><span style="color: #800000">'</span>:f</span>})  <span style="color: #008000">#</span><span style="color: #008000"> 打开页面，将错误信息用字典方式传到html页面，并且将表单类传到html页面替换没传参的表单验证类</span></pre>
</div>
<p><span style="color: #0000ff"><strong>html</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">&lt;!</span><span style="color: #ff00ff">DOCTYPE html</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">html </span><span style="color: #ff0000">lang</span><span style="color: #0000ff">="en"</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">head</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">meta </span><span style="color: #ff0000">charset</span><span style="color: #0000ff">="UTF-8"</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">title</span><span style="color: #0000ff">&gt;</span>Title<span style="color: #0000ff">&lt;/</span><span style="color: #800000">title</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">link </span><span style="color: #ff0000">rel</span><span style="color: #0000ff">="stylesheet"</span><span style="color: #ff0000"> type</span><span style="color: #0000ff">="text/css"</span><span style="color: #ff0000"> href</span><span style="color: #0000ff">="/static/css/tou.css"</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">head</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">body</span><span style="color: #0000ff">&gt;</span>

<span style="color: #0000ff">&lt;</span><span style="color: #800000">form </span><span style="color: #ff0000">action</span><span style="color: #0000ff">="/bugarticles/"</span><span style="color: #ff0000"> method</span><span style="color: #0000ff">="post"</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span><span style="color: #000000; background-color: #ffff00">
        {{ form.user }}                                     </span><span style="color: #008000">&lt;!--</span><span style="color: #008000"> 接收get请求时创建的表单类，生成表单标签 </span><span style="color: #008000">--&gt;</span><span style="background-color: #ff99cc"><span style="color: #000000">
        {% if cuow.user.0 %}
            </span><span style="color: #0000ff">&lt;</span><span style="color: #800000">span </span><span style="color: #ff0000">class</span><span style="color: #0000ff">="cuow"</span><span style="color: #0000ff">&gt;</span>{{ cuow.user.0 }}<span style="color: #0000ff">&lt;/</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span>     <span style="color: #008000">&lt;!--</span><span style="color: #008000"> 接收错误信息里的user的错误信息 </span><span style="color: #008000">--&gt;</span><span style="color: #000000">
        {% endif %}
    </span></span><span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span><span style="color: #000000; background-color: #ffff00">
        {{ form.pwd }}                                      </span><span style="color: #008000">&lt;!--</span><span style="color: #008000"> 接收get请求时创建的表单类，生成表单标签 </span><span style="color: #008000">--&gt;</span><span style="background-color: #ff99cc"><span style="color: #000000">
        {% if cuow.pwd.0 %}
            </span><span style="color: #0000ff">&lt;</span><span style="color: #800000">span </span><span style="color: #ff0000">class</span><span style="color: #0000ff">="cuow"</span><span style="color: #0000ff">&gt;</span>{{ cuow.pwd.0 }}<span style="color: #0000ff">&lt;/</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span>      <span style="color: #008000">&lt;!--</span><span style="color: #008000"> 接收错误信息里的pwd的错误信息 </span><span style="color: #008000">--&gt;</span><span style="color: #000000">
        {% endif %}
    </span></span><span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="submit"</span><span style="color: #ff0000"> value</span><span style="color: #0000ff">="提交"</span><span style="color: #0000ff">/&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">form</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">body</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">html</span><span style="color: #0000ff">&gt;</span></pre>
</div>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong>常用的内置验证字段</strong></span></p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">EmailField()</span>验证邮箱字段</strong></span><br><span style="color: #ff0000"><strong><span style="color: #0000ff">CharField()</span>验证字符串字段</strong></span><br><span style="color: #ff0000"><strong><span style="color: #0000ff">URLField()</span>验证url地址字段</strong></span><br><span style="color: #ff0000"><strong><span style="color: #0000ff">IntegerField()</span>验证数字字段</strong></span><br><span style="color: #ff0000"><strong><span style="color: #0000ff">GenericIPAddressField()</span>验证IP字段</strong></span></p>
<p><span style="color: #0000ff"><strong>注意：虽然有很多内置验证字段，但是我们还是要根据我们自己的需求来验证，所以</strong></span></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong>验证字段的参数</strong></span></p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">required</span>设置字段是否可以为空</strong></span><br><strong>	　　True不可以为空</strong><br><strong>	　　False可以为空</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user = forms.CharField(<span style="background-color: #ff99cc">required=True</span>)   <span style="color: #008000">#</span><span style="color: #008000">True不可以为空</span>
    pwd = forms.CharField()</pre>
</div>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">max_length</span>最大字符数</strong></span><br><span style="color: #ff0000"><strong><span style="color: #0000ff">min_length</span>最小字符数</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user = forms.CharField(<span style="background-color: #ff99cc">max_length=4</span>,<span style="background-color: #ff99cc">min_length=2</span><span style="color: #000000">)
    pwd </span>= forms.CharField()</pre>
</div>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">error_messages</span>自定义错误提示信息</strong></span><br><strong>　　参数是一个字典{'验证名称':'错误提示'}</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        <span style="background-color: #ffff00">required</span></span>=<span style="color: #000000">True,
        <span style="background-color: #ffff00">max_length</span></span>=4<span style="color: #000000">,
        <span style="background-color: #ffff00">min_length</span></span>=2<span style="color: #000000">,
<span style="background-color: #ff99cc">        error_messages</span></span><span style="background-color: #ff99cc">=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000; background-color: #ffff00">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000; background-color: #ffff00">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000; background-color: #ffff00">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span></span><span style="color: #000000"><span style="background-color: #ff99cc">
        }</span>
    )
    pwd </span>= forms.CharField()</pre>
</div>
<p><strong><span style="color: #0000ff">invalid</span>设置邮箱格式错误提示信息</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        required</span>=<span style="color: #000000">True,
        max_length</span>=4<span style="color: #000000">,
        min_length</span>=2<span style="color: #000000">,
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span><span style="color: #000000">
        }
    )
    pwd </span>=<span style="color: #000000"> forms.<span style="background-color: #ff99cc">EmailField</span>(
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>: <span style="color: #800000">'</span><span style="color: #800000">邮箱不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="background-color: #ff99cc"><span style="color: #800000">'</span><span style="color: #800000">invalid</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">邮箱格式不正确</span><span style="color: #800000">'</span></span><span style="color: #000000">
        }
    )</span></pre>
</div>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">widget</span>设置表单字段在html页面的类型</strong></span><br><strong>	　　使用方式：widget=forms.Textarea()</strong><br><strong>	　　Textarea(): &lt;textarea&gt;标签类型</strong><br><strong>	　　TextInput()：&lt;input&gt;标签类型</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        required</span>=<span style="color: #000000">True,
        max_length</span>=4<span style="color: #000000">,
        min_length</span>=2<span style="color: #000000">,
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span><span style="color: #000000">
        }
    )
    pwd </span>=<span style="color: #000000"> forms.CharField(
        <span style="background-color: #ff99cc">widget</span></span>=<span style="color: #000000">forms.<span style="background-color: #ff99cc">TextInput()</span>,
    )</span></pre>
</div>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">attrs</span>给表单标签设置属性，可以给标签元素设置class样式，和input标签的各种type属性</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        required</span>=<span style="color: #000000">True,
        max_length</span>=4<span style="color: #000000">,
        min_length</span>=2<span style="color: #000000">,
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span><span style="color: #000000">
        }
    )
    pwd </span>=<span style="color: #000000"> forms.CharField(
        widget</span>=forms.TextInput(<span style="background-color: #ff99cc">attrs={<span style="background-color: #ffff00"><span style="color: #800000">'</span><span style="color: #800000">type</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">password</span><span style="color: #800000">'</span></span>,<span style="background-color: #ffff00"><span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">c1</span><span style="color: #800000">'</span></span></span><span style="color: #000000"><span style="background-color: #ff99cc">}</span>),
    )</span></pre>
</div>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">Select</span>生成表单，select标签，下拉选项框</strong></span><br><strong>	　　参数:</strong><br><strong>		　　　　<span style="color: #0000ff">choices</span>设置下拉数据，元组类型</strong><br><strong>		　　　　<span style="color: #0000ff">attrs</span>设置select标签属性</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        required</span>=<span style="color: #000000">True,
        max_length</span>=4<span style="color: #000000">,
        min_length</span>=2<span style="color: #000000">,
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span><span style="color: #000000">
        }
    )

<span style="background-color: #ffff00">    zhi </span></span><span style="background-color: #ffff00">=<span style="color: #000000"> (
        (0, </span><span style="color: #800000">'</span><span style="color: #800000">普通会员</span><span style="color: #800000">'</span><span style="color: #000000">),
        (</span>1, <span style="color: #800000">'</span><span style="color: #800000">超级会员</span><span style="color: #800000">'</span><span style="color: #000000">),
        (</span>2, <span style="color: #800000">'</span><span style="color: #800000">黄金会员</span><span style="color: #800000">'</span><span style="color: #000000">),
        (</span>3, <span style="color: #800000">'</span><span style="color: #800000">白银会员</span><span style="color: #800000">'</span><span style="color: #000000">),
        (</span>4, <span style="color: #800000">'</span><span style="color: #800000">vip会员</span><span style="color: #800000">'</span></span><span style="color: #000000"><span style="background-color: #ffff00">)
    )</span>
    pwd </span>=<span style="color: #000000"> forms.CharField(
        widget</span>=forms.<span style="background-color: #ff99cc">widgets.Select(<span style="background-color: #ffff00">choices=zhi</span>,attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">c1</span><span style="color: #800000">'</span></span><span style="color: #000000"><span style="background-color: #ff99cc">})</span>
    )</span></pre>
</div>
<p><img src="https://images2015.cnblogs.com/blog/955761/201707/955761-20170717194742910-289353552.png" alt=""></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>下拉框结合数据库应用</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>
<span style="background-color: #ffff00"><span style="color: #0000ff">from</span> app1.models <span style="color: #0000ff">import</span> *</span>       <span style="color: #008000">#</span><span style="color: #008000">导入数据库操作</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        required</span>=<span style="color: #000000">True,
        max_length</span>=4<span style="color: #000000">,
        min_length</span>=2<span style="color: #000000">,
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span><span style="color: #000000">
        }
    )

    <span style="background-color: #ffff00">a </span></span><span style="background-color: #ffff00">= shengf.objects.all().values_list(<span style="color: #800000">'</span><span style="color: #800000">id</span><span style="color: #800000">'</span>,<span style="color: #800000">'</span><span style="color: #800000">shf</span><span style="color: #800000">'</span>) <span style="color: #008000">#</span><span style="color: #008000">获取数据库里shengf表里的id和shf字段的数据</span></span>
    pwd =<span style="color: #000000"> forms.CharField(
        widget</span>=forms.widgets.<span style="background-color: #ff99cc">Select(<span style="background-color: #ffff00">choices=a</span>,attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">c1</span><span style="color: #800000">'</span>})</span> <span style="color: #008000">#</span><span style="color: #008000">将数据库的数据显示到下拉框</span>
    )</pre>
</div>
<p>&nbsp;<img src="https://images2015.cnblogs.com/blog/955761/201707/955761-20170717194742910-289353552.png" alt=""></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>下拉框结合数据库应用，防止数据库添加了数据，或者删除了数据，页面缓存了下拉框数据，无法事实数据同步</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>
<span style="color: #0000ff">from</span> app1.models <span style="color: #0000ff">import</span> *       <span style="color: #008000">#</span><span style="color: #008000">导入数据库操作</span>

<span style="color: #0000ff">class</span> <span style="background-color: #ff99cc">yhbd</span>(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        required</span>=<span style="color: #000000">True,
        max_length</span>=4<span style="color: #000000">,
        min_length</span>=2<span style="color: #000000">,
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span><span style="color: #000000">
        }
    )

    a </span>= shengf.objects.all().values_list(<span style="color: #800000">'</span><span style="color: #800000">id</span><span style="color: #800000">'</span>,<span style="color: #800000">'</span><span style="color: #800000">shf</span><span style="color: #800000">'</span>) <span style="color: #008000">#</span><span style="color: #008000">获取数据库里shengf表里的id和shf字段的数据</span>
    <span style="background-color: #ff99cc">pwd</span> =<span style="color: #000000"> forms.CharField(
        widget</span>=forms.widgets.Select(choices=a,attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">c1</span><span style="color: #800000">'</span>}) <span style="color: #008000">#</span><span style="color: #008000">将数据库的数据显示到下拉框</span>
<span style="color: #000000">    )

    </span><span style="color: #008000">#</span><span style="color: #008000">防止数据库添加了数据，或者删除了数据，页面缓存了下拉框数据，无法事实数据同步</span>
    <span style="color: #0000ff">def</span> <span style="color: #800080">__init__</span>(self,*args, **kwargs):                                     <span style="color: #008000">#</span><span style="color: #008000">创建类的__init__方法，每次创建类时都会执行</span>
        super(<span style="background-color: #ff99cc">yhbd</span>,self).<span style="color: #800080">__init__</span>(*args, **kwargs)                          <span style="color: #008000">#</span><span style="color: #008000">获取当前类的父类里的__init__方法执行</span>
        a = shengf.objects.all().values_list(<span style="color: #800000">'</span><span style="color: #800000">id</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">shf</span><span style="color: #800000">'</span>)                   <span style="color: #008000">#</span><span style="color: #008000">重新获取数据库里shengf表里的id和shf字段的数据</span>
        self.fields[<span style="background-color: #ff99cc"><span style="color: #800000">'</span><span style="color: #800000">pwd</span><span style="color: #800000">'</span></span>] = forms.CharField(widget=forms.widgets.Select(choices=a,attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">c1</span><span style="color: #800000">'</span>}))  <span style="color: #008000">#</span><span style="color: #008000">更新一下表单pwd字段的数据</span></pre>
</div>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>自定义验证规则</strong></span></p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">validators</span>设置自定义验证规则，参数是一个列表，列表里是自定义验证方法名称</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>
<span style="color: #0000ff">from</span> django.core.exceptions <span style="color: #0000ff">import</span><span style="color: #000000"> ValidationError
</span><span style="color: #0000ff">import</span><span style="color: #000000"> re

</span><span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        required</span>=<span style="color: #000000">True,
        max_length</span>=4<span style="color: #000000">,
        min_length</span>=2<span style="color: #000000">,
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span><span style="color: #000000">
        }
    )


    </span><span style="color: #008000">#</span><span style="color: #008000">自定义验证规则</span>
<span style="background-color: #ffff00">    <span style="color: #0000ff">def</span><span style="color: #000000"> shouji(value):
        mobile_re </span>= re.compile(r<span style="color: #800000">'</span><span style="color: #800000">^(13[0-9]|15[012356789]|17[678]|18[0-9]|14[57])[0-9]{8}$</span><span style="color: #800000">'</span><span style="color: #000000">)
        </span><span style="color: #0000ff">if</span> <span style="color: #0000ff">not</span><span style="color: #000000"> mobile_re.match(value):
            </span><span style="color: #0000ff">raise</span> ValidationError(<span style="color: #800000">'</span><span style="color: #800000">手机号码格式错误</span><span style="color: #800000">'</span>)   <span style="color: #008000">#</span><span style="color: #008000">如果不匹配返回错误信息</span></span>
<span style="color: #000000">

    pwd </span>=<span style="color: #000000"> forms.CharField(
        <span style="background-color: #ffff00">validators</span></span><span style="background-color: #ffff00">=[shouji, ],   <span style="color: #008000">#</span><span style="color: #008000">设置自定义验证规则</span></span>
        required=<span style="color: #000000">True,
        widget</span>=<span style="color: #000000">forms.TextInput(
            attrs</span>=<span style="color: #000000">{
                </span><span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>: <span style="color: #800000">"</span><span style="color: #800000">cl</span><span style="color: #800000">"</span><span style="color: #000000">,
                </span><span style="color: #800000">'</span><span style="color: #800000">placeholder</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">手机号码</span><span style="color: #800000">'</span><span style="color: #000000">
            }
        ),
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">手机不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
        }
    )</span></pre>
</div>
<p><img src="https://images2015.cnblogs.com/blog/955761/201707/955761-20170717232723411-1592842803.png" alt=""></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>其他</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span>
<span style="color: #0000ff">import</span><span style="color: #000000"> re
</span><span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span><span style="color: #000000"> forms
</span><span style="color: #0000ff">from</span> django.core.exceptions <span style="color: #0000ff">import</span><span style="color: #000000"> ValidationError


</span><span style="color: #0000ff">def</span><span style="color: #000000"> mobile_validate(value):
    mobile_re </span>= re.compile(r<span style="color: #800000">'</span><span style="color: #800000">^(13[0-9]|15[012356789]|17[678]|18[0-9]|14[57])[0-9]{8}$</span><span style="color: #800000">'</span><span style="color: #000000">)
    </span><span style="color: #0000ff">if</span> <span style="color: #0000ff">not</span><span style="color: #000000"> mobile_re.match(value):
        </span><span style="color: #0000ff">raise</span> ValidationError(<span style="color: #800000">'</span><span style="color: #800000">手机号码格式错误</span><span style="color: #800000">'</span><span style="color: #000000">)


</span><span style="color: #0000ff">class</span><span style="color: #000000"> PublishForm(forms.Form):

    user_type_choice </span>=<span style="color: #000000"> (
        (0, u</span><span style="color: #800000">'</span><span style="color: #800000">普通用户</span><span style="color: #800000">'</span><span style="color: #000000">),
        (</span>1, u<span style="color: #800000">'</span><span style="color: #800000">高级用户</span><span style="color: #800000">'</span><span style="color: #000000">),
    )

    user_type </span>= forms.IntegerField(widget=forms.widgets.Select(choices=<span style="color: #000000">user_type_choice,
                                                                  attrs</span>={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>: <span style="color: #800000">"</span><span style="color: #800000">form-control</span><span style="color: #800000">"</span><span style="color: #000000">}))

    title </span>= forms.CharField(max_length=20<span style="color: #000000">,
                            min_length</span>=5<span style="color: #000000">,
                            error_messages</span>={<span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">标题不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
                                            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">标题最少为5个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
                                            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">标题最多为20个字符</span><span style="color: #800000">'</span><span style="color: #000000">},
                            widget</span>=forms.TextInput(attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>: <span style="color: #800000">"</span><span style="color: #800000">form-control</span><span style="color: #800000">"</span><span style="color: #000000">,
                                                          </span><span style="color: #800000">'</span><span style="color: #800000">placeholder</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">标题5-20个字符</span><span style="color: #800000">'</span><span style="color: #000000">}))

    memo </span>= forms.CharField(required=<span style="color: #000000">False,
                           max_length</span>=256<span style="color: #000000">,
                           widget</span>=forms.widgets.Textarea(attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>: <span style="color: #800000">"</span><span style="color: #800000">form-control no-radius</span><span style="color: #800000">"</span>, <span style="color: #800000">'</span><span style="color: #800000">placeholder</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">详细描述</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">rows</span><span style="color: #800000">'</span>: 3<span style="color: #000000">}))

    phone </span>= forms.CharField(validators=<span style="color: #000000">[mobile_validate, ],
                            error_messages</span>={<span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">手机不能为空</span><span style="color: #800000">'</span><span style="color: #000000">},
                            widget</span>=forms.TextInput(attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>: <span style="color: #800000">"</span><span style="color: #800000">form-control</span><span style="color: #800000">"</span><span style="color: #000000">,
                                                          </span><span style="color: #800000">'</span><span style="color: #800000">placeholder</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">手机号码</span><span style="color: #800000">'</span><span style="color: #000000">}))

    email </span>= forms.EmailField(required=<span style="color: #000000">False,
                            error_messages</span>={<span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">邮箱不能为空</span><span style="color: #800000">'</span>,<span style="color: #800000">'</span><span style="color: #800000">invalid</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">邮箱格式错误</span><span style="color: #800000">'</span><span style="color: #000000">},
                            widget</span>=forms.TextInput(attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>: <span style="color: #800000">"</span><span style="color: #800000">form-control</span><span style="color: #800000">"</span>, <span style="color: #800000">'</span><span style="color: #800000">placeholder</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">邮箱</span><span style="color: #800000">'</span>}))</pre>
</div>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>注意：如果表单是通过Ajax提交的，页面不刷新，那么html页面将无法获取到错误信息，那么我们只能将所有错误信息构造成字典，然后以json的方式返回给Ajax，添加到页面</strong></span></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>将models数据库表类转换成表单验证类【必要使用】</strong></span></p>
<p><span style="color: #000000"><strong>这样可以少写表单验证代码，使用的是数据库字段的验证规则</strong></span></p>
<p><span style="color: #ff0000"><strong>models.py</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">from</span> django.db <span style="color: #0000ff">import</span> models        <span style="color: #008000">#</span><span style="color: #008000"> 导入models对象</span>

<span style="color: #0000ff">class</span><span style="color: #000000"><span style="background-color: #ff99cc"> CourseOrg</span>(models.Model):
    <span style="background-color: #ff99cc">name </span></span><span style="background-color: #ff99cc">= models.CharField(max_length=50, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">机构名称</span><span style="color: #800000">'</span></span><span style="color: #000000"><span style="background-color: #ff99cc">)</span>
    desc </span>= models.TextField(verbose_name=<span style="color: #800000">'</span><span style="color: #800000">机构描述</span><span style="color: #800000">'</span><span style="color: #000000">)
    <span style="background-color: #ff99cc">category </span></span><span style="background-color: #ff99cc">= models.CharField(max_length=20, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">机构类别</span><span style="color: #800000">'</span>, default=<span style="color: #800000">'</span><span style="color: #800000">pxjg</span><span style="color: #800000">'</span>, choices=((<span style="color: #800000">'</span><span style="color: #800000">pxjg</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">培训机构</span><span style="color: #800000">'</span>), (<span style="color: #800000">'</span><span style="color: #800000">gx</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">高校</span><span style="color: #800000">'</span>), (<span style="color: #800000">'</span><span style="color: #800000">gr</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">个人</span><span style="color: #800000">'</span></span><span style="color: #000000"><span style="background-color: #ff99cc">)))</span>
    click </span>= models.IntegerField(default=0, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">点击数</span><span style="color: #800000">'</span><span style="color: #000000">)
    <span style="background-color: #ff99cc">fav_nums </span></span><span style="background-color: #ff99cc">= models.IntegerField(default=0, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">收藏数</span><span style="color: #800000">'</span></span><span style="color: #000000"><span style="background-color: #ff99cc">)</span>
    image </span>= models.ImageField(upload_to=<span style="color: #800000">'</span><span style="color: #800000">org/%Y/%m</span><span style="color: #800000">'</span>, storage=ImageStorage(), verbose_name=<span style="color: #800000">'</span><span style="color: #800000">封面图</span><span style="color: #800000">'</span>, max_length=100<span style="color: #000000">)
    address </span>= models.CharField(max_length=150, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">机构地址</span><span style="color: #800000">'</span><span style="color: #000000">)
    city </span>= models.ForeignKey(CityDict, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">外键城市表</span><span style="color: #800000">'</span><span style="color: #000000">)
    add_time </span>= models.DateTimeField(default=datetime.now, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">添加日期</span><span style="color: #800000">'</span><span style="color: #000000">)

    </span><span style="color: #0000ff">class</span><span style="color: #000000"> Meta:
        verbose_name </span>= <span style="color: #800000">'</span><span style="color: #800000">课程机构表</span><span style="color: #800000">'</span><span style="color: #000000">
        verbose_name_plural </span>=<span style="color: #000000"> verbose_name

    </span><span style="color: #0000ff">def</span> <span style="color: #800080">__str__</span><span style="color: #000000">(self):
        </span><span style="color: #0000ff">return</span> self.name</pre>
</div>
<p><span style="color: #ff0000"><strong>forms.py</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf8 -*-</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> <span style="background-color: #ff99cc">forms</span>                             <span style="color: #008000">#</span><span style="color: #008000"> 导入Django的表单验证模块</span>
<span style="color: #0000ff">from</span> app_organization.models <span style="color: #0000ff">import</span> <span style="background-color: #ff99cc"><strong>CourseOrg</strong></span>        <span style="color: #008000">#</span><span style="color: #008000"> 导入数据库表类</span>


<span style="color: #0000ff">class</span><span style="color: #000000"> CourseOrgForm(<span style="background-color: #ff99cc">forms.ModelForm</span>):
    zdyi </span>= forms.CharField()                         <span style="color: #008000">#</span><span style="color: #008000"> 自定义表单验证字段</span>

    <span style="color: #0000ff">class</span><span style="color: #000000"> Meta:
        model </span>= <span style="background-color: #ff99cc">CourseOrg</span>                            <span style="color: #008000">#</span><span style="color: #008000"> 设置要将数据库表类转换成表单验证类的名称</span>
        fields = [<span style="color: #800000">'</span><span style="color: #800000">name</span><span style="color: #800000">'</span>,<span style="color: #800000">'</span><span style="color: #800000">category</span><span style="color: #800000">'</span>,<span style="color: #800000">'</span><span style="color: #800000">fav_nums</span><span style="color: #800000">'</span>]      <span style="color: #008000">#</span><span style="color: #008000"> 要使用的字段</span></pre>
</div>
<p>&nbsp;</p></div>第三百一十一节，Django框架，Form表单验证


			<div id="cnblogs_post_body" class="blogpost-body"><p><strong>第三百一十一节，Django框架，Form表单验证</strong></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong>表单提交</strong></span></p>
<p><span style="color: #0000ff"><strong>html</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">&lt;!</span><span style="color: #ff00ff">DOCTYPE html</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">html </span><span style="color: #ff0000">lang</span><span style="color: #0000ff">="en"</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">head</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">meta </span><span style="color: #ff0000">charset</span><span style="color: #0000ff">="UTF-8"</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">title</span><span style="color: #0000ff">&gt;</span>Title<span style="color: #0000ff">&lt;/</span><span style="color: #800000">title</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">link </span><span style="color: #ff0000">rel</span><span style="color: #0000ff">="stylesheet"</span><span style="color: #ff0000"> type</span><span style="color: #0000ff">="text/css"</span><span style="color: #ff0000"> href</span><span style="color: #0000ff">="/static/css/tou.css"</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">head</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">body</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">form </span><span style="color: #ff0000">action</span><span style="color: #0000ff">="<span style="background-color: #ff99cc">/bug<span style="background-color: #ffff00">articles</span>/</span>"</span><span style="color: #ff0000"> method</span><span style="color: #0000ff">="post"</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="text"</span><span style="color: #ff0000"> name</span><span style="color: #0000ff">="user"</span><span style="color: #0000ff">/&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="text"</span><span style="color: #ff0000"> name</span><span style="color: #0000ff">="pwd"</span><span style="color: #0000ff">/&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="submit"</span><span style="color: #ff0000"> value</span><span style="color: #0000ff">="提交"</span><span style="color: #0000ff">/&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">form</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">body</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">html</span><span style="color: #0000ff">&gt;</span></pre>
</div>
<p><span style="color: #0000ff"><strong>路由映射</strong></span></p>
<div class="cnblogs_code">
<pre>urlpatterns =<span style="color: #000000"> [
    url(r</span><span style="color: #800000">'</span><span style="color: #800000">admin/</span><span style="color: #800000">'</span>, admin.site.urls),   <span style="color: #008000">#</span><span style="color: #008000">路由映射admin数据库管理</span>
    url(r<span style="color: #800000">'</span><span style="color: #800000"><span style="background-color: #ffff00">articles</span>/</span><span style="color: #800000">'</span><span style="color: #000000">, <span style="background-color: #ffff00">views.special</span>)    
]</span></pre>
</div>
<p><span style="color: #0000ff"><strong>逻辑处理</strong></span></p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">method</span>属性获取用户请求方式，post或者get</strong></span><br><strong>使用方式：请求对象.method</strong></p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">POST</span>获取用户post请求方式的信息</strong></span><br><strong>使用方式：请求对象.POST</strong></p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">POST.get()</span>获取用户POST请求方式的表单name名称对应的值，参数是表单name名</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">from</span> django.shortcuts <span style="color: #0000ff">import</span><span style="color: #000000"> render
</span><span style="color: #0000ff">from</span> app1.models <span style="color: #0000ff">import</span> *    <span style="color: #008000">#</span><span style="color: #008000">导入数据库操作模块</span>

<span style="color: #008000">#</span><span style="color: #008000">逻辑处理模块</span>
<span style="color: #0000ff">def</span><span style="color: #000000"><span style="background-color: #ffff00"> special</span>(request):  　　　　　　　　　　　　　 <span style="color: #008080">#自定义参数接收用户请求对象
    </span></span><span style="color: #0000ff">if</span> request.method == <span style="color: #800000">"</span><span style="color: #800000">POST</span><span style="color: #800000">"</span><span style="color: #000000">:　　　　　　　　 <span style="color: #008080">#判断用户请求如果是post方式
        </span></span><span style="color: #0000ff">print</span>(request.POST.get(<span style="color: #800000">'</span><span style="color: #800000">user</span><span style="color: #800000">'</span>,None))  <span style="color: #008000">#</span><span style="color: #008000">接收用户表单提交的name名称对应的值</span>
        <span style="color: #0000ff">print</span>(request.POST.get(<span style="color: #800000">'</span><span style="color: #800000">pwd</span><span style="color: #800000">'</span>, None))  <span style="color: #008000">#</span><span style="color: #008000">接收用户表单提交的name名称对应的值</span>
    <span style="color: #0000ff">return</span> render(request, <span style="color: #800000">'</span><span style="color: #800000">app1/index.html</span><span style="color: #800000">'</span>, locals())  <span style="color: #008000">#</span><span style="color: #008000"> 打开页面</span></pre>
</div>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong>表单提交验证，获取数据与获取错误信息</strong></span></p>
<p><span style="color: #000000"><strong>1、创建表单验证模块，必须继承</strong><span style="color: #0000ff"><strong>Django的表单验证forms.Form类</strong></span></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> <span style="background-color: #ff99cc">django <span style="color: #0000ff">import</span> forms</span>        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(<span style="background-color: #ff99cc">forms.Form</span>):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    <span style="background-color: #ff99cc">user</span> = forms.CharField()    <span style="color: #008000">#</span><span style="color: #008000">接收逻辑处理时，创建yhbd类时传进来的POST对象，里的表单name名对应的值进行验证</span>
    <span style="background-color: #ff99cc">pwd</span> = forms.CharField()     <span style="color: #008000">#</span><span style="color: #008000">#接收逻辑处理时，创建yhbd类时传进来的POST对象，里的表单name名对应的值进行验证</span></pre>
</div>
<p><strong>2、逻辑处理，创建表单验证模块里的验证类，并将用户请求的<span style="color: #0000ff">POST对象</span>，传入验证类进行验证，验证后获取验证通过的提交信息，或者验证没通过的错误信息</strong></p>
<p><span style="color: #0000ff"><strong>如果出现错误，将错误信息对象以字典方式传到html页面</strong></span></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">is_valid()</span>返回验证是否通过的布尔值</strong></span><br><strong>使用方式：验证类.is_valid()</strong></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">cleaned_data</span>获取验证通过后的所有提交数据，返回字典</strong></span><br><strong>使用方式：验证类.cleaned_data</strong></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">errors</span>获取验证错误信息，返回所有表单的错误信息对象</strong></span><br><strong>使用方法：验证类.errors</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">from</span> django.shortcuts <span style="color: #0000ff">import</span><span style="color: #000000"> render
</span><span style="color: #0000ff">from</span> app1.models <span style="color: #0000ff">import</span> *    <span style="color: #008000">#</span><span style="color: #008000">导入数据库操作模块</span>
<span style="color: #0000ff">from</span> app1.biaodan <span style="color: #0000ff">import</span> *   <span style="color: #008000">#</span><span style="color: #008000">导入自定义表单验证模块</span><span style="color: #008000">
#</span><span style="color: #008000">逻辑处理模块</span>
<span style="color: #0000ff">def</span><span style="color: #000000"> special(request):
    </span><span style="color: #0000ff">if</span> request.method == <span style="color: #800000">'</span><span style="color: #800000">GET</span><span style="color: #800000">'</span><span style="color: #000000">:
        </span><span style="color: #0000ff">return</span> render(request, <span style="color: #800000">'</span><span style="color: #800000">app1/index.html</span><span style="color: #800000">'</span>, locals())  <span style="color: #008000">#</span><span style="color: #008000"> 打开页面</span>

    <span style="background-color: #ff99cc"><span style="color: #0000ff">if</span> request.method == <span style="color: #800000">"</span><span style="color: #800000">POST</span><span style="color: #800000">"</span><span style="color: #000000">:
        </span></span><span style="color: #008000">#</span><span style="color: #008000"> print(request.POST.get('user',None))          #接收用户表单提交的name名称对应的值</span>
        <span style="color: #008000">#</span><span style="color: #008000"> print(request.POST.get('pwd', None))          #接收用户表单提交的name名称对应的值</span>
<span style="background-color: #ff99cc"><span style="color: #000000">
        f </span>= yhbd(request.POST)</span>                          <span style="color: #008000">#</span><span style="color: #008000">创建验证表单类，将用户请求POST对象传进表单验证类进行验证</span>

        <span style="color: #008000">#</span><span style="color: #008000"> ret = f.is_valid()                            #返回验证是否通过</span>
        <span style="color: #008000">#</span><span style="color: #008000"> print(ret)                                    #返回布尔值</span>

       <span style="background-color: #ff99cc"> <span style="color: #0000ff">if</span> f.is_valid():</span>                                <span style="color: #008000">#</span><span style="color: #008000">判断验证如果通过</span>
            <span style="background-color: #ff99cc"><span style="color: #0000ff">print</span>(f.cleaned_data)</span>                       <span style="color: #008000">#</span><span style="color: #008000">获取到用户提交信息,字典方式</span>
        <span style="color: #0000ff">else</span>:                                           <span style="color: #008000">#</span><span style="color: #008000">如果没通过</span>
            <span style="background-color: #ff99cc"><span style="color: #0000ff">print</span>(f.errors)</span>                             <span style="color: #008000">#</span><span style="color: #008000">获取错误对象</span>

        <span style="color: #0000ff">return</span> render(request, <span style="color: #800000">'</span><span style="color: #800000">app1/index.html</span><span style="color: #800000">'</span>,<span style="background-color: #ff99cc">{<span style="color: #800000">'</span><span style="color: #800000">cuow</span><span style="color: #800000">'</span>:f.errors}</span>)  <span style="color: #008000">#</span><span style="color: #008000"> 打开页面，将错误信息用字典方式传到html页面</span></pre>
</div>
<p><strong>3、在html页面接收逻辑处理<span style="color: #0000ff">以字典形式</span>传过来的错误对象，分别获取不同表单的错误信息</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">&lt;!</span><span style="color: #ff00ff">DOCTYPE html</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">html </span><span style="color: #ff0000">lang</span><span style="color: #0000ff">="en"</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">head</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">meta </span><span style="color: #ff0000">charset</span><span style="color: #0000ff">="UTF-8"</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">title</span><span style="color: #0000ff">&gt;</span>Title<span style="color: #0000ff">&lt;/</span><span style="color: #800000">title</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">link </span><span style="color: #ff0000">rel</span><span style="color: #0000ff">="stylesheet"</span><span style="color: #ff0000"> type</span><span style="color: #0000ff">="text/css"</span><span style="color: #ff0000"> href</span><span style="color: #0000ff">="/static/css/tou.css"</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">head</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">body</span><span style="color: #0000ff">&gt;</span>

<span style="color: #0000ff">&lt;</span><span style="color: #800000">form </span><span style="color: #ff0000">action</span><span style="color: #0000ff">="/bugarticles/"</span><span style="color: #ff0000"> method</span><span style="color: #0000ff">="post"</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="text"</span><span style="color: #ff0000"> name</span><span style="color: #0000ff">="user"</span><span style="color: #0000ff">/&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span><span style="background-color: #ff99cc">{{ cuow.user.0 }}</span><span style="color: #0000ff">&lt;/</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span>     <span style="color: #008000">&lt;!--</span><span style="color: #008000"> 接收错误信息里的user的错误信息 </span><span style="color: #008000">--&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="text"</span><span style="color: #ff0000"> name</span><span style="color: #0000ff">="pwd"</span><span style="color: #0000ff">/&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span><span style="background-color: #ff99cc">{{ cuow.pwd.0 }}</span><span style="color: #0000ff">&lt;/</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span>      <span style="color: #008000">&lt;!--</span><span style="color: #008000"> 接收错误信息里的pwd的错误信息 </span><span style="color: #008000">--&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="submit"</span><span style="color: #ff0000"> value</span><span style="color: #0000ff">="提交"</span><span style="color: #0000ff">/&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">form</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">body</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">html</span><span style="color: #0000ff">&gt;</span></pre>
</div>
<p>&nbsp;<img src="https://images2015.cnblogs.com/blog/955761/201707/955761-20170716170032722-817776133.png" alt=""></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong>利用表单类自动创建表单标签</strong></span></p>
<p><span style="background-color: #ffffff"><strong>以上表单的&lt;input&gt;是我们自己手动写的，还可以用表单类来自动创建表单标签，好处是不用自己写表单标签，还有就是当用户填写的表单不合法提交时提示错误信息不清空表单</strong></span></p>
<p>&nbsp;</p>
<p><span style="background-color: #ffff00; color: #0000ff"><strong>注意：表单类根据字段创建的表单标签，当用户输入内容时，首先要经过浏览器默认行为的表单验证，如果浏览器<strong>默认行为的表单验证都没有通过那么将无法提交</strong></strong></span></p>
<p><span style="background-color: #ffff00; color: #0000ff"><strong><strong><strong>浏览器<strong>默认行为的表单验证，通过了在进行我们定义的表单类验证，验证合法获取用户提交信息，不合法返回错误信息</strong></strong></strong></strong></span></p>
<p><span style="background-color: #ffffff; color: #0000ff"><strong><strong><strong><strong>利用表单类自动创建表单标签</strong></strong></strong></strong></span></p>
<p><span style="background-color: #ffffff"><strong><strong><strong><strong>1、首先在get访问页面时，创建表单类不传参数，然后把这个表单类传到html页面，在html页面通过，<span style="color: #ff0000">表单类.字段名称</span>，来自动创建表单标签</strong></strong></strong></strong></span></p>
<p><span style="background-color: #ffffff"><strong><strong><strong><strong>　　每一种表单字段类型，都有一个默认的表单标签，这个标签是可以更改的，所以表单类可以创建任何表单标签</strong></strong></strong></strong></span></p>
<p><span style="background-color: #ffffff"><strong><strong><strong><strong>2、在post访问时，再次创建表单类需要传参，将post请求对象传入表单类进行验证表单，如果表单不合法，将错误信息对象传到html显示错误信息，将这次创建的表单类传到html页面替换get时创建的表单类</strong></strong></strong></strong></span></p>
<p><span style="color: #0000ff; background-color: #ffffff"><strong>逻辑处理</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">from</span> django.shortcuts <span style="color: #0000ff">import</span><span style="color: #000000"> render
</span><span style="color: #0000ff">from</span> app1.models <span style="color: #0000ff">import</span> *    <span style="color: #008000">#</span><span style="color: #008000">导入数据库操作模块</span>
<span style="color: #0000ff">from</span> app1.biaodan <span style="color: #0000ff">import</span> *   <span style="color: #008000">#</span><span style="color: #008000">导入自定义表单验证模块</span><span style="color: #008000">
#</span><span style="color: #008000">逻辑处理模块</span>
<span style="color: #0000ff">def</span><span style="color: #000000"> special(request):
    </span><span style="color: #0000ff">if</span> request.method == <span style="color: #800000">'</span><span style="color: #800000; background-color: #ffff00">GET</span><span style="color: #800000">'</span><span style="color: #000000">:
        <span style="background-color: #ffff00">f </span></span><span style="background-color: #ffff00">= yhbd()</span>                                            <span style="color: #008000">#</span><span style="color: #008000">创建表单验证类，不传参</span>
        <span style="color: #0000ff">return</span> render(request, <span style="color: #800000">'</span><span style="color: #800000">app1/index.html</span><span style="color: #800000">'</span>,{<span style="background-color: #ffff00"><span style="color: #800000">'</span><span style="color: #800000">form</span><span style="color: #800000">'</span>:f</span>})  <span style="color: #008000">#</span><span style="color: #008000"> 打开页面，并将表单验证类传到html生成表单标签</span>

    <span style="color: #0000ff">if</span> request.method == <span style="color: #800000">"</span><span style="color: #800000; background-color: #ff99cc">POST</span><span style="color: #800000">"</span><span style="color: #000000">:
        <span style="background-color: #ff99cc">f </span></span><span style="background-color: #ff99cc">= yhbd(request.POST)</span>                          <span style="color: #008000">#</span><span style="color: #008000">创建验证表单类，将用户请求POST对象传进表单验证类进行验证</span>

        <span style="background-color: #ff99cc"><span style="color: #0000ff">if</span> f.is_valid():</span>                                <span style="color: #008000">#</span><span style="color: #008000">判断验证如果通过</span>
            <span style="background-color: #ff99cc"><span style="color: #0000ff">print</span>(f.cleaned_data)</span>                       <span style="color: #008000">#</span><span style="color: #008000">获取到用户提交信息,字典方式</span>
        <span style="color: #0000ff">else</span>:                                           <span style="color: #008000">#</span><span style="color: #008000">如果没通过</span>
            <span style="color: #008000">#</span><span style="color: #008000"><span style="background-color: #ff99cc"> print(f.errors)</span>                           #获取错误对象</span>
            <span style="color: #0000ff">pass</span>

        <span style="color: #0000ff">return</span> render(request, <span style="color: #800000">'</span><span style="color: #800000">app1/index.html</span><span style="color: #800000">'</span>,{<span style="background-color: #ff99cc"><span style="color: #800000">'</span><span style="color: #800000">cuow</span><span style="color: #800000">'</span>:f.errors</span>,<span style="background-color: #ff99cc"><span style="color: #800000">'</span><span style="color: #800000">form</span><span style="color: #800000">'</span>:f</span>})  <span style="color: #008000">#</span><span style="color: #008000"> 打开页面，将错误信息用字典方式传到html页面，并且将表单类传到html页面替换没传参的表单验证类</span></pre>
</div>
<p><span style="color: #0000ff"><strong>html</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">&lt;!</span><span style="color: #ff00ff">DOCTYPE html</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">html </span><span style="color: #ff0000">lang</span><span style="color: #0000ff">="en"</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">head</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">meta </span><span style="color: #ff0000">charset</span><span style="color: #0000ff">="UTF-8"</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">title</span><span style="color: #0000ff">&gt;</span>Title<span style="color: #0000ff">&lt;/</span><span style="color: #800000">title</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">link </span><span style="color: #ff0000">rel</span><span style="color: #0000ff">="stylesheet"</span><span style="color: #ff0000"> type</span><span style="color: #0000ff">="text/css"</span><span style="color: #ff0000"> href</span><span style="color: #0000ff">="/static/css/tou.css"</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">head</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">body</span><span style="color: #0000ff">&gt;</span>

<span style="color: #0000ff">&lt;</span><span style="color: #800000">form </span><span style="color: #ff0000">action</span><span style="color: #0000ff">="/bugarticles/"</span><span style="color: #ff0000"> method</span><span style="color: #0000ff">="post"</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span><span style="color: #000000; background-color: #ffff00">
        {{ form.user }}                                     </span><span style="color: #008000">&lt;!--</span><span style="color: #008000"> 接收get请求时创建的表单类，生成表单标签 </span><span style="color: #008000">--&gt;</span><span style="background-color: #ff99cc"><span style="color: #000000">
        {% if cuow.user.0 %}
            </span><span style="color: #0000ff">&lt;</span><span style="color: #800000">span </span><span style="color: #ff0000">class</span><span style="color: #0000ff">="cuow"</span><span style="color: #0000ff">&gt;</span>{{ cuow.user.0 }}<span style="color: #0000ff">&lt;/</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span>     <span style="color: #008000">&lt;!--</span><span style="color: #008000"> 接收错误信息里的user的错误信息 </span><span style="color: #008000">--&gt;</span><span style="color: #000000">
        {% endif %}
    </span></span><span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span><span style="color: #000000; background-color: #ffff00">
        {{ form.pwd }}                                      </span><span style="color: #008000">&lt;!--</span><span style="color: #008000"> 接收get请求时创建的表单类，生成表单标签 </span><span style="color: #008000">--&gt;</span><span style="background-color: #ff99cc"><span style="color: #000000">
        {% if cuow.pwd.0 %}
            </span><span style="color: #0000ff">&lt;</span><span style="color: #800000">span </span><span style="color: #ff0000">class</span><span style="color: #0000ff">="cuow"</span><span style="color: #0000ff">&gt;</span>{{ cuow.pwd.0 }}<span style="color: #0000ff">&lt;/</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span>      <span style="color: #008000">&lt;!--</span><span style="color: #008000"> 接收错误信息里的pwd的错误信息 </span><span style="color: #008000">--&gt;</span><span style="color: #000000">
        {% endif %}
    </span></span><span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="submit"</span><span style="color: #ff0000"> value</span><span style="color: #0000ff">="提交"</span><span style="color: #0000ff">/&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">form</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">body</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">html</span><span style="color: #0000ff">&gt;</span></pre>
</div>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong>常用的内置验证字段</strong></span></p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">EmailField()</span>验证邮箱字段</strong></span><br><span style="color: #ff0000"><strong><span style="color: #0000ff">CharField()</span>验证字符串字段</strong></span><br><span style="color: #ff0000"><strong><span style="color: #0000ff">URLField()</span>验证url地址字段</strong></span><br><span style="color: #ff0000"><strong><span style="color: #0000ff">IntegerField()</span>验证数字字段</strong></span><br><span style="color: #ff0000"><strong><span style="color: #0000ff">GenericIPAddressField()</span>验证IP字段</strong></span></p>
<p><span style="color: #0000ff"><strong>注意：虽然有很多内置验证字段，但是我们还是要根据我们自己的需求来验证，所以</strong></span></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong>验证字段的参数</strong></span></p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">required</span>设置字段是否可以为空</strong></span><br><strong>	　　True不可以为空</strong><br><strong>	　　False可以为空</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user = forms.CharField(<span style="background-color: #ff99cc">required=True</span>)   <span style="color: #008000">#</span><span style="color: #008000">True不可以为空</span>
    pwd = forms.CharField()</pre>
</div>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">max_length</span>最大字符数</strong></span><br><span style="color: #ff0000"><strong><span style="color: #0000ff">min_length</span>最小字符数</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user = forms.CharField(<span style="background-color: #ff99cc">max_length=4</span>,<span style="background-color: #ff99cc">min_length=2</span><span style="color: #000000">)
    pwd </span>= forms.CharField()</pre>
</div>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">error_messages</span>自定义错误提示信息</strong></span><br><strong>　　参数是一个字典{'验证名称':'错误提示'}</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        <span style="background-color: #ffff00">required</span></span>=<span style="color: #000000">True,
        <span style="background-color: #ffff00">max_length</span></span>=4<span style="color: #000000">,
        <span style="background-color: #ffff00">min_length</span></span>=2<span style="color: #000000">,
<span style="background-color: #ff99cc">        error_messages</span></span><span style="background-color: #ff99cc">=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000; background-color: #ffff00">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000; background-color: #ffff00">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000; background-color: #ffff00">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span></span><span style="color: #000000"><span style="background-color: #ff99cc">
        }</span>
    )
    pwd </span>= forms.CharField()</pre>
</div>
<p><strong><span style="color: #0000ff">invalid</span>设置邮箱格式错误提示信息</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        required</span>=<span style="color: #000000">True,
        max_length</span>=4<span style="color: #000000">,
        min_length</span>=2<span style="color: #000000">,
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span><span style="color: #000000">
        }
    )
    pwd </span>=<span style="color: #000000"> forms.<span style="background-color: #ff99cc">EmailField</span>(
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>: <span style="color: #800000">'</span><span style="color: #800000">邮箱不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="background-color: #ff99cc"><span style="color: #800000">'</span><span style="color: #800000">invalid</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">邮箱格式不正确</span><span style="color: #800000">'</span></span><span style="color: #000000">
        }
    )</span></pre>
</div>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">widget</span>设置表单字段在html页面的类型</strong></span><br><strong>	　　使用方式：widget=forms.Textarea()</strong><br><strong>	　　Textarea(): &lt;textarea&gt;标签类型</strong><br><strong>	　　TextInput()：&lt;input&gt;标签类型</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        required</span>=<span style="color: #000000">True,
        max_length</span>=4<span style="color: #000000">,
        min_length</span>=2<span style="color: #000000">,
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span><span style="color: #000000">
        }
    )
    pwd </span>=<span style="color: #000000"> forms.CharField(
        <span style="background-color: #ff99cc">widget</span></span>=<span style="color: #000000">forms.<span style="background-color: #ff99cc">TextInput()</span>,
    )</span></pre>
</div>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">attrs</span>给表单标签设置属性，可以给标签元素设置class样式，和input标签的各种type属性</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        required</span>=<span style="color: #000000">True,
        max_length</span>=4<span style="color: #000000">,
        min_length</span>=2<span style="color: #000000">,
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span><span style="color: #000000">
        }
    )
    pwd </span>=<span style="color: #000000"> forms.CharField(
        widget</span>=forms.TextInput(<span style="background-color: #ff99cc">attrs={<span style="background-color: #ffff00"><span style="color: #800000">'</span><span style="color: #800000">type</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">password</span><span style="color: #800000">'</span></span>,<span style="background-color: #ffff00"><span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">c1</span><span style="color: #800000">'</span></span></span><span style="color: #000000"><span style="background-color: #ff99cc">}</span>),
    )</span></pre>
</div>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">Select</span>生成表单，select标签，下拉选项框</strong></span><br><strong>	　　参数:</strong><br><strong>		　　　　<span style="color: #0000ff">choices</span>设置下拉数据，元组类型</strong><br><strong>		　　　　<span style="color: #0000ff">attrs</span>设置select标签属性</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        required</span>=<span style="color: #000000">True,
        max_length</span>=4<span style="color: #000000">,
        min_length</span>=2<span style="color: #000000">,
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span><span style="color: #000000">
        }
    )

<span style="background-color: #ffff00">    zhi </span></span><span style="background-color: #ffff00">=<span style="color: #000000"> (
        (0, </span><span style="color: #800000">'</span><span style="color: #800000">普通会员</span><span style="color: #800000">'</span><span style="color: #000000">),
        (</span>1, <span style="color: #800000">'</span><span style="color: #800000">超级会员</span><span style="color: #800000">'</span><span style="color: #000000">),
        (</span>2, <span style="color: #800000">'</span><span style="color: #800000">黄金会员</span><span style="color: #800000">'</span><span style="color: #000000">),
        (</span>3, <span style="color: #800000">'</span><span style="color: #800000">白银会员</span><span style="color: #800000">'</span><span style="color: #000000">),
        (</span>4, <span style="color: #800000">'</span><span style="color: #800000">vip会员</span><span style="color: #800000">'</span></span><span style="color: #000000"><span style="background-color: #ffff00">)
    )</span>
    pwd </span>=<span style="color: #000000"> forms.CharField(
        widget</span>=forms.<span style="background-color: #ff99cc">widgets.Select(<span style="background-color: #ffff00">choices=zhi</span>,attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">c1</span><span style="color: #800000">'</span></span><span style="color: #000000"><span style="background-color: #ff99cc">})</span>
    )</span></pre>
</div>
<p><img src="https://images2015.cnblogs.com/blog/955761/201707/955761-20170717194742910-289353552.png" alt=""></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>下拉框结合数据库应用</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>
<span style="background-color: #ffff00"><span style="color: #0000ff">from</span> app1.models <span style="color: #0000ff">import</span> *</span>       <span style="color: #008000">#</span><span style="color: #008000">导入数据库操作</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        required</span>=<span style="color: #000000">True,
        max_length</span>=4<span style="color: #000000">,
        min_length</span>=2<span style="color: #000000">,
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span><span style="color: #000000">
        }
    )

    <span style="background-color: #ffff00">a </span></span><span style="background-color: #ffff00">= shengf.objects.all().values_list(<span style="color: #800000">'</span><span style="color: #800000">id</span><span style="color: #800000">'</span>,<span style="color: #800000">'</span><span style="color: #800000">shf</span><span style="color: #800000">'</span>) <span style="color: #008000">#</span><span style="color: #008000">获取数据库里shengf表里的id和shf字段的数据</span></span>
    pwd =<span style="color: #000000"> forms.CharField(
        widget</span>=forms.widgets.<span style="background-color: #ff99cc">Select(<span style="background-color: #ffff00">choices=a</span>,attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">c1</span><span style="color: #800000">'</span>})</span> <span style="color: #008000">#</span><span style="color: #008000">将数据库的数据显示到下拉框</span>
    )</pre>
</div>
<p>&nbsp;<img src="https://images2015.cnblogs.com/blog/955761/201707/955761-20170717194742910-289353552.png" alt=""></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>下拉框结合数据库应用，防止数据库添加了数据，或者删除了数据，页面缓存了下拉框数据，无法事实数据同步</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>
<span style="color: #0000ff">from</span> app1.models <span style="color: #0000ff">import</span> *       <span style="color: #008000">#</span><span style="color: #008000">导入数据库操作</span>

<span style="color: #0000ff">class</span> <span style="background-color: #ff99cc">yhbd</span>(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        required</span>=<span style="color: #000000">True,
        max_length</span>=4<span style="color: #000000">,
        min_length</span>=2<span style="color: #000000">,
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span><span style="color: #000000">
        }
    )

    a </span>= shengf.objects.all().values_list(<span style="color: #800000">'</span><span style="color: #800000">id</span><span style="color: #800000">'</span>,<span style="color: #800000">'</span><span style="color: #800000">shf</span><span style="color: #800000">'</span>) <span style="color: #008000">#</span><span style="color: #008000">获取数据库里shengf表里的id和shf字段的数据</span>
    <span style="background-color: #ff99cc">pwd</span> =<span style="color: #000000"> forms.CharField(
        widget</span>=forms.widgets.Select(choices=a,attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">c1</span><span style="color: #800000">'</span>}) <span style="color: #008000">#</span><span style="color: #008000">将数据库的数据显示到下拉框</span>
<span style="color: #000000">    )

    </span><span style="color: #008000">#</span><span style="color: #008000">防止数据库添加了数据，或者删除了数据，页面缓存了下拉框数据，无法事实数据同步</span>
    <span style="color: #0000ff">def</span> <span style="color: #800080">__init__</span>(self,*args, **kwargs):                                     <span style="color: #008000">#</span><span style="color: #008000">创建类的__init__方法，每次创建类时都会执行</span>
        super(<span style="background-color: #ff99cc">yhbd</span>,self).<span style="color: #800080">__init__</span>(*args, **kwargs)                          <span style="color: #008000">#</span><span style="color: #008000">获取当前类的父类里的__init__方法执行</span>
        a = shengf.objects.all().values_list(<span style="color: #800000">'</span><span style="color: #800000">id</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">shf</span><span style="color: #800000">'</span>)                   <span style="color: #008000">#</span><span style="color: #008000">重新获取数据库里shengf表里的id和shf字段的数据</span>
        self.fields[<span style="background-color: #ff99cc"><span style="color: #800000">'</span><span style="color: #800000">pwd</span><span style="color: #800000">'</span></span>] = forms.CharField(widget=forms.widgets.Select(choices=a,attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">c1</span><span style="color: #800000">'</span>}))  <span style="color: #008000">#</span><span style="color: #008000">更新一下表单pwd字段的数据</span></pre>
</div>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>自定义验证规则</strong></span></p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">validators</span>设置自定义验证规则，参数是一个列表，列表里是自定义验证方法名称</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>
<span style="color: #0000ff">from</span> django.core.exceptions <span style="color: #0000ff">import</span><span style="color: #000000"> ValidationError
</span><span style="color: #0000ff">import</span><span style="color: #000000"> re

</span><span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        required</span>=<span style="color: #000000">True,
        max_length</span>=4<span style="color: #000000">,
        min_length</span>=2<span style="color: #000000">,
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span><span style="color: #000000">
        }
    )


    </span><span style="color: #008000">#</span><span style="color: #008000">自定义验证规则</span>
<span style="background-color: #ffff00">    <span style="color: #0000ff">def</span><span style="color: #000000"> shouji(value):
        mobile_re </span>= re.compile(r<span style="color: #800000">'</span><span style="color: #800000">^(13[0-9]|15[012356789]|17[678]|18[0-9]|14[57])[0-9]{8}$</span><span style="color: #800000">'</span><span style="color: #000000">)
        </span><span style="color: #0000ff">if</span> <span style="color: #0000ff">not</span><span style="color: #000000"> mobile_re.match(value):
            </span><span style="color: #0000ff">raise</span> ValidationError(<span style="color: #800000">'</span><span style="color: #800000">手机号码格式错误</span><span style="color: #800000">'</span>)   <span style="color: #008000">#</span><span style="color: #008000">如果不匹配返回错误信息</span></span>
<span style="color: #000000">

    pwd </span>=<span style="color: #000000"> forms.CharField(
        <span style="background-color: #ffff00">validators</span></span><span style="background-color: #ffff00">=[shouji, ],   <span style="color: #008000">#</span><span style="color: #008000">设置自定义验证规则</span></span>
        required=<span style="color: #000000">True,
        widget</span>=<span style="color: #000000">forms.TextInput(
            attrs</span>=<span style="color: #000000">{
                </span><span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>: <span style="color: #800000">"</span><span style="color: #800000">cl</span><span style="color: #800000">"</span><span style="color: #000000">,
                </span><span style="color: #800000">'</span><span style="color: #800000">placeholder</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">手机号码</span><span style="color: #800000">'</span><span style="color: #000000">
            }
        ),
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">手机不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
        }
    )</span></pre>
</div>
<p><img src="https://images2015.cnblogs.com/blog/955761/201707/955761-20170717232723411-1592842803.png" alt=""></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>其他</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span>
<span style="color: #0000ff">import</span><span style="color: #000000"> re
</span><span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span><span style="color: #000000"> forms
</span><span style="color: #0000ff">from</span> django.core.exceptions <span style="color: #0000ff">import</span><span style="color: #000000"> ValidationError


</span><span style="color: #0000ff">def</span><span style="color: #000000"> mobile_validate(value):
    mobile_re </span>= re.compile(r<span style="color: #800000">'</span><span style="color: #800000">^(13[0-9]|15[012356789]|17[678]|18[0-9]|14[57])[0-9]{8}$</span><span style="color: #800000">'</span><span style="color: #000000">)
    </span><span style="color: #0000ff">if</span> <span style="color: #0000ff">not</span><span style="color: #000000"> mobile_re.match(value):
        </span><span style="color: #0000ff">raise</span> ValidationError(<span style="color: #800000">'</span><span style="color: #800000">手机号码格式错误</span><span style="color: #800000">'</span><span style="color: #000000">)


</span><span style="color: #0000ff">class</span><span style="color: #000000"> PublishForm(forms.Form):

    user_type_choice </span>=<span style="color: #000000"> (
        (0, u</span><span style="color: #800000">'</span><span style="color: #800000">普通用户</span><span style="color: #800000">'</span><span style="color: #000000">),
        (</span>1, u<span style="color: #800000">'</span><span style="color: #800000">高级用户</span><span style="color: #800000">'</span><span style="color: #000000">),
    )

    user_type </span>= forms.IntegerField(widget=forms.widgets.Select(choices=<span style="color: #000000">user_type_choice,
                                                                  attrs</span>={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>: <span style="color: #800000">"</span><span style="color: #800000">form-control</span><span style="color: #800000">"</span><span style="color: #000000">}))

    title </span>= forms.CharField(max_length=20<span style="color: #000000">,
                            min_length</span>=5<span style="color: #000000">,
                            error_messages</span>={<span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">标题不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
                                            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">标题最少为5个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
                                            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">标题最多为20个字符</span><span style="color: #800000">'</span><span style="color: #000000">},
                            widget</span>=forms.TextInput(attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>: <span style="color: #800000">"</span><span style="color: #800000">form-control</span><span style="color: #800000">"</span><span style="color: #000000">,
                                                          </span><span style="color: #800000">'</span><span style="color: #800000">placeholder</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">标题5-20个字符</span><span style="color: #800000">'</span><span style="color: #000000">}))

    memo </span>= forms.CharField(required=<span style="color: #000000">False,
                           max_length</span>=256<span style="color: #000000">,
                           widget</span>=forms.widgets.Textarea(attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>: <span style="color: #800000">"</span><span style="color: #800000">form-control no-radius</span><span style="color: #800000">"</span>, <span style="color: #800000">'</span><span style="color: #800000">placeholder</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">详细描述</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">rows</span><span style="color: #800000">'</span>: 3<span style="color: #000000">}))

    phone </span>= forms.CharField(validators=<span style="color: #000000">[mobile_validate, ],
                            error_messages</span>={<span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">手机不能为空</span><span style="color: #800000">'</span><span style="color: #000000">},
                            widget</span>=forms.TextInput(attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>: <span style="color: #800000">"</span><span style="color: #800000">form-control</span><span style="color: #800000">"</span><span style="color: #000000">,
                                                          </span><span style="color: #800000">'</span><span style="color: #800000">placeholder</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">手机号码</span><span style="color: #800000">'</span><span style="color: #000000">}))

    email </span>= forms.EmailField(required=<span style="color: #000000">False,
                            error_messages</span>={<span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">邮箱不能为空</span><span style="color: #800000">'</span>,<span style="color: #800000">'</span><span style="color: #800000">invalid</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">邮箱格式错误</span><span style="color: #800000">'</span><span style="color: #000000">},
                            widget</span>=forms.TextInput(attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>: <span style="color: #800000">"</span><span style="color: #800000">form-control</span><span style="color: #800000">"</span>, <span style="color: #800000">'</span><span style="color: #800000">placeholder</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">邮箱</span><span style="color: #800000">'</span>}))</pre>
</div>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>注意：如果表单是通过Ajax提交的，页面不刷新，那么html页面将无法获取到错误信息，那么我们只能将所有错误信息构造成字典，然后以json的方式返回给Ajax，添加到页面</strong></span></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>将models数据库表类转换成表单验证类【必要使用】</strong></span></p>
<p><span style="color: #000000"><strong>这样可以少写表单验证代码，使用的是数据库字段的验证规则</strong></span></p>
<p><span style="color: #ff0000"><strong>models.py</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">from</span> django.db <span style="color: #0000ff">import</span> models        <span style="color: #008000">#</span><span style="color: #008000"> 导入models对象</span>

<span style="color: #0000ff">class</span><span style="color: #000000"><span style="background-color: #ff99cc"> CourseOrg</span>(models.Model):
    <span style="background-color: #ff99cc">name </span></span><span style="background-color: #ff99cc">= models.CharField(max_length=50, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">机构名称</span><span style="color: #800000">'</span></span><span style="color: #000000"><span style="background-color: #ff99cc">)</span>
    desc </span>= models.TextField(verbose_name=<span style="color: #800000">'</span><span style="color: #800000">机构描述</span><span style="color: #800000">'</span><span style="color: #000000">)
    <span style="background-color: #ff99cc">category </span></span><span style="background-color: #ff99cc">= models.CharField(max_length=20, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">机构类别</span><span style="color: #800000">'</span>, default=<span style="color: #800000">'</span><span style="color: #800000">pxjg</span><span style="color: #800000">'</span>, choices=((<span style="color: #800000">'</span><span style="color: #800000">pxjg</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">培训机构</span><span style="color: #800000">'</span>), (<span style="color: #800000">'</span><span style="color: #800000">gx</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">高校</span><span style="color: #800000">'</span>), (<span style="color: #800000">'</span><span style="color: #800000">gr</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">个人</span><span style="color: #800000">'</span></span><span style="color: #000000"><span style="background-color: #ff99cc">)))</span>
    click </span>= models.IntegerField(default=0, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">点击数</span><span style="color: #800000">'</span><span style="color: #000000">)
    <span style="background-color: #ff99cc">fav_nums </span></span><span style="background-color: #ff99cc">= models.IntegerField(default=0, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">收藏数</span><span style="color: #800000">'</span></span><span style="color: #000000"><span style="background-color: #ff99cc">)</span>
    image </span>= models.ImageField(upload_to=<span style="color: #800000">'</span><span style="color: #800000">org/%Y/%m</span><span style="color: #800000">'</span>, storage=ImageStorage(), verbose_name=<span style="color: #800000">'</span><span style="color: #800000">封面图</span><span style="color: #800000">'</span>, max_length=100<span style="color: #000000">)
    address </span>= models.CharField(max_length=150, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">机构地址</span><span style="color: #800000">'</span><span style="color: #000000">)
    city </span>= models.ForeignKey(CityDict, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">外键城市表</span><span style="color: #800000">'</span><span style="color: #000000">)
    add_time </span>= models.DateTimeField(default=datetime.now, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">添加日期</span><span style="color: #800000">'</span><span style="color: #000000">)

    </span><span style="color: #0000ff">class</span><span style="color: #000000"> Meta:
        verbose_name </span>= <span style="color: #800000">'</span><span style="color: #800000">课程机构表</span><span style="color: #800000">'</span><span style="color: #000000">
        verbose_name_plural </span>=<span style="color: #000000"> verbose_name

    </span><span style="color: #0000ff">def</span> <span style="color: #800080">__str__</span><span style="color: #000000">(self):
        </span><span style="color: #0000ff">return</span> self.name</pre>
</div>
<p><span style="color: #ff0000"><strong>forms.py</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf8 -*-</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> <span style="background-color: #ff99cc">forms</span>                             <span style="color: #008000">#</span><span style="color: #008000"> 导入Django的表单验证模块</span>
<span style="color: #0000ff">from</span> app_organization.models <span style="color: #0000ff">import</span> <span style="background-color: #ff99cc"><strong>CourseOrg</strong></span>        <span style="color: #008000">#</span><span style="color: #008000"> 导入数据库表类</span>


<span style="color: #0000ff">class</span><span style="color: #000000"> CourseOrgForm(<span style="background-color: #ff99cc">forms.ModelForm</span>):
    zdyi </span>= forms.CharField()                         <span style="color: #008000">#</span><span style="color: #008000"> 自定义表单验证字段</span>

    <span style="color: #0000ff">class</span><span style="color: #000000"> Meta:
        model </span>= <span style="background-color: #ff99cc">CourseOrg</span>                            <span style="color: #008000">#</span><span style="color: #008000"> 设置要将数据库表类转换成表单验证类的名称</span>
        fields = [<span style="color: #800000">'</span><span style="color: #800000">name</span><span style="color: #800000">'</span>,<span style="color: #800000">'</span><span style="color: #800000">category</span><span style="color: #800000">'</span>,<span style="color: #800000">'</span><span style="color: #800000">fav_nums</span><span style="color: #800000">'</span>]      <span style="color: #008000">#</span><span style="color: #008000"> 要使用的字段</span></pre>
</div>
<p>&nbsp;</p></div>第三百一十一节，Django框架，Form表单验证


			<div id="cnblogs_post_body" class="blogpost-body"><p><strong>第三百一十一节，Django框架，Form表单验证</strong></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong>表单提交</strong></span></p>
<p><span style="color: #0000ff"><strong>html</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">&lt;!</span><span style="color: #ff00ff">DOCTYPE html</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">html </span><span style="color: #ff0000">lang</span><span style="color: #0000ff">="en"</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">head</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">meta </span><span style="color: #ff0000">charset</span><span style="color: #0000ff">="UTF-8"</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">title</span><span style="color: #0000ff">&gt;</span>Title<span style="color: #0000ff">&lt;/</span><span style="color: #800000">title</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">link </span><span style="color: #ff0000">rel</span><span style="color: #0000ff">="stylesheet"</span><span style="color: #ff0000"> type</span><span style="color: #0000ff">="text/css"</span><span style="color: #ff0000"> href</span><span style="color: #0000ff">="/static/css/tou.css"</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">head</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">body</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">form </span><span style="color: #ff0000">action</span><span style="color: #0000ff">="<span style="background-color: #ff99cc">/bug<span style="background-color: #ffff00">articles</span>/</span>"</span><span style="color: #ff0000"> method</span><span style="color: #0000ff">="post"</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="text"</span><span style="color: #ff0000"> name</span><span style="color: #0000ff">="user"</span><span style="color: #0000ff">/&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="text"</span><span style="color: #ff0000"> name</span><span style="color: #0000ff">="pwd"</span><span style="color: #0000ff">/&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="submit"</span><span style="color: #ff0000"> value</span><span style="color: #0000ff">="提交"</span><span style="color: #0000ff">/&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">form</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">body</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">html</span><span style="color: #0000ff">&gt;</span></pre>
</div>
<p><span style="color: #0000ff"><strong>路由映射</strong></span></p>
<div class="cnblogs_code">
<pre>urlpatterns =<span style="color: #000000"> [
    url(r</span><span style="color: #800000">'</span><span style="color: #800000">admin/</span><span style="color: #800000">'</span>, admin.site.urls),   <span style="color: #008000">#</span><span style="color: #008000">路由映射admin数据库管理</span>
    url(r<span style="color: #800000">'</span><span style="color: #800000"><span style="background-color: #ffff00">articles</span>/</span><span style="color: #800000">'</span><span style="color: #000000">, <span style="background-color: #ffff00">views.special</span>)    
]</span></pre>
</div>
<p><span style="color: #0000ff"><strong>逻辑处理</strong></span></p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">method</span>属性获取用户请求方式，post或者get</strong></span><br><strong>使用方式：请求对象.method</strong></p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">POST</span>获取用户post请求方式的信息</strong></span><br><strong>使用方式：请求对象.POST</strong></p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">POST.get()</span>获取用户POST请求方式的表单name名称对应的值，参数是表单name名</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">from</span> django.shortcuts <span style="color: #0000ff">import</span><span style="color: #000000"> render
</span><span style="color: #0000ff">from</span> app1.models <span style="color: #0000ff">import</span> *    <span style="color: #008000">#</span><span style="color: #008000">导入数据库操作模块</span>

<span style="color: #008000">#</span><span style="color: #008000">逻辑处理模块</span>
<span style="color: #0000ff">def</span><span style="color: #000000"><span style="background-color: #ffff00"> special</span>(request):  　　　　　　　　　　　　　 <span style="color: #008080">#自定义参数接收用户请求对象
    </span></span><span style="color: #0000ff">if</span> request.method == <span style="color: #800000">"</span><span style="color: #800000">POST</span><span style="color: #800000">"</span><span style="color: #000000">:　　　　　　　　 <span style="color: #008080">#判断用户请求如果是post方式
        </span></span><span style="color: #0000ff">print</span>(request.POST.get(<span style="color: #800000">'</span><span style="color: #800000">user</span><span style="color: #800000">'</span>,None))  <span style="color: #008000">#</span><span style="color: #008000">接收用户表单提交的name名称对应的值</span>
        <span style="color: #0000ff">print</span>(request.POST.get(<span style="color: #800000">'</span><span style="color: #800000">pwd</span><span style="color: #800000">'</span>, None))  <span style="color: #008000">#</span><span style="color: #008000">接收用户表单提交的name名称对应的值</span>
    <span style="color: #0000ff">return</span> render(request, <span style="color: #800000">'</span><span style="color: #800000">app1/index.html</span><span style="color: #800000">'</span>, locals())  <span style="color: #008000">#</span><span style="color: #008000"> 打开页面</span></pre>
</div>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong>表单提交验证，获取数据与获取错误信息</strong></span></p>
<p><span style="color: #000000"><strong>1、创建表单验证模块，必须继承</strong><span style="color: #0000ff"><strong>Django的表单验证forms.Form类</strong></span></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> <span style="background-color: #ff99cc">django <span style="color: #0000ff">import</span> forms</span>        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(<span style="background-color: #ff99cc">forms.Form</span>):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    <span style="background-color: #ff99cc">user</span> = forms.CharField()    <span style="color: #008000">#</span><span style="color: #008000">接收逻辑处理时，创建yhbd类时传进来的POST对象，里的表单name名对应的值进行验证</span>
    <span style="background-color: #ff99cc">pwd</span> = forms.CharField()     <span style="color: #008000">#</span><span style="color: #008000">#接收逻辑处理时，创建yhbd类时传进来的POST对象，里的表单name名对应的值进行验证</span></pre>
</div>
<p><strong>2、逻辑处理，创建表单验证模块里的验证类，并将用户请求的<span style="color: #0000ff">POST对象</span>，传入验证类进行验证，验证后获取验证通过的提交信息，或者验证没通过的错误信息</strong></p>
<p><span style="color: #0000ff"><strong>如果出现错误，将错误信息对象以字典方式传到html页面</strong></span></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">is_valid()</span>返回验证是否通过的布尔值</strong></span><br><strong>使用方式：验证类.is_valid()</strong></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">cleaned_data</span>获取验证通过后的所有提交数据，返回字典</strong></span><br><strong>使用方式：验证类.cleaned_data</strong></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">errors</span>获取验证错误信息，返回所有表单的错误信息对象</strong></span><br><strong>使用方法：验证类.errors</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">from</span> django.shortcuts <span style="color: #0000ff">import</span><span style="color: #000000"> render
</span><span style="color: #0000ff">from</span> app1.models <span style="color: #0000ff">import</span> *    <span style="color: #008000">#</span><span style="color: #008000">导入数据库操作模块</span>
<span style="color: #0000ff">from</span> app1.biaodan <span style="color: #0000ff">import</span> *   <span style="color: #008000">#</span><span style="color: #008000">导入自定义表单验证模块</span><span style="color: #008000">
#</span><span style="color: #008000">逻辑处理模块</span>
<span style="color: #0000ff">def</span><span style="color: #000000"> special(request):
    </span><span style="color: #0000ff">if</span> request.method == <span style="color: #800000">'</span><span style="color: #800000">GET</span><span style="color: #800000">'</span><span style="color: #000000">:
        </span><span style="color: #0000ff">return</span> render(request, <span style="color: #800000">'</span><span style="color: #800000">app1/index.html</span><span style="color: #800000">'</span>, locals())  <span style="color: #008000">#</span><span style="color: #008000"> 打开页面</span>

    <span style="background-color: #ff99cc"><span style="color: #0000ff">if</span> request.method == <span style="color: #800000">"</span><span style="color: #800000">POST</span><span style="color: #800000">"</span><span style="color: #000000">:
        </span></span><span style="color: #008000">#</span><span style="color: #008000"> print(request.POST.get('user',None))          #接收用户表单提交的name名称对应的值</span>
        <span style="color: #008000">#</span><span style="color: #008000"> print(request.POST.get('pwd', None))          #接收用户表单提交的name名称对应的值</span>
<span style="background-color: #ff99cc"><span style="color: #000000">
        f </span>= yhbd(request.POST)</span>                          <span style="color: #008000">#</span><span style="color: #008000">创建验证表单类，将用户请求POST对象传进表单验证类进行验证</span>

        <span style="color: #008000">#</span><span style="color: #008000"> ret = f.is_valid()                            #返回验证是否通过</span>
        <span style="color: #008000">#</span><span style="color: #008000"> print(ret)                                    #返回布尔值</span>

       <span style="background-color: #ff99cc"> <span style="color: #0000ff">if</span> f.is_valid():</span>                                <span style="color: #008000">#</span><span style="color: #008000">判断验证如果通过</span>
            <span style="background-color: #ff99cc"><span style="color: #0000ff">print</span>(f.cleaned_data)</span>                       <span style="color: #008000">#</span><span style="color: #008000">获取到用户提交信息,字典方式</span>
        <span style="color: #0000ff">else</span>:                                           <span style="color: #008000">#</span><span style="color: #008000">如果没通过</span>
            <span style="background-color: #ff99cc"><span style="color: #0000ff">print</span>(f.errors)</span>                             <span style="color: #008000">#</span><span style="color: #008000">获取错误对象</span>

        <span style="color: #0000ff">return</span> render(request, <span style="color: #800000">'</span><span style="color: #800000">app1/index.html</span><span style="color: #800000">'</span>,<span style="background-color: #ff99cc">{<span style="color: #800000">'</span><span style="color: #800000">cuow</span><span style="color: #800000">'</span>:f.errors}</span>)  <span style="color: #008000">#</span><span style="color: #008000"> 打开页面，将错误信息用字典方式传到html页面</span></pre>
</div>
<p><strong>3、在html页面接收逻辑处理<span style="color: #0000ff">以字典形式</span>传过来的错误对象，分别获取不同表单的错误信息</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">&lt;!</span><span style="color: #ff00ff">DOCTYPE html</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">html </span><span style="color: #ff0000">lang</span><span style="color: #0000ff">="en"</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">head</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">meta </span><span style="color: #ff0000">charset</span><span style="color: #0000ff">="UTF-8"</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">title</span><span style="color: #0000ff">&gt;</span>Title<span style="color: #0000ff">&lt;/</span><span style="color: #800000">title</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">link </span><span style="color: #ff0000">rel</span><span style="color: #0000ff">="stylesheet"</span><span style="color: #ff0000"> type</span><span style="color: #0000ff">="text/css"</span><span style="color: #ff0000"> href</span><span style="color: #0000ff">="/static/css/tou.css"</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">head</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">body</span><span style="color: #0000ff">&gt;</span>

<span style="color: #0000ff">&lt;</span><span style="color: #800000">form </span><span style="color: #ff0000">action</span><span style="color: #0000ff">="/bugarticles/"</span><span style="color: #ff0000"> method</span><span style="color: #0000ff">="post"</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="text"</span><span style="color: #ff0000"> name</span><span style="color: #0000ff">="user"</span><span style="color: #0000ff">/&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span><span style="background-color: #ff99cc">{{ cuow.user.0 }}</span><span style="color: #0000ff">&lt;/</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span>     <span style="color: #008000">&lt;!--</span><span style="color: #008000"> 接收错误信息里的user的错误信息 </span><span style="color: #008000">--&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="text"</span><span style="color: #ff0000"> name</span><span style="color: #0000ff">="pwd"</span><span style="color: #0000ff">/&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span><span style="background-color: #ff99cc">{{ cuow.pwd.0 }}</span><span style="color: #0000ff">&lt;/</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span>      <span style="color: #008000">&lt;!--</span><span style="color: #008000"> 接收错误信息里的pwd的错误信息 </span><span style="color: #008000">--&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="submit"</span><span style="color: #ff0000"> value</span><span style="color: #0000ff">="提交"</span><span style="color: #0000ff">/&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">form</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">body</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">html</span><span style="color: #0000ff">&gt;</span></pre>
</div>
<p>&nbsp;<img src="https://images2015.cnblogs.com/blog/955761/201707/955761-20170716170032722-817776133.png" alt=""></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong>利用表单类自动创建表单标签</strong></span></p>
<p><span style="background-color: #ffffff"><strong>以上表单的&lt;input&gt;是我们自己手动写的，还可以用表单类来自动创建表单标签，好处是不用自己写表单标签，还有就是当用户填写的表单不合法提交时提示错误信息不清空表单</strong></span></p>
<p>&nbsp;</p>
<p><span style="background-color: #ffff00; color: #0000ff"><strong>注意：表单类根据字段创建的表单标签，当用户输入内容时，首先要经过浏览器默认行为的表单验证，如果浏览器<strong>默认行为的表单验证都没有通过那么将无法提交</strong></strong></span></p>
<p><span style="background-color: #ffff00; color: #0000ff"><strong><strong><strong>浏览器<strong>默认行为的表单验证，通过了在进行我们定义的表单类验证，验证合法获取用户提交信息，不合法返回错误信息</strong></strong></strong></strong></span></p>
<p><span style="background-color: #ffffff; color: #0000ff"><strong><strong><strong><strong>利用表单类自动创建表单标签</strong></strong></strong></strong></span></p>
<p><span style="background-color: #ffffff"><strong><strong><strong><strong>1、首先在get访问页面时，创建表单类不传参数，然后把这个表单类传到html页面，在html页面通过，<span style="color: #ff0000">表单类.字段名称</span>，来自动创建表单标签</strong></strong></strong></strong></span></p>
<p><span style="background-color: #ffffff"><strong><strong><strong><strong>　　每一种表单字段类型，都有一个默认的表单标签，这个标签是可以更改的，所以表单类可以创建任何表单标签</strong></strong></strong></strong></span></p>
<p><span style="background-color: #ffffff"><strong><strong><strong><strong>2、在post访问时，再次创建表单类需要传参，将post请求对象传入表单类进行验证表单，如果表单不合法，将错误信息对象传到html显示错误信息，将这次创建的表单类传到html页面替换get时创建的表单类</strong></strong></strong></strong></span></p>
<p><span style="color: #0000ff; background-color: #ffffff"><strong>逻辑处理</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">from</span> django.shortcuts <span style="color: #0000ff">import</span><span style="color: #000000"> render
</span><span style="color: #0000ff">from</span> app1.models <span style="color: #0000ff">import</span> *    <span style="color: #008000">#</span><span style="color: #008000">导入数据库操作模块</span>
<span style="color: #0000ff">from</span> app1.biaodan <span style="color: #0000ff">import</span> *   <span style="color: #008000">#</span><span style="color: #008000">导入自定义表单验证模块</span><span style="color: #008000">
#</span><span style="color: #008000">逻辑处理模块</span>
<span style="color: #0000ff">def</span><span style="color: #000000"> special(request):
    </span><span style="color: #0000ff">if</span> request.method == <span style="color: #800000">'</span><span style="color: #800000; background-color: #ffff00">GET</span><span style="color: #800000">'</span><span style="color: #000000">:
        <span style="background-color: #ffff00">f </span></span><span style="background-color: #ffff00">= yhbd()</span>                                            <span style="color: #008000">#</span><span style="color: #008000">创建表单验证类，不传参</span>
        <span style="color: #0000ff">return</span> render(request, <span style="color: #800000">'</span><span style="color: #800000">app1/index.html</span><span style="color: #800000">'</span>,{<span style="background-color: #ffff00"><span style="color: #800000">'</span><span style="color: #800000">form</span><span style="color: #800000">'</span>:f</span>})  <span style="color: #008000">#</span><span style="color: #008000"> 打开页面，并将表单验证类传到html生成表单标签</span>

    <span style="color: #0000ff">if</span> request.method == <span style="color: #800000">"</span><span style="color: #800000; background-color: #ff99cc">POST</span><span style="color: #800000">"</span><span style="color: #000000">:
        <span style="background-color: #ff99cc">f </span></span><span style="background-color: #ff99cc">= yhbd(request.POST)</span>                          <span style="color: #008000">#</span><span style="color: #008000">创建验证表单类，将用户请求POST对象传进表单验证类进行验证</span>

        <span style="background-color: #ff99cc"><span style="color: #0000ff">if</span> f.is_valid():</span>                                <span style="color: #008000">#</span><span style="color: #008000">判断验证如果通过</span>
            <span style="background-color: #ff99cc"><span style="color: #0000ff">print</span>(f.cleaned_data)</span>                       <span style="color: #008000">#</span><span style="color: #008000">获取到用户提交信息,字典方式</span>
        <span style="color: #0000ff">else</span>:                                           <span style="color: #008000">#</span><span style="color: #008000">如果没通过</span>
            <span style="color: #008000">#</span><span style="color: #008000"><span style="background-color: #ff99cc"> print(f.errors)</span>                           #获取错误对象</span>
            <span style="color: #0000ff">pass</span>

        <span style="color: #0000ff">return</span> render(request, <span style="color: #800000">'</span><span style="color: #800000">app1/index.html</span><span style="color: #800000">'</span>,{<span style="background-color: #ff99cc"><span style="color: #800000">'</span><span style="color: #800000">cuow</span><span style="color: #800000">'</span>:f.errors</span>,<span style="background-color: #ff99cc"><span style="color: #800000">'</span><span style="color: #800000">form</span><span style="color: #800000">'</span>:f</span>})  <span style="color: #008000">#</span><span style="color: #008000"> 打开页面，将错误信息用字典方式传到html页面，并且将表单类传到html页面替换没传参的表单验证类</span></pre>
</div>
<p><span style="color: #0000ff"><strong>html</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">&lt;!</span><span style="color: #ff00ff">DOCTYPE html</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">html </span><span style="color: #ff0000">lang</span><span style="color: #0000ff">="en"</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">head</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">meta </span><span style="color: #ff0000">charset</span><span style="color: #0000ff">="UTF-8"</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">title</span><span style="color: #0000ff">&gt;</span>Title<span style="color: #0000ff">&lt;/</span><span style="color: #800000">title</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">link </span><span style="color: #ff0000">rel</span><span style="color: #0000ff">="stylesheet"</span><span style="color: #ff0000"> type</span><span style="color: #0000ff">="text/css"</span><span style="color: #ff0000"> href</span><span style="color: #0000ff">="/static/css/tou.css"</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">head</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">body</span><span style="color: #0000ff">&gt;</span>

<span style="color: #0000ff">&lt;</span><span style="color: #800000">form </span><span style="color: #ff0000">action</span><span style="color: #0000ff">="/bugarticles/"</span><span style="color: #ff0000"> method</span><span style="color: #0000ff">="post"</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span><span style="color: #000000; background-color: #ffff00">
        {{ form.user }}                                     </span><span style="color: #008000">&lt;!--</span><span style="color: #008000"> 接收get请求时创建的表单类，生成表单标签 </span><span style="color: #008000">--&gt;</span><span style="background-color: #ff99cc"><span style="color: #000000">
        {% if cuow.user.0 %}
            </span><span style="color: #0000ff">&lt;</span><span style="color: #800000">span </span><span style="color: #ff0000">class</span><span style="color: #0000ff">="cuow"</span><span style="color: #0000ff">&gt;</span>{{ cuow.user.0 }}<span style="color: #0000ff">&lt;/</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span>     <span style="color: #008000">&lt;!--</span><span style="color: #008000"> 接收错误信息里的user的错误信息 </span><span style="color: #008000">--&gt;</span><span style="color: #000000">
        {% endif %}
    </span></span><span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span><span style="color: #000000; background-color: #ffff00">
        {{ form.pwd }}                                      </span><span style="color: #008000">&lt;!--</span><span style="color: #008000"> 接收get请求时创建的表单类，生成表单标签 </span><span style="color: #008000">--&gt;</span><span style="background-color: #ff99cc"><span style="color: #000000">
        {% if cuow.pwd.0 %}
            </span><span style="color: #0000ff">&lt;</span><span style="color: #800000">span </span><span style="color: #ff0000">class</span><span style="color: #0000ff">="cuow"</span><span style="color: #0000ff">&gt;</span>{{ cuow.pwd.0 }}<span style="color: #0000ff">&lt;/</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span>      <span style="color: #008000">&lt;!--</span><span style="color: #008000"> 接收错误信息里的pwd的错误信息 </span><span style="color: #008000">--&gt;</span><span style="color: #000000">
        {% endif %}
    </span></span><span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="submit"</span><span style="color: #ff0000"> value</span><span style="color: #0000ff">="提交"</span><span style="color: #0000ff">/&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">form</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">body</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">html</span><span style="color: #0000ff">&gt;</span></pre>
</div>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong>常用的内置验证字段</strong></span></p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">EmailField()</span>验证邮箱字段</strong></span><br><span style="color: #ff0000"><strong><span style="color: #0000ff">CharField()</span>验证字符串字段</strong></span><br><span style="color: #ff0000"><strong><span style="color: #0000ff">URLField()</span>验证url地址字段</strong></span><br><span style="color: #ff0000"><strong><span style="color: #0000ff">IntegerField()</span>验证数字字段</strong></span><br><span style="color: #ff0000"><strong><span style="color: #0000ff">GenericIPAddressField()</span>验证IP字段</strong></span></p>
<p><span style="color: #0000ff"><strong>注意：虽然有很多内置验证字段，但是我们还是要根据我们自己的需求来验证，所以</strong></span></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong>验证字段的参数</strong></span></p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">required</span>设置字段是否可以为空</strong></span><br><strong>	　　True不可以为空</strong><br><strong>	　　False可以为空</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user = forms.CharField(<span style="background-color: #ff99cc">required=True</span>)   <span style="color: #008000">#</span><span style="color: #008000">True不可以为空</span>
    pwd = forms.CharField()</pre>
</div>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">max_length</span>最大字符数</strong></span><br><span style="color: #ff0000"><strong><span style="color: #0000ff">min_length</span>最小字符数</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user = forms.CharField(<span style="background-color: #ff99cc">max_length=4</span>,<span style="background-color: #ff99cc">min_length=2</span><span style="color: #000000">)
    pwd </span>= forms.CharField()</pre>
</div>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">error_messages</span>自定义错误提示信息</strong></span><br><strong>　　参数是一个字典{'验证名称':'错误提示'}</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        <span style="background-color: #ffff00">required</span></span>=<span style="color: #000000">True,
        <span style="background-color: #ffff00">max_length</span></span>=4<span style="color: #000000">,
        <span style="background-color: #ffff00">min_length</span></span>=2<span style="color: #000000">,
<span style="background-color: #ff99cc">        error_messages</span></span><span style="background-color: #ff99cc">=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000; background-color: #ffff00">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000; background-color: #ffff00">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000; background-color: #ffff00">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span></span><span style="color: #000000"><span style="background-color: #ff99cc">
        }</span>
    )
    pwd </span>= forms.CharField()</pre>
</div>
<p><strong><span style="color: #0000ff">invalid</span>设置邮箱格式错误提示信息</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        required</span>=<span style="color: #000000">True,
        max_length</span>=4<span style="color: #000000">,
        min_length</span>=2<span style="color: #000000">,
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span><span style="color: #000000">
        }
    )
    pwd </span>=<span style="color: #000000"> forms.<span style="background-color: #ff99cc">EmailField</span>(
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>: <span style="color: #800000">'</span><span style="color: #800000">邮箱不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="background-color: #ff99cc"><span style="color: #800000">'</span><span style="color: #800000">invalid</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">邮箱格式不正确</span><span style="color: #800000">'</span></span><span style="color: #000000">
        }
    )</span></pre>
</div>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">widget</span>设置表单字段在html页面的类型</strong></span><br><strong>	　　使用方式：widget=forms.Textarea()</strong><br><strong>	　　Textarea(): &lt;textarea&gt;标签类型</strong><br><strong>	　　TextInput()：&lt;input&gt;标签类型</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        required</span>=<span style="color: #000000">True,
        max_length</span>=4<span style="color: #000000">,
        min_length</span>=2<span style="color: #000000">,
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span><span style="color: #000000">
        }
    )
    pwd </span>=<span style="color: #000000"> forms.CharField(
        <span style="background-color: #ff99cc">widget</span></span>=<span style="color: #000000">forms.<span style="background-color: #ff99cc">TextInput()</span>,
    )</span></pre>
</div>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">attrs</span>给表单标签设置属性，可以给标签元素设置class样式，和input标签的各种type属性</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        required</span>=<span style="color: #000000">True,
        max_length</span>=4<span style="color: #000000">,
        min_length</span>=2<span style="color: #000000">,
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span><span style="color: #000000">
        }
    )
    pwd </span>=<span style="color: #000000"> forms.CharField(
        widget</span>=forms.TextInput(<span style="background-color: #ff99cc">attrs={<span style="background-color: #ffff00"><span style="color: #800000">'</span><span style="color: #800000">type</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">password</span><span style="color: #800000">'</span></span>,<span style="background-color: #ffff00"><span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">c1</span><span style="color: #800000">'</span></span></span><span style="color: #000000"><span style="background-color: #ff99cc">}</span>),
    )</span></pre>
</div>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">Select</span>生成表单，select标签，下拉选项框</strong></span><br><strong>	　　参数:</strong><br><strong>		　　　　<span style="color: #0000ff">choices</span>设置下拉数据，元组类型</strong><br><strong>		　　　　<span style="color: #0000ff">attrs</span>设置select标签属性</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        required</span>=<span style="color: #000000">True,
        max_length</span>=4<span style="color: #000000">,
        min_length</span>=2<span style="color: #000000">,
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span><span style="color: #000000">
        }
    )

<span style="background-color: #ffff00">    zhi </span></span><span style="background-color: #ffff00">=<span style="color: #000000"> (
        (0, </span><span style="color: #800000">'</span><span style="color: #800000">普通会员</span><span style="color: #800000">'</span><span style="color: #000000">),
        (</span>1, <span style="color: #800000">'</span><span style="color: #800000">超级会员</span><span style="color: #800000">'</span><span style="color: #000000">),
        (</span>2, <span style="color: #800000">'</span><span style="color: #800000">黄金会员</span><span style="color: #800000">'</span><span style="color: #000000">),
        (</span>3, <span style="color: #800000">'</span><span style="color: #800000">白银会员</span><span style="color: #800000">'</span><span style="color: #000000">),
        (</span>4, <span style="color: #800000">'</span><span style="color: #800000">vip会员</span><span style="color: #800000">'</span></span><span style="color: #000000"><span style="background-color: #ffff00">)
    )</span>
    pwd </span>=<span style="color: #000000"> forms.CharField(
        widget</span>=forms.<span style="background-color: #ff99cc">widgets.Select(<span style="background-color: #ffff00">choices=zhi</span>,attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">c1</span><span style="color: #800000">'</span></span><span style="color: #000000"><span style="background-color: #ff99cc">})</span>
    )</span></pre>
</div>
<p><img src="https://images2015.cnblogs.com/blog/955761/201707/955761-20170717194742910-289353552.png" alt=""></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>下拉框结合数据库应用</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>
<span style="background-color: #ffff00"><span style="color: #0000ff">from</span> app1.models <span style="color: #0000ff">import</span> *</span>       <span style="color: #008000">#</span><span style="color: #008000">导入数据库操作</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        required</span>=<span style="color: #000000">True,
        max_length</span>=4<span style="color: #000000">,
        min_length</span>=2<span style="color: #000000">,
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span><span style="color: #000000">
        }
    )

    <span style="background-color: #ffff00">a </span></span><span style="background-color: #ffff00">= shengf.objects.all().values_list(<span style="color: #800000">'</span><span style="color: #800000">id</span><span style="color: #800000">'</span>,<span style="color: #800000">'</span><span style="color: #800000">shf</span><span style="color: #800000">'</span>) <span style="color: #008000">#</span><span style="color: #008000">获取数据库里shengf表里的id和shf字段的数据</span></span>
    pwd =<span style="color: #000000"> forms.CharField(
        widget</span>=forms.widgets.<span style="background-color: #ff99cc">Select(<span style="background-color: #ffff00">choices=a</span>,attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">c1</span><span style="color: #800000">'</span>})</span> <span style="color: #008000">#</span><span style="color: #008000">将数据库的数据显示到下拉框</span>
    )</pre>
</div>
<p>&nbsp;<img src="https://images2015.cnblogs.com/blog/955761/201707/955761-20170717194742910-289353552.png" alt=""></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>下拉框结合数据库应用，防止数据库添加了数据，或者删除了数据，页面缓存了下拉框数据，无法事实数据同步</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>
<span style="color: #0000ff">from</span> app1.models <span style="color: #0000ff">import</span> *       <span style="color: #008000">#</span><span style="color: #008000">导入数据库操作</span>

<span style="color: #0000ff">class</span> <span style="background-color: #ff99cc">yhbd</span>(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        required</span>=<span style="color: #000000">True,
        max_length</span>=4<span style="color: #000000">,
        min_length</span>=2<span style="color: #000000">,
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span><span style="color: #000000">
        }
    )

    a </span>= shengf.objects.all().values_list(<span style="color: #800000">'</span><span style="color: #800000">id</span><span style="color: #800000">'</span>,<span style="color: #800000">'</span><span style="color: #800000">shf</span><span style="color: #800000">'</span>) <span style="color: #008000">#</span><span style="color: #008000">获取数据库里shengf表里的id和shf字段的数据</span>
    <span style="background-color: #ff99cc">pwd</span> =<span style="color: #000000"> forms.CharField(
        widget</span>=forms.widgets.Select(choices=a,attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">c1</span><span style="color: #800000">'</span>}) <span style="color: #008000">#</span><span style="color: #008000">将数据库的数据显示到下拉框</span>
<span style="color: #000000">    )

    </span><span style="color: #008000">#</span><span style="color: #008000">防止数据库添加了数据，或者删除了数据，页面缓存了下拉框数据，无法事实数据同步</span>
    <span style="color: #0000ff">def</span> <span style="color: #800080">__init__</span>(self,*args, **kwargs):                                     <span style="color: #008000">#</span><span style="color: #008000">创建类的__init__方法，每次创建类时都会执行</span>
        super(<span style="background-color: #ff99cc">yhbd</span>,self).<span style="color: #800080">__init__</span>(*args, **kwargs)                          <span style="color: #008000">#</span><span style="color: #008000">获取当前类的父类里的__init__方法执行</span>
        a = shengf.objects.all().values_list(<span style="color: #800000">'</span><span style="color: #800000">id</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">shf</span><span style="color: #800000">'</span>)                   <span style="color: #008000">#</span><span style="color: #008000">重新获取数据库里shengf表里的id和shf字段的数据</span>
        self.fields[<span style="background-color: #ff99cc"><span style="color: #800000">'</span><span style="color: #800000">pwd</span><span style="color: #800000">'</span></span>] = forms.CharField(widget=forms.widgets.Select(choices=a,attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">c1</span><span style="color: #800000">'</span>}))  <span style="color: #008000">#</span><span style="color: #008000">更新一下表单pwd字段的数据</span></pre>
</div>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>自定义验证规则</strong></span></p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">validators</span>设置自定义验证规则，参数是一个列表，列表里是自定义验证方法名称</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>
<span style="color: #0000ff">from</span> django.core.exceptions <span style="color: #0000ff">import</span><span style="color: #000000"> ValidationError
</span><span style="color: #0000ff">import</span><span style="color: #000000"> re

</span><span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        required</span>=<span style="color: #000000">True,
        max_length</span>=4<span style="color: #000000">,
        min_length</span>=2<span style="color: #000000">,
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span><span style="color: #000000">
        }
    )


    </span><span style="color: #008000">#</span><span style="color: #008000">自定义验证规则</span>
<span style="background-color: #ffff00">    <span style="color: #0000ff">def</span><span style="color: #000000"> shouji(value):
        mobile_re </span>= re.compile(r<span style="color: #800000">'</span><span style="color: #800000">^(13[0-9]|15[012356789]|17[678]|18[0-9]|14[57])[0-9]{8}$</span><span style="color: #800000">'</span><span style="color: #000000">)
        </span><span style="color: #0000ff">if</span> <span style="color: #0000ff">not</span><span style="color: #000000"> mobile_re.match(value):
            </span><span style="color: #0000ff">raise</span> ValidationError(<span style="color: #800000">'</span><span style="color: #800000">手机号码格式错误</span><span style="color: #800000">'</span>)   <span style="color: #008000">#</span><span style="color: #008000">如果不匹配返回错误信息</span></span>
<span style="color: #000000">

    pwd </span>=<span style="color: #000000"> forms.CharField(
        <span style="background-color: #ffff00">validators</span></span><span style="background-color: #ffff00">=[shouji, ],   <span style="color: #008000">#</span><span style="color: #008000">设置自定义验证规则</span></span>
        required=<span style="color: #000000">True,
        widget</span>=<span style="color: #000000">forms.TextInput(
            attrs</span>=<span style="color: #000000">{
                </span><span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>: <span style="color: #800000">"</span><span style="color: #800000">cl</span><span style="color: #800000">"</span><span style="color: #000000">,
                </span><span style="color: #800000">'</span><span style="color: #800000">placeholder</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">手机号码</span><span style="color: #800000">'</span><span style="color: #000000">
            }
        ),
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">手机不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
        }
    )</span></pre>
</div>
<p><img src="https://images2015.cnblogs.com/blog/955761/201707/955761-20170717232723411-1592842803.png" alt=""></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>其他</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span>
<span style="color: #0000ff">import</span><span style="color: #000000"> re
</span><span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span><span style="color: #000000"> forms
</span><span style="color: #0000ff">from</span> django.core.exceptions <span style="color: #0000ff">import</span><span style="color: #000000"> ValidationError


</span><span style="color: #0000ff">def</span><span style="color: #000000"> mobile_validate(value):
    mobile_re </span>= re.compile(r<span style="color: #800000">'</span><span style="color: #800000">^(13[0-9]|15[012356789]|17[678]|18[0-9]|14[57])[0-9]{8}$</span><span style="color: #800000">'</span><span style="color: #000000">)
    </span><span style="color: #0000ff">if</span> <span style="color: #0000ff">not</span><span style="color: #000000"> mobile_re.match(value):
        </span><span style="color: #0000ff">raise</span> ValidationError(<span style="color: #800000">'</span><span style="color: #800000">手机号码格式错误</span><span style="color: #800000">'</span><span style="color: #000000">)


</span><span style="color: #0000ff">class</span><span style="color: #000000"> PublishForm(forms.Form):

    user_type_choice </span>=<span style="color: #000000"> (
        (0, u</span><span style="color: #800000">'</span><span style="color: #800000">普通用户</span><span style="color: #800000">'</span><span style="color: #000000">),
        (</span>1, u<span style="color: #800000">'</span><span style="color: #800000">高级用户</span><span style="color: #800000">'</span><span style="color: #000000">),
    )

    user_type </span>= forms.IntegerField(widget=forms.widgets.Select(choices=<span style="color: #000000">user_type_choice,
                                                                  attrs</span>={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>: <span style="color: #800000">"</span><span style="color: #800000">form-control</span><span style="color: #800000">"</span><span style="color: #000000">}))

    title </span>= forms.CharField(max_length=20<span style="color: #000000">,
                            min_length</span>=5<span style="color: #000000">,
                            error_messages</span>={<span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">标题不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
                                            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">标题最少为5个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
                                            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">标题最多为20个字符</span><span style="color: #800000">'</span><span style="color: #000000">},
                            widget</span>=forms.TextInput(attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>: <span style="color: #800000">"</span><span style="color: #800000">form-control</span><span style="color: #800000">"</span><span style="color: #000000">,
                                                          </span><span style="color: #800000">'</span><span style="color: #800000">placeholder</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">标题5-20个字符</span><span style="color: #800000">'</span><span style="color: #000000">}))

    memo </span>= forms.CharField(required=<span style="color: #000000">False,
                           max_length</span>=256<span style="color: #000000">,
                           widget</span>=forms.widgets.Textarea(attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>: <span style="color: #800000">"</span><span style="color: #800000">form-control no-radius</span><span style="color: #800000">"</span>, <span style="color: #800000">'</span><span style="color: #800000">placeholder</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">详细描述</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">rows</span><span style="color: #800000">'</span>: 3<span style="color: #000000">}))

    phone </span>= forms.CharField(validators=<span style="color: #000000">[mobile_validate, ],
                            error_messages</span>={<span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">手机不能为空</span><span style="color: #800000">'</span><span style="color: #000000">},
                            widget</span>=forms.TextInput(attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>: <span style="color: #800000">"</span><span style="color: #800000">form-control</span><span style="color: #800000">"</span><span style="color: #000000">,
                                                          </span><span style="color: #800000">'</span><span style="color: #800000">placeholder</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">手机号码</span><span style="color: #800000">'</span><span style="color: #000000">}))

    email </span>= forms.EmailField(required=<span style="color: #000000">False,
                            error_messages</span>={<span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">邮箱不能为空</span><span style="color: #800000">'</span>,<span style="color: #800000">'</span><span style="color: #800000">invalid</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">邮箱格式错误</span><span style="color: #800000">'</span><span style="color: #000000">},
                            widget</span>=forms.TextInput(attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>: <span style="color: #800000">"</span><span style="color: #800000">form-control</span><span style="color: #800000">"</span>, <span style="color: #800000">'</span><span style="color: #800000">placeholder</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">邮箱</span><span style="color: #800000">'</span>}))</pre>
</div>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>注意：如果表单是通过Ajax提交的，页面不刷新，那么html页面将无法获取到错误信息，那么我们只能将所有错误信息构造成字典，然后以json的方式返回给Ajax，添加到页面</strong></span></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>将models数据库表类转换成表单验证类【必要使用】</strong></span></p>
<p><span style="color: #000000"><strong>这样可以少写表单验证代码，使用的是数据库字段的验证规则</strong></span></p>
<p><span style="color: #ff0000"><strong>models.py</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">from</span> django.db <span style="color: #0000ff">import</span> models        <span style="color: #008000">#</span><span style="color: #008000"> 导入models对象</span>

<span style="color: #0000ff">class</span><span style="color: #000000"><span style="background-color: #ff99cc"> CourseOrg</span>(models.Model):
    <span style="background-color: #ff99cc">name </span></span><span style="background-color: #ff99cc">= models.CharField(max_length=50, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">机构名称</span><span style="color: #800000">'</span></span><span style="color: #000000"><span style="background-color: #ff99cc">)</span>
    desc </span>= models.TextField(verbose_name=<span style="color: #800000">'</span><span style="color: #800000">机构描述</span><span style="color: #800000">'</span><span style="color: #000000">)
    <span style="background-color: #ff99cc">category </span></span><span style="background-color: #ff99cc">= models.CharField(max_length=20, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">机构类别</span><span style="color: #800000">'</span>, default=<span style="color: #800000">'</span><span style="color: #800000">pxjg</span><span style="color: #800000">'</span>, choices=((<span style="color: #800000">'</span><span style="color: #800000">pxjg</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">培训机构</span><span style="color: #800000">'</span>), (<span style="color: #800000">'</span><span style="color: #800000">gx</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">高校</span><span style="color: #800000">'</span>), (<span style="color: #800000">'</span><span style="color: #800000">gr</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">个人</span><span style="color: #800000">'</span></span><span style="color: #000000"><span style="background-color: #ff99cc">)))</span>
    click </span>= models.IntegerField(default=0, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">点击数</span><span style="color: #800000">'</span><span style="color: #000000">)
    <span style="background-color: #ff99cc">fav_nums </span></span><span style="background-color: #ff99cc">= models.IntegerField(default=0, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">收藏数</span><span style="color: #800000">'</span></span><span style="color: #000000"><span style="background-color: #ff99cc">)</span>
    image </span>= models.ImageField(upload_to=<span style="color: #800000">'</span><span style="color: #800000">org/%Y/%m</span><span style="color: #800000">'</span>, storage=ImageStorage(), verbose_name=<span style="color: #800000">'</span><span style="color: #800000">封面图</span><span style="color: #800000">'</span>, max_length=100<span style="color: #000000">)
    address </span>= models.CharField(max_length=150, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">机构地址</span><span style="color: #800000">'</span><span style="color: #000000">)
    city </span>= models.ForeignKey(CityDict, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">外键城市表</span><span style="color: #800000">'</span><span style="color: #000000">)
    add_time </span>= models.DateTimeField(default=datetime.now, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">添加日期</span><span style="color: #800000">'</span><span style="color: #000000">)

    </span><span style="color: #0000ff">class</span><span style="color: #000000"> Meta:
        verbose_name </span>= <span style="color: #800000">'</span><span style="color: #800000">课程机构表</span><span style="color: #800000">'</span><span style="color: #000000">
        verbose_name_plural </span>=<span style="color: #000000"> verbose_name

    </span><span style="color: #0000ff">def</span> <span style="color: #800080">__str__</span><span style="color: #000000">(self):
        </span><span style="color: #0000ff">return</span> self.name</pre>
</div>
<p><span style="color: #ff0000"><strong>forms.py</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf8 -*-</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> <span style="background-color: #ff99cc">forms</span>                             <span style="color: #008000">#</span><span style="color: #008000"> 导入Django的表单验证模块</span>
<span style="color: #0000ff">from</span> app_organization.models <span style="color: #0000ff">import</span> <span style="background-color: #ff99cc"><strong>CourseOrg</strong></span>        <span style="color: #008000">#</span><span style="color: #008000"> 导入数据库表类</span>


<span style="color: #0000ff">class</span><span style="color: #000000"> CourseOrgForm(<span style="background-color: #ff99cc">forms.ModelForm</span>):
    zdyi </span>= forms.CharField()                         <span style="color: #008000">#</span><span style="color: #008000"> 自定义表单验证字段</span>

    <span style="color: #0000ff">class</span><span style="color: #000000"> Meta:
        model </span>= <span style="background-color: #ff99cc">CourseOrg</span>                            <span style="color: #008000">#</span><span style="color: #008000"> 设置要将数据库表类转换成表单验证类的名称</span>
        fields = [<span style="color: #800000">'</span><span style="color: #800000">name</span><span style="color: #800000">'</span>,<span style="color: #800000">'</span><span style="color: #800000">category</span><span style="color: #800000">'</span>,<span style="color: #800000">'</span><span style="color: #800000">fav_nums</span><span style="color: #800000">'</span>]      <span style="color: #008000">#</span><span style="color: #008000"> 要使用的字段</span></pre>
</div>
<p>&nbsp;</p></div>第三百一十一节，Django框架，Form表单验证


			<div id="cnblogs_post_body" class="blogpost-body"><p><strong>第三百一十一节，Django框架，Form表单验证</strong></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong>表单提交</strong></span></p>
<p><span style="color: #0000ff"><strong>html</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">&lt;!</span><span style="color: #ff00ff">DOCTYPE html</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">html </span><span style="color: #ff0000">lang</span><span style="color: #0000ff">="en"</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">head</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">meta </span><span style="color: #ff0000">charset</span><span style="color: #0000ff">="UTF-8"</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">title</span><span style="color: #0000ff">&gt;</span>Title<span style="color: #0000ff">&lt;/</span><span style="color: #800000">title</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">link </span><span style="color: #ff0000">rel</span><span style="color: #0000ff">="stylesheet"</span><span style="color: #ff0000"> type</span><span style="color: #0000ff">="text/css"</span><span style="color: #ff0000"> href</span><span style="color: #0000ff">="/static/css/tou.css"</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">head</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">body</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">form </span><span style="color: #ff0000">action</span><span style="color: #0000ff">="<span style="background-color: #ff99cc">/bug<span style="background-color: #ffff00">articles</span>/</span>"</span><span style="color: #ff0000"> method</span><span style="color: #0000ff">="post"</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="text"</span><span style="color: #ff0000"> name</span><span style="color: #0000ff">="user"</span><span style="color: #0000ff">/&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="text"</span><span style="color: #ff0000"> name</span><span style="color: #0000ff">="pwd"</span><span style="color: #0000ff">/&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="submit"</span><span style="color: #ff0000"> value</span><span style="color: #0000ff">="提交"</span><span style="color: #0000ff">/&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">form</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">body</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">html</span><span style="color: #0000ff">&gt;</span></pre>
</div>
<p><span style="color: #0000ff"><strong>路由映射</strong></span></p>
<div class="cnblogs_code">
<pre>urlpatterns =<span style="color: #000000"> [
    url(r</span><span style="color: #800000">'</span><span style="color: #800000">admin/</span><span style="color: #800000">'</span>, admin.site.urls),   <span style="color: #008000">#</span><span style="color: #008000">路由映射admin数据库管理</span>
    url(r<span style="color: #800000">'</span><span style="color: #800000"><span style="background-color: #ffff00">articles</span>/</span><span style="color: #800000">'</span><span style="color: #000000">, <span style="background-color: #ffff00">views.special</span>)    
]</span></pre>
</div>
<p><span style="color: #0000ff"><strong>逻辑处理</strong></span></p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">method</span>属性获取用户请求方式，post或者get</strong></span><br><strong>使用方式：请求对象.method</strong></p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">POST</span>获取用户post请求方式的信息</strong></span><br><strong>使用方式：请求对象.POST</strong></p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">POST.get()</span>获取用户POST请求方式的表单name名称对应的值，参数是表单name名</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">from</span> django.shortcuts <span style="color: #0000ff">import</span><span style="color: #000000"> render
</span><span style="color: #0000ff">from</span> app1.models <span style="color: #0000ff">import</span> *    <span style="color: #008000">#</span><span style="color: #008000">导入数据库操作模块</span>

<span style="color: #008000">#</span><span style="color: #008000">逻辑处理模块</span>
<span style="color: #0000ff">def</span><span style="color: #000000"><span style="background-color: #ffff00"> special</span>(request):  　　　　　　　　　　　　　 <span style="color: #008080">#自定义参数接收用户请求对象
    </span></span><span style="color: #0000ff">if</span> request.method == <span style="color: #800000">"</span><span style="color: #800000">POST</span><span style="color: #800000">"</span><span style="color: #000000">:　　　　　　　　 <span style="color: #008080">#判断用户请求如果是post方式
        </span></span><span style="color: #0000ff">print</span>(request.POST.get(<span style="color: #800000">'</span><span style="color: #800000">user</span><span style="color: #800000">'</span>,None))  <span style="color: #008000">#</span><span style="color: #008000">接收用户表单提交的name名称对应的值</span>
        <span style="color: #0000ff">print</span>(request.POST.get(<span style="color: #800000">'</span><span style="color: #800000">pwd</span><span style="color: #800000">'</span>, None))  <span style="color: #008000">#</span><span style="color: #008000">接收用户表单提交的name名称对应的值</span>
    <span style="color: #0000ff">return</span> render(request, <span style="color: #800000">'</span><span style="color: #800000">app1/index.html</span><span style="color: #800000">'</span>, locals())  <span style="color: #008000">#</span><span style="color: #008000"> 打开页面</span></pre>
</div>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong>表单提交验证，获取数据与获取错误信息</strong></span></p>
<p><span style="color: #000000"><strong>1、创建表单验证模块，必须继承</strong><span style="color: #0000ff"><strong>Django的表单验证forms.Form类</strong></span></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> <span style="background-color: #ff99cc">django <span style="color: #0000ff">import</span> forms</span>        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(<span style="background-color: #ff99cc">forms.Form</span>):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    <span style="background-color: #ff99cc">user</span> = forms.CharField()    <span style="color: #008000">#</span><span style="color: #008000">接收逻辑处理时，创建yhbd类时传进来的POST对象，里的表单name名对应的值进行验证</span>
    <span style="background-color: #ff99cc">pwd</span> = forms.CharField()     <span style="color: #008000">#</span><span style="color: #008000">#接收逻辑处理时，创建yhbd类时传进来的POST对象，里的表单name名对应的值进行验证</span></pre>
</div>
<p><strong>2、逻辑处理，创建表单验证模块里的验证类，并将用户请求的<span style="color: #0000ff">POST对象</span>，传入验证类进行验证，验证后获取验证通过的提交信息，或者验证没通过的错误信息</strong></p>
<p><span style="color: #0000ff"><strong>如果出现错误，将错误信息对象以字典方式传到html页面</strong></span></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">is_valid()</span>返回验证是否通过的布尔值</strong></span><br><strong>使用方式：验证类.is_valid()</strong></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">cleaned_data</span>获取验证通过后的所有提交数据，返回字典</strong></span><br><strong>使用方式：验证类.cleaned_data</strong></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">errors</span>获取验证错误信息，返回所有表单的错误信息对象</strong></span><br><strong>使用方法：验证类.errors</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">from</span> django.shortcuts <span style="color: #0000ff">import</span><span style="color: #000000"> render
</span><span style="color: #0000ff">from</span> app1.models <span style="color: #0000ff">import</span> *    <span style="color: #008000">#</span><span style="color: #008000">导入数据库操作模块</span>
<span style="color: #0000ff">from</span> app1.biaodan <span style="color: #0000ff">import</span> *   <span style="color: #008000">#</span><span style="color: #008000">导入自定义表单验证模块</span><span style="color: #008000">
#</span><span style="color: #008000">逻辑处理模块</span>
<span style="color: #0000ff">def</span><span style="color: #000000"> special(request):
    </span><span style="color: #0000ff">if</span> request.method == <span style="color: #800000">'</span><span style="color: #800000">GET</span><span style="color: #800000">'</span><span style="color: #000000">:
        </span><span style="color: #0000ff">return</span> render(request, <span style="color: #800000">'</span><span style="color: #800000">app1/index.html</span><span style="color: #800000">'</span>, locals())  <span style="color: #008000">#</span><span style="color: #008000"> 打开页面</span>

    <span style="background-color: #ff99cc"><span style="color: #0000ff">if</span> request.method == <span style="color: #800000">"</span><span style="color: #800000">POST</span><span style="color: #800000">"</span><span style="color: #000000">:
        </span></span><span style="color: #008000">#</span><span style="color: #008000"> print(request.POST.get('user',None))          #接收用户表单提交的name名称对应的值</span>
        <span style="color: #008000">#</span><span style="color: #008000"> print(request.POST.get('pwd', None))          #接收用户表单提交的name名称对应的值</span>
<span style="background-color: #ff99cc"><span style="color: #000000">
        f </span>= yhbd(request.POST)</span>                          <span style="color: #008000">#</span><span style="color: #008000">创建验证表单类，将用户请求POST对象传进表单验证类进行验证</span>

        <span style="color: #008000">#</span><span style="color: #008000"> ret = f.is_valid()                            #返回验证是否通过</span>
        <span style="color: #008000">#</span><span style="color: #008000"> print(ret)                                    #返回布尔值</span>

       <span style="background-color: #ff99cc"> <span style="color: #0000ff">if</span> f.is_valid():</span>                                <span style="color: #008000">#</span><span style="color: #008000">判断验证如果通过</span>
            <span style="background-color: #ff99cc"><span style="color: #0000ff">print</span>(f.cleaned_data)</span>                       <span style="color: #008000">#</span><span style="color: #008000">获取到用户提交信息,字典方式</span>
        <span style="color: #0000ff">else</span>:                                           <span style="color: #008000">#</span><span style="color: #008000">如果没通过</span>
            <span style="background-color: #ff99cc"><span style="color: #0000ff">print</span>(f.errors)</span>                             <span style="color: #008000">#</span><span style="color: #008000">获取错误对象</span>

        <span style="color: #0000ff">return</span> render(request, <span style="color: #800000">'</span><span style="color: #800000">app1/index.html</span><span style="color: #800000">'</span>,<span style="background-color: #ff99cc">{<span style="color: #800000">'</span><span style="color: #800000">cuow</span><span style="color: #800000">'</span>:f.errors}</span>)  <span style="color: #008000">#</span><span style="color: #008000"> 打开页面，将错误信息用字典方式传到html页面</span></pre>
</div>
<p><strong>3、在html页面接收逻辑处理<span style="color: #0000ff">以字典形式</span>传过来的错误对象，分别获取不同表单的错误信息</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">&lt;!</span><span style="color: #ff00ff">DOCTYPE html</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">html </span><span style="color: #ff0000">lang</span><span style="color: #0000ff">="en"</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">head</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">meta </span><span style="color: #ff0000">charset</span><span style="color: #0000ff">="UTF-8"</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">title</span><span style="color: #0000ff">&gt;</span>Title<span style="color: #0000ff">&lt;/</span><span style="color: #800000">title</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">link </span><span style="color: #ff0000">rel</span><span style="color: #0000ff">="stylesheet"</span><span style="color: #ff0000"> type</span><span style="color: #0000ff">="text/css"</span><span style="color: #ff0000"> href</span><span style="color: #0000ff">="/static/css/tou.css"</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">head</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">body</span><span style="color: #0000ff">&gt;</span>

<span style="color: #0000ff">&lt;</span><span style="color: #800000">form </span><span style="color: #ff0000">action</span><span style="color: #0000ff">="/bugarticles/"</span><span style="color: #ff0000"> method</span><span style="color: #0000ff">="post"</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="text"</span><span style="color: #ff0000"> name</span><span style="color: #0000ff">="user"</span><span style="color: #0000ff">/&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span><span style="background-color: #ff99cc">{{ cuow.user.0 }}</span><span style="color: #0000ff">&lt;/</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span>     <span style="color: #008000">&lt;!--</span><span style="color: #008000"> 接收错误信息里的user的错误信息 </span><span style="color: #008000">--&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="text"</span><span style="color: #ff0000"> name</span><span style="color: #0000ff">="pwd"</span><span style="color: #0000ff">/&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span><span style="background-color: #ff99cc">{{ cuow.pwd.0 }}</span><span style="color: #0000ff">&lt;/</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span>      <span style="color: #008000">&lt;!--</span><span style="color: #008000"> 接收错误信息里的pwd的错误信息 </span><span style="color: #008000">--&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="submit"</span><span style="color: #ff0000"> value</span><span style="color: #0000ff">="提交"</span><span style="color: #0000ff">/&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">form</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">body</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">html</span><span style="color: #0000ff">&gt;</span></pre>
</div>
<p>&nbsp;<img src="https://images2015.cnblogs.com/blog/955761/201707/955761-20170716170032722-817776133.png" alt=""></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong>利用表单类自动创建表单标签</strong></span></p>
<p><span style="background-color: #ffffff"><strong>以上表单的&lt;input&gt;是我们自己手动写的，还可以用表单类来自动创建表单标签，好处是不用自己写表单标签，还有就是当用户填写的表单不合法提交时提示错误信息不清空表单</strong></span></p>
<p>&nbsp;</p>
<p><span style="background-color: #ffff00; color: #0000ff"><strong>注意：表单类根据字段创建的表单标签，当用户输入内容时，首先要经过浏览器默认行为的表单验证，如果浏览器<strong>默认行为的表单验证都没有通过那么将无法提交</strong></strong></span></p>
<p><span style="background-color: #ffff00; color: #0000ff"><strong><strong><strong>浏览器<strong>默认行为的表单验证，通过了在进行我们定义的表单类验证，验证合法获取用户提交信息，不合法返回错误信息</strong></strong></strong></strong></span></p>
<p><span style="background-color: #ffffff; color: #0000ff"><strong><strong><strong><strong>利用表单类自动创建表单标签</strong></strong></strong></strong></span></p>
<p><span style="background-color: #ffffff"><strong><strong><strong><strong>1、首先在get访问页面时，创建表单类不传参数，然后把这个表单类传到html页面，在html页面通过，<span style="color: #ff0000">表单类.字段名称</span>，来自动创建表单标签</strong></strong></strong></strong></span></p>
<p><span style="background-color: #ffffff"><strong><strong><strong><strong>　　每一种表单字段类型，都有一个默认的表单标签，这个标签是可以更改的，所以表单类可以创建任何表单标签</strong></strong></strong></strong></span></p>
<p><span style="background-color: #ffffff"><strong><strong><strong><strong>2、在post访问时，再次创建表单类需要传参，将post请求对象传入表单类进行验证表单，如果表单不合法，将错误信息对象传到html显示错误信息，将这次创建的表单类传到html页面替换get时创建的表单类</strong></strong></strong></strong></span></p>
<p><span style="color: #0000ff; background-color: #ffffff"><strong>逻辑处理</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">from</span> django.shortcuts <span style="color: #0000ff">import</span><span style="color: #000000"> render
</span><span style="color: #0000ff">from</span> app1.models <span style="color: #0000ff">import</span> *    <span style="color: #008000">#</span><span style="color: #008000">导入数据库操作模块</span>
<span style="color: #0000ff">from</span> app1.biaodan <span style="color: #0000ff">import</span> *   <span style="color: #008000">#</span><span style="color: #008000">导入自定义表单验证模块</span><span style="color: #008000">
#</span><span style="color: #008000">逻辑处理模块</span>
<span style="color: #0000ff">def</span><span style="color: #000000"> special(request):
    </span><span style="color: #0000ff">if</span> request.method == <span style="color: #800000">'</span><span style="color: #800000; background-color: #ffff00">GET</span><span style="color: #800000">'</span><span style="color: #000000">:
        <span style="background-color: #ffff00">f </span></span><span style="background-color: #ffff00">= yhbd()</span>                                            <span style="color: #008000">#</span><span style="color: #008000">创建表单验证类，不传参</span>
        <span style="color: #0000ff">return</span> render(request, <span style="color: #800000">'</span><span style="color: #800000">app1/index.html</span><span style="color: #800000">'</span>,{<span style="background-color: #ffff00"><span style="color: #800000">'</span><span style="color: #800000">form</span><span style="color: #800000">'</span>:f</span>})  <span style="color: #008000">#</span><span style="color: #008000"> 打开页面，并将表单验证类传到html生成表单标签</span>

    <span style="color: #0000ff">if</span> request.method == <span style="color: #800000">"</span><span style="color: #800000; background-color: #ff99cc">POST</span><span style="color: #800000">"</span><span style="color: #000000">:
        <span style="background-color: #ff99cc">f </span></span><span style="background-color: #ff99cc">= yhbd(request.POST)</span>                          <span style="color: #008000">#</span><span style="color: #008000">创建验证表单类，将用户请求POST对象传进表单验证类进行验证</span>

        <span style="background-color: #ff99cc"><span style="color: #0000ff">if</span> f.is_valid():</span>                                <span style="color: #008000">#</span><span style="color: #008000">判断验证如果通过</span>
            <span style="background-color: #ff99cc"><span style="color: #0000ff">print</span>(f.cleaned_data)</span>                       <span style="color: #008000">#</span><span style="color: #008000">获取到用户提交信息,字典方式</span>
        <span style="color: #0000ff">else</span>:                                           <span style="color: #008000">#</span><span style="color: #008000">如果没通过</span>
            <span style="color: #008000">#</span><span style="color: #008000"><span style="background-color: #ff99cc"> print(f.errors)</span>                           #获取错误对象</span>
            <span style="color: #0000ff">pass</span>

        <span style="color: #0000ff">return</span> render(request, <span style="color: #800000">'</span><span style="color: #800000">app1/index.html</span><span style="color: #800000">'</span>,{<span style="background-color: #ff99cc"><span style="color: #800000">'</span><span style="color: #800000">cuow</span><span style="color: #800000">'</span>:f.errors</span>,<span style="background-color: #ff99cc"><span style="color: #800000">'</span><span style="color: #800000">form</span><span style="color: #800000">'</span>:f</span>})  <span style="color: #008000">#</span><span style="color: #008000"> 打开页面，将错误信息用字典方式传到html页面，并且将表单类传到html页面替换没传参的表单验证类</span></pre>
</div>
<p><span style="color: #0000ff"><strong>html</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">&lt;!</span><span style="color: #ff00ff">DOCTYPE html</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">html </span><span style="color: #ff0000">lang</span><span style="color: #0000ff">="en"</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">head</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">meta </span><span style="color: #ff0000">charset</span><span style="color: #0000ff">="UTF-8"</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">title</span><span style="color: #0000ff">&gt;</span>Title<span style="color: #0000ff">&lt;/</span><span style="color: #800000">title</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">link </span><span style="color: #ff0000">rel</span><span style="color: #0000ff">="stylesheet"</span><span style="color: #ff0000"> type</span><span style="color: #0000ff">="text/css"</span><span style="color: #ff0000"> href</span><span style="color: #0000ff">="/static/css/tou.css"</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">head</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">body</span><span style="color: #0000ff">&gt;</span>

<span style="color: #0000ff">&lt;</span><span style="color: #800000">form </span><span style="color: #ff0000">action</span><span style="color: #0000ff">="/bugarticles/"</span><span style="color: #ff0000"> method</span><span style="color: #0000ff">="post"</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span><span style="color: #000000; background-color: #ffff00">
        {{ form.user }}                                     </span><span style="color: #008000">&lt;!--</span><span style="color: #008000"> 接收get请求时创建的表单类，生成表单标签 </span><span style="color: #008000">--&gt;</span><span style="background-color: #ff99cc"><span style="color: #000000">
        {% if cuow.user.0 %}
            </span><span style="color: #0000ff">&lt;</span><span style="color: #800000">span </span><span style="color: #ff0000">class</span><span style="color: #0000ff">="cuow"</span><span style="color: #0000ff">&gt;</span>{{ cuow.user.0 }}<span style="color: #0000ff">&lt;/</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span>     <span style="color: #008000">&lt;!--</span><span style="color: #008000"> 接收错误信息里的user的错误信息 </span><span style="color: #008000">--&gt;</span><span style="color: #000000">
        {% endif %}
    </span></span><span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span><span style="color: #000000; background-color: #ffff00">
        {{ form.pwd }}                                      </span><span style="color: #008000">&lt;!--</span><span style="color: #008000"> 接收get请求时创建的表单类，生成表单标签 </span><span style="color: #008000">--&gt;</span><span style="background-color: #ff99cc"><span style="color: #000000">
        {% if cuow.pwd.0 %}
            </span><span style="color: #0000ff">&lt;</span><span style="color: #800000">span </span><span style="color: #ff0000">class</span><span style="color: #0000ff">="cuow"</span><span style="color: #0000ff">&gt;</span>{{ cuow.pwd.0 }}<span style="color: #0000ff">&lt;/</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span>      <span style="color: #008000">&lt;!--</span><span style="color: #008000"> 接收错误信息里的pwd的错误信息 </span><span style="color: #008000">--&gt;</span><span style="color: #000000">
        {% endif %}
    </span></span><span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="submit"</span><span style="color: #ff0000"> value</span><span style="color: #0000ff">="提交"</span><span style="color: #0000ff">/&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">form</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">body</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">html</span><span style="color: #0000ff">&gt;</span></pre>
</div>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong>常用的内置验证字段</strong></span></p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">EmailField()</span>验证邮箱字段</strong></span><br><span style="color: #ff0000"><strong><span style="color: #0000ff">CharField()</span>验证字符串字段</strong></span><br><span style="color: #ff0000"><strong><span style="color: #0000ff">URLField()</span>验证url地址字段</strong></span><br><span style="color: #ff0000"><strong><span style="color: #0000ff">IntegerField()</span>验证数字字段</strong></span><br><span style="color: #ff0000"><strong><span style="color: #0000ff">GenericIPAddressField()</span>验证IP字段</strong></span></p>
<p><span style="color: #0000ff"><strong>注意：虽然有很多内置验证字段，但是我们还是要根据我们自己的需求来验证，所以</strong></span></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong>验证字段的参数</strong></span></p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">required</span>设置字段是否可以为空</strong></span><br><strong>	　　True不可以为空</strong><br><strong>	　　False可以为空</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user = forms.CharField(<span style="background-color: #ff99cc">required=True</span>)   <span style="color: #008000">#</span><span style="color: #008000">True不可以为空</span>
    pwd = forms.CharField()</pre>
</div>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">max_length</span>最大字符数</strong></span><br><span style="color: #ff0000"><strong><span style="color: #0000ff">min_length</span>最小字符数</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user = forms.CharField(<span style="background-color: #ff99cc">max_length=4</span>,<span style="background-color: #ff99cc">min_length=2</span><span style="color: #000000">)
    pwd </span>= forms.CharField()</pre>
</div>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">error_messages</span>自定义错误提示信息</strong></span><br><strong>　　参数是一个字典{'验证名称':'错误提示'}</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        <span style="background-color: #ffff00">required</span></span>=<span style="color: #000000">True,
        <span style="background-color: #ffff00">max_length</span></span>=4<span style="color: #000000">,
        <span style="background-color: #ffff00">min_length</span></span>=2<span style="color: #000000">,
<span style="background-color: #ff99cc">        error_messages</span></span><span style="background-color: #ff99cc">=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000; background-color: #ffff00">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000; background-color: #ffff00">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000; background-color: #ffff00">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span></span><span style="color: #000000"><span style="background-color: #ff99cc">
        }</span>
    )
    pwd </span>= forms.CharField()</pre>
</div>
<p><strong><span style="color: #0000ff">invalid</span>设置邮箱格式错误提示信息</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        required</span>=<span style="color: #000000">True,
        max_length</span>=4<span style="color: #000000">,
        min_length</span>=2<span style="color: #000000">,
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span><span style="color: #000000">
        }
    )
    pwd </span>=<span style="color: #000000"> forms.<span style="background-color: #ff99cc">EmailField</span>(
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>: <span style="color: #800000">'</span><span style="color: #800000">邮箱不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="background-color: #ff99cc"><span style="color: #800000">'</span><span style="color: #800000">invalid</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">邮箱格式不正确</span><span style="color: #800000">'</span></span><span style="color: #000000">
        }
    )</span></pre>
</div>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">widget</span>设置表单字段在html页面的类型</strong></span><br><strong>	　　使用方式：widget=forms.Textarea()</strong><br><strong>	　　Textarea(): &lt;textarea&gt;标签类型</strong><br><strong>	　　TextInput()：&lt;input&gt;标签类型</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        required</span>=<span style="color: #000000">True,
        max_length</span>=4<span style="color: #000000">,
        min_length</span>=2<span style="color: #000000">,
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span><span style="color: #000000">
        }
    )
    pwd </span>=<span style="color: #000000"> forms.CharField(
        <span style="background-color: #ff99cc">widget</span></span>=<span style="color: #000000">forms.<span style="background-color: #ff99cc">TextInput()</span>,
    )</span></pre>
</div>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">attrs</span>给表单标签设置属性，可以给标签元素设置class样式，和input标签的各种type属性</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        required</span>=<span style="color: #000000">True,
        max_length</span>=4<span style="color: #000000">,
        min_length</span>=2<span style="color: #000000">,
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span><span style="color: #000000">
        }
    )
    pwd </span>=<span style="color: #000000"> forms.CharField(
        widget</span>=forms.TextInput(<span style="background-color: #ff99cc">attrs={<span style="background-color: #ffff00"><span style="color: #800000">'</span><span style="color: #800000">type</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">password</span><span style="color: #800000">'</span></span>,<span style="background-color: #ffff00"><span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">c1</span><span style="color: #800000">'</span></span></span><span style="color: #000000"><span style="background-color: #ff99cc">}</span>),
    )</span></pre>
</div>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">Select</span>生成表单，select标签，下拉选项框</strong></span><br><strong>	　　参数:</strong><br><strong>		　　　　<span style="color: #0000ff">choices</span>设置下拉数据，元组类型</strong><br><strong>		　　　　<span style="color: #0000ff">attrs</span>设置select标签属性</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        required</span>=<span style="color: #000000">True,
        max_length</span>=4<span style="color: #000000">,
        min_length</span>=2<span style="color: #000000">,
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span><span style="color: #000000">
        }
    )

<span style="background-color: #ffff00">    zhi </span></span><span style="background-color: #ffff00">=<span style="color: #000000"> (
        (0, </span><span style="color: #800000">'</span><span style="color: #800000">普通会员</span><span style="color: #800000">'</span><span style="color: #000000">),
        (</span>1, <span style="color: #800000">'</span><span style="color: #800000">超级会员</span><span style="color: #800000">'</span><span style="color: #000000">),
        (</span>2, <span style="color: #800000">'</span><span style="color: #800000">黄金会员</span><span style="color: #800000">'</span><span style="color: #000000">),
        (</span>3, <span style="color: #800000">'</span><span style="color: #800000">白银会员</span><span style="color: #800000">'</span><span style="color: #000000">),
        (</span>4, <span style="color: #800000">'</span><span style="color: #800000">vip会员</span><span style="color: #800000">'</span></span><span style="color: #000000"><span style="background-color: #ffff00">)
    )</span>
    pwd </span>=<span style="color: #000000"> forms.CharField(
        widget</span>=forms.<span style="background-color: #ff99cc">widgets.Select(<span style="background-color: #ffff00">choices=zhi</span>,attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">c1</span><span style="color: #800000">'</span></span><span style="color: #000000"><span style="background-color: #ff99cc">})</span>
    )</span></pre>
</div>
<p><img src="https://images2015.cnblogs.com/blog/955761/201707/955761-20170717194742910-289353552.png" alt=""></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>下拉框结合数据库应用</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>
<span style="background-color: #ffff00"><span style="color: #0000ff">from</span> app1.models <span style="color: #0000ff">import</span> *</span>       <span style="color: #008000">#</span><span style="color: #008000">导入数据库操作</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        required</span>=<span style="color: #000000">True,
        max_length</span>=4<span style="color: #000000">,
        min_length</span>=2<span style="color: #000000">,
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span><span style="color: #000000">
        }
    )

    <span style="background-color: #ffff00">a </span></span><span style="background-color: #ffff00">= shengf.objects.all().values_list(<span style="color: #800000">'</span><span style="color: #800000">id</span><span style="color: #800000">'</span>,<span style="color: #800000">'</span><span style="color: #800000">shf</span><span style="color: #800000">'</span>) <span style="color: #008000">#</span><span style="color: #008000">获取数据库里shengf表里的id和shf字段的数据</span></span>
    pwd =<span style="color: #000000"> forms.CharField(
        widget</span>=forms.widgets.<span style="background-color: #ff99cc">Select(<span style="background-color: #ffff00">choices=a</span>,attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">c1</span><span style="color: #800000">'</span>})</span> <span style="color: #008000">#</span><span style="color: #008000">将数据库的数据显示到下拉框</span>
    )</pre>
</div>
<p>&nbsp;<img src="https://images2015.cnblogs.com/blog/955761/201707/955761-20170717194742910-289353552.png" alt=""></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>下拉框结合数据库应用，防止数据库添加了数据，或者删除了数据，页面缓存了下拉框数据，无法事实数据同步</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>
<span style="color: #0000ff">from</span> app1.models <span style="color: #0000ff">import</span> *       <span style="color: #008000">#</span><span style="color: #008000">导入数据库操作</span>

<span style="color: #0000ff">class</span> <span style="background-color: #ff99cc">yhbd</span>(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        required</span>=<span style="color: #000000">True,
        max_length</span>=4<span style="color: #000000">,
        min_length</span>=2<span style="color: #000000">,
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span><span style="color: #000000">
        }
    )

    a </span>= shengf.objects.all().values_list(<span style="color: #800000">'</span><span style="color: #800000">id</span><span style="color: #800000">'</span>,<span style="color: #800000">'</span><span style="color: #800000">shf</span><span style="color: #800000">'</span>) <span style="color: #008000">#</span><span style="color: #008000">获取数据库里shengf表里的id和shf字段的数据</span>
    <span style="background-color: #ff99cc">pwd</span> =<span style="color: #000000"> forms.CharField(
        widget</span>=forms.widgets.Select(choices=a,attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">c1</span><span style="color: #800000">'</span>}) <span style="color: #008000">#</span><span style="color: #008000">将数据库的数据显示到下拉框</span>
<span style="color: #000000">    )

    </span><span style="color: #008000">#</span><span style="color: #008000">防止数据库添加了数据，或者删除了数据，页面缓存了下拉框数据，无法事实数据同步</span>
    <span style="color: #0000ff">def</span> <span style="color: #800080">__init__</span>(self,*args, **kwargs):                                     <span style="color: #008000">#</span><span style="color: #008000">创建类的__init__方法，每次创建类时都会执行</span>
        super(<span style="background-color: #ff99cc">yhbd</span>,self).<span style="color: #800080">__init__</span>(*args, **kwargs)                          <span style="color: #008000">#</span><span style="color: #008000">获取当前类的父类里的__init__方法执行</span>
        a = shengf.objects.all().values_list(<span style="color: #800000">'</span><span style="color: #800000">id</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">shf</span><span style="color: #800000">'</span>)                   <span style="color: #008000">#</span><span style="color: #008000">重新获取数据库里shengf表里的id和shf字段的数据</span>
        self.fields[<span style="background-color: #ff99cc"><span style="color: #800000">'</span><span style="color: #800000">pwd</span><span style="color: #800000">'</span></span>] = forms.CharField(widget=forms.widgets.Select(choices=a,attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">c1</span><span style="color: #800000">'</span>}))  <span style="color: #008000">#</span><span style="color: #008000">更新一下表单pwd字段的数据</span></pre>
</div>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>自定义验证规则</strong></span></p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">validators</span>设置自定义验证规则，参数是一个列表，列表里是自定义验证方法名称</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>
<span style="color: #0000ff">from</span> django.core.exceptions <span style="color: #0000ff">import</span><span style="color: #000000"> ValidationError
</span><span style="color: #0000ff">import</span><span style="color: #000000"> re

</span><span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        required</span>=<span style="color: #000000">True,
        max_length</span>=4<span style="color: #000000">,
        min_length</span>=2<span style="color: #000000">,
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span><span style="color: #000000">
        }
    )


    </span><span style="color: #008000">#</span><span style="color: #008000">自定义验证规则</span>
<span style="background-color: #ffff00">    <span style="color: #0000ff">def</span><span style="color: #000000"> shouji(value):
        mobile_re </span>= re.compile(r<span style="color: #800000">'</span><span style="color: #800000">^(13[0-9]|15[012356789]|17[678]|18[0-9]|14[57])[0-9]{8}$</span><span style="color: #800000">'</span><span style="color: #000000">)
        </span><span style="color: #0000ff">if</span> <span style="color: #0000ff">not</span><span style="color: #000000"> mobile_re.match(value):
            </span><span style="color: #0000ff">raise</span> ValidationError(<span style="color: #800000">'</span><span style="color: #800000">手机号码格式错误</span><span style="color: #800000">'</span>)   <span style="color: #008000">#</span><span style="color: #008000">如果不匹配返回错误信息</span></span>
<span style="color: #000000">

    pwd </span>=<span style="color: #000000"> forms.CharField(
        <span style="background-color: #ffff00">validators</span></span><span style="background-color: #ffff00">=[shouji, ],   <span style="color: #008000">#</span><span style="color: #008000">设置自定义验证规则</span></span>
        required=<span style="color: #000000">True,
        widget</span>=<span style="color: #000000">forms.TextInput(
            attrs</span>=<span style="color: #000000">{
                </span><span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>: <span style="color: #800000">"</span><span style="color: #800000">cl</span><span style="color: #800000">"</span><span style="color: #000000">,
                </span><span style="color: #800000">'</span><span style="color: #800000">placeholder</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">手机号码</span><span style="color: #800000">'</span><span style="color: #000000">
            }
        ),
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">手机不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
        }
    )</span></pre>
</div>
<p><img src="https://images2015.cnblogs.com/blog/955761/201707/955761-20170717232723411-1592842803.png" alt=""></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>其他</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span>
<span style="color: #0000ff">import</span><span style="color: #000000"> re
</span><span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span><span style="color: #000000"> forms
</span><span style="color: #0000ff">from</span> django.core.exceptions <span style="color: #0000ff">import</span><span style="color: #000000"> ValidationError


</span><span style="color: #0000ff">def</span><span style="color: #000000"> mobile_validate(value):
    mobile_re </span>= re.compile(r<span style="color: #800000">'</span><span style="color: #800000">^(13[0-9]|15[012356789]|17[678]|18[0-9]|14[57])[0-9]{8}$</span><span style="color: #800000">'</span><span style="color: #000000">)
    </span><span style="color: #0000ff">if</span> <span style="color: #0000ff">not</span><span style="color: #000000"> mobile_re.match(value):
        </span><span style="color: #0000ff">raise</span> ValidationError(<span style="color: #800000">'</span><span style="color: #800000">手机号码格式错误</span><span style="color: #800000">'</span><span style="color: #000000">)


</span><span style="color: #0000ff">class</span><span style="color: #000000"> PublishForm(forms.Form):

    user_type_choice </span>=<span style="color: #000000"> (
        (0, u</span><span style="color: #800000">'</span><span style="color: #800000">普通用户</span><span style="color: #800000">'</span><span style="color: #000000">),
        (</span>1, u<span style="color: #800000">'</span><span style="color: #800000">高级用户</span><span style="color: #800000">'</span><span style="color: #000000">),
    )

    user_type </span>= forms.IntegerField(widget=forms.widgets.Select(choices=<span style="color: #000000">user_type_choice,
                                                                  attrs</span>={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>: <span style="color: #800000">"</span><span style="color: #800000">form-control</span><span style="color: #800000">"</span><span style="color: #000000">}))

    title </span>= forms.CharField(max_length=20<span style="color: #000000">,
                            min_length</span>=5<span style="color: #000000">,
                            error_messages</span>={<span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">标题不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
                                            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">标题最少为5个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
                                            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">标题最多为20个字符</span><span style="color: #800000">'</span><span style="color: #000000">},
                            widget</span>=forms.TextInput(attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>: <span style="color: #800000">"</span><span style="color: #800000">form-control</span><span style="color: #800000">"</span><span style="color: #000000">,
                                                          </span><span style="color: #800000">'</span><span style="color: #800000">placeholder</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">标题5-20个字符</span><span style="color: #800000">'</span><span style="color: #000000">}))

    memo </span>= forms.CharField(required=<span style="color: #000000">False,
                           max_length</span>=256<span style="color: #000000">,
                           widget</span>=forms.widgets.Textarea(attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>: <span style="color: #800000">"</span><span style="color: #800000">form-control no-radius</span><span style="color: #800000">"</span>, <span style="color: #800000">'</span><span style="color: #800000">placeholder</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">详细描述</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">rows</span><span style="color: #800000">'</span>: 3<span style="color: #000000">}))

    phone </span>= forms.CharField(validators=<span style="color: #000000">[mobile_validate, ],
                            error_messages</span>={<span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">手机不能为空</span><span style="color: #800000">'</span><span style="color: #000000">},
                            widget</span>=forms.TextInput(attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>: <span style="color: #800000">"</span><span style="color: #800000">form-control</span><span style="color: #800000">"</span><span style="color: #000000">,
                                                          </span><span style="color: #800000">'</span><span style="color: #800000">placeholder</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">手机号码</span><span style="color: #800000">'</span><span style="color: #000000">}))

    email </span>= forms.EmailField(required=<span style="color: #000000">False,
                            error_messages</span>={<span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">邮箱不能为空</span><span style="color: #800000">'</span>,<span style="color: #800000">'</span><span style="color: #800000">invalid</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">邮箱格式错误</span><span style="color: #800000">'</span><span style="color: #000000">},
                            widget</span>=forms.TextInput(attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>: <span style="color: #800000">"</span><span style="color: #800000">form-control</span><span style="color: #800000">"</span>, <span style="color: #800000">'</span><span style="color: #800000">placeholder</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">邮箱</span><span style="color: #800000">'</span>}))</pre>
</div>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>注意：如果表单是通过Ajax提交的，页面不刷新，那么html页面将无法获取到错误信息，那么我们只能将所有错误信息构造成字典，然后以json的方式返回给Ajax，添加到页面</strong></span></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>将models数据库表类转换成表单验证类【必要使用】</strong></span></p>
<p><span style="color: #000000"><strong>这样可以少写表单验证代码，使用的是数据库字段的验证规则</strong></span></p>
<p><span style="color: #ff0000"><strong>models.py</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">from</span> django.db <span style="color: #0000ff">import</span> models        <span style="color: #008000">#</span><span style="color: #008000"> 导入models对象</span>

<span style="color: #0000ff">class</span><span style="color: #000000"><span style="background-color: #ff99cc"> CourseOrg</span>(models.Model):
    <span style="background-color: #ff99cc">name </span></span><span style="background-color: #ff99cc">= models.CharField(max_length=50, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">机构名称</span><span style="color: #800000">'</span></span><span style="color: #000000"><span style="background-color: #ff99cc">)</span>
    desc </span>= models.TextField(verbose_name=<span style="color: #800000">'</span><span style="color: #800000">机构描述</span><span style="color: #800000">'</span><span style="color: #000000">)
    <span style="background-color: #ff99cc">category </span></span><span style="background-color: #ff99cc">= models.CharField(max_length=20, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">机构类别</span><span style="color: #800000">'</span>, default=<span style="color: #800000">'</span><span style="color: #800000">pxjg</span><span style="color: #800000">'</span>, choices=((<span style="color: #800000">'</span><span style="color: #800000">pxjg</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">培训机构</span><span style="color: #800000">'</span>), (<span style="color: #800000">'</span><span style="color: #800000">gx</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">高校</span><span style="color: #800000">'</span>), (<span style="color: #800000">'</span><span style="color: #800000">gr</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">个人</span><span style="color: #800000">'</span></span><span style="color: #000000"><span style="background-color: #ff99cc">)))</span>
    click </span>= models.IntegerField(default=0, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">点击数</span><span style="color: #800000">'</span><span style="color: #000000">)
    <span style="background-color: #ff99cc">fav_nums </span></span><span style="background-color: #ff99cc">= models.IntegerField(default=0, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">收藏数</span><span style="color: #800000">'</span></span><span style="color: #000000"><span style="background-color: #ff99cc">)</span>
    image </span>= models.ImageField(upload_to=<span style="color: #800000">'</span><span style="color: #800000">org/%Y/%m</span><span style="color: #800000">'</span>, storage=ImageStorage(), verbose_name=<span style="color: #800000">'</span><span style="color: #800000">封面图</span><span style="color: #800000">'</span>, max_length=100<span style="color: #000000">)
    address </span>= models.CharField(max_length=150, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">机构地址</span><span style="color: #800000">'</span><span style="color: #000000">)
    city </span>= models.ForeignKey(CityDict, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">外键城市表</span><span style="color: #800000">'</span><span style="color: #000000">)
    add_time </span>= models.DateTimeField(default=datetime.now, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">添加日期</span><span style="color: #800000">'</span><span style="color: #000000">)

    </span><span style="color: #0000ff">class</span><span style="color: #000000"> Meta:
        verbose_name </span>= <span style="color: #800000">'</span><span style="color: #800000">课程机构表</span><span style="color: #800000">'</span><span style="color: #000000">
        verbose_name_plural </span>=<span style="color: #000000"> verbose_name

    </span><span style="color: #0000ff">def</span> <span style="color: #800080">__str__</span><span style="color: #000000">(self):
        </span><span style="color: #0000ff">return</span> self.name</pre>
</div>
<p><span style="color: #ff0000"><strong>forms.py</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf8 -*-</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> <span style="background-color: #ff99cc">forms</span>                             <span style="color: #008000">#</span><span style="color: #008000"> 导入Django的表单验证模块</span>
<span style="color: #0000ff">from</span> app_organization.models <span style="color: #0000ff">import</span> <span style="background-color: #ff99cc"><strong>CourseOrg</strong></span>        <span style="color: #008000">#</span><span style="color: #008000"> 导入数据库表类</span>


<span style="color: #0000ff">class</span><span style="color: #000000"> CourseOrgForm(<span style="background-color: #ff99cc">forms.ModelForm</span>):
    zdyi </span>= forms.CharField()                         <span style="color: #008000">#</span><span style="color: #008000"> 自定义表单验证字段</span>

    <span style="color: #0000ff">class</span><span style="color: #000000"> Meta:
        model </span>= <span style="background-color: #ff99cc">CourseOrg</span>                            <span style="color: #008000">#</span><span style="color: #008000"> 设置要将数据库表类转换成表单验证类的名称</span>
        fields = [<span style="color: #800000">'</span><span style="color: #800000">name</span><span style="color: #800000">'</span>,<span style="color: #800000">'</span><span style="color: #800000">category</span><span style="color: #800000">'</span>,<span style="color: #800000">'</span><span style="color: #800000">fav_nums</span><span style="color: #800000">'</span>]      <span style="color: #008000">#</span><span style="color: #008000"> 要使用的字段</span></pre>
</div>
<p>&nbsp;</p></div>第三百一十一节，Django框架，Form表单验证


			<div id="cnblogs_post_body" class="blogpost-body"><p><strong>第三百一十一节，Django框架，Form表单验证</strong></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong>表单提交</strong></span></p>
<p><span style="color: #0000ff"><strong>html</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">&lt;!</span><span style="color: #ff00ff">DOCTYPE html</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">html </span><span style="color: #ff0000">lang</span><span style="color: #0000ff">="en"</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">head</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">meta </span><span style="color: #ff0000">charset</span><span style="color: #0000ff">="UTF-8"</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">title</span><span style="color: #0000ff">&gt;</span>Title<span style="color: #0000ff">&lt;/</span><span style="color: #800000">title</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">link </span><span style="color: #ff0000">rel</span><span style="color: #0000ff">="stylesheet"</span><span style="color: #ff0000"> type</span><span style="color: #0000ff">="text/css"</span><span style="color: #ff0000"> href</span><span style="color: #0000ff">="/static/css/tou.css"</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">head</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">body</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">form </span><span style="color: #ff0000">action</span><span style="color: #0000ff">="<span style="background-color: #ff99cc">/bug<span style="background-color: #ffff00">articles</span>/</span>"</span><span style="color: #ff0000"> method</span><span style="color: #0000ff">="post"</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="text"</span><span style="color: #ff0000"> name</span><span style="color: #0000ff">="user"</span><span style="color: #0000ff">/&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="text"</span><span style="color: #ff0000"> name</span><span style="color: #0000ff">="pwd"</span><span style="color: #0000ff">/&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="submit"</span><span style="color: #ff0000"> value</span><span style="color: #0000ff">="提交"</span><span style="color: #0000ff">/&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">form</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">body</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">html</span><span style="color: #0000ff">&gt;</span></pre>
</div>
<p><span style="color: #0000ff"><strong>路由映射</strong></span></p>
<div class="cnblogs_code">
<pre>urlpatterns =<span style="color: #000000"> [
    url(r</span><span style="color: #800000">'</span><span style="color: #800000">admin/</span><span style="color: #800000">'</span>, admin.site.urls),   <span style="color: #008000">#</span><span style="color: #008000">路由映射admin数据库管理</span>
    url(r<span style="color: #800000">'</span><span style="color: #800000"><span style="background-color: #ffff00">articles</span>/</span><span style="color: #800000">'</span><span style="color: #000000">, <span style="background-color: #ffff00">views.special</span>)    
]</span></pre>
</div>
<p><span style="color: #0000ff"><strong>逻辑处理</strong></span></p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">method</span>属性获取用户请求方式，post或者get</strong></span><br><strong>使用方式：请求对象.method</strong></p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">POST</span>获取用户post请求方式的信息</strong></span><br><strong>使用方式：请求对象.POST</strong></p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">POST.get()</span>获取用户POST请求方式的表单name名称对应的值，参数是表单name名</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">from</span> django.shortcuts <span style="color: #0000ff">import</span><span style="color: #000000"> render
</span><span style="color: #0000ff">from</span> app1.models <span style="color: #0000ff">import</span> *    <span style="color: #008000">#</span><span style="color: #008000">导入数据库操作模块</span>

<span style="color: #008000">#</span><span style="color: #008000">逻辑处理模块</span>
<span style="color: #0000ff">def</span><span style="color: #000000"><span style="background-color: #ffff00"> special</span>(request):  　　　　　　　　　　　　　 <span style="color: #008080">#自定义参数接收用户请求对象
    </span></span><span style="color: #0000ff">if</span> request.method == <span style="color: #800000">"</span><span style="color: #800000">POST</span><span style="color: #800000">"</span><span style="color: #000000">:　　　　　　　　 <span style="color: #008080">#判断用户请求如果是post方式
        </span></span><span style="color: #0000ff">print</span>(request.POST.get(<span style="color: #800000">'</span><span style="color: #800000">user</span><span style="color: #800000">'</span>,None))  <span style="color: #008000">#</span><span style="color: #008000">接收用户表单提交的name名称对应的值</span>
        <span style="color: #0000ff">print</span>(request.POST.get(<span style="color: #800000">'</span><span style="color: #800000">pwd</span><span style="color: #800000">'</span>, None))  <span style="color: #008000">#</span><span style="color: #008000">接收用户表单提交的name名称对应的值</span>
    <span style="color: #0000ff">return</span> render(request, <span style="color: #800000">'</span><span style="color: #800000">app1/index.html</span><span style="color: #800000">'</span>, locals())  <span style="color: #008000">#</span><span style="color: #008000"> 打开页面</span></pre>
</div>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong>表单提交验证，获取数据与获取错误信息</strong></span></p>
<p><span style="color: #000000"><strong>1、创建表单验证模块，必须继承</strong><span style="color: #0000ff"><strong>Django的表单验证forms.Form类</strong></span></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> <span style="background-color: #ff99cc">django <span style="color: #0000ff">import</span> forms</span>        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(<span style="background-color: #ff99cc">forms.Form</span>):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    <span style="background-color: #ff99cc">user</span> = forms.CharField()    <span style="color: #008000">#</span><span style="color: #008000">接收逻辑处理时，创建yhbd类时传进来的POST对象，里的表单name名对应的值进行验证</span>
    <span style="background-color: #ff99cc">pwd</span> = forms.CharField()     <span style="color: #008000">#</span><span style="color: #008000">#接收逻辑处理时，创建yhbd类时传进来的POST对象，里的表单name名对应的值进行验证</span></pre>
</div>
<p><strong>2、逻辑处理，创建表单验证模块里的验证类，并将用户请求的<span style="color: #0000ff">POST对象</span>，传入验证类进行验证，验证后获取验证通过的提交信息，或者验证没通过的错误信息</strong></p>
<p><span style="color: #0000ff"><strong>如果出现错误，将错误信息对象以字典方式传到html页面</strong></span></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">is_valid()</span>返回验证是否通过的布尔值</strong></span><br><strong>使用方式：验证类.is_valid()</strong></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">cleaned_data</span>获取验证通过后的所有提交数据，返回字典</strong></span><br><strong>使用方式：验证类.cleaned_data</strong></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">errors</span>获取验证错误信息，返回所有表单的错误信息对象</strong></span><br><strong>使用方法：验证类.errors</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">from</span> django.shortcuts <span style="color: #0000ff">import</span><span style="color: #000000"> render
</span><span style="color: #0000ff">from</span> app1.models <span style="color: #0000ff">import</span> *    <span style="color: #008000">#</span><span style="color: #008000">导入数据库操作模块</span>
<span style="color: #0000ff">from</span> app1.biaodan <span style="color: #0000ff">import</span> *   <span style="color: #008000">#</span><span style="color: #008000">导入自定义表单验证模块</span><span style="color: #008000">
#</span><span style="color: #008000">逻辑处理模块</span>
<span style="color: #0000ff">def</span><span style="color: #000000"> special(request):
    </span><span style="color: #0000ff">if</span> request.method == <span style="color: #800000">'</span><span style="color: #800000">GET</span><span style="color: #800000">'</span><span style="color: #000000">:
        </span><span style="color: #0000ff">return</span> render(request, <span style="color: #800000">'</span><span style="color: #800000">app1/index.html</span><span style="color: #800000">'</span>, locals())  <span style="color: #008000">#</span><span style="color: #008000"> 打开页面</span>

    <span style="background-color: #ff99cc"><span style="color: #0000ff">if</span> request.method == <span style="color: #800000">"</span><span style="color: #800000">POST</span><span style="color: #800000">"</span><span style="color: #000000">:
        </span></span><span style="color: #008000">#</span><span style="color: #008000"> print(request.POST.get('user',None))          #接收用户表单提交的name名称对应的值</span>
        <span style="color: #008000">#</span><span style="color: #008000"> print(request.POST.get('pwd', None))          #接收用户表单提交的name名称对应的值</span>
<span style="background-color: #ff99cc"><span style="color: #000000">
        f </span>= yhbd(request.POST)</span>                          <span style="color: #008000">#</span><span style="color: #008000">创建验证表单类，将用户请求POST对象传进表单验证类进行验证</span>

        <span style="color: #008000">#</span><span style="color: #008000"> ret = f.is_valid()                            #返回验证是否通过</span>
        <span style="color: #008000">#</span><span style="color: #008000"> print(ret)                                    #返回布尔值</span>

       <span style="background-color: #ff99cc"> <span style="color: #0000ff">if</span> f.is_valid():</span>                                <span style="color: #008000">#</span><span style="color: #008000">判断验证如果通过</span>
            <span style="background-color: #ff99cc"><span style="color: #0000ff">print</span>(f.cleaned_data)</span>                       <span style="color: #008000">#</span><span style="color: #008000">获取到用户提交信息,字典方式</span>
        <span style="color: #0000ff">else</span>:                                           <span style="color: #008000">#</span><span style="color: #008000">如果没通过</span>
            <span style="background-color: #ff99cc"><span style="color: #0000ff">print</span>(f.errors)</span>                             <span style="color: #008000">#</span><span style="color: #008000">获取错误对象</span>

        <span style="color: #0000ff">return</span> render(request, <span style="color: #800000">'</span><span style="color: #800000">app1/index.html</span><span style="color: #800000">'</span>,<span style="background-color: #ff99cc">{<span style="color: #800000">'</span><span style="color: #800000">cuow</span><span style="color: #800000">'</span>:f.errors}</span>)  <span style="color: #008000">#</span><span style="color: #008000"> 打开页面，将错误信息用字典方式传到html页面</span></pre>
</div>
<p><strong>3、在html页面接收逻辑处理<span style="color: #0000ff">以字典形式</span>传过来的错误对象，分别获取不同表单的错误信息</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">&lt;!</span><span style="color: #ff00ff">DOCTYPE html</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">html </span><span style="color: #ff0000">lang</span><span style="color: #0000ff">="en"</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">head</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">meta </span><span style="color: #ff0000">charset</span><span style="color: #0000ff">="UTF-8"</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">title</span><span style="color: #0000ff">&gt;</span>Title<span style="color: #0000ff">&lt;/</span><span style="color: #800000">title</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">link </span><span style="color: #ff0000">rel</span><span style="color: #0000ff">="stylesheet"</span><span style="color: #ff0000"> type</span><span style="color: #0000ff">="text/css"</span><span style="color: #ff0000"> href</span><span style="color: #0000ff">="/static/css/tou.css"</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">head</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">body</span><span style="color: #0000ff">&gt;</span>

<span style="color: #0000ff">&lt;</span><span style="color: #800000">form </span><span style="color: #ff0000">action</span><span style="color: #0000ff">="/bugarticles/"</span><span style="color: #ff0000"> method</span><span style="color: #0000ff">="post"</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="text"</span><span style="color: #ff0000"> name</span><span style="color: #0000ff">="user"</span><span style="color: #0000ff">/&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span><span style="background-color: #ff99cc">{{ cuow.user.0 }}</span><span style="color: #0000ff">&lt;/</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span>     <span style="color: #008000">&lt;!--</span><span style="color: #008000"> 接收错误信息里的user的错误信息 </span><span style="color: #008000">--&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="text"</span><span style="color: #ff0000"> name</span><span style="color: #0000ff">="pwd"</span><span style="color: #0000ff">/&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span><span style="background-color: #ff99cc">{{ cuow.pwd.0 }}</span><span style="color: #0000ff">&lt;/</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span>      <span style="color: #008000">&lt;!--</span><span style="color: #008000"> 接收错误信息里的pwd的错误信息 </span><span style="color: #008000">--&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="submit"</span><span style="color: #ff0000"> value</span><span style="color: #0000ff">="提交"</span><span style="color: #0000ff">/&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">form</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">body</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">html</span><span style="color: #0000ff">&gt;</span></pre>
</div>
<p>&nbsp;<img src="https://images2015.cnblogs.com/blog/955761/201707/955761-20170716170032722-817776133.png" alt=""></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong>利用表单类自动创建表单标签</strong></span></p>
<p><span style="background-color: #ffffff"><strong>以上表单的&lt;input&gt;是我们自己手动写的，还可以用表单类来自动创建表单标签，好处是不用自己写表单标签，还有就是当用户填写的表单不合法提交时提示错误信息不清空表单</strong></span></p>
<p>&nbsp;</p>
<p><span style="background-color: #ffff00; color: #0000ff"><strong>注意：表单类根据字段创建的表单标签，当用户输入内容时，首先要经过浏览器默认行为的表单验证，如果浏览器<strong>默认行为的表单验证都没有通过那么将无法提交</strong></strong></span></p>
<p><span style="background-color: #ffff00; color: #0000ff"><strong><strong><strong>浏览器<strong>默认行为的表单验证，通过了在进行我们定义的表单类验证，验证合法获取用户提交信息，不合法返回错误信息</strong></strong></strong></strong></span></p>
<p><span style="background-color: #ffffff; color: #0000ff"><strong><strong><strong><strong>利用表单类自动创建表单标签</strong></strong></strong></strong></span></p>
<p><span style="background-color: #ffffff"><strong><strong><strong><strong>1、首先在get访问页面时，创建表单类不传参数，然后把这个表单类传到html页面，在html页面通过，<span style="color: #ff0000">表单类.字段名称</span>，来自动创建表单标签</strong></strong></strong></strong></span></p>
<p><span style="background-color: #ffffff"><strong><strong><strong><strong>　　每一种表单字段类型，都有一个默认的表单标签，这个标签是可以更改的，所以表单类可以创建任何表单标签</strong></strong></strong></strong></span></p>
<p><span style="background-color: #ffffff"><strong><strong><strong><strong>2、在post访问时，再次创建表单类需要传参，将post请求对象传入表单类进行验证表单，如果表单不合法，将错误信息对象传到html显示错误信息，将这次创建的表单类传到html页面替换get时创建的表单类</strong></strong></strong></strong></span></p>
<p><span style="color: #0000ff; background-color: #ffffff"><strong>逻辑处理</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">from</span> django.shortcuts <span style="color: #0000ff">import</span><span style="color: #000000"> render
</span><span style="color: #0000ff">from</span> app1.models <span style="color: #0000ff">import</span> *    <span style="color: #008000">#</span><span style="color: #008000">导入数据库操作模块</span>
<span style="color: #0000ff">from</span> app1.biaodan <span style="color: #0000ff">import</span> *   <span style="color: #008000">#</span><span style="color: #008000">导入自定义表单验证模块</span><span style="color: #008000">
#</span><span style="color: #008000">逻辑处理模块</span>
<span style="color: #0000ff">def</span><span style="color: #000000"> special(request):
    </span><span style="color: #0000ff">if</span> request.method == <span style="color: #800000">'</span><span style="color: #800000; background-color: #ffff00">GET</span><span style="color: #800000">'</span><span style="color: #000000">:
        <span style="background-color: #ffff00">f </span></span><span style="background-color: #ffff00">= yhbd()</span>                                            <span style="color: #008000">#</span><span style="color: #008000">创建表单验证类，不传参</span>
        <span style="color: #0000ff">return</span> render(request, <span style="color: #800000">'</span><span style="color: #800000">app1/index.html</span><span style="color: #800000">'</span>,{<span style="background-color: #ffff00"><span style="color: #800000">'</span><span style="color: #800000">form</span><span style="color: #800000">'</span>:f</span>})  <span style="color: #008000">#</span><span style="color: #008000"> 打开页面，并将表单验证类传到html生成表单标签</span>

    <span style="color: #0000ff">if</span> request.method == <span style="color: #800000">"</span><span style="color: #800000; background-color: #ff99cc">POST</span><span style="color: #800000">"</span><span style="color: #000000">:
        <span style="background-color: #ff99cc">f </span></span><span style="background-color: #ff99cc">= yhbd(request.POST)</span>                          <span style="color: #008000">#</span><span style="color: #008000">创建验证表单类，将用户请求POST对象传进表单验证类进行验证</span>

        <span style="background-color: #ff99cc"><span style="color: #0000ff">if</span> f.is_valid():</span>                                <span style="color: #008000">#</span><span style="color: #008000">判断验证如果通过</span>
            <span style="background-color: #ff99cc"><span style="color: #0000ff">print</span>(f.cleaned_data)</span>                       <span style="color: #008000">#</span><span style="color: #008000">获取到用户提交信息,字典方式</span>
        <span style="color: #0000ff">else</span>:                                           <span style="color: #008000">#</span><span style="color: #008000">如果没通过</span>
            <span style="color: #008000">#</span><span style="color: #008000"><span style="background-color: #ff99cc"> print(f.errors)</span>                           #获取错误对象</span>
            <span style="color: #0000ff">pass</span>

        <span style="color: #0000ff">return</span> render(request, <span style="color: #800000">'</span><span style="color: #800000">app1/index.html</span><span style="color: #800000">'</span>,{<span style="background-color: #ff99cc"><span style="color: #800000">'</span><span style="color: #800000">cuow</span><span style="color: #800000">'</span>:f.errors</span>,<span style="background-color: #ff99cc"><span style="color: #800000">'</span><span style="color: #800000">form</span><span style="color: #800000">'</span>:f</span>})  <span style="color: #008000">#</span><span style="color: #008000"> 打开页面，将错误信息用字典方式传到html页面，并且将表单类传到html页面替换没传参的表单验证类</span></pre>
</div>
<p><span style="color: #0000ff"><strong>html</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">&lt;!</span><span style="color: #ff00ff">DOCTYPE html</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">html </span><span style="color: #ff0000">lang</span><span style="color: #0000ff">="en"</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">head</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">meta </span><span style="color: #ff0000">charset</span><span style="color: #0000ff">="UTF-8"</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">title</span><span style="color: #0000ff">&gt;</span>Title<span style="color: #0000ff">&lt;/</span><span style="color: #800000">title</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">link </span><span style="color: #ff0000">rel</span><span style="color: #0000ff">="stylesheet"</span><span style="color: #ff0000"> type</span><span style="color: #0000ff">="text/css"</span><span style="color: #ff0000"> href</span><span style="color: #0000ff">="/static/css/tou.css"</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">head</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">body</span><span style="color: #0000ff">&gt;</span>

<span style="color: #0000ff">&lt;</span><span style="color: #800000">form </span><span style="color: #ff0000">action</span><span style="color: #0000ff">="/bugarticles/"</span><span style="color: #ff0000"> method</span><span style="color: #0000ff">="post"</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span><span style="color: #000000; background-color: #ffff00">
        {{ form.user }}                                     </span><span style="color: #008000">&lt;!--</span><span style="color: #008000"> 接收get请求时创建的表单类，生成表单标签 </span><span style="color: #008000">--&gt;</span><span style="background-color: #ff99cc"><span style="color: #000000">
        {% if cuow.user.0 %}
            </span><span style="color: #0000ff">&lt;</span><span style="color: #800000">span </span><span style="color: #ff0000">class</span><span style="color: #0000ff">="cuow"</span><span style="color: #0000ff">&gt;</span>{{ cuow.user.0 }}<span style="color: #0000ff">&lt;/</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span>     <span style="color: #008000">&lt;!--</span><span style="color: #008000"> 接收错误信息里的user的错误信息 </span><span style="color: #008000">--&gt;</span><span style="color: #000000">
        {% endif %}
    </span></span><span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span><span style="color: #000000; background-color: #ffff00">
        {{ form.pwd }}                                      </span><span style="color: #008000">&lt;!--</span><span style="color: #008000"> 接收get请求时创建的表单类，生成表单标签 </span><span style="color: #008000">--&gt;</span><span style="background-color: #ff99cc"><span style="color: #000000">
        {% if cuow.pwd.0 %}
            </span><span style="color: #0000ff">&lt;</span><span style="color: #800000">span </span><span style="color: #ff0000">class</span><span style="color: #0000ff">="cuow"</span><span style="color: #0000ff">&gt;</span>{{ cuow.pwd.0 }}<span style="color: #0000ff">&lt;/</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span>      <span style="color: #008000">&lt;!--</span><span style="color: #008000"> 接收错误信息里的pwd的错误信息 </span><span style="color: #008000">--&gt;</span><span style="color: #000000">
        {% endif %}
    </span></span><span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="submit"</span><span style="color: #ff0000"> value</span><span style="color: #0000ff">="提交"</span><span style="color: #0000ff">/&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">form</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">body</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">html</span><span style="color: #0000ff">&gt;</span></pre>
</div>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong>常用的内置验证字段</strong></span></p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">EmailField()</span>验证邮箱字段</strong></span><br><span style="color: #ff0000"><strong><span style="color: #0000ff">CharField()</span>验证字符串字段</strong></span><br><span style="color: #ff0000"><strong><span style="color: #0000ff">URLField()</span>验证url地址字段</strong></span><br><span style="color: #ff0000"><strong><span style="color: #0000ff">IntegerField()</span>验证数字字段</strong></span><br><span style="color: #ff0000"><strong><span style="color: #0000ff">GenericIPAddressField()</span>验证IP字段</strong></span></p>
<p><span style="color: #0000ff"><strong>注意：虽然有很多内置验证字段，但是我们还是要根据我们自己的需求来验证，所以</strong></span></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong>验证字段的参数</strong></span></p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">required</span>设置字段是否可以为空</strong></span><br><strong>	　　True不可以为空</strong><br><strong>	　　False可以为空</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user = forms.CharField(<span style="background-color: #ff99cc">required=True</span>)   <span style="color: #008000">#</span><span style="color: #008000">True不可以为空</span>
    pwd = forms.CharField()</pre>
</div>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">max_length</span>最大字符数</strong></span><br><span style="color: #ff0000"><strong><span style="color: #0000ff">min_length</span>最小字符数</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user = forms.CharField(<span style="background-color: #ff99cc">max_length=4</span>,<span style="background-color: #ff99cc">min_length=2</span><span style="color: #000000">)
    pwd </span>= forms.CharField()</pre>
</div>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">error_messages</span>自定义错误提示信息</strong></span><br><strong>　　参数是一个字典{'验证名称':'错误提示'}</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        <span style="background-color: #ffff00">required</span></span>=<span style="color: #000000">True,
        <span style="background-color: #ffff00">max_length</span></span>=4<span style="color: #000000">,
        <span style="background-color: #ffff00">min_length</span></span>=2<span style="color: #000000">,
<span style="background-color: #ff99cc">        error_messages</span></span><span style="background-color: #ff99cc">=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000; background-color: #ffff00">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000; background-color: #ffff00">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000; background-color: #ffff00">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span></span><span style="color: #000000"><span style="background-color: #ff99cc">
        }</span>
    )
    pwd </span>= forms.CharField()</pre>
</div>
<p><strong><span style="color: #0000ff">invalid</span>设置邮箱格式错误提示信息</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        required</span>=<span style="color: #000000">True,
        max_length</span>=4<span style="color: #000000">,
        min_length</span>=2<span style="color: #000000">,
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span><span style="color: #000000">
        }
    )
    pwd </span>=<span style="color: #000000"> forms.<span style="background-color: #ff99cc">EmailField</span>(
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>: <span style="color: #800000">'</span><span style="color: #800000">邮箱不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="background-color: #ff99cc"><span style="color: #800000">'</span><span style="color: #800000">invalid</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">邮箱格式不正确</span><span style="color: #800000">'</span></span><span style="color: #000000">
        }
    )</span></pre>
</div>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">widget</span>设置表单字段在html页面的类型</strong></span><br><strong>	　　使用方式：widget=forms.Textarea()</strong><br><strong>	　　Textarea(): &lt;textarea&gt;标签类型</strong><br><strong>	　　TextInput()：&lt;input&gt;标签类型</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        required</span>=<span style="color: #000000">True,
        max_length</span>=4<span style="color: #000000">,
        min_length</span>=2<span style="color: #000000">,
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span><span style="color: #000000">
        }
    )
    pwd </span>=<span style="color: #000000"> forms.CharField(
        <span style="background-color: #ff99cc">widget</span></span>=<span style="color: #000000">forms.<span style="background-color: #ff99cc">TextInput()</span>,
    )</span></pre>
</div>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">attrs</span>给表单标签设置属性，可以给标签元素设置class样式，和input标签的各种type属性</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        required</span>=<span style="color: #000000">True,
        max_length</span>=4<span style="color: #000000">,
        min_length</span>=2<span style="color: #000000">,
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span><span style="color: #000000">
        }
    )
    pwd </span>=<span style="color: #000000"> forms.CharField(
        widget</span>=forms.TextInput(<span style="background-color: #ff99cc">attrs={<span style="background-color: #ffff00"><span style="color: #800000">'</span><span style="color: #800000">type</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">password</span><span style="color: #800000">'</span></span>,<span style="background-color: #ffff00"><span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">c1</span><span style="color: #800000">'</span></span></span><span style="color: #000000"><span style="background-color: #ff99cc">}</span>),
    )</span></pre>
</div>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">Select</span>生成表单，select标签，下拉选项框</strong></span><br><strong>	　　参数:</strong><br><strong>		　　　　<span style="color: #0000ff">choices</span>设置下拉数据，元组类型</strong><br><strong>		　　　　<span style="color: #0000ff">attrs</span>设置select标签属性</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        required</span>=<span style="color: #000000">True,
        max_length</span>=4<span style="color: #000000">,
        min_length</span>=2<span style="color: #000000">,
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span><span style="color: #000000">
        }
    )

<span style="background-color: #ffff00">    zhi </span></span><span style="background-color: #ffff00">=<span style="color: #000000"> (
        (0, </span><span style="color: #800000">'</span><span style="color: #800000">普通会员</span><span style="color: #800000">'</span><span style="color: #000000">),
        (</span>1, <span style="color: #800000">'</span><span style="color: #800000">超级会员</span><span style="color: #800000">'</span><span style="color: #000000">),
        (</span>2, <span style="color: #800000">'</span><span style="color: #800000">黄金会员</span><span style="color: #800000">'</span><span style="color: #000000">),
        (</span>3, <span style="color: #800000">'</span><span style="color: #800000">白银会员</span><span style="color: #800000">'</span><span style="color: #000000">),
        (</span>4, <span style="color: #800000">'</span><span style="color: #800000">vip会员</span><span style="color: #800000">'</span></span><span style="color: #000000"><span style="background-color: #ffff00">)
    )</span>
    pwd </span>=<span style="color: #000000"> forms.CharField(
        widget</span>=forms.<span style="background-color: #ff99cc">widgets.Select(<span style="background-color: #ffff00">choices=zhi</span>,attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">c1</span><span style="color: #800000">'</span></span><span style="color: #000000"><span style="background-color: #ff99cc">})</span>
    )</span></pre>
</div>
<p><img src="https://images2015.cnblogs.com/blog/955761/201707/955761-20170717194742910-289353552.png" alt=""></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>下拉框结合数据库应用</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>
<span style="background-color: #ffff00"><span style="color: #0000ff">from</span> app1.models <span style="color: #0000ff">import</span> *</span>       <span style="color: #008000">#</span><span style="color: #008000">导入数据库操作</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        required</span>=<span style="color: #000000">True,
        max_length</span>=4<span style="color: #000000">,
        min_length</span>=2<span style="color: #000000">,
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span><span style="color: #000000">
        }
    )

    <span style="background-color: #ffff00">a </span></span><span style="background-color: #ffff00">= shengf.objects.all().values_list(<span style="color: #800000">'</span><span style="color: #800000">id</span><span style="color: #800000">'</span>,<span style="color: #800000">'</span><span style="color: #800000">shf</span><span style="color: #800000">'</span>) <span style="color: #008000">#</span><span style="color: #008000">获取数据库里shengf表里的id和shf字段的数据</span></span>
    pwd =<span style="color: #000000"> forms.CharField(
        widget</span>=forms.widgets.<span style="background-color: #ff99cc">Select(<span style="background-color: #ffff00">choices=a</span>,attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">c1</span><span style="color: #800000">'</span>})</span> <span style="color: #008000">#</span><span style="color: #008000">将数据库的数据显示到下拉框</span>
    )</pre>
</div>
<p>&nbsp;<img src="https://images2015.cnblogs.com/blog/955761/201707/955761-20170717194742910-289353552.png" alt=""></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>下拉框结合数据库应用，防止数据库添加了数据，或者删除了数据，页面缓存了下拉框数据，无法事实数据同步</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>
<span style="color: #0000ff">from</span> app1.models <span style="color: #0000ff">import</span> *       <span style="color: #008000">#</span><span style="color: #008000">导入数据库操作</span>

<span style="color: #0000ff">class</span> <span style="background-color: #ff99cc">yhbd</span>(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        required</span>=<span style="color: #000000">True,
        max_length</span>=4<span style="color: #000000">,
        min_length</span>=2<span style="color: #000000">,
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span><span style="color: #000000">
        }
    )

    a </span>= shengf.objects.all().values_list(<span style="color: #800000">'</span><span style="color: #800000">id</span><span style="color: #800000">'</span>,<span style="color: #800000">'</span><span style="color: #800000">shf</span><span style="color: #800000">'</span>) <span style="color: #008000">#</span><span style="color: #008000">获取数据库里shengf表里的id和shf字段的数据</span>
    <span style="background-color: #ff99cc">pwd</span> =<span style="color: #000000"> forms.CharField(
        widget</span>=forms.widgets.Select(choices=a,attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">c1</span><span style="color: #800000">'</span>}) <span style="color: #008000">#</span><span style="color: #008000">将数据库的数据显示到下拉框</span>
<span style="color: #000000">    )

    </span><span style="color: #008000">#</span><span style="color: #008000">防止数据库添加了数据，或者删除了数据，页面缓存了下拉框数据，无法事实数据同步</span>
    <span style="color: #0000ff">def</span> <span style="color: #800080">__init__</span>(self,*args, **kwargs):                                     <span style="color: #008000">#</span><span style="color: #008000">创建类的__init__方法，每次创建类时都会执行</span>
        super(<span style="background-color: #ff99cc">yhbd</span>,self).<span style="color: #800080">__init__</span>(*args, **kwargs)                          <span style="color: #008000">#</span><span style="color: #008000">获取当前类的父类里的__init__方法执行</span>
        a = shengf.objects.all().values_list(<span style="color: #800000">'</span><span style="color: #800000">id</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">shf</span><span style="color: #800000">'</span>)                   <span style="color: #008000">#</span><span style="color: #008000">重新获取数据库里shengf表里的id和shf字段的数据</span>
        self.fields[<span style="background-color: #ff99cc"><span style="color: #800000">'</span><span style="color: #800000">pwd</span><span style="color: #800000">'</span></span>] = forms.CharField(widget=forms.widgets.Select(choices=a,attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">c1</span><span style="color: #800000">'</span>}))  <span style="color: #008000">#</span><span style="color: #008000">更新一下表单pwd字段的数据</span></pre>
</div>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>自定义验证规则</strong></span></p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">validators</span>设置自定义验证规则，参数是一个列表，列表里是自定义验证方法名称</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>
<span style="color: #0000ff">from</span> django.core.exceptions <span style="color: #0000ff">import</span><span style="color: #000000"> ValidationError
</span><span style="color: #0000ff">import</span><span style="color: #000000"> re

</span><span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        required</span>=<span style="color: #000000">True,
        max_length</span>=4<span style="color: #000000">,
        min_length</span>=2<span style="color: #000000">,
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span><span style="color: #000000">
        }
    )


    </span><span style="color: #008000">#</span><span style="color: #008000">自定义验证规则</span>
<span style="background-color: #ffff00">    <span style="color: #0000ff">def</span><span style="color: #000000"> shouji(value):
        mobile_re </span>= re.compile(r<span style="color: #800000">'</span><span style="color: #800000">^(13[0-9]|15[012356789]|17[678]|18[0-9]|14[57])[0-9]{8}$</span><span style="color: #800000">'</span><span style="color: #000000">)
        </span><span style="color: #0000ff">if</span> <span style="color: #0000ff">not</span><span style="color: #000000"> mobile_re.match(value):
            </span><span style="color: #0000ff">raise</span> ValidationError(<span style="color: #800000">'</span><span style="color: #800000">手机号码格式错误</span><span style="color: #800000">'</span>)   <span style="color: #008000">#</span><span style="color: #008000">如果不匹配返回错误信息</span></span>
<span style="color: #000000">

    pwd </span>=<span style="color: #000000"> forms.CharField(
        <span style="background-color: #ffff00">validators</span></span><span style="background-color: #ffff00">=[shouji, ],   <span style="color: #008000">#</span><span style="color: #008000">设置自定义验证规则</span></span>
        required=<span style="color: #000000">True,
        widget</span>=<span style="color: #000000">forms.TextInput(
            attrs</span>=<span style="color: #000000">{
                </span><span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>: <span style="color: #800000">"</span><span style="color: #800000">cl</span><span style="color: #800000">"</span><span style="color: #000000">,
                </span><span style="color: #800000">'</span><span style="color: #800000">placeholder</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">手机号码</span><span style="color: #800000">'</span><span style="color: #000000">
            }
        ),
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">手机不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
        }
    )</span></pre>
</div>
<p><img src="https://images2015.cnblogs.com/blog/955761/201707/955761-20170717232723411-1592842803.png" alt=""></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>其他</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span>
<span style="color: #0000ff">import</span><span style="color: #000000"> re
</span><span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span><span style="color: #000000"> forms
</span><span style="color: #0000ff">from</span> django.core.exceptions <span style="color: #0000ff">import</span><span style="color: #000000"> ValidationError


</span><span style="color: #0000ff">def</span><span style="color: #000000"> mobile_validate(value):
    mobile_re </span>= re.compile(r<span style="color: #800000">'</span><span style="color: #800000">^(13[0-9]|15[012356789]|17[678]|18[0-9]|14[57])[0-9]{8}$</span><span style="color: #800000">'</span><span style="color: #000000">)
    </span><span style="color: #0000ff">if</span> <span style="color: #0000ff">not</span><span style="color: #000000"> mobile_re.match(value):
        </span><span style="color: #0000ff">raise</span> ValidationError(<span style="color: #800000">'</span><span style="color: #800000">手机号码格式错误</span><span style="color: #800000">'</span><span style="color: #000000">)


</span><span style="color: #0000ff">class</span><span style="color: #000000"> PublishForm(forms.Form):

    user_type_choice </span>=<span style="color: #000000"> (
        (0, u</span><span style="color: #800000">'</span><span style="color: #800000">普通用户</span><span style="color: #800000">'</span><span style="color: #000000">),
        (</span>1, u<span style="color: #800000">'</span><span style="color: #800000">高级用户</span><span style="color: #800000">'</span><span style="color: #000000">),
    )

    user_type </span>= forms.IntegerField(widget=forms.widgets.Select(choices=<span style="color: #000000">user_type_choice,
                                                                  attrs</span>={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>: <span style="color: #800000">"</span><span style="color: #800000">form-control</span><span style="color: #800000">"</span><span style="color: #000000">}))

    title </span>= forms.CharField(max_length=20<span style="color: #000000">,
                            min_length</span>=5<span style="color: #000000">,
                            error_messages</span>={<span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">标题不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
                                            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">标题最少为5个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
                                            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">标题最多为20个字符</span><span style="color: #800000">'</span><span style="color: #000000">},
                            widget</span>=forms.TextInput(attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>: <span style="color: #800000">"</span><span style="color: #800000">form-control</span><span style="color: #800000">"</span><span style="color: #000000">,
                                                          </span><span style="color: #800000">'</span><span style="color: #800000">placeholder</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">标题5-20个字符</span><span style="color: #800000">'</span><span style="color: #000000">}))

    memo </span>= forms.CharField(required=<span style="color: #000000">False,
                           max_length</span>=256<span style="color: #000000">,
                           widget</span>=forms.widgets.Textarea(attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>: <span style="color: #800000">"</span><span style="color: #800000">form-control no-radius</span><span style="color: #800000">"</span>, <span style="color: #800000">'</span><span style="color: #800000">placeholder</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">详细描述</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">rows</span><span style="color: #800000">'</span>: 3<span style="color: #000000">}))

    phone </span>= forms.CharField(validators=<span style="color: #000000">[mobile_validate, ],
                            error_messages</span>={<span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">手机不能为空</span><span style="color: #800000">'</span><span style="color: #000000">},
                            widget</span>=forms.TextInput(attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>: <span style="color: #800000">"</span><span style="color: #800000">form-control</span><span style="color: #800000">"</span><span style="color: #000000">,
                                                          </span><span style="color: #800000">'</span><span style="color: #800000">placeholder</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">手机号码</span><span style="color: #800000">'</span><span style="color: #000000">}))

    email </span>= forms.EmailField(required=<span style="color: #000000">False,
                            error_messages</span>={<span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">邮箱不能为空</span><span style="color: #800000">'</span>,<span style="color: #800000">'</span><span style="color: #800000">invalid</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">邮箱格式错误</span><span style="color: #800000">'</span><span style="color: #000000">},
                            widget</span>=forms.TextInput(attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>: <span style="color: #800000">"</span><span style="color: #800000">form-control</span><span style="color: #800000">"</span>, <span style="color: #800000">'</span><span style="color: #800000">placeholder</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">邮箱</span><span style="color: #800000">'</span>}))</pre>
</div>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>注意：如果表单是通过Ajax提交的，页面不刷新，那么html页面将无法获取到错误信息，那么我们只能将所有错误信息构造成字典，然后以json的方式返回给Ajax，添加到页面</strong></span></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>将models数据库表类转换成表单验证类【必要使用】</strong></span></p>
<p><span style="color: #000000"><strong>这样可以少写表单验证代码，使用的是数据库字段的验证规则</strong></span></p>
<p><span style="color: #ff0000"><strong>models.py</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">from</span> django.db <span style="color: #0000ff">import</span> models        <span style="color: #008000">#</span><span style="color: #008000"> 导入models对象</span>

<span style="color: #0000ff">class</span><span style="color: #000000"><span style="background-color: #ff99cc"> CourseOrg</span>(models.Model):
    <span style="background-color: #ff99cc">name </span></span><span style="background-color: #ff99cc">= models.CharField(max_length=50, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">机构名称</span><span style="color: #800000">'</span></span><span style="color: #000000"><span style="background-color: #ff99cc">)</span>
    desc </span>= models.TextField(verbose_name=<span style="color: #800000">'</span><span style="color: #800000">机构描述</span><span style="color: #800000">'</span><span style="color: #000000">)
    <span style="background-color: #ff99cc">category </span></span><span style="background-color: #ff99cc">= models.CharField(max_length=20, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">机构类别</span><span style="color: #800000">'</span>, default=<span style="color: #800000">'</span><span style="color: #800000">pxjg</span><span style="color: #800000">'</span>, choices=((<span style="color: #800000">'</span><span style="color: #800000">pxjg</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">培训机构</span><span style="color: #800000">'</span>), (<span style="color: #800000">'</span><span style="color: #800000">gx</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">高校</span><span style="color: #800000">'</span>), (<span style="color: #800000">'</span><span style="color: #800000">gr</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">个人</span><span style="color: #800000">'</span></span><span style="color: #000000"><span style="background-color: #ff99cc">)))</span>
    click </span>= models.IntegerField(default=0, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">点击数</span><span style="color: #800000">'</span><span style="color: #000000">)
    <span style="background-color: #ff99cc">fav_nums </span></span><span style="background-color: #ff99cc">= models.IntegerField(default=0, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">收藏数</span><span style="color: #800000">'</span></span><span style="color: #000000"><span style="background-color: #ff99cc">)</span>
    image </span>= models.ImageField(upload_to=<span style="color: #800000">'</span><span style="color: #800000">org/%Y/%m</span><span style="color: #800000">'</span>, storage=ImageStorage(), verbose_name=<span style="color: #800000">'</span><span style="color: #800000">封面图</span><span style="color: #800000">'</span>, max_length=100<span style="color: #000000">)
    address </span>= models.CharField(max_length=150, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">机构地址</span><span style="color: #800000">'</span><span style="color: #000000">)
    city </span>= models.ForeignKey(CityDict, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">外键城市表</span><span style="color: #800000">'</span><span style="color: #000000">)
    add_time </span>= models.DateTimeField(default=datetime.now, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">添加日期</span><span style="color: #800000">'</span><span style="color: #000000">)

    </span><span style="color: #0000ff">class</span><span style="color: #000000"> Meta:
        verbose_name </span>= <span style="color: #800000">'</span><span style="color: #800000">课程机构表</span><span style="color: #800000">'</span><span style="color: #000000">
        verbose_name_plural </span>=<span style="color: #000000"> verbose_name

    </span><span style="color: #0000ff">def</span> <span style="color: #800080">__str__</span><span style="color: #000000">(self):
        </span><span style="color: #0000ff">return</span> self.name</pre>
</div>
<p><span style="color: #ff0000"><strong>forms.py</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf8 -*-</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> <span style="background-color: #ff99cc">forms</span>                             <span style="color: #008000">#</span><span style="color: #008000"> 导入Django的表单验证模块</span>
<span style="color: #0000ff">from</span> app_organization.models <span style="color: #0000ff">import</span> <span style="background-color: #ff99cc"><strong>CourseOrg</strong></span>        <span style="color: #008000">#</span><span style="color: #008000"> 导入数据库表类</span>


<span style="color: #0000ff">class</span><span style="color: #000000"> CourseOrgForm(<span style="background-color: #ff99cc">forms.ModelForm</span>):
    zdyi </span>= forms.CharField()                         <span style="color: #008000">#</span><span style="color: #008000"> 自定义表单验证字段</span>

    <span style="color: #0000ff">class</span><span style="color: #000000"> Meta:
        model </span>= <span style="background-color: #ff99cc">CourseOrg</span>                            <span style="color: #008000">#</span><span style="color: #008000"> 设置要将数据库表类转换成表单验证类的名称</span>
        fields = [<span style="color: #800000">'</span><span style="color: #800000">name</span><span style="color: #800000">'</span>,<span style="color: #800000">'</span><span style="color: #800000">category</span><span style="color: #800000">'</span>,<span style="color: #800000">'</span><span style="color: #800000">fav_nums</span><span style="color: #800000">'</span>]      <span style="color: #008000">#</span><span style="color: #008000"> 要使用的字段</span></pre>
</div>
<p>&nbsp;</p></div>第三百一十一节，Django框架，Form表单验证


			<div id="cnblogs_post_body" class="blogpost-body"><p><strong>第三百一十一节，Django框架，Form表单验证</strong></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong>表单提交</strong></span></p>
<p><span style="color: #0000ff"><strong>html</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">&lt;!</span><span style="color: #ff00ff">DOCTYPE html</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">html </span><span style="color: #ff0000">lang</span><span style="color: #0000ff">="en"</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">head</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">meta </span><span style="color: #ff0000">charset</span><span style="color: #0000ff">="UTF-8"</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">title</span><span style="color: #0000ff">&gt;</span>Title<span style="color: #0000ff">&lt;/</span><span style="color: #800000">title</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">link </span><span style="color: #ff0000">rel</span><span style="color: #0000ff">="stylesheet"</span><span style="color: #ff0000"> type</span><span style="color: #0000ff">="text/css"</span><span style="color: #ff0000"> href</span><span style="color: #0000ff">="/static/css/tou.css"</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">head</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">body</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">form </span><span style="color: #ff0000">action</span><span style="color: #0000ff">="<span style="background-color: #ff99cc">/bug<span style="background-color: #ffff00">articles</span>/</span>"</span><span style="color: #ff0000"> method</span><span style="color: #0000ff">="post"</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="text"</span><span style="color: #ff0000"> name</span><span style="color: #0000ff">="user"</span><span style="color: #0000ff">/&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="text"</span><span style="color: #ff0000"> name</span><span style="color: #0000ff">="pwd"</span><span style="color: #0000ff">/&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="submit"</span><span style="color: #ff0000"> value</span><span style="color: #0000ff">="提交"</span><span style="color: #0000ff">/&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">form</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">body</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">html</span><span style="color: #0000ff">&gt;</span></pre>
</div>
<p><span style="color: #0000ff"><strong>路由映射</strong></span></p>
<div class="cnblogs_code">
<pre>urlpatterns =<span style="color: #000000"> [
    url(r</span><span style="color: #800000">'</span><span style="color: #800000">admin/</span><span style="color: #800000">'</span>, admin.site.urls),   <span style="color: #008000">#</span><span style="color: #008000">路由映射admin数据库管理</span>
    url(r<span style="color: #800000">'</span><span style="color: #800000"><span style="background-color: #ffff00">articles</span>/</span><span style="color: #800000">'</span><span style="color: #000000">, <span style="background-color: #ffff00">views.special</span>)    
]</span></pre>
</div>
<p><span style="color: #0000ff"><strong>逻辑处理</strong></span></p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">method</span>属性获取用户请求方式，post或者get</strong></span><br><strong>使用方式：请求对象.method</strong></p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">POST</span>获取用户post请求方式的信息</strong></span><br><strong>使用方式：请求对象.POST</strong></p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">POST.get()</span>获取用户POST请求方式的表单name名称对应的值，参数是表单name名</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">from</span> django.shortcuts <span style="color: #0000ff">import</span><span style="color: #000000"> render
</span><span style="color: #0000ff">from</span> app1.models <span style="color: #0000ff">import</span> *    <span style="color: #008000">#</span><span style="color: #008000">导入数据库操作模块</span>

<span style="color: #008000">#</span><span style="color: #008000">逻辑处理模块</span>
<span style="color: #0000ff">def</span><span style="color: #000000"><span style="background-color: #ffff00"> special</span>(request):  　　　　　　　　　　　　　 <span style="color: #008080">#自定义参数接收用户请求对象
    </span></span><span style="color: #0000ff">if</span> request.method == <span style="color: #800000">"</span><span style="color: #800000">POST</span><span style="color: #800000">"</span><span style="color: #000000">:　　　　　　　　 <span style="color: #008080">#判断用户请求如果是post方式
        </span></span><span style="color: #0000ff">print</span>(request.POST.get(<span style="color: #800000">'</span><span style="color: #800000">user</span><span style="color: #800000">'</span>,None))  <span style="color: #008000">#</span><span style="color: #008000">接收用户表单提交的name名称对应的值</span>
        <span style="color: #0000ff">print</span>(request.POST.get(<span style="color: #800000">'</span><span style="color: #800000">pwd</span><span style="color: #800000">'</span>, None))  <span style="color: #008000">#</span><span style="color: #008000">接收用户表单提交的name名称对应的值</span>
    <span style="color: #0000ff">return</span> render(request, <span style="color: #800000">'</span><span style="color: #800000">app1/index.html</span><span style="color: #800000">'</span>, locals())  <span style="color: #008000">#</span><span style="color: #008000"> 打开页面</span></pre>
</div>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong>表单提交验证，获取数据与获取错误信息</strong></span></p>
<p><span style="color: #000000"><strong>1、创建表单验证模块，必须继承</strong><span style="color: #0000ff"><strong>Django的表单验证forms.Form类</strong></span></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> <span style="background-color: #ff99cc">django <span style="color: #0000ff">import</span> forms</span>        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(<span style="background-color: #ff99cc">forms.Form</span>):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    <span style="background-color: #ff99cc">user</span> = forms.CharField()    <span style="color: #008000">#</span><span style="color: #008000">接收逻辑处理时，创建yhbd类时传进来的POST对象，里的表单name名对应的值进行验证</span>
    <span style="background-color: #ff99cc">pwd</span> = forms.CharField()     <span style="color: #008000">#</span><span style="color: #008000">#接收逻辑处理时，创建yhbd类时传进来的POST对象，里的表单name名对应的值进行验证</span></pre>
</div>
<p><strong>2、逻辑处理，创建表单验证模块里的验证类，并将用户请求的<span style="color: #0000ff">POST对象</span>，传入验证类进行验证，验证后获取验证通过的提交信息，或者验证没通过的错误信息</strong></p>
<p><span style="color: #0000ff"><strong>如果出现错误，将错误信息对象以字典方式传到html页面</strong></span></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">is_valid()</span>返回验证是否通过的布尔值</strong></span><br><strong>使用方式：验证类.is_valid()</strong></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">cleaned_data</span>获取验证通过后的所有提交数据，返回字典</strong></span><br><strong>使用方式：验证类.cleaned_data</strong></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">errors</span>获取验证错误信息，返回所有表单的错误信息对象</strong></span><br><strong>使用方法：验证类.errors</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">from</span> django.shortcuts <span style="color: #0000ff">import</span><span style="color: #000000"> render
</span><span style="color: #0000ff">from</span> app1.models <span style="color: #0000ff">import</span> *    <span style="color: #008000">#</span><span style="color: #008000">导入数据库操作模块</span>
<span style="color: #0000ff">from</span> app1.biaodan <span style="color: #0000ff">import</span> *   <span style="color: #008000">#</span><span style="color: #008000">导入自定义表单验证模块</span><span style="color: #008000">
#</span><span style="color: #008000">逻辑处理模块</span>
<span style="color: #0000ff">def</span><span style="color: #000000"> special(request):
    </span><span style="color: #0000ff">if</span> request.method == <span style="color: #800000">'</span><span style="color: #800000">GET</span><span style="color: #800000">'</span><span style="color: #000000">:
        </span><span style="color: #0000ff">return</span> render(request, <span style="color: #800000">'</span><span style="color: #800000">app1/index.html</span><span style="color: #800000">'</span>, locals())  <span style="color: #008000">#</span><span style="color: #008000"> 打开页面</span>

    <span style="background-color: #ff99cc"><span style="color: #0000ff">if</span> request.method == <span style="color: #800000">"</span><span style="color: #800000">POST</span><span style="color: #800000">"</span><span style="color: #000000">:
        </span></span><span style="color: #008000">#</span><span style="color: #008000"> print(request.POST.get('user',None))          #接收用户表单提交的name名称对应的值</span>
        <span style="color: #008000">#</span><span style="color: #008000"> print(request.POST.get('pwd', None))          #接收用户表单提交的name名称对应的值</span>
<span style="background-color: #ff99cc"><span style="color: #000000">
        f </span>= yhbd(request.POST)</span>                          <span style="color: #008000">#</span><span style="color: #008000">创建验证表单类，将用户请求POST对象传进表单验证类进行验证</span>

        <span style="color: #008000">#</span><span style="color: #008000"> ret = f.is_valid()                            #返回验证是否通过</span>
        <span style="color: #008000">#</span><span style="color: #008000"> print(ret)                                    #返回布尔值</span>

       <span style="background-color: #ff99cc"> <span style="color: #0000ff">if</span> f.is_valid():</span>                                <span style="color: #008000">#</span><span style="color: #008000">判断验证如果通过</span>
            <span style="background-color: #ff99cc"><span style="color: #0000ff">print</span>(f.cleaned_data)</span>                       <span style="color: #008000">#</span><span style="color: #008000">获取到用户提交信息,字典方式</span>
        <span style="color: #0000ff">else</span>:                                           <span style="color: #008000">#</span><span style="color: #008000">如果没通过</span>
            <span style="background-color: #ff99cc"><span style="color: #0000ff">print</span>(f.errors)</span>                             <span style="color: #008000">#</span><span style="color: #008000">获取错误对象</span>

        <span style="color: #0000ff">return</span> render(request, <span style="color: #800000">'</span><span style="color: #800000">app1/index.html</span><span style="color: #800000">'</span>,<span style="background-color: #ff99cc">{<span style="color: #800000">'</span><span style="color: #800000">cuow</span><span style="color: #800000">'</span>:f.errors}</span>)  <span style="color: #008000">#</span><span style="color: #008000"> 打开页面，将错误信息用字典方式传到html页面</span></pre>
</div>
<p><strong>3、在html页面接收逻辑处理<span style="color: #0000ff">以字典形式</span>传过来的错误对象，分别获取不同表单的错误信息</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">&lt;!</span><span style="color: #ff00ff">DOCTYPE html</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">html </span><span style="color: #ff0000">lang</span><span style="color: #0000ff">="en"</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">head</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">meta </span><span style="color: #ff0000">charset</span><span style="color: #0000ff">="UTF-8"</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">title</span><span style="color: #0000ff">&gt;</span>Title<span style="color: #0000ff">&lt;/</span><span style="color: #800000">title</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">link </span><span style="color: #ff0000">rel</span><span style="color: #0000ff">="stylesheet"</span><span style="color: #ff0000"> type</span><span style="color: #0000ff">="text/css"</span><span style="color: #ff0000"> href</span><span style="color: #0000ff">="/static/css/tou.css"</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">head</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">body</span><span style="color: #0000ff">&gt;</span>

<span style="color: #0000ff">&lt;</span><span style="color: #800000">form </span><span style="color: #ff0000">action</span><span style="color: #0000ff">="/bugarticles/"</span><span style="color: #ff0000"> method</span><span style="color: #0000ff">="post"</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="text"</span><span style="color: #ff0000"> name</span><span style="color: #0000ff">="user"</span><span style="color: #0000ff">/&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span><span style="background-color: #ff99cc">{{ cuow.user.0 }}</span><span style="color: #0000ff">&lt;/</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span>     <span style="color: #008000">&lt;!--</span><span style="color: #008000"> 接收错误信息里的user的错误信息 </span><span style="color: #008000">--&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="text"</span><span style="color: #ff0000"> name</span><span style="color: #0000ff">="pwd"</span><span style="color: #0000ff">/&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span><span style="background-color: #ff99cc">{{ cuow.pwd.0 }}</span><span style="color: #0000ff">&lt;/</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span>      <span style="color: #008000">&lt;!--</span><span style="color: #008000"> 接收错误信息里的pwd的错误信息 </span><span style="color: #008000">--&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="submit"</span><span style="color: #ff0000"> value</span><span style="color: #0000ff">="提交"</span><span style="color: #0000ff">/&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">form</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">body</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">html</span><span style="color: #0000ff">&gt;</span></pre>
</div>
<p>&nbsp;<img src="https://images2015.cnblogs.com/blog/955761/201707/955761-20170716170032722-817776133.png" alt=""></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong>利用表单类自动创建表单标签</strong></span></p>
<p><span style="background-color: #ffffff"><strong>以上表单的&lt;input&gt;是我们自己手动写的，还可以用表单类来自动创建表单标签，好处是不用自己写表单标签，还有就是当用户填写的表单不合法提交时提示错误信息不清空表单</strong></span></p>
<p>&nbsp;</p>
<p><span style="background-color: #ffff00; color: #0000ff"><strong>注意：表单类根据字段创建的表单标签，当用户输入内容时，首先要经过浏览器默认行为的表单验证，如果浏览器<strong>默认行为的表单验证都没有通过那么将无法提交</strong></strong></span></p>
<p><span style="background-color: #ffff00; color: #0000ff"><strong><strong><strong>浏览器<strong>默认行为的表单验证，通过了在进行我们定义的表单类验证，验证合法获取用户提交信息，不合法返回错误信息</strong></strong></strong></strong></span></p>
<p><span style="background-color: #ffffff; color: #0000ff"><strong><strong><strong><strong>利用表单类自动创建表单标签</strong></strong></strong></strong></span></p>
<p><span style="background-color: #ffffff"><strong><strong><strong><strong>1、首先在get访问页面时，创建表单类不传参数，然后把这个表单类传到html页面，在html页面通过，<span style="color: #ff0000">表单类.字段名称</span>，来自动创建表单标签</strong></strong></strong></strong></span></p>
<p><span style="background-color: #ffffff"><strong><strong><strong><strong>　　每一种表单字段类型，都有一个默认的表单标签，这个标签是可以更改的，所以表单类可以创建任何表单标签</strong></strong></strong></strong></span></p>
<p><span style="background-color: #ffffff"><strong><strong><strong><strong>2、在post访问时，再次创建表单类需要传参，将post请求对象传入表单类进行验证表单，如果表单不合法，将错误信息对象传到html显示错误信息，将这次创建的表单类传到html页面替换get时创建的表单类</strong></strong></strong></strong></span></p>
<p><span style="color: #0000ff; background-color: #ffffff"><strong>逻辑处理</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">from</span> django.shortcuts <span style="color: #0000ff">import</span><span style="color: #000000"> render
</span><span style="color: #0000ff">from</span> app1.models <span style="color: #0000ff">import</span> *    <span style="color: #008000">#</span><span style="color: #008000">导入数据库操作模块</span>
<span style="color: #0000ff">from</span> app1.biaodan <span style="color: #0000ff">import</span> *   <span style="color: #008000">#</span><span style="color: #008000">导入自定义表单验证模块</span><span style="color: #008000">
#</span><span style="color: #008000">逻辑处理模块</span>
<span style="color: #0000ff">def</span><span style="color: #000000"> special(request):
    </span><span style="color: #0000ff">if</span> request.method == <span style="color: #800000">'</span><span style="color: #800000; background-color: #ffff00">GET</span><span style="color: #800000">'</span><span style="color: #000000">:
        <span style="background-color: #ffff00">f </span></span><span style="background-color: #ffff00">= yhbd()</span>                                            <span style="color: #008000">#</span><span style="color: #008000">创建表单验证类，不传参</span>
        <span style="color: #0000ff">return</span> render(request, <span style="color: #800000">'</span><span style="color: #800000">app1/index.html</span><span style="color: #800000">'</span>,{<span style="background-color: #ffff00"><span style="color: #800000">'</span><span style="color: #800000">form</span><span style="color: #800000">'</span>:f</span>})  <span style="color: #008000">#</span><span style="color: #008000"> 打开页面，并将表单验证类传到html生成表单标签</span>

    <span style="color: #0000ff">if</span> request.method == <span style="color: #800000">"</span><span style="color: #800000; background-color: #ff99cc">POST</span><span style="color: #800000">"</span><span style="color: #000000">:
        <span style="background-color: #ff99cc">f </span></span><span style="background-color: #ff99cc">= yhbd(request.POST)</span>                          <span style="color: #008000">#</span><span style="color: #008000">创建验证表单类，将用户请求POST对象传进表单验证类进行验证</span>

        <span style="background-color: #ff99cc"><span style="color: #0000ff">if</span> f.is_valid():</span>                                <span style="color: #008000">#</span><span style="color: #008000">判断验证如果通过</span>
            <span style="background-color: #ff99cc"><span style="color: #0000ff">print</span>(f.cleaned_data)</span>                       <span style="color: #008000">#</span><span style="color: #008000">获取到用户提交信息,字典方式</span>
        <span style="color: #0000ff">else</span>:                                           <span style="color: #008000">#</span><span style="color: #008000">如果没通过</span>
            <span style="color: #008000">#</span><span style="color: #008000"><span style="background-color: #ff99cc"> print(f.errors)</span>                           #获取错误对象</span>
            <span style="color: #0000ff">pass</span>

        <span style="color: #0000ff">return</span> render(request, <span style="color: #800000">'</span><span style="color: #800000">app1/index.html</span><span style="color: #800000">'</span>,{<span style="background-color: #ff99cc"><span style="color: #800000">'</span><span style="color: #800000">cuow</span><span style="color: #800000">'</span>:f.errors</span>,<span style="background-color: #ff99cc"><span style="color: #800000">'</span><span style="color: #800000">form</span><span style="color: #800000">'</span>:f</span>})  <span style="color: #008000">#</span><span style="color: #008000"> 打开页面，将错误信息用字典方式传到html页面，并且将表单类传到html页面替换没传参的表单验证类</span></pre>
</div>
<p><span style="color: #0000ff"><strong>html</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">&lt;!</span><span style="color: #ff00ff">DOCTYPE html</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">html </span><span style="color: #ff0000">lang</span><span style="color: #0000ff">="en"</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">head</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">meta </span><span style="color: #ff0000">charset</span><span style="color: #0000ff">="UTF-8"</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">title</span><span style="color: #0000ff">&gt;</span>Title<span style="color: #0000ff">&lt;/</span><span style="color: #800000">title</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">link </span><span style="color: #ff0000">rel</span><span style="color: #0000ff">="stylesheet"</span><span style="color: #ff0000"> type</span><span style="color: #0000ff">="text/css"</span><span style="color: #ff0000"> href</span><span style="color: #0000ff">="/static/css/tou.css"</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">head</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">body</span><span style="color: #0000ff">&gt;</span>

<span style="color: #0000ff">&lt;</span><span style="color: #800000">form </span><span style="color: #ff0000">action</span><span style="color: #0000ff">="/bugarticles/"</span><span style="color: #ff0000"> method</span><span style="color: #0000ff">="post"</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span><span style="color: #000000; background-color: #ffff00">
        {{ form.user }}                                     </span><span style="color: #008000">&lt;!--</span><span style="color: #008000"> 接收get请求时创建的表单类，生成表单标签 </span><span style="color: #008000">--&gt;</span><span style="background-color: #ff99cc"><span style="color: #000000">
        {% if cuow.user.0 %}
            </span><span style="color: #0000ff">&lt;</span><span style="color: #800000">span </span><span style="color: #ff0000">class</span><span style="color: #0000ff">="cuow"</span><span style="color: #0000ff">&gt;</span>{{ cuow.user.0 }}<span style="color: #0000ff">&lt;/</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span>     <span style="color: #008000">&lt;!--</span><span style="color: #008000"> 接收错误信息里的user的错误信息 </span><span style="color: #008000">--&gt;</span><span style="color: #000000">
        {% endif %}
    </span></span><span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span><span style="color: #000000; background-color: #ffff00">
        {{ form.pwd }}                                      </span><span style="color: #008000">&lt;!--</span><span style="color: #008000"> 接收get请求时创建的表单类，生成表单标签 </span><span style="color: #008000">--&gt;</span><span style="background-color: #ff99cc"><span style="color: #000000">
        {% if cuow.pwd.0 %}
            </span><span style="color: #0000ff">&lt;</span><span style="color: #800000">span </span><span style="color: #ff0000">class</span><span style="color: #0000ff">="cuow"</span><span style="color: #0000ff">&gt;</span>{{ cuow.pwd.0 }}<span style="color: #0000ff">&lt;/</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span>      <span style="color: #008000">&lt;!--</span><span style="color: #008000"> 接收错误信息里的pwd的错误信息 </span><span style="color: #008000">--&gt;</span><span style="color: #000000">
        {% endif %}
    </span></span><span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="submit"</span><span style="color: #ff0000"> value</span><span style="color: #0000ff">="提交"</span><span style="color: #0000ff">/&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">form</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">body</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">html</span><span style="color: #0000ff">&gt;</span></pre>
</div>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong>常用的内置验证字段</strong></span></p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">EmailField()</span>验证邮箱字段</strong></span><br><span style="color: #ff0000"><strong><span style="color: #0000ff">CharField()</span>验证字符串字段</strong></span><br><span style="color: #ff0000"><strong><span style="color: #0000ff">URLField()</span>验证url地址字段</strong></span><br><span style="color: #ff0000"><strong><span style="color: #0000ff">IntegerField()</span>验证数字字段</strong></span><br><span style="color: #ff0000"><strong><span style="color: #0000ff">GenericIPAddressField()</span>验证IP字段</strong></span></p>
<p><span style="color: #0000ff"><strong>注意：虽然有很多内置验证字段，但是我们还是要根据我们自己的需求来验证，所以</strong></span></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong>验证字段的参数</strong></span></p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">required</span>设置字段是否可以为空</strong></span><br><strong>	　　True不可以为空</strong><br><strong>	　　False可以为空</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user = forms.CharField(<span style="background-color: #ff99cc">required=True</span>)   <span style="color: #008000">#</span><span style="color: #008000">True不可以为空</span>
    pwd = forms.CharField()</pre>
</div>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">max_length</span>最大字符数</strong></span><br><span style="color: #ff0000"><strong><span style="color: #0000ff">min_length</span>最小字符数</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user = forms.CharField(<span style="background-color: #ff99cc">max_length=4</span>,<span style="background-color: #ff99cc">min_length=2</span><span style="color: #000000">)
    pwd </span>= forms.CharField()</pre>
</div>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">error_messages</span>自定义错误提示信息</strong></span><br><strong>　　参数是一个字典{'验证名称':'错误提示'}</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        <span style="background-color: #ffff00">required</span></span>=<span style="color: #000000">True,
        <span style="background-color: #ffff00">max_length</span></span>=4<span style="color: #000000">,
        <span style="background-color: #ffff00">min_length</span></span>=2<span style="color: #000000">,
<span style="background-color: #ff99cc">        error_messages</span></span><span style="background-color: #ff99cc">=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000; background-color: #ffff00">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000; background-color: #ffff00">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000; background-color: #ffff00">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span></span><span style="color: #000000"><span style="background-color: #ff99cc">
        }</span>
    )
    pwd </span>= forms.CharField()</pre>
</div>
<p><strong><span style="color: #0000ff">invalid</span>设置邮箱格式错误提示信息</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        required</span>=<span style="color: #000000">True,
        max_length</span>=4<span style="color: #000000">,
        min_length</span>=2<span style="color: #000000">,
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span><span style="color: #000000">
        }
    )
    pwd </span>=<span style="color: #000000"> forms.<span style="background-color: #ff99cc">EmailField</span>(
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>: <span style="color: #800000">'</span><span style="color: #800000">邮箱不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="background-color: #ff99cc"><span style="color: #800000">'</span><span style="color: #800000">invalid</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">邮箱格式不正确</span><span style="color: #800000">'</span></span><span style="color: #000000">
        }
    )</span></pre>
</div>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">widget</span>设置表单字段在html页面的类型</strong></span><br><strong>	　　使用方式：widget=forms.Textarea()</strong><br><strong>	　　Textarea(): &lt;textarea&gt;标签类型</strong><br><strong>	　　TextInput()：&lt;input&gt;标签类型</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        required</span>=<span style="color: #000000">True,
        max_length</span>=4<span style="color: #000000">,
        min_length</span>=2<span style="color: #000000">,
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span><span style="color: #000000">
        }
    )
    pwd </span>=<span style="color: #000000"> forms.CharField(
        <span style="background-color: #ff99cc">widget</span></span>=<span style="color: #000000">forms.<span style="background-color: #ff99cc">TextInput()</span>,
    )</span></pre>
</div>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">attrs</span>给表单标签设置属性，可以给标签元素设置class样式，和input标签的各种type属性</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        required</span>=<span style="color: #000000">True,
        max_length</span>=4<span style="color: #000000">,
        min_length</span>=2<span style="color: #000000">,
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span><span style="color: #000000">
        }
    )
    pwd </span>=<span style="color: #000000"> forms.CharField(
        widget</span>=forms.TextInput(<span style="background-color: #ff99cc">attrs={<span style="background-color: #ffff00"><span style="color: #800000">'</span><span style="color: #800000">type</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">password</span><span style="color: #800000">'</span></span>,<span style="background-color: #ffff00"><span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">c1</span><span style="color: #800000">'</span></span></span><span style="color: #000000"><span style="background-color: #ff99cc">}</span>),
    )</span></pre>
</div>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">Select</span>生成表单，select标签，下拉选项框</strong></span><br><strong>	　　参数:</strong><br><strong>		　　　　<span style="color: #0000ff">choices</span>设置下拉数据，元组类型</strong><br><strong>		　　　　<span style="color: #0000ff">attrs</span>设置select标签属性</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        required</span>=<span style="color: #000000">True,
        max_length</span>=4<span style="color: #000000">,
        min_length</span>=2<span style="color: #000000">,
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span><span style="color: #000000">
        }
    )

<span style="background-color: #ffff00">    zhi </span></span><span style="background-color: #ffff00">=<span style="color: #000000"> (
        (0, </span><span style="color: #800000">'</span><span style="color: #800000">普通会员</span><span style="color: #800000">'</span><span style="color: #000000">),
        (</span>1, <span style="color: #800000">'</span><span style="color: #800000">超级会员</span><span style="color: #800000">'</span><span style="color: #000000">),
        (</span>2, <span style="color: #800000">'</span><span style="color: #800000">黄金会员</span><span style="color: #800000">'</span><span style="color: #000000">),
        (</span>3, <span style="color: #800000">'</span><span style="color: #800000">白银会员</span><span style="color: #800000">'</span><span style="color: #000000">),
        (</span>4, <span style="color: #800000">'</span><span style="color: #800000">vip会员</span><span style="color: #800000">'</span></span><span style="color: #000000"><span style="background-color: #ffff00">)
    )</span>
    pwd </span>=<span style="color: #000000"> forms.CharField(
        widget</span>=forms.<span style="background-color: #ff99cc">widgets.Select(<span style="background-color: #ffff00">choices=zhi</span>,attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">c1</span><span style="color: #800000">'</span></span><span style="color: #000000"><span style="background-color: #ff99cc">})</span>
    )</span></pre>
</div>
<p><img src="https://images2015.cnblogs.com/blog/955761/201707/955761-20170717194742910-289353552.png" alt=""></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>下拉框结合数据库应用</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>
<span style="background-color: #ffff00"><span style="color: #0000ff">from</span> app1.models <span style="color: #0000ff">import</span> *</span>       <span style="color: #008000">#</span><span style="color: #008000">导入数据库操作</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        required</span>=<span style="color: #000000">True,
        max_length</span>=4<span style="color: #000000">,
        min_length</span>=2<span style="color: #000000">,
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span><span style="color: #000000">
        }
    )

    <span style="background-color: #ffff00">a </span></span><span style="background-color: #ffff00">= shengf.objects.all().values_list(<span style="color: #800000">'</span><span style="color: #800000">id</span><span style="color: #800000">'</span>,<span style="color: #800000">'</span><span style="color: #800000">shf</span><span style="color: #800000">'</span>) <span style="color: #008000">#</span><span style="color: #008000">获取数据库里shengf表里的id和shf字段的数据</span></span>
    pwd =<span style="color: #000000"> forms.CharField(
        widget</span>=forms.widgets.<span style="background-color: #ff99cc">Select(<span style="background-color: #ffff00">choices=a</span>,attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">c1</span><span style="color: #800000">'</span>})</span> <span style="color: #008000">#</span><span style="color: #008000">将数据库的数据显示到下拉框</span>
    )</pre>
</div>
<p>&nbsp;<img src="https://images2015.cnblogs.com/blog/955761/201707/955761-20170717194742910-289353552.png" alt=""></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>下拉框结合数据库应用，防止数据库添加了数据，或者删除了数据，页面缓存了下拉框数据，无法事实数据同步</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>
<span style="color: #0000ff">from</span> app1.models <span style="color: #0000ff">import</span> *       <span style="color: #008000">#</span><span style="color: #008000">导入数据库操作</span>

<span style="color: #0000ff">class</span> <span style="background-color: #ff99cc">yhbd</span>(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        required</span>=<span style="color: #000000">True,
        max_length</span>=4<span style="color: #000000">,
        min_length</span>=2<span style="color: #000000">,
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span><span style="color: #000000">
        }
    )

    a </span>= shengf.objects.all().values_list(<span style="color: #800000">'</span><span style="color: #800000">id</span><span style="color: #800000">'</span>,<span style="color: #800000">'</span><span style="color: #800000">shf</span><span style="color: #800000">'</span>) <span style="color: #008000">#</span><span style="color: #008000">获取数据库里shengf表里的id和shf字段的数据</span>
    <span style="background-color: #ff99cc">pwd</span> =<span style="color: #000000"> forms.CharField(
        widget</span>=forms.widgets.Select(choices=a,attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">c1</span><span style="color: #800000">'</span>}) <span style="color: #008000">#</span><span style="color: #008000">将数据库的数据显示到下拉框</span>
<span style="color: #000000">    )

    </span><span style="color: #008000">#</span><span style="color: #008000">防止数据库添加了数据，或者删除了数据，页面缓存了下拉框数据，无法事实数据同步</span>
    <span style="color: #0000ff">def</span> <span style="color: #800080">__init__</span>(self,*args, **kwargs):                                     <span style="color: #008000">#</span><span style="color: #008000">创建类的__init__方法，每次创建类时都会执行</span>
        super(<span style="background-color: #ff99cc">yhbd</span>,self).<span style="color: #800080">__init__</span>(*args, **kwargs)                          <span style="color: #008000">#</span><span style="color: #008000">获取当前类的父类里的__init__方法执行</span>
        a = shengf.objects.all().values_list(<span style="color: #800000">'</span><span style="color: #800000">id</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">shf</span><span style="color: #800000">'</span>)                   <span style="color: #008000">#</span><span style="color: #008000">重新获取数据库里shengf表里的id和shf字段的数据</span>
        self.fields[<span style="background-color: #ff99cc"><span style="color: #800000">'</span><span style="color: #800000">pwd</span><span style="color: #800000">'</span></span>] = forms.CharField(widget=forms.widgets.Select(choices=a,attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">c1</span><span style="color: #800000">'</span>}))  <span style="color: #008000">#</span><span style="color: #008000">更新一下表单pwd字段的数据</span></pre>
</div>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>自定义验证规则</strong></span></p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">validators</span>设置自定义验证规则，参数是一个列表，列表里是自定义验证方法名称</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>
<span style="color: #0000ff">from</span> django.core.exceptions <span style="color: #0000ff">import</span><span style="color: #000000"> ValidationError
</span><span style="color: #0000ff">import</span><span style="color: #000000"> re

</span><span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        required</span>=<span style="color: #000000">True,
        max_length</span>=4<span style="color: #000000">,
        min_length</span>=2<span style="color: #000000">,
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span><span style="color: #000000">
        }
    )


    </span><span style="color: #008000">#</span><span style="color: #008000">自定义验证规则</span>
<span style="background-color: #ffff00">    <span style="color: #0000ff">def</span><span style="color: #000000"> shouji(value):
        mobile_re </span>= re.compile(r<span style="color: #800000">'</span><span style="color: #800000">^(13[0-9]|15[012356789]|17[678]|18[0-9]|14[57])[0-9]{8}$</span><span style="color: #800000">'</span><span style="color: #000000">)
        </span><span style="color: #0000ff">if</span> <span style="color: #0000ff">not</span><span style="color: #000000"> mobile_re.match(value):
            </span><span style="color: #0000ff">raise</span> ValidationError(<span style="color: #800000">'</span><span style="color: #800000">手机号码格式错误</span><span style="color: #800000">'</span>)   <span style="color: #008000">#</span><span style="color: #008000">如果不匹配返回错误信息</span></span>
<span style="color: #000000">

    pwd </span>=<span style="color: #000000"> forms.CharField(
        <span style="background-color: #ffff00">validators</span></span><span style="background-color: #ffff00">=[shouji, ],   <span style="color: #008000">#</span><span style="color: #008000">设置自定义验证规则</span></span>
        required=<span style="color: #000000">True,
        widget</span>=<span style="color: #000000">forms.TextInput(
            attrs</span>=<span style="color: #000000">{
                </span><span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>: <span style="color: #800000">"</span><span style="color: #800000">cl</span><span style="color: #800000">"</span><span style="color: #000000">,
                </span><span style="color: #800000">'</span><span style="color: #800000">placeholder</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">手机号码</span><span style="color: #800000">'</span><span style="color: #000000">
            }
        ),
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">手机不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
        }
    )</span></pre>
</div>
<p><img src="https://images2015.cnblogs.com/blog/955761/201707/955761-20170717232723411-1592842803.png" alt=""></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>其他</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span>
<span style="color: #0000ff">import</span><span style="color: #000000"> re
</span><span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span><span style="color: #000000"> forms
</span><span style="color: #0000ff">from</span> django.core.exceptions <span style="color: #0000ff">import</span><span style="color: #000000"> ValidationError


</span><span style="color: #0000ff">def</span><span style="color: #000000"> mobile_validate(value):
    mobile_re </span>= re.compile(r<span style="color: #800000">'</span><span style="color: #800000">^(13[0-9]|15[012356789]|17[678]|18[0-9]|14[57])[0-9]{8}$</span><span style="color: #800000">'</span><span style="color: #000000">)
    </span><span style="color: #0000ff">if</span> <span style="color: #0000ff">not</span><span style="color: #000000"> mobile_re.match(value):
        </span><span style="color: #0000ff">raise</span> ValidationError(<span style="color: #800000">'</span><span style="color: #800000">手机号码格式错误</span><span style="color: #800000">'</span><span style="color: #000000">)


</span><span style="color: #0000ff">class</span><span style="color: #000000"> PublishForm(forms.Form):

    user_type_choice </span>=<span style="color: #000000"> (
        (0, u</span><span style="color: #800000">'</span><span style="color: #800000">普通用户</span><span style="color: #800000">'</span><span style="color: #000000">),
        (</span>1, u<span style="color: #800000">'</span><span style="color: #800000">高级用户</span><span style="color: #800000">'</span><span style="color: #000000">),
    )

    user_type </span>= forms.IntegerField(widget=forms.widgets.Select(choices=<span style="color: #000000">user_type_choice,
                                                                  attrs</span>={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>: <span style="color: #800000">"</span><span style="color: #800000">form-control</span><span style="color: #800000">"</span><span style="color: #000000">}))

    title </span>= forms.CharField(max_length=20<span style="color: #000000">,
                            min_length</span>=5<span style="color: #000000">,
                            error_messages</span>={<span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">标题不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
                                            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">标题最少为5个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
                                            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">标题最多为20个字符</span><span style="color: #800000">'</span><span style="color: #000000">},
                            widget</span>=forms.TextInput(attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>: <span style="color: #800000">"</span><span style="color: #800000">form-control</span><span style="color: #800000">"</span><span style="color: #000000">,
                                                          </span><span style="color: #800000">'</span><span style="color: #800000">placeholder</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">标题5-20个字符</span><span style="color: #800000">'</span><span style="color: #000000">}))

    memo </span>= forms.CharField(required=<span style="color: #000000">False,
                           max_length</span>=256<span style="color: #000000">,
                           widget</span>=forms.widgets.Textarea(attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>: <span style="color: #800000">"</span><span style="color: #800000">form-control no-radius</span><span style="color: #800000">"</span>, <span style="color: #800000">'</span><span style="color: #800000">placeholder</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">详细描述</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">rows</span><span style="color: #800000">'</span>: 3<span style="color: #000000">}))

    phone </span>= forms.CharField(validators=<span style="color: #000000">[mobile_validate, ],
                            error_messages</span>={<span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">手机不能为空</span><span style="color: #800000">'</span><span style="color: #000000">},
                            widget</span>=forms.TextInput(attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>: <span style="color: #800000">"</span><span style="color: #800000">form-control</span><span style="color: #800000">"</span><span style="color: #000000">,
                                                          </span><span style="color: #800000">'</span><span style="color: #800000">placeholder</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">手机号码</span><span style="color: #800000">'</span><span style="color: #000000">}))

    email </span>= forms.EmailField(required=<span style="color: #000000">False,
                            error_messages</span>={<span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">邮箱不能为空</span><span style="color: #800000">'</span>,<span style="color: #800000">'</span><span style="color: #800000">invalid</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">邮箱格式错误</span><span style="color: #800000">'</span><span style="color: #000000">},
                            widget</span>=forms.TextInput(attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>: <span style="color: #800000">"</span><span style="color: #800000">form-control</span><span style="color: #800000">"</span>, <span style="color: #800000">'</span><span style="color: #800000">placeholder</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">邮箱</span><span style="color: #800000">'</span>}))</pre>
</div>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>注意：如果表单是通过Ajax提交的，页面不刷新，那么html页面将无法获取到错误信息，那么我们只能将所有错误信息构造成字典，然后以json的方式返回给Ajax，添加到页面</strong></span></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>将models数据库表类转换成表单验证类【必要使用】</strong></span></p>
<p><span style="color: #000000"><strong>这样可以少写表单验证代码，使用的是数据库字段的验证规则</strong></span></p>
<p><span style="color: #ff0000"><strong>models.py</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">from</span> django.db <span style="color: #0000ff">import</span> models        <span style="color: #008000">#</span><span style="color: #008000"> 导入models对象</span>

<span style="color: #0000ff">class</span><span style="color: #000000"><span style="background-color: #ff99cc"> CourseOrg</span>(models.Model):
    <span style="background-color: #ff99cc">name </span></span><span style="background-color: #ff99cc">= models.CharField(max_length=50, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">机构名称</span><span style="color: #800000">'</span></span><span style="color: #000000"><span style="background-color: #ff99cc">)</span>
    desc </span>= models.TextField(verbose_name=<span style="color: #800000">'</span><span style="color: #800000">机构描述</span><span style="color: #800000">'</span><span style="color: #000000">)
    <span style="background-color: #ff99cc">category </span></span><span style="background-color: #ff99cc">= models.CharField(max_length=20, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">机构类别</span><span style="color: #800000">'</span>, default=<span style="color: #800000">'</span><span style="color: #800000">pxjg</span><span style="color: #800000">'</span>, choices=((<span style="color: #800000">'</span><span style="color: #800000">pxjg</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">培训机构</span><span style="color: #800000">'</span>), (<span style="color: #800000">'</span><span style="color: #800000">gx</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">高校</span><span style="color: #800000">'</span>), (<span style="color: #800000">'</span><span style="color: #800000">gr</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">个人</span><span style="color: #800000">'</span></span><span style="color: #000000"><span style="background-color: #ff99cc">)))</span>
    click </span>= models.IntegerField(default=0, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">点击数</span><span style="color: #800000">'</span><span style="color: #000000">)
    <span style="background-color: #ff99cc">fav_nums </span></span><span style="background-color: #ff99cc">= models.IntegerField(default=0, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">收藏数</span><span style="color: #800000">'</span></span><span style="color: #000000"><span style="background-color: #ff99cc">)</span>
    image </span>= models.ImageField(upload_to=<span style="color: #800000">'</span><span style="color: #800000">org/%Y/%m</span><span style="color: #800000">'</span>, storage=ImageStorage(), verbose_name=<span style="color: #800000">'</span><span style="color: #800000">封面图</span><span style="color: #800000">'</span>, max_length=100<span style="color: #000000">)
    address </span>= models.CharField(max_length=150, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">机构地址</span><span style="color: #800000">'</span><span style="color: #000000">)
    city </span>= models.ForeignKey(CityDict, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">外键城市表</span><span style="color: #800000">'</span><span style="color: #000000">)
    add_time </span>= models.DateTimeField(default=datetime.now, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">添加日期</span><span style="color: #800000">'</span><span style="color: #000000">)

    </span><span style="color: #0000ff">class</span><span style="color: #000000"> Meta:
        verbose_name </span>= <span style="color: #800000">'</span><span style="color: #800000">课程机构表</span><span style="color: #800000">'</span><span style="color: #000000">
        verbose_name_plural </span>=<span style="color: #000000"> verbose_name

    </span><span style="color: #0000ff">def</span> <span style="color: #800080">__str__</span><span style="color: #000000">(self):
        </span><span style="color: #0000ff">return</span> self.name</pre>
</div>
<p><span style="color: #ff0000"><strong>forms.py</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf8 -*-</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> <span style="background-color: #ff99cc">forms</span>                             <span style="color: #008000">#</span><span style="color: #008000"> 导入Django的表单验证模块</span>
<span style="color: #0000ff">from</span> app_organization.models <span style="color: #0000ff">import</span> <span style="background-color: #ff99cc"><strong>CourseOrg</strong></span>        <span style="color: #008000">#</span><span style="color: #008000"> 导入数据库表类</span>


<span style="color: #0000ff">class</span><span style="color: #000000"> CourseOrgForm(<span style="background-color: #ff99cc">forms.ModelForm</span>):
    zdyi </span>= forms.CharField()                         <span style="color: #008000">#</span><span style="color: #008000"> 自定义表单验证字段</span>

    <span style="color: #0000ff">class</span><span style="color: #000000"> Meta:
        model </span>= <span style="background-color: #ff99cc">CourseOrg</span>                            <span style="color: #008000">#</span><span style="color: #008000"> 设置要将数据库表类转换成表单验证类的名称</span>
        fields = [<span style="color: #800000">'</span><span style="color: #800000">name</span><span style="color: #800000">'</span>,<span style="color: #800000">'</span><span style="color: #800000">category</span><span style="color: #800000">'</span>,<span style="color: #800000">'</span><span style="color: #800000">fav_nums</span><span style="color: #800000">'</span>]      <span style="color: #008000">#</span><span style="color: #008000"> 要使用的字段</span></pre>
</div>
<p>&nbsp;</p></div>第三百一十一节，Django框架，Form表单验证


			<div id="cnblogs_post_body" class="blogpost-body"><p><strong>第三百一十一节，Django框架，Form表单验证</strong></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong>表单提交</strong></span></p>
<p><span style="color: #0000ff"><strong>html</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">&lt;!</span><span style="color: #ff00ff">DOCTYPE html</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">html </span><span style="color: #ff0000">lang</span><span style="color: #0000ff">="en"</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">head</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">meta </span><span style="color: #ff0000">charset</span><span style="color: #0000ff">="UTF-8"</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">title</span><span style="color: #0000ff">&gt;</span>Title<span style="color: #0000ff">&lt;/</span><span style="color: #800000">title</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">link </span><span style="color: #ff0000">rel</span><span style="color: #0000ff">="stylesheet"</span><span style="color: #ff0000"> type</span><span style="color: #0000ff">="text/css"</span><span style="color: #ff0000"> href</span><span style="color: #0000ff">="/static/css/tou.css"</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">head</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">body</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">form </span><span style="color: #ff0000">action</span><span style="color: #0000ff">="<span style="background-color: #ff99cc">/bug<span style="background-color: #ffff00">articles</span>/</span>"</span><span style="color: #ff0000"> method</span><span style="color: #0000ff">="post"</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="text"</span><span style="color: #ff0000"> name</span><span style="color: #0000ff">="user"</span><span style="color: #0000ff">/&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="text"</span><span style="color: #ff0000"> name</span><span style="color: #0000ff">="pwd"</span><span style="color: #0000ff">/&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="submit"</span><span style="color: #ff0000"> value</span><span style="color: #0000ff">="提交"</span><span style="color: #0000ff">/&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">form</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">body</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">html</span><span style="color: #0000ff">&gt;</span></pre>
</div>
<p><span style="color: #0000ff"><strong>路由映射</strong></span></p>
<div class="cnblogs_code">
<pre>urlpatterns =<span style="color: #000000"> [
    url(r</span><span style="color: #800000">'</span><span style="color: #800000">admin/</span><span style="color: #800000">'</span>, admin.site.urls),   <span style="color: #008000">#</span><span style="color: #008000">路由映射admin数据库管理</span>
    url(r<span style="color: #800000">'</span><span style="color: #800000"><span style="background-color: #ffff00">articles</span>/</span><span style="color: #800000">'</span><span style="color: #000000">, <span style="background-color: #ffff00">views.special</span>)    
]</span></pre>
</div>
<p><span style="color: #0000ff"><strong>逻辑处理</strong></span></p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">method</span>属性获取用户请求方式，post或者get</strong></span><br><strong>使用方式：请求对象.method</strong></p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">POST</span>获取用户post请求方式的信息</strong></span><br><strong>使用方式：请求对象.POST</strong></p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">POST.get()</span>获取用户POST请求方式的表单name名称对应的值，参数是表单name名</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">from</span> django.shortcuts <span style="color: #0000ff">import</span><span style="color: #000000"> render
</span><span style="color: #0000ff">from</span> app1.models <span style="color: #0000ff">import</span> *    <span style="color: #008000">#</span><span style="color: #008000">导入数据库操作模块</span>

<span style="color: #008000">#</span><span style="color: #008000">逻辑处理模块</span>
<span style="color: #0000ff">def</span><span style="color: #000000"><span style="background-color: #ffff00"> special</span>(request):  　　　　　　　　　　　　　 <span style="color: #008080">#自定义参数接收用户请求对象
    </span></span><span style="color: #0000ff">if</span> request.method == <span style="color: #800000">"</span><span style="color: #800000">POST</span><span style="color: #800000">"</span><span style="color: #000000">:　　　　　　　　 <span style="color: #008080">#判断用户请求如果是post方式
        </span></span><span style="color: #0000ff">print</span>(request.POST.get(<span style="color: #800000">'</span><span style="color: #800000">user</span><span style="color: #800000">'</span>,None))  <span style="color: #008000">#</span><span style="color: #008000">接收用户表单提交的name名称对应的值</span>
        <span style="color: #0000ff">print</span>(request.POST.get(<span style="color: #800000">'</span><span style="color: #800000">pwd</span><span style="color: #800000">'</span>, None))  <span style="color: #008000">#</span><span style="color: #008000">接收用户表单提交的name名称对应的值</span>
    <span style="color: #0000ff">return</span> render(request, <span style="color: #800000">'</span><span style="color: #800000">app1/index.html</span><span style="color: #800000">'</span>, locals())  <span style="color: #008000">#</span><span style="color: #008000"> 打开页面</span></pre>
</div>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong>表单提交验证，获取数据与获取错误信息</strong></span></p>
<p><span style="color: #000000"><strong>1、创建表单验证模块，必须继承</strong><span style="color: #0000ff"><strong>Django的表单验证forms.Form类</strong></span></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> <span style="background-color: #ff99cc">django <span style="color: #0000ff">import</span> forms</span>        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(<span style="background-color: #ff99cc">forms.Form</span>):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    <span style="background-color: #ff99cc">user</span> = forms.CharField()    <span style="color: #008000">#</span><span style="color: #008000">接收逻辑处理时，创建yhbd类时传进来的POST对象，里的表单name名对应的值进行验证</span>
    <span style="background-color: #ff99cc">pwd</span> = forms.CharField()     <span style="color: #008000">#</span><span style="color: #008000">#接收逻辑处理时，创建yhbd类时传进来的POST对象，里的表单name名对应的值进行验证</span></pre>
</div>
<p><strong>2、逻辑处理，创建表单验证模块里的验证类，并将用户请求的<span style="color: #0000ff">POST对象</span>，传入验证类进行验证，验证后获取验证通过的提交信息，或者验证没通过的错误信息</strong></p>
<p><span style="color: #0000ff"><strong>如果出现错误，将错误信息对象以字典方式传到html页面</strong></span></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">is_valid()</span>返回验证是否通过的布尔值</strong></span><br><strong>使用方式：验证类.is_valid()</strong></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">cleaned_data</span>获取验证通过后的所有提交数据，返回字典</strong></span><br><strong>使用方式：验证类.cleaned_data</strong></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">errors</span>获取验证错误信息，返回所有表单的错误信息对象</strong></span><br><strong>使用方法：验证类.errors</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">from</span> django.shortcuts <span style="color: #0000ff">import</span><span style="color: #000000"> render
</span><span style="color: #0000ff">from</span> app1.models <span style="color: #0000ff">import</span> *    <span style="color: #008000">#</span><span style="color: #008000">导入数据库操作模块</span>
<span style="color: #0000ff">from</span> app1.biaodan <span style="color: #0000ff">import</span> *   <span style="color: #008000">#</span><span style="color: #008000">导入自定义表单验证模块</span><span style="color: #008000">
#</span><span style="color: #008000">逻辑处理模块</span>
<span style="color: #0000ff">def</span><span style="color: #000000"> special(request):
    </span><span style="color: #0000ff">if</span> request.method == <span style="color: #800000">'</span><span style="color: #800000">GET</span><span style="color: #800000">'</span><span style="color: #000000">:
        </span><span style="color: #0000ff">return</span> render(request, <span style="color: #800000">'</span><span style="color: #800000">app1/index.html</span><span style="color: #800000">'</span>, locals())  <span style="color: #008000">#</span><span style="color: #008000"> 打开页面</span>

    <span style="background-color: #ff99cc"><span style="color: #0000ff">if</span> request.method == <span style="color: #800000">"</span><span style="color: #800000">POST</span><span style="color: #800000">"</span><span style="color: #000000">:
        </span></span><span style="color: #008000">#</span><span style="color: #008000"> print(request.POST.get('user',None))          #接收用户表单提交的name名称对应的值</span>
        <span style="color: #008000">#</span><span style="color: #008000"> print(request.POST.get('pwd', None))          #接收用户表单提交的name名称对应的值</span>
<span style="background-color: #ff99cc"><span style="color: #000000">
        f </span>= yhbd(request.POST)</span>                          <span style="color: #008000">#</span><span style="color: #008000">创建验证表单类，将用户请求POST对象传进表单验证类进行验证</span>

        <span style="color: #008000">#</span><span style="color: #008000"> ret = f.is_valid()                            #返回验证是否通过</span>
        <span style="color: #008000">#</span><span style="color: #008000"> print(ret)                                    #返回布尔值</span>

       <span style="background-color: #ff99cc"> <span style="color: #0000ff">if</span> f.is_valid():</span>                                <span style="color: #008000">#</span><span style="color: #008000">判断验证如果通过</span>
            <span style="background-color: #ff99cc"><span style="color: #0000ff">print</span>(f.cleaned_data)</span>                       <span style="color: #008000">#</span><span style="color: #008000">获取到用户提交信息,字典方式</span>
        <span style="color: #0000ff">else</span>:                                           <span style="color: #008000">#</span><span style="color: #008000">如果没通过</span>
            <span style="background-color: #ff99cc"><span style="color: #0000ff">print</span>(f.errors)</span>                             <span style="color: #008000">#</span><span style="color: #008000">获取错误对象</span>

        <span style="color: #0000ff">return</span> render(request, <span style="color: #800000">'</span><span style="color: #800000">app1/index.html</span><span style="color: #800000">'</span>,<span style="background-color: #ff99cc">{<span style="color: #800000">'</span><span style="color: #800000">cuow</span><span style="color: #800000">'</span>:f.errors}</span>)  <span style="color: #008000">#</span><span style="color: #008000"> 打开页面，将错误信息用字典方式传到html页面</span></pre>
</div>
<p><strong>3、在html页面接收逻辑处理<span style="color: #0000ff">以字典形式</span>传过来的错误对象，分别获取不同表单的错误信息</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">&lt;!</span><span style="color: #ff00ff">DOCTYPE html</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">html </span><span style="color: #ff0000">lang</span><span style="color: #0000ff">="en"</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">head</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">meta </span><span style="color: #ff0000">charset</span><span style="color: #0000ff">="UTF-8"</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">title</span><span style="color: #0000ff">&gt;</span>Title<span style="color: #0000ff">&lt;/</span><span style="color: #800000">title</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">link </span><span style="color: #ff0000">rel</span><span style="color: #0000ff">="stylesheet"</span><span style="color: #ff0000"> type</span><span style="color: #0000ff">="text/css"</span><span style="color: #ff0000"> href</span><span style="color: #0000ff">="/static/css/tou.css"</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">head</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">body</span><span style="color: #0000ff">&gt;</span>

<span style="color: #0000ff">&lt;</span><span style="color: #800000">form </span><span style="color: #ff0000">action</span><span style="color: #0000ff">="/bugarticles/"</span><span style="color: #ff0000"> method</span><span style="color: #0000ff">="post"</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="text"</span><span style="color: #ff0000"> name</span><span style="color: #0000ff">="user"</span><span style="color: #0000ff">/&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span><span style="background-color: #ff99cc">{{ cuow.user.0 }}</span><span style="color: #0000ff">&lt;/</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span>     <span style="color: #008000">&lt;!--</span><span style="color: #008000"> 接收错误信息里的user的错误信息 </span><span style="color: #008000">--&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="text"</span><span style="color: #ff0000"> name</span><span style="color: #0000ff">="pwd"</span><span style="color: #0000ff">/&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span><span style="background-color: #ff99cc">{{ cuow.pwd.0 }}</span><span style="color: #0000ff">&lt;/</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span>      <span style="color: #008000">&lt;!--</span><span style="color: #008000"> 接收错误信息里的pwd的错误信息 </span><span style="color: #008000">--&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="submit"</span><span style="color: #ff0000"> value</span><span style="color: #0000ff">="提交"</span><span style="color: #0000ff">/&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">form</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">body</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">html</span><span style="color: #0000ff">&gt;</span></pre>
</div>
<p>&nbsp;<img src="https://images2015.cnblogs.com/blog/955761/201707/955761-20170716170032722-817776133.png" alt=""></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong>利用表单类自动创建表单标签</strong></span></p>
<p><span style="background-color: #ffffff"><strong>以上表单的&lt;input&gt;是我们自己手动写的，还可以用表单类来自动创建表单标签，好处是不用自己写表单标签，还有就是当用户填写的表单不合法提交时提示错误信息不清空表单</strong></span></p>
<p>&nbsp;</p>
<p><span style="background-color: #ffff00; color: #0000ff"><strong>注意：表单类根据字段创建的表单标签，当用户输入内容时，首先要经过浏览器默认行为的表单验证，如果浏览器<strong>默认行为的表单验证都没有通过那么将无法提交</strong></strong></span></p>
<p><span style="background-color: #ffff00; color: #0000ff"><strong><strong><strong>浏览器<strong>默认行为的表单验证，通过了在进行我们定义的表单类验证，验证合法获取用户提交信息，不合法返回错误信息</strong></strong></strong></strong></span></p>
<p><span style="background-color: #ffffff; color: #0000ff"><strong><strong><strong><strong>利用表单类自动创建表单标签</strong></strong></strong></strong></span></p>
<p><span style="background-color: #ffffff"><strong><strong><strong><strong>1、首先在get访问页面时，创建表单类不传参数，然后把这个表单类传到html页面，在html页面通过，<span style="color: #ff0000">表单类.字段名称</span>，来自动创建表单标签</strong></strong></strong></strong></span></p>
<p><span style="background-color: #ffffff"><strong><strong><strong><strong>　　每一种表单字段类型，都有一个默认的表单标签，这个标签是可以更改的，所以表单类可以创建任何表单标签</strong></strong></strong></strong></span></p>
<p><span style="background-color: #ffffff"><strong><strong><strong><strong>2、在post访问时，再次创建表单类需要传参，将post请求对象传入表单类进行验证表单，如果表单不合法，将错误信息对象传到html显示错误信息，将这次创建的表单类传到html页面替换get时创建的表单类</strong></strong></strong></strong></span></p>
<p><span style="color: #0000ff; background-color: #ffffff"><strong>逻辑处理</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">from</span> django.shortcuts <span style="color: #0000ff">import</span><span style="color: #000000"> render
</span><span style="color: #0000ff">from</span> app1.models <span style="color: #0000ff">import</span> *    <span style="color: #008000">#</span><span style="color: #008000">导入数据库操作模块</span>
<span style="color: #0000ff">from</span> app1.biaodan <span style="color: #0000ff">import</span> *   <span style="color: #008000">#</span><span style="color: #008000">导入自定义表单验证模块</span><span style="color: #008000">
#</span><span style="color: #008000">逻辑处理模块</span>
<span style="color: #0000ff">def</span><span style="color: #000000"> special(request):
    </span><span style="color: #0000ff">if</span> request.method == <span style="color: #800000">'</span><span style="color: #800000; background-color: #ffff00">GET</span><span style="color: #800000">'</span><span style="color: #000000">:
        <span style="background-color: #ffff00">f </span></span><span style="background-color: #ffff00">= yhbd()</span>                                            <span style="color: #008000">#</span><span style="color: #008000">创建表单验证类，不传参</span>
        <span style="color: #0000ff">return</span> render(request, <span style="color: #800000">'</span><span style="color: #800000">app1/index.html</span><span style="color: #800000">'</span>,{<span style="background-color: #ffff00"><span style="color: #800000">'</span><span style="color: #800000">form</span><span style="color: #800000">'</span>:f</span>})  <span style="color: #008000">#</span><span style="color: #008000"> 打开页面，并将表单验证类传到html生成表单标签</span>

    <span style="color: #0000ff">if</span> request.method == <span style="color: #800000">"</span><span style="color: #800000; background-color: #ff99cc">POST</span><span style="color: #800000">"</span><span style="color: #000000">:
        <span style="background-color: #ff99cc">f </span></span><span style="background-color: #ff99cc">= yhbd(request.POST)</span>                          <span style="color: #008000">#</span><span style="color: #008000">创建验证表单类，将用户请求POST对象传进表单验证类进行验证</span>

        <span style="background-color: #ff99cc"><span style="color: #0000ff">if</span> f.is_valid():</span>                                <span style="color: #008000">#</span><span style="color: #008000">判断验证如果通过</span>
            <span style="background-color: #ff99cc"><span style="color: #0000ff">print</span>(f.cleaned_data)</span>                       <span style="color: #008000">#</span><span style="color: #008000">获取到用户提交信息,字典方式</span>
        <span style="color: #0000ff">else</span>:                                           <span style="color: #008000">#</span><span style="color: #008000">如果没通过</span>
            <span style="color: #008000">#</span><span style="color: #008000"><span style="background-color: #ff99cc"> print(f.errors)</span>                           #获取错误对象</span>
            <span style="color: #0000ff">pass</span>

        <span style="color: #0000ff">return</span> render(request, <span style="color: #800000">'</span><span style="color: #800000">app1/index.html</span><span style="color: #800000">'</span>,{<span style="background-color: #ff99cc"><span style="color: #800000">'</span><span style="color: #800000">cuow</span><span style="color: #800000">'</span>:f.errors</span>,<span style="background-color: #ff99cc"><span style="color: #800000">'</span><span style="color: #800000">form</span><span style="color: #800000">'</span>:f</span>})  <span style="color: #008000">#</span><span style="color: #008000"> 打开页面，将错误信息用字典方式传到html页面，并且将表单类传到html页面替换没传参的表单验证类</span></pre>
</div>
<p><span style="color: #0000ff"><strong>html</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">&lt;!</span><span style="color: #ff00ff">DOCTYPE html</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">html </span><span style="color: #ff0000">lang</span><span style="color: #0000ff">="en"</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">head</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">meta </span><span style="color: #ff0000">charset</span><span style="color: #0000ff">="UTF-8"</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">title</span><span style="color: #0000ff">&gt;</span>Title<span style="color: #0000ff">&lt;/</span><span style="color: #800000">title</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">link </span><span style="color: #ff0000">rel</span><span style="color: #0000ff">="stylesheet"</span><span style="color: #ff0000"> type</span><span style="color: #0000ff">="text/css"</span><span style="color: #ff0000"> href</span><span style="color: #0000ff">="/static/css/tou.css"</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">head</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">body</span><span style="color: #0000ff">&gt;</span>

<span style="color: #0000ff">&lt;</span><span style="color: #800000">form </span><span style="color: #ff0000">action</span><span style="color: #0000ff">="/bugarticles/"</span><span style="color: #ff0000"> method</span><span style="color: #0000ff">="post"</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span><span style="color: #000000; background-color: #ffff00">
        {{ form.user }}                                     </span><span style="color: #008000">&lt;!--</span><span style="color: #008000"> 接收get请求时创建的表单类，生成表单标签 </span><span style="color: #008000">--&gt;</span><span style="background-color: #ff99cc"><span style="color: #000000">
        {% if cuow.user.0 %}
            </span><span style="color: #0000ff">&lt;</span><span style="color: #800000">span </span><span style="color: #ff0000">class</span><span style="color: #0000ff">="cuow"</span><span style="color: #0000ff">&gt;</span>{{ cuow.user.0 }}<span style="color: #0000ff">&lt;/</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span>     <span style="color: #008000">&lt;!--</span><span style="color: #008000"> 接收错误信息里的user的错误信息 </span><span style="color: #008000">--&gt;</span><span style="color: #000000">
        {% endif %}
    </span></span><span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span><span style="color: #000000; background-color: #ffff00">
        {{ form.pwd }}                                      </span><span style="color: #008000">&lt;!--</span><span style="color: #008000"> 接收get请求时创建的表单类，生成表单标签 </span><span style="color: #008000">--&gt;</span><span style="background-color: #ff99cc"><span style="color: #000000">
        {% if cuow.pwd.0 %}
            </span><span style="color: #0000ff">&lt;</span><span style="color: #800000">span </span><span style="color: #ff0000">class</span><span style="color: #0000ff">="cuow"</span><span style="color: #0000ff">&gt;</span>{{ cuow.pwd.0 }}<span style="color: #0000ff">&lt;/</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span>      <span style="color: #008000">&lt;!--</span><span style="color: #008000"> 接收错误信息里的pwd的错误信息 </span><span style="color: #008000">--&gt;</span><span style="color: #000000">
        {% endif %}
    </span></span><span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="submit"</span><span style="color: #ff0000"> value</span><span style="color: #0000ff">="提交"</span><span style="color: #0000ff">/&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">form</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">body</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">html</span><span style="color: #0000ff">&gt;</span></pre>
</div>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong>常用的内置验证字段</strong></span></p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">EmailField()</span>验证邮箱字段</strong></span><br><span style="color: #ff0000"><strong><span style="color: #0000ff">CharField()</span>验证字符串字段</strong></span><br><span style="color: #ff0000"><strong><span style="color: #0000ff">URLField()</span>验证url地址字段</strong></span><br><span style="color: #ff0000"><strong><span style="color: #0000ff">IntegerField()</span>验证数字字段</strong></span><br><span style="color: #ff0000"><strong><span style="color: #0000ff">GenericIPAddressField()</span>验证IP字段</strong></span></p>
<p><span style="color: #0000ff"><strong>注意：虽然有很多内置验证字段，但是我们还是要根据我们自己的需求来验证，所以</strong></span></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong>验证字段的参数</strong></span></p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">required</span>设置字段是否可以为空</strong></span><br><strong>	　　True不可以为空</strong><br><strong>	　　False可以为空</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user = forms.CharField(<span style="background-color: #ff99cc">required=True</span>)   <span style="color: #008000">#</span><span style="color: #008000">True不可以为空</span>
    pwd = forms.CharField()</pre>
</div>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">max_length</span>最大字符数</strong></span><br><span style="color: #ff0000"><strong><span style="color: #0000ff">min_length</span>最小字符数</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user = forms.CharField(<span style="background-color: #ff99cc">max_length=4</span>,<span style="background-color: #ff99cc">min_length=2</span><span style="color: #000000">)
    pwd </span>= forms.CharField()</pre>
</div>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">error_messages</span>自定义错误提示信息</strong></span><br><strong>　　参数是一个字典{'验证名称':'错误提示'}</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        <span style="background-color: #ffff00">required</span></span>=<span style="color: #000000">True,
        <span style="background-color: #ffff00">max_length</span></span>=4<span style="color: #000000">,
        <span style="background-color: #ffff00">min_length</span></span>=2<span style="color: #000000">,
<span style="background-color: #ff99cc">        error_messages</span></span><span style="background-color: #ff99cc">=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000; background-color: #ffff00">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000; background-color: #ffff00">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000; background-color: #ffff00">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span></span><span style="color: #000000"><span style="background-color: #ff99cc">
        }</span>
    )
    pwd </span>= forms.CharField()</pre>
</div>
<p><strong><span style="color: #0000ff">invalid</span>设置邮箱格式错误提示信息</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        required</span>=<span style="color: #000000">True,
        max_length</span>=4<span style="color: #000000">,
        min_length</span>=2<span style="color: #000000">,
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span><span style="color: #000000">
        }
    )
    pwd </span>=<span style="color: #000000"> forms.<span style="background-color: #ff99cc">EmailField</span>(
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>: <span style="color: #800000">'</span><span style="color: #800000">邮箱不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="background-color: #ff99cc"><span style="color: #800000">'</span><span style="color: #800000">invalid</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">邮箱格式不正确</span><span style="color: #800000">'</span></span><span style="color: #000000">
        }
    )</span></pre>
</div>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">widget</span>设置表单字段在html页面的类型</strong></span><br><strong>	　　使用方式：widget=forms.Textarea()</strong><br><strong>	　　Textarea(): &lt;textarea&gt;标签类型</strong><br><strong>	　　TextInput()：&lt;input&gt;标签类型</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        required</span>=<span style="color: #000000">True,
        max_length</span>=4<span style="color: #000000">,
        min_length</span>=2<span style="color: #000000">,
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span><span style="color: #000000">
        }
    )
    pwd </span>=<span style="color: #000000"> forms.CharField(
        <span style="background-color: #ff99cc">widget</span></span>=<span style="color: #000000">forms.<span style="background-color: #ff99cc">TextInput()</span>,
    )</span></pre>
</div>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">attrs</span>给表单标签设置属性，可以给标签元素设置class样式，和input标签的各种type属性</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        required</span>=<span style="color: #000000">True,
        max_length</span>=4<span style="color: #000000">,
        min_length</span>=2<span style="color: #000000">,
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span><span style="color: #000000">
        }
    )
    pwd </span>=<span style="color: #000000"> forms.CharField(
        widget</span>=forms.TextInput(<span style="background-color: #ff99cc">attrs={<span style="background-color: #ffff00"><span style="color: #800000">'</span><span style="color: #800000">type</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">password</span><span style="color: #800000">'</span></span>,<span style="background-color: #ffff00"><span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">c1</span><span style="color: #800000">'</span></span></span><span style="color: #000000"><span style="background-color: #ff99cc">}</span>),
    )</span></pre>
</div>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">Select</span>生成表单，select标签，下拉选项框</strong></span><br><strong>	　　参数:</strong><br><strong>		　　　　<span style="color: #0000ff">choices</span>设置下拉数据，元组类型</strong><br><strong>		　　　　<span style="color: #0000ff">attrs</span>设置select标签属性</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        required</span>=<span style="color: #000000">True,
        max_length</span>=4<span style="color: #000000">,
        min_length</span>=2<span style="color: #000000">,
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span><span style="color: #000000">
        }
    )

<span style="background-color: #ffff00">    zhi </span></span><span style="background-color: #ffff00">=<span style="color: #000000"> (
        (0, </span><span style="color: #800000">'</span><span style="color: #800000">普通会员</span><span style="color: #800000">'</span><span style="color: #000000">),
        (</span>1, <span style="color: #800000">'</span><span style="color: #800000">超级会员</span><span style="color: #800000">'</span><span style="color: #000000">),
        (</span>2, <span style="color: #800000">'</span><span style="color: #800000">黄金会员</span><span style="color: #800000">'</span><span style="color: #000000">),
        (</span>3, <span style="color: #800000">'</span><span style="color: #800000">白银会员</span><span style="color: #800000">'</span><span style="color: #000000">),
        (</span>4, <span style="color: #800000">'</span><span style="color: #800000">vip会员</span><span style="color: #800000">'</span></span><span style="color: #000000"><span style="background-color: #ffff00">)
    )</span>
    pwd </span>=<span style="color: #000000"> forms.CharField(
        widget</span>=forms.<span style="background-color: #ff99cc">widgets.Select(<span style="background-color: #ffff00">choices=zhi</span>,attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">c1</span><span style="color: #800000">'</span></span><span style="color: #000000"><span style="background-color: #ff99cc">})</span>
    )</span></pre>
</div>
<p><img src="https://images2015.cnblogs.com/blog/955761/201707/955761-20170717194742910-289353552.png" alt=""></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>下拉框结合数据库应用</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>
<span style="background-color: #ffff00"><span style="color: #0000ff">from</span> app1.models <span style="color: #0000ff">import</span> *</span>       <span style="color: #008000">#</span><span style="color: #008000">导入数据库操作</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        required</span>=<span style="color: #000000">True,
        max_length</span>=4<span style="color: #000000">,
        min_length</span>=2<span style="color: #000000">,
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span><span style="color: #000000">
        }
    )

    <span style="background-color: #ffff00">a </span></span><span style="background-color: #ffff00">= shengf.objects.all().values_list(<span style="color: #800000">'</span><span style="color: #800000">id</span><span style="color: #800000">'</span>,<span style="color: #800000">'</span><span style="color: #800000">shf</span><span style="color: #800000">'</span>) <span style="color: #008000">#</span><span style="color: #008000">获取数据库里shengf表里的id和shf字段的数据</span></span>
    pwd =<span style="color: #000000"> forms.CharField(
        widget</span>=forms.widgets.<span style="background-color: #ff99cc">Select(<span style="background-color: #ffff00">choices=a</span>,attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">c1</span><span style="color: #800000">'</span>})</span> <span style="color: #008000">#</span><span style="color: #008000">将数据库的数据显示到下拉框</span>
    )</pre>
</div>
<p>&nbsp;<img src="https://images2015.cnblogs.com/blog/955761/201707/955761-20170717194742910-289353552.png" alt=""></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>下拉框结合数据库应用，防止数据库添加了数据，或者删除了数据，页面缓存了下拉框数据，无法事实数据同步</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>
<span style="color: #0000ff">from</span> app1.models <span style="color: #0000ff">import</span> *       <span style="color: #008000">#</span><span style="color: #008000">导入数据库操作</span>

<span style="color: #0000ff">class</span> <span style="background-color: #ff99cc">yhbd</span>(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        required</span>=<span style="color: #000000">True,
        max_length</span>=4<span style="color: #000000">,
        min_length</span>=2<span style="color: #000000">,
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span><span style="color: #000000">
        }
    )

    a </span>= shengf.objects.all().values_list(<span style="color: #800000">'</span><span style="color: #800000">id</span><span style="color: #800000">'</span>,<span style="color: #800000">'</span><span style="color: #800000">shf</span><span style="color: #800000">'</span>) <span style="color: #008000">#</span><span style="color: #008000">获取数据库里shengf表里的id和shf字段的数据</span>
    <span style="background-color: #ff99cc">pwd</span> =<span style="color: #000000"> forms.CharField(
        widget</span>=forms.widgets.Select(choices=a,attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">c1</span><span style="color: #800000">'</span>}) <span style="color: #008000">#</span><span style="color: #008000">将数据库的数据显示到下拉框</span>
<span style="color: #000000">    )

    </span><span style="color: #008000">#</span><span style="color: #008000">防止数据库添加了数据，或者删除了数据，页面缓存了下拉框数据，无法事实数据同步</span>
    <span style="color: #0000ff">def</span> <span style="color: #800080">__init__</span>(self,*args, **kwargs):                                     <span style="color: #008000">#</span><span style="color: #008000">创建类的__init__方法，每次创建类时都会执行</span>
        super(<span style="background-color: #ff99cc">yhbd</span>,self).<span style="color: #800080">__init__</span>(*args, **kwargs)                          <span style="color: #008000">#</span><span style="color: #008000">获取当前类的父类里的__init__方法执行</span>
        a = shengf.objects.all().values_list(<span style="color: #800000">'</span><span style="color: #800000">id</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">shf</span><span style="color: #800000">'</span>)                   <span style="color: #008000">#</span><span style="color: #008000">重新获取数据库里shengf表里的id和shf字段的数据</span>
        self.fields[<span style="background-color: #ff99cc"><span style="color: #800000">'</span><span style="color: #800000">pwd</span><span style="color: #800000">'</span></span>] = forms.CharField(widget=forms.widgets.Select(choices=a,attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">c1</span><span style="color: #800000">'</span>}))  <span style="color: #008000">#</span><span style="color: #008000">更新一下表单pwd字段的数据</span></pre>
</div>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>自定义验证规则</strong></span></p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">validators</span>设置自定义验证规则，参数是一个列表，列表里是自定义验证方法名称</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>
<span style="color: #0000ff">from</span> django.core.exceptions <span style="color: #0000ff">import</span><span style="color: #000000"> ValidationError
</span><span style="color: #0000ff">import</span><span style="color: #000000"> re

</span><span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        required</span>=<span style="color: #000000">True,
        max_length</span>=4<span style="color: #000000">,
        min_length</span>=2<span style="color: #000000">,
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span><span style="color: #000000">
        }
    )


    </span><span style="color: #008000">#</span><span style="color: #008000">自定义验证规则</span>
<span style="background-color: #ffff00">    <span style="color: #0000ff">def</span><span style="color: #000000"> shouji(value):
        mobile_re </span>= re.compile(r<span style="color: #800000">'</span><span style="color: #800000">^(13[0-9]|15[012356789]|17[678]|18[0-9]|14[57])[0-9]{8}$</span><span style="color: #800000">'</span><span style="color: #000000">)
        </span><span style="color: #0000ff">if</span> <span style="color: #0000ff">not</span><span style="color: #000000"> mobile_re.match(value):
            </span><span style="color: #0000ff">raise</span> ValidationError(<span style="color: #800000">'</span><span style="color: #800000">手机号码格式错误</span><span style="color: #800000">'</span>)   <span style="color: #008000">#</span><span style="color: #008000">如果不匹配返回错误信息</span></span>
<span style="color: #000000">

    pwd </span>=<span style="color: #000000"> forms.CharField(
        <span style="background-color: #ffff00">validators</span></span><span style="background-color: #ffff00">=[shouji, ],   <span style="color: #008000">#</span><span style="color: #008000">设置自定义验证规则</span></span>
        required=<span style="color: #000000">True,
        widget</span>=<span style="color: #000000">forms.TextInput(
            attrs</span>=<span style="color: #000000">{
                </span><span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>: <span style="color: #800000">"</span><span style="color: #800000">cl</span><span style="color: #800000">"</span><span style="color: #000000">,
                </span><span style="color: #800000">'</span><span style="color: #800000">placeholder</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">手机号码</span><span style="color: #800000">'</span><span style="color: #000000">
            }
        ),
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">手机不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
        }
    )</span></pre>
</div>
<p><img src="https://images2015.cnblogs.com/blog/955761/201707/955761-20170717232723411-1592842803.png" alt=""></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>其他</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span>
<span style="color: #0000ff">import</span><span style="color: #000000"> re
</span><span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span><span style="color: #000000"> forms
</span><span style="color: #0000ff">from</span> django.core.exceptions <span style="color: #0000ff">import</span><span style="color: #000000"> ValidationError


</span><span style="color: #0000ff">def</span><span style="color: #000000"> mobile_validate(value):
    mobile_re </span>= re.compile(r<span style="color: #800000">'</span><span style="color: #800000">^(13[0-9]|15[012356789]|17[678]|18[0-9]|14[57])[0-9]{8}$</span><span style="color: #800000">'</span><span style="color: #000000">)
    </span><span style="color: #0000ff">if</span> <span style="color: #0000ff">not</span><span style="color: #000000"> mobile_re.match(value):
        </span><span style="color: #0000ff">raise</span> ValidationError(<span style="color: #800000">'</span><span style="color: #800000">手机号码格式错误</span><span style="color: #800000">'</span><span style="color: #000000">)


</span><span style="color: #0000ff">class</span><span style="color: #000000"> PublishForm(forms.Form):

    user_type_choice </span>=<span style="color: #000000"> (
        (0, u</span><span style="color: #800000">'</span><span style="color: #800000">普通用户</span><span style="color: #800000">'</span><span style="color: #000000">),
        (</span>1, u<span style="color: #800000">'</span><span style="color: #800000">高级用户</span><span style="color: #800000">'</span><span style="color: #000000">),
    )

    user_type </span>= forms.IntegerField(widget=forms.widgets.Select(choices=<span style="color: #000000">user_type_choice,
                                                                  attrs</span>={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>: <span style="color: #800000">"</span><span style="color: #800000">form-control</span><span style="color: #800000">"</span><span style="color: #000000">}))

    title </span>= forms.CharField(max_length=20<span style="color: #000000">,
                            min_length</span>=5<span style="color: #000000">,
                            error_messages</span>={<span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">标题不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
                                            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">标题最少为5个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
                                            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">标题最多为20个字符</span><span style="color: #800000">'</span><span style="color: #000000">},
                            widget</span>=forms.TextInput(attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>: <span style="color: #800000">"</span><span style="color: #800000">form-control</span><span style="color: #800000">"</span><span style="color: #000000">,
                                                          </span><span style="color: #800000">'</span><span style="color: #800000">placeholder</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">标题5-20个字符</span><span style="color: #800000">'</span><span style="color: #000000">}))

    memo </span>= forms.CharField(required=<span style="color: #000000">False,
                           max_length</span>=256<span style="color: #000000">,
                           widget</span>=forms.widgets.Textarea(attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>: <span style="color: #800000">"</span><span style="color: #800000">form-control no-radius</span><span style="color: #800000">"</span>, <span style="color: #800000">'</span><span style="color: #800000">placeholder</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">详细描述</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">rows</span><span style="color: #800000">'</span>: 3<span style="color: #000000">}))

    phone </span>= forms.CharField(validators=<span style="color: #000000">[mobile_validate, ],
                            error_messages</span>={<span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">手机不能为空</span><span style="color: #800000">'</span><span style="color: #000000">},
                            widget</span>=forms.TextInput(attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>: <span style="color: #800000">"</span><span style="color: #800000">form-control</span><span style="color: #800000">"</span><span style="color: #000000">,
                                                          </span><span style="color: #800000">'</span><span style="color: #800000">placeholder</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">手机号码</span><span style="color: #800000">'</span><span style="color: #000000">}))

    email </span>= forms.EmailField(required=<span style="color: #000000">False,
                            error_messages</span>={<span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">邮箱不能为空</span><span style="color: #800000">'</span>,<span style="color: #800000">'</span><span style="color: #800000">invalid</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">邮箱格式错误</span><span style="color: #800000">'</span><span style="color: #000000">},
                            widget</span>=forms.TextInput(attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>: <span style="color: #800000">"</span><span style="color: #800000">form-control</span><span style="color: #800000">"</span>, <span style="color: #800000">'</span><span style="color: #800000">placeholder</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">邮箱</span><span style="color: #800000">'</span>}))</pre>
</div>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>注意：如果表单是通过Ajax提交的，页面不刷新，那么html页面将无法获取到错误信息，那么我们只能将所有错误信息构造成字典，然后以json的方式返回给Ajax，添加到页面</strong></span></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>将models数据库表类转换成表单验证类【必要使用】</strong></span></p>
<p><span style="color: #000000"><strong>这样可以少写表单验证代码，使用的是数据库字段的验证规则</strong></span></p>
<p><span style="color: #ff0000"><strong>models.py</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">from</span> django.db <span style="color: #0000ff">import</span> models        <span style="color: #008000">#</span><span style="color: #008000"> 导入models对象</span>

<span style="color: #0000ff">class</span><span style="color: #000000"><span style="background-color: #ff99cc"> CourseOrg</span>(models.Model):
    <span style="background-color: #ff99cc">name </span></span><span style="background-color: #ff99cc">= models.CharField(max_length=50, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">机构名称</span><span style="color: #800000">'</span></span><span style="color: #000000"><span style="background-color: #ff99cc">)</span>
    desc </span>= models.TextField(verbose_name=<span style="color: #800000">'</span><span style="color: #800000">机构描述</span><span style="color: #800000">'</span><span style="color: #000000">)
    <span style="background-color: #ff99cc">category </span></span><span style="background-color: #ff99cc">= models.CharField(max_length=20, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">机构类别</span><span style="color: #800000">'</span>, default=<span style="color: #800000">'</span><span style="color: #800000">pxjg</span><span style="color: #800000">'</span>, choices=((<span style="color: #800000">'</span><span style="color: #800000">pxjg</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">培训机构</span><span style="color: #800000">'</span>), (<span style="color: #800000">'</span><span style="color: #800000">gx</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">高校</span><span style="color: #800000">'</span>), (<span style="color: #800000">'</span><span style="color: #800000">gr</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">个人</span><span style="color: #800000">'</span></span><span style="color: #000000"><span style="background-color: #ff99cc">)))</span>
    click </span>= models.IntegerField(default=0, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">点击数</span><span style="color: #800000">'</span><span style="color: #000000">)
    <span style="background-color: #ff99cc">fav_nums </span></span><span style="background-color: #ff99cc">= models.IntegerField(default=0, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">收藏数</span><span style="color: #800000">'</span></span><span style="color: #000000"><span style="background-color: #ff99cc">)</span>
    image </span>= models.ImageField(upload_to=<span style="color: #800000">'</span><span style="color: #800000">org/%Y/%m</span><span style="color: #800000">'</span>, storage=ImageStorage(), verbose_name=<span style="color: #800000">'</span><span style="color: #800000">封面图</span><span style="color: #800000">'</span>, max_length=100<span style="color: #000000">)
    address </span>= models.CharField(max_length=150, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">机构地址</span><span style="color: #800000">'</span><span style="color: #000000">)
    city </span>= models.ForeignKey(CityDict, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">外键城市表</span><span style="color: #800000">'</span><span style="color: #000000">)
    add_time </span>= models.DateTimeField(default=datetime.now, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">添加日期</span><span style="color: #800000">'</span><span style="color: #000000">)

    </span><span style="color: #0000ff">class</span><span style="color: #000000"> Meta:
        verbose_name </span>= <span style="color: #800000">'</span><span style="color: #800000">课程机构表</span><span style="color: #800000">'</span><span style="color: #000000">
        verbose_name_plural </span>=<span style="color: #000000"> verbose_name

    </span><span style="color: #0000ff">def</span> <span style="color: #800080">__str__</span><span style="color: #000000">(self):
        </span><span style="color: #0000ff">return</span> self.name</pre>
</div>
<p><span style="color: #ff0000"><strong>forms.py</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf8 -*-</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> <span style="background-color: #ff99cc">forms</span>                             <span style="color: #008000">#</span><span style="color: #008000"> 导入Django的表单验证模块</span>
<span style="color: #0000ff">from</span> app_organization.models <span style="color: #0000ff">import</span> <span style="background-color: #ff99cc"><strong>CourseOrg</strong></span>        <span style="color: #008000">#</span><span style="color: #008000"> 导入数据库表类</span>


<span style="color: #0000ff">class</span><span style="color: #000000"> CourseOrgForm(<span style="background-color: #ff99cc">forms.ModelForm</span>):
    zdyi </span>= forms.CharField()                         <span style="color: #008000">#</span><span style="color: #008000"> 自定义表单验证字段</span>

    <span style="color: #0000ff">class</span><span style="color: #000000"> Meta:
        model </span>= <span style="background-color: #ff99cc">CourseOrg</span>                            <span style="color: #008000">#</span><span style="color: #008000"> 设置要将数据库表类转换成表单验证类的名称</span>
        fields = [<span style="color: #800000">'</span><span style="color: #800000">name</span><span style="color: #800000">'</span>,<span style="color: #800000">'</span><span style="color: #800000">category</span><span style="color: #800000">'</span>,<span style="color: #800000">'</span><span style="color: #800000">fav_nums</span><span style="color: #800000">'</span>]      <span style="color: #008000">#</span><span style="color: #008000"> 要使用的字段</span></pre>
</div>
<p>&nbsp;</p></div>第三百一十一节，Django框架，Form表单验证


			<div id="cnblogs_post_body" class="blogpost-body"><p><strong>第三百一十一节，Django框架，Form表单验证</strong></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong>表单提交</strong></span></p>
<p><span style="color: #0000ff"><strong>html</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">&lt;!</span><span style="color: #ff00ff">DOCTYPE html</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">html </span><span style="color: #ff0000">lang</span><span style="color: #0000ff">="en"</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">head</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">meta </span><span style="color: #ff0000">charset</span><span style="color: #0000ff">="UTF-8"</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">title</span><span style="color: #0000ff">&gt;</span>Title<span style="color: #0000ff">&lt;/</span><span style="color: #800000">title</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">link </span><span style="color: #ff0000">rel</span><span style="color: #0000ff">="stylesheet"</span><span style="color: #ff0000"> type</span><span style="color: #0000ff">="text/css"</span><span style="color: #ff0000"> href</span><span style="color: #0000ff">="/static/css/tou.css"</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">head</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">body</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">form </span><span style="color: #ff0000">action</span><span style="color: #0000ff">="<span style="background-color: #ff99cc">/bug<span style="background-color: #ffff00">articles</span>/</span>"</span><span style="color: #ff0000"> method</span><span style="color: #0000ff">="post"</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="text"</span><span style="color: #ff0000"> name</span><span style="color: #0000ff">="user"</span><span style="color: #0000ff">/&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="text"</span><span style="color: #ff0000"> name</span><span style="color: #0000ff">="pwd"</span><span style="color: #0000ff">/&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="submit"</span><span style="color: #ff0000"> value</span><span style="color: #0000ff">="提交"</span><span style="color: #0000ff">/&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">form</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">body</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">html</span><span style="color: #0000ff">&gt;</span></pre>
</div>
<p><span style="color: #0000ff"><strong>路由映射</strong></span></p>
<div class="cnblogs_code">
<pre>urlpatterns =<span style="color: #000000"> [
    url(r</span><span style="color: #800000">'</span><span style="color: #800000">admin/</span><span style="color: #800000">'</span>, admin.site.urls),   <span style="color: #008000">#</span><span style="color: #008000">路由映射admin数据库管理</span>
    url(r<span style="color: #800000">'</span><span style="color: #800000"><span style="background-color: #ffff00">articles</span>/</span><span style="color: #800000">'</span><span style="color: #000000">, <span style="background-color: #ffff00">views.special</span>)    
]</span></pre>
</div>
<p><span style="color: #0000ff"><strong>逻辑处理</strong></span></p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">method</span>属性获取用户请求方式，post或者get</strong></span><br><strong>使用方式：请求对象.method</strong></p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">POST</span>获取用户post请求方式的信息</strong></span><br><strong>使用方式：请求对象.POST</strong></p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">POST.get()</span>获取用户POST请求方式的表单name名称对应的值，参数是表单name名</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">from</span> django.shortcuts <span style="color: #0000ff">import</span><span style="color: #000000"> render
</span><span style="color: #0000ff">from</span> app1.models <span style="color: #0000ff">import</span> *    <span style="color: #008000">#</span><span style="color: #008000">导入数据库操作模块</span>

<span style="color: #008000">#</span><span style="color: #008000">逻辑处理模块</span>
<span style="color: #0000ff">def</span><span style="color: #000000"><span style="background-color: #ffff00"> special</span>(request):  　　　　　　　　　　　　　 <span style="color: #008080">#自定义参数接收用户请求对象
    </span></span><span style="color: #0000ff">if</span> request.method == <span style="color: #800000">"</span><span style="color: #800000">POST</span><span style="color: #800000">"</span><span style="color: #000000">:　　　　　　　　 <span style="color: #008080">#判断用户请求如果是post方式
        </span></span><span style="color: #0000ff">print</span>(request.POST.get(<span style="color: #800000">'</span><span style="color: #800000">user</span><span style="color: #800000">'</span>,None))  <span style="color: #008000">#</span><span style="color: #008000">接收用户表单提交的name名称对应的值</span>
        <span style="color: #0000ff">print</span>(request.POST.get(<span style="color: #800000">'</span><span style="color: #800000">pwd</span><span style="color: #800000">'</span>, None))  <span style="color: #008000">#</span><span style="color: #008000">接收用户表单提交的name名称对应的值</span>
    <span style="color: #0000ff">return</span> render(request, <span style="color: #800000">'</span><span style="color: #800000">app1/index.html</span><span style="color: #800000">'</span>, locals())  <span style="color: #008000">#</span><span style="color: #008000"> 打开页面</span></pre>
</div>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong>表单提交验证，获取数据与获取错误信息</strong></span></p>
<p><span style="color: #000000"><strong>1、创建表单验证模块，必须继承</strong><span style="color: #0000ff"><strong>Django的表单验证forms.Form类</strong></span></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> <span style="background-color: #ff99cc">django <span style="color: #0000ff">import</span> forms</span>        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(<span style="background-color: #ff99cc">forms.Form</span>):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    <span style="background-color: #ff99cc">user</span> = forms.CharField()    <span style="color: #008000">#</span><span style="color: #008000">接收逻辑处理时，创建yhbd类时传进来的POST对象，里的表单name名对应的值进行验证</span>
    <span style="background-color: #ff99cc">pwd</span> = forms.CharField()     <span style="color: #008000">#</span><span style="color: #008000">#接收逻辑处理时，创建yhbd类时传进来的POST对象，里的表单name名对应的值进行验证</span></pre>
</div>
<p><strong>2、逻辑处理，创建表单验证模块里的验证类，并将用户请求的<span style="color: #0000ff">POST对象</span>，传入验证类进行验证，验证后获取验证通过的提交信息，或者验证没通过的错误信息</strong></p>
<p><span style="color: #0000ff"><strong>如果出现错误，将错误信息对象以字典方式传到html页面</strong></span></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">is_valid()</span>返回验证是否通过的布尔值</strong></span><br><strong>使用方式：验证类.is_valid()</strong></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">cleaned_data</span>获取验证通过后的所有提交数据，返回字典</strong></span><br><strong>使用方式：验证类.cleaned_data</strong></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">errors</span>获取验证错误信息，返回所有表单的错误信息对象</strong></span><br><strong>使用方法：验证类.errors</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">from</span> django.shortcuts <span style="color: #0000ff">import</span><span style="color: #000000"> render
</span><span style="color: #0000ff">from</span> app1.models <span style="color: #0000ff">import</span> *    <span style="color: #008000">#</span><span style="color: #008000">导入数据库操作模块</span>
<span style="color: #0000ff">from</span> app1.biaodan <span style="color: #0000ff">import</span> *   <span style="color: #008000">#</span><span style="color: #008000">导入自定义表单验证模块</span><span style="color: #008000">
#</span><span style="color: #008000">逻辑处理模块</span>
<span style="color: #0000ff">def</span><span style="color: #000000"> special(request):
    </span><span style="color: #0000ff">if</span> request.method == <span style="color: #800000">'</span><span style="color: #800000">GET</span><span style="color: #800000">'</span><span style="color: #000000">:
        </span><span style="color: #0000ff">return</span> render(request, <span style="color: #800000">'</span><span style="color: #800000">app1/index.html</span><span style="color: #800000">'</span>, locals())  <span style="color: #008000">#</span><span style="color: #008000"> 打开页面</span>

    <span style="background-color: #ff99cc"><span style="color: #0000ff">if</span> request.method == <span style="color: #800000">"</span><span style="color: #800000">POST</span><span style="color: #800000">"</span><span style="color: #000000">:
        </span></span><span style="color: #008000">#</span><span style="color: #008000"> print(request.POST.get('user',None))          #接收用户表单提交的name名称对应的值</span>
        <span style="color: #008000">#</span><span style="color: #008000"> print(request.POST.get('pwd', None))          #接收用户表单提交的name名称对应的值</span>
<span style="background-color: #ff99cc"><span style="color: #000000">
        f </span>= yhbd(request.POST)</span>                          <span style="color: #008000">#</span><span style="color: #008000">创建验证表单类，将用户请求POST对象传进表单验证类进行验证</span>

        <span style="color: #008000">#</span><span style="color: #008000"> ret = f.is_valid()                            #返回验证是否通过</span>
        <span style="color: #008000">#</span><span style="color: #008000"> print(ret)                                    #返回布尔值</span>

       <span style="background-color: #ff99cc"> <span style="color: #0000ff">if</span> f.is_valid():</span>                                <span style="color: #008000">#</span><span style="color: #008000">判断验证如果通过</span>
            <span style="background-color: #ff99cc"><span style="color: #0000ff">print</span>(f.cleaned_data)</span>                       <span style="color: #008000">#</span><span style="color: #008000">获取到用户提交信息,字典方式</span>
        <span style="color: #0000ff">else</span>:                                           <span style="color: #008000">#</span><span style="color: #008000">如果没通过</span>
            <span style="background-color: #ff99cc"><span style="color: #0000ff">print</span>(f.errors)</span>                             <span style="color: #008000">#</span><span style="color: #008000">获取错误对象</span>

        <span style="color: #0000ff">return</span> render(request, <span style="color: #800000">'</span><span style="color: #800000">app1/index.html</span><span style="color: #800000">'</span>,<span style="background-color: #ff99cc">{<span style="color: #800000">'</span><span style="color: #800000">cuow</span><span style="color: #800000">'</span>:f.errors}</span>)  <span style="color: #008000">#</span><span style="color: #008000"> 打开页面，将错误信息用字典方式传到html页面</span></pre>
</div>
<p><strong>3、在html页面接收逻辑处理<span style="color: #0000ff">以字典形式</span>传过来的错误对象，分别获取不同表单的错误信息</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">&lt;!</span><span style="color: #ff00ff">DOCTYPE html</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">html </span><span style="color: #ff0000">lang</span><span style="color: #0000ff">="en"</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">head</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">meta </span><span style="color: #ff0000">charset</span><span style="color: #0000ff">="UTF-8"</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">title</span><span style="color: #0000ff">&gt;</span>Title<span style="color: #0000ff">&lt;/</span><span style="color: #800000">title</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">link </span><span style="color: #ff0000">rel</span><span style="color: #0000ff">="stylesheet"</span><span style="color: #ff0000"> type</span><span style="color: #0000ff">="text/css"</span><span style="color: #ff0000"> href</span><span style="color: #0000ff">="/static/css/tou.css"</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">head</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">body</span><span style="color: #0000ff">&gt;</span>

<span style="color: #0000ff">&lt;</span><span style="color: #800000">form </span><span style="color: #ff0000">action</span><span style="color: #0000ff">="/bugarticles/"</span><span style="color: #ff0000"> method</span><span style="color: #0000ff">="post"</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="text"</span><span style="color: #ff0000"> name</span><span style="color: #0000ff">="user"</span><span style="color: #0000ff">/&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span><span style="background-color: #ff99cc">{{ cuow.user.0 }}</span><span style="color: #0000ff">&lt;/</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span>     <span style="color: #008000">&lt;!--</span><span style="color: #008000"> 接收错误信息里的user的错误信息 </span><span style="color: #008000">--&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="text"</span><span style="color: #ff0000"> name</span><span style="color: #0000ff">="pwd"</span><span style="color: #0000ff">/&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span><span style="background-color: #ff99cc">{{ cuow.pwd.0 }}</span><span style="color: #0000ff">&lt;/</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span>      <span style="color: #008000">&lt;!--</span><span style="color: #008000"> 接收错误信息里的pwd的错误信息 </span><span style="color: #008000">--&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="submit"</span><span style="color: #ff0000"> value</span><span style="color: #0000ff">="提交"</span><span style="color: #0000ff">/&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">form</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">body</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">html</span><span style="color: #0000ff">&gt;</span></pre>
</div>
<p>&nbsp;<img src="https://images2015.cnblogs.com/blog/955761/201707/955761-20170716170032722-817776133.png" alt=""></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong>利用表单类自动创建表单标签</strong></span></p>
<p><span style="background-color: #ffffff"><strong>以上表单的&lt;input&gt;是我们自己手动写的，还可以用表单类来自动创建表单标签，好处是不用自己写表单标签，还有就是当用户填写的表单不合法提交时提示错误信息不清空表单</strong></span></p>
<p>&nbsp;</p>
<p><span style="background-color: #ffff00; color: #0000ff"><strong>注意：表单类根据字段创建的表单标签，当用户输入内容时，首先要经过浏览器默认行为的表单验证，如果浏览器<strong>默认行为的表单验证都没有通过那么将无法提交</strong></strong></span></p>
<p><span style="background-color: #ffff00; color: #0000ff"><strong><strong><strong>浏览器<strong>默认行为的表单验证，通过了在进行我们定义的表单类验证，验证合法获取用户提交信息，不合法返回错误信息</strong></strong></strong></strong></span></p>
<p><span style="background-color: #ffffff; color: #0000ff"><strong><strong><strong><strong>利用表单类自动创建表单标签</strong></strong></strong></strong></span></p>
<p><span style="background-color: #ffffff"><strong><strong><strong><strong>1、首先在get访问页面时，创建表单类不传参数，然后把这个表单类传到html页面，在html页面通过，<span style="color: #ff0000">表单类.字段名称</span>，来自动创建表单标签</strong></strong></strong></strong></span></p>
<p><span style="background-color: #ffffff"><strong><strong><strong><strong>　　每一种表单字段类型，都有一个默认的表单标签，这个标签是可以更改的，所以表单类可以创建任何表单标签</strong></strong></strong></strong></span></p>
<p><span style="background-color: #ffffff"><strong><strong><strong><strong>2、在post访问时，再次创建表单类需要传参，将post请求对象传入表单类进行验证表单，如果表单不合法，将错误信息对象传到html显示错误信息，将这次创建的表单类传到html页面替换get时创建的表单类</strong></strong></strong></strong></span></p>
<p><span style="color: #0000ff; background-color: #ffffff"><strong>逻辑处理</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">from</span> django.shortcuts <span style="color: #0000ff">import</span><span style="color: #000000"> render
</span><span style="color: #0000ff">from</span> app1.models <span style="color: #0000ff">import</span> *    <span style="color: #008000">#</span><span style="color: #008000">导入数据库操作模块</span>
<span style="color: #0000ff">from</span> app1.biaodan <span style="color: #0000ff">import</span> *   <span style="color: #008000">#</span><span style="color: #008000">导入自定义表单验证模块</span><span style="color: #008000">
#</span><span style="color: #008000">逻辑处理模块</span>
<span style="color: #0000ff">def</span><span style="color: #000000"> special(request):
    </span><span style="color: #0000ff">if</span> request.method == <span style="color: #800000">'</span><span style="color: #800000; background-color: #ffff00">GET</span><span style="color: #800000">'</span><span style="color: #000000">:
        <span style="background-color: #ffff00">f </span></span><span style="background-color: #ffff00">= yhbd()</span>                                            <span style="color: #008000">#</span><span style="color: #008000">创建表单验证类，不传参</span>
        <span style="color: #0000ff">return</span> render(request, <span style="color: #800000">'</span><span style="color: #800000">app1/index.html</span><span style="color: #800000">'</span>,{<span style="background-color: #ffff00"><span style="color: #800000">'</span><span style="color: #800000">form</span><span style="color: #800000">'</span>:f</span>})  <span style="color: #008000">#</span><span style="color: #008000"> 打开页面，并将表单验证类传到html生成表单标签</span>

    <span style="color: #0000ff">if</span> request.method == <span style="color: #800000">"</span><span style="color: #800000; background-color: #ff99cc">POST</span><span style="color: #800000">"</span><span style="color: #000000">:
        <span style="background-color: #ff99cc">f </span></span><span style="background-color: #ff99cc">= yhbd(request.POST)</span>                          <span style="color: #008000">#</span><span style="color: #008000">创建验证表单类，将用户请求POST对象传进表单验证类进行验证</span>

        <span style="background-color: #ff99cc"><span style="color: #0000ff">if</span> f.is_valid():</span>                                <span style="color: #008000">#</span><span style="color: #008000">判断验证如果通过</span>
            <span style="background-color: #ff99cc"><span style="color: #0000ff">print</span>(f.cleaned_data)</span>                       <span style="color: #008000">#</span><span style="color: #008000">获取到用户提交信息,字典方式</span>
        <span style="color: #0000ff">else</span>:                                           <span style="color: #008000">#</span><span style="color: #008000">如果没通过</span>
            <span style="color: #008000">#</span><span style="color: #008000"><span style="background-color: #ff99cc"> print(f.errors)</span>                           #获取错误对象</span>
            <span style="color: #0000ff">pass</span>

        <span style="color: #0000ff">return</span> render(request, <span style="color: #800000">'</span><span style="color: #800000">app1/index.html</span><span style="color: #800000">'</span>,{<span style="background-color: #ff99cc"><span style="color: #800000">'</span><span style="color: #800000">cuow</span><span style="color: #800000">'</span>:f.errors</span>,<span style="background-color: #ff99cc"><span style="color: #800000">'</span><span style="color: #800000">form</span><span style="color: #800000">'</span>:f</span>})  <span style="color: #008000">#</span><span style="color: #008000"> 打开页面，将错误信息用字典方式传到html页面，并且将表单类传到html页面替换没传参的表单验证类</span></pre>
</div>
<p><span style="color: #0000ff"><strong>html</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">&lt;!</span><span style="color: #ff00ff">DOCTYPE html</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">html </span><span style="color: #ff0000">lang</span><span style="color: #0000ff">="en"</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">head</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">meta </span><span style="color: #ff0000">charset</span><span style="color: #0000ff">="UTF-8"</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">title</span><span style="color: #0000ff">&gt;</span>Title<span style="color: #0000ff">&lt;/</span><span style="color: #800000">title</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">link </span><span style="color: #ff0000">rel</span><span style="color: #0000ff">="stylesheet"</span><span style="color: #ff0000"> type</span><span style="color: #0000ff">="text/css"</span><span style="color: #ff0000"> href</span><span style="color: #0000ff">="/static/css/tou.css"</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">head</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">body</span><span style="color: #0000ff">&gt;</span>

<span style="color: #0000ff">&lt;</span><span style="color: #800000">form </span><span style="color: #ff0000">action</span><span style="color: #0000ff">="/bugarticles/"</span><span style="color: #ff0000"> method</span><span style="color: #0000ff">="post"</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span><span style="color: #000000; background-color: #ffff00">
        {{ form.user }}                                     </span><span style="color: #008000">&lt;!--</span><span style="color: #008000"> 接收get请求时创建的表单类，生成表单标签 </span><span style="color: #008000">--&gt;</span><span style="background-color: #ff99cc"><span style="color: #000000">
        {% if cuow.user.0 %}
            </span><span style="color: #0000ff">&lt;</span><span style="color: #800000">span </span><span style="color: #ff0000">class</span><span style="color: #0000ff">="cuow"</span><span style="color: #0000ff">&gt;</span>{{ cuow.user.0 }}<span style="color: #0000ff">&lt;/</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span>     <span style="color: #008000">&lt;!--</span><span style="color: #008000"> 接收错误信息里的user的错误信息 </span><span style="color: #008000">--&gt;</span><span style="color: #000000">
        {% endif %}
    </span></span><span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span><span style="color: #000000; background-color: #ffff00">
        {{ form.pwd }}                                      </span><span style="color: #008000">&lt;!--</span><span style="color: #008000"> 接收get请求时创建的表单类，生成表单标签 </span><span style="color: #008000">--&gt;</span><span style="background-color: #ff99cc"><span style="color: #000000">
        {% if cuow.pwd.0 %}
            </span><span style="color: #0000ff">&lt;</span><span style="color: #800000">span </span><span style="color: #ff0000">class</span><span style="color: #0000ff">="cuow"</span><span style="color: #0000ff">&gt;</span>{{ cuow.pwd.0 }}<span style="color: #0000ff">&lt;/</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span>      <span style="color: #008000">&lt;!--</span><span style="color: #008000"> 接收错误信息里的pwd的错误信息 </span><span style="color: #008000">--&gt;</span><span style="color: #000000">
        {% endif %}
    </span></span><span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="submit"</span><span style="color: #ff0000"> value</span><span style="color: #0000ff">="提交"</span><span style="color: #0000ff">/&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">form</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">body</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">html</span><span style="color: #0000ff">&gt;</span></pre>
</div>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong>常用的内置验证字段</strong></span></p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">EmailField()</span>验证邮箱字段</strong></span><br><span style="color: #ff0000"><strong><span style="color: #0000ff">CharField()</span>验证字符串字段</strong></span><br><span style="color: #ff0000"><strong><span style="color: #0000ff">URLField()</span>验证url地址字段</strong></span><br><span style="color: #ff0000"><strong><span style="color: #0000ff">IntegerField()</span>验证数字字段</strong></span><br><span style="color: #ff0000"><strong><span style="color: #0000ff">GenericIPAddressField()</span>验证IP字段</strong></span></p>
<p><span style="color: #0000ff"><strong>注意：虽然有很多内置验证字段，但是我们还是要根据我们自己的需求来验证，所以</strong></span></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong>验证字段的参数</strong></span></p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">required</span>设置字段是否可以为空</strong></span><br><strong>	　　True不可以为空</strong><br><strong>	　　False可以为空</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user = forms.CharField(<span style="background-color: #ff99cc">required=True</span>)   <span style="color: #008000">#</span><span style="color: #008000">True不可以为空</span>
    pwd = forms.CharField()</pre>
</div>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">max_length</span>最大字符数</strong></span><br><span style="color: #ff0000"><strong><span style="color: #0000ff">min_length</span>最小字符数</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user = forms.CharField(<span style="background-color: #ff99cc">max_length=4</span>,<span style="background-color: #ff99cc">min_length=2</span><span style="color: #000000">)
    pwd </span>= forms.CharField()</pre>
</div>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">error_messages</span>自定义错误提示信息</strong></span><br><strong>　　参数是一个字典{'验证名称':'错误提示'}</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        <span style="background-color: #ffff00">required</span></span>=<span style="color: #000000">True,
        <span style="background-color: #ffff00">max_length</span></span>=4<span style="color: #000000">,
        <span style="background-color: #ffff00">min_length</span></span>=2<span style="color: #000000">,
<span style="background-color: #ff99cc">        error_messages</span></span><span style="background-color: #ff99cc">=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000; background-color: #ffff00">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000; background-color: #ffff00">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000; background-color: #ffff00">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span></span><span style="color: #000000"><span style="background-color: #ff99cc">
        }</span>
    )
    pwd </span>= forms.CharField()</pre>
</div>
<p><strong><span style="color: #0000ff">invalid</span>设置邮箱格式错误提示信息</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        required</span>=<span style="color: #000000">True,
        max_length</span>=4<span style="color: #000000">,
        min_length</span>=2<span style="color: #000000">,
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span><span style="color: #000000">
        }
    )
    pwd </span>=<span style="color: #000000"> forms.<span style="background-color: #ff99cc">EmailField</span>(
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>: <span style="color: #800000">'</span><span style="color: #800000">邮箱不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="background-color: #ff99cc"><span style="color: #800000">'</span><span style="color: #800000">invalid</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">邮箱格式不正确</span><span style="color: #800000">'</span></span><span style="color: #000000">
        }
    )</span></pre>
</div>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">widget</span>设置表单字段在html页面的类型</strong></span><br><strong>	　　使用方式：widget=forms.Textarea()</strong><br><strong>	　　Textarea(): &lt;textarea&gt;标签类型</strong><br><strong>	　　TextInput()：&lt;input&gt;标签类型</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        required</span>=<span style="color: #000000">True,
        max_length</span>=4<span style="color: #000000">,
        min_length</span>=2<span style="color: #000000">,
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span><span style="color: #000000">
        }
    )
    pwd </span>=<span style="color: #000000"> forms.CharField(
        <span style="background-color: #ff99cc">widget</span></span>=<span style="color: #000000">forms.<span style="background-color: #ff99cc">TextInput()</span>,
    )</span></pre>
</div>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">attrs</span>给表单标签设置属性，可以给标签元素设置class样式，和input标签的各种type属性</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        required</span>=<span style="color: #000000">True,
        max_length</span>=4<span style="color: #000000">,
        min_length</span>=2<span style="color: #000000">,
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span><span style="color: #000000">
        }
    )
    pwd </span>=<span style="color: #000000"> forms.CharField(
        widget</span>=forms.TextInput(<span style="background-color: #ff99cc">attrs={<span style="background-color: #ffff00"><span style="color: #800000">'</span><span style="color: #800000">type</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">password</span><span style="color: #800000">'</span></span>,<span style="background-color: #ffff00"><span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">c1</span><span style="color: #800000">'</span></span></span><span style="color: #000000"><span style="background-color: #ff99cc">}</span>),
    )</span></pre>
</div>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">Select</span>生成表单，select标签，下拉选项框</strong></span><br><strong>	　　参数:</strong><br><strong>		　　　　<span style="color: #0000ff">choices</span>设置下拉数据，元组类型</strong><br><strong>		　　　　<span style="color: #0000ff">attrs</span>设置select标签属性</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        required</span>=<span style="color: #000000">True,
        max_length</span>=4<span style="color: #000000">,
        min_length</span>=2<span style="color: #000000">,
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span><span style="color: #000000">
        }
    )

<span style="background-color: #ffff00">    zhi </span></span><span style="background-color: #ffff00">=<span style="color: #000000"> (
        (0, </span><span style="color: #800000">'</span><span style="color: #800000">普通会员</span><span style="color: #800000">'</span><span style="color: #000000">),
        (</span>1, <span style="color: #800000">'</span><span style="color: #800000">超级会员</span><span style="color: #800000">'</span><span style="color: #000000">),
        (</span>2, <span style="color: #800000">'</span><span style="color: #800000">黄金会员</span><span style="color: #800000">'</span><span style="color: #000000">),
        (</span>3, <span style="color: #800000">'</span><span style="color: #800000">白银会员</span><span style="color: #800000">'</span><span style="color: #000000">),
        (</span>4, <span style="color: #800000">'</span><span style="color: #800000">vip会员</span><span style="color: #800000">'</span></span><span style="color: #000000"><span style="background-color: #ffff00">)
    )</span>
    pwd </span>=<span style="color: #000000"> forms.CharField(
        widget</span>=forms.<span style="background-color: #ff99cc">widgets.Select(<span style="background-color: #ffff00">choices=zhi</span>,attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">c1</span><span style="color: #800000">'</span></span><span style="color: #000000"><span style="background-color: #ff99cc">})</span>
    )</span></pre>
</div>
<p><img src="https://images2015.cnblogs.com/blog/955761/201707/955761-20170717194742910-289353552.png" alt=""></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>下拉框结合数据库应用</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>
<span style="background-color: #ffff00"><span style="color: #0000ff">from</span> app1.models <span style="color: #0000ff">import</span> *</span>       <span style="color: #008000">#</span><span style="color: #008000">导入数据库操作</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        required</span>=<span style="color: #000000">True,
        max_length</span>=4<span style="color: #000000">,
        min_length</span>=2<span style="color: #000000">,
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span><span style="color: #000000">
        }
    )

    <span style="background-color: #ffff00">a </span></span><span style="background-color: #ffff00">= shengf.objects.all().values_list(<span style="color: #800000">'</span><span style="color: #800000">id</span><span style="color: #800000">'</span>,<span style="color: #800000">'</span><span style="color: #800000">shf</span><span style="color: #800000">'</span>) <span style="color: #008000">#</span><span style="color: #008000">获取数据库里shengf表里的id和shf字段的数据</span></span>
    pwd =<span style="color: #000000"> forms.CharField(
        widget</span>=forms.widgets.<span style="background-color: #ff99cc">Select(<span style="background-color: #ffff00">choices=a</span>,attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">c1</span><span style="color: #800000">'</span>})</span> <span style="color: #008000">#</span><span style="color: #008000">将数据库的数据显示到下拉框</span>
    )</pre>
</div>
<p>&nbsp;<img src="https://images2015.cnblogs.com/blog/955761/201707/955761-20170717194742910-289353552.png" alt=""></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>下拉框结合数据库应用，防止数据库添加了数据，或者删除了数据，页面缓存了下拉框数据，无法事实数据同步</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>
<span style="color: #0000ff">from</span> app1.models <span style="color: #0000ff">import</span> *       <span style="color: #008000">#</span><span style="color: #008000">导入数据库操作</span>

<span style="color: #0000ff">class</span> <span style="background-color: #ff99cc">yhbd</span>(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        required</span>=<span style="color: #000000">True,
        max_length</span>=4<span style="color: #000000">,
        min_length</span>=2<span style="color: #000000">,
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span><span style="color: #000000">
        }
    )

    a </span>= shengf.objects.all().values_list(<span style="color: #800000">'</span><span style="color: #800000">id</span><span style="color: #800000">'</span>,<span style="color: #800000">'</span><span style="color: #800000">shf</span><span style="color: #800000">'</span>) <span style="color: #008000">#</span><span style="color: #008000">获取数据库里shengf表里的id和shf字段的数据</span>
    <span style="background-color: #ff99cc">pwd</span> =<span style="color: #000000"> forms.CharField(
        widget</span>=forms.widgets.Select(choices=a,attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">c1</span><span style="color: #800000">'</span>}) <span style="color: #008000">#</span><span style="color: #008000">将数据库的数据显示到下拉框</span>
<span style="color: #000000">    )

    </span><span style="color: #008000">#</span><span style="color: #008000">防止数据库添加了数据，或者删除了数据，页面缓存了下拉框数据，无法事实数据同步</span>
    <span style="color: #0000ff">def</span> <span style="color: #800080">__init__</span>(self,*args, **kwargs):                                     <span style="color: #008000">#</span><span style="color: #008000">创建类的__init__方法，每次创建类时都会执行</span>
        super(<span style="background-color: #ff99cc">yhbd</span>,self).<span style="color: #800080">__init__</span>(*args, **kwargs)                          <span style="color: #008000">#</span><span style="color: #008000">获取当前类的父类里的__init__方法执行</span>
        a = shengf.objects.all().values_list(<span style="color: #800000">'</span><span style="color: #800000">id</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">shf</span><span style="color: #800000">'</span>)                   <span style="color: #008000">#</span><span style="color: #008000">重新获取数据库里shengf表里的id和shf字段的数据</span>
        self.fields[<span style="background-color: #ff99cc"><span style="color: #800000">'</span><span style="color: #800000">pwd</span><span style="color: #800000">'</span></span>] = forms.CharField(widget=forms.widgets.Select(choices=a,attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">c1</span><span style="color: #800000">'</span>}))  <span style="color: #008000">#</span><span style="color: #008000">更新一下表单pwd字段的数据</span></pre>
</div>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>自定义验证规则</strong></span></p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">validators</span>设置自定义验证规则，参数是一个列表，列表里是自定义验证方法名称</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>
<span style="color: #0000ff">from</span> django.core.exceptions <span style="color: #0000ff">import</span><span style="color: #000000"> ValidationError
</span><span style="color: #0000ff">import</span><span style="color: #000000"> re

</span><span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        required</span>=<span style="color: #000000">True,
        max_length</span>=4<span style="color: #000000">,
        min_length</span>=2<span style="color: #000000">,
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span><span style="color: #000000">
        }
    )


    </span><span style="color: #008000">#</span><span style="color: #008000">自定义验证规则</span>
<span style="background-color: #ffff00">    <span style="color: #0000ff">def</span><span style="color: #000000"> shouji(value):
        mobile_re </span>= re.compile(r<span style="color: #800000">'</span><span style="color: #800000">^(13[0-9]|15[012356789]|17[678]|18[0-9]|14[57])[0-9]{8}$</span><span style="color: #800000">'</span><span style="color: #000000">)
        </span><span style="color: #0000ff">if</span> <span style="color: #0000ff">not</span><span style="color: #000000"> mobile_re.match(value):
            </span><span style="color: #0000ff">raise</span> ValidationError(<span style="color: #800000">'</span><span style="color: #800000">手机号码格式错误</span><span style="color: #800000">'</span>)   <span style="color: #008000">#</span><span style="color: #008000">如果不匹配返回错误信息</span></span>
<span style="color: #000000">

    pwd </span>=<span style="color: #000000"> forms.CharField(
        <span style="background-color: #ffff00">validators</span></span><span style="background-color: #ffff00">=[shouji, ],   <span style="color: #008000">#</span><span style="color: #008000">设置自定义验证规则</span></span>
        required=<span style="color: #000000">True,
        widget</span>=<span style="color: #000000">forms.TextInput(
            attrs</span>=<span style="color: #000000">{
                </span><span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>: <span style="color: #800000">"</span><span style="color: #800000">cl</span><span style="color: #800000">"</span><span style="color: #000000">,
                </span><span style="color: #800000">'</span><span style="color: #800000">placeholder</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">手机号码</span><span style="color: #800000">'</span><span style="color: #000000">
            }
        ),
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">手机不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
        }
    )</span></pre>
</div>
<p><img src="https://images2015.cnblogs.com/blog/955761/201707/955761-20170717232723411-1592842803.png" alt=""></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>其他</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span>
<span style="color: #0000ff">import</span><span style="color: #000000"> re
</span><span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span><span style="color: #000000"> forms
</span><span style="color: #0000ff">from</span> django.core.exceptions <span style="color: #0000ff">import</span><span style="color: #000000"> ValidationError


</span><span style="color: #0000ff">def</span><span style="color: #000000"> mobile_validate(value):
    mobile_re </span>= re.compile(r<span style="color: #800000">'</span><span style="color: #800000">^(13[0-9]|15[012356789]|17[678]|18[0-9]|14[57])[0-9]{8}$</span><span style="color: #800000">'</span><span style="color: #000000">)
    </span><span style="color: #0000ff">if</span> <span style="color: #0000ff">not</span><span style="color: #000000"> mobile_re.match(value):
        </span><span style="color: #0000ff">raise</span> ValidationError(<span style="color: #800000">'</span><span style="color: #800000">手机号码格式错误</span><span style="color: #800000">'</span><span style="color: #000000">)


</span><span style="color: #0000ff">class</span><span style="color: #000000"> PublishForm(forms.Form):

    user_type_choice </span>=<span style="color: #000000"> (
        (0, u</span><span style="color: #800000">'</span><span style="color: #800000">普通用户</span><span style="color: #800000">'</span><span style="color: #000000">),
        (</span>1, u<span style="color: #800000">'</span><span style="color: #800000">高级用户</span><span style="color: #800000">'</span><span style="color: #000000">),
    )

    user_type </span>= forms.IntegerField(widget=forms.widgets.Select(choices=<span style="color: #000000">user_type_choice,
                                                                  attrs</span>={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>: <span style="color: #800000">"</span><span style="color: #800000">form-control</span><span style="color: #800000">"</span><span style="color: #000000">}))

    title </span>= forms.CharField(max_length=20<span style="color: #000000">,
                            min_length</span>=5<span style="color: #000000">,
                            error_messages</span>={<span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">标题不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
                                            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">标题最少为5个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
                                            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">标题最多为20个字符</span><span style="color: #800000">'</span><span style="color: #000000">},
                            widget</span>=forms.TextInput(attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>: <span style="color: #800000">"</span><span style="color: #800000">form-control</span><span style="color: #800000">"</span><span style="color: #000000">,
                                                          </span><span style="color: #800000">'</span><span style="color: #800000">placeholder</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">标题5-20个字符</span><span style="color: #800000">'</span><span style="color: #000000">}))

    memo </span>= forms.CharField(required=<span style="color: #000000">False,
                           max_length</span>=256<span style="color: #000000">,
                           widget</span>=forms.widgets.Textarea(attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>: <span style="color: #800000">"</span><span style="color: #800000">form-control no-radius</span><span style="color: #800000">"</span>, <span style="color: #800000">'</span><span style="color: #800000">placeholder</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">详细描述</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">rows</span><span style="color: #800000">'</span>: 3<span style="color: #000000">}))

    phone </span>= forms.CharField(validators=<span style="color: #000000">[mobile_validate, ],
                            error_messages</span>={<span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">手机不能为空</span><span style="color: #800000">'</span><span style="color: #000000">},
                            widget</span>=forms.TextInput(attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>: <span style="color: #800000">"</span><span style="color: #800000">form-control</span><span style="color: #800000">"</span><span style="color: #000000">,
                                                          </span><span style="color: #800000">'</span><span style="color: #800000">placeholder</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">手机号码</span><span style="color: #800000">'</span><span style="color: #000000">}))

    email </span>= forms.EmailField(required=<span style="color: #000000">False,
                            error_messages</span>={<span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">邮箱不能为空</span><span style="color: #800000">'</span>,<span style="color: #800000">'</span><span style="color: #800000">invalid</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">邮箱格式错误</span><span style="color: #800000">'</span><span style="color: #000000">},
                            widget</span>=forms.TextInput(attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>: <span style="color: #800000">"</span><span style="color: #800000">form-control</span><span style="color: #800000">"</span>, <span style="color: #800000">'</span><span style="color: #800000">placeholder</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">邮箱</span><span style="color: #800000">'</span>}))</pre>
</div>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>注意：如果表单是通过Ajax提交的，页面不刷新，那么html页面将无法获取到错误信息，那么我们只能将所有错误信息构造成字典，然后以json的方式返回给Ajax，添加到页面</strong></span></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>将models数据库表类转换成表单验证类【必要使用】</strong></span></p>
<p><span style="color: #000000"><strong>这样可以少写表单验证代码，使用的是数据库字段的验证规则</strong></span></p>
<p><span style="color: #ff0000"><strong>models.py</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">from</span> django.db <span style="color: #0000ff">import</span> models        <span style="color: #008000">#</span><span style="color: #008000"> 导入models对象</span>

<span style="color: #0000ff">class</span><span style="color: #000000"><span style="background-color: #ff99cc"> CourseOrg</span>(models.Model):
    <span style="background-color: #ff99cc">name </span></span><span style="background-color: #ff99cc">= models.CharField(max_length=50, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">机构名称</span><span style="color: #800000">'</span></span><span style="color: #000000"><span style="background-color: #ff99cc">)</span>
    desc </span>= models.TextField(verbose_name=<span style="color: #800000">'</span><span style="color: #800000">机构描述</span><span style="color: #800000">'</span><span style="color: #000000">)
    <span style="background-color: #ff99cc">category </span></span><span style="background-color: #ff99cc">= models.CharField(max_length=20, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">机构类别</span><span style="color: #800000">'</span>, default=<span style="color: #800000">'</span><span style="color: #800000">pxjg</span><span style="color: #800000">'</span>, choices=((<span style="color: #800000">'</span><span style="color: #800000">pxjg</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">培训机构</span><span style="color: #800000">'</span>), (<span style="color: #800000">'</span><span style="color: #800000">gx</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">高校</span><span style="color: #800000">'</span>), (<span style="color: #800000">'</span><span style="color: #800000">gr</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">个人</span><span style="color: #800000">'</span></span><span style="color: #000000"><span style="background-color: #ff99cc">)))</span>
    click </span>= models.IntegerField(default=0, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">点击数</span><span style="color: #800000">'</span><span style="color: #000000">)
    <span style="background-color: #ff99cc">fav_nums </span></span><span style="background-color: #ff99cc">= models.IntegerField(default=0, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">收藏数</span><span style="color: #800000">'</span></span><span style="color: #000000"><span style="background-color: #ff99cc">)</span>
    image </span>= models.ImageField(upload_to=<span style="color: #800000">'</span><span style="color: #800000">org/%Y/%m</span><span style="color: #800000">'</span>, storage=ImageStorage(), verbose_name=<span style="color: #800000">'</span><span style="color: #800000">封面图</span><span style="color: #800000">'</span>, max_length=100<span style="color: #000000">)
    address </span>= models.CharField(max_length=150, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">机构地址</span><span style="color: #800000">'</span><span style="color: #000000">)
    city </span>= models.ForeignKey(CityDict, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">外键城市表</span><span style="color: #800000">'</span><span style="color: #000000">)
    add_time </span>= models.DateTimeField(default=datetime.now, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">添加日期</span><span style="color: #800000">'</span><span style="color: #000000">)

    </span><span style="color: #0000ff">class</span><span style="color: #000000"> Meta:
        verbose_name </span>= <span style="color: #800000">'</span><span style="color: #800000">课程机构表</span><span style="color: #800000">'</span><span style="color: #000000">
        verbose_name_plural </span>=<span style="color: #000000"> verbose_name

    </span><span style="color: #0000ff">def</span> <span style="color: #800080">__str__</span><span style="color: #000000">(self):
        </span><span style="color: #0000ff">return</span> self.name</pre>
</div>
<p><span style="color: #ff0000"><strong>forms.py</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf8 -*-</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> <span style="background-color: #ff99cc">forms</span>                             <span style="color: #008000">#</span><span style="color: #008000"> 导入Django的表单验证模块</span>
<span style="color: #0000ff">from</span> app_organization.models <span style="color: #0000ff">import</span> <span style="background-color: #ff99cc"><strong>CourseOrg</strong></span>        <span style="color: #008000">#</span><span style="color: #008000"> 导入数据库表类</span>


<span style="color: #0000ff">class</span><span style="color: #000000"> CourseOrgForm(<span style="background-color: #ff99cc">forms.ModelForm</span>):
    zdyi </span>= forms.CharField()                         <span style="color: #008000">#</span><span style="color: #008000"> 自定义表单验证字段</span>

    <span style="color: #0000ff">class</span><span style="color: #000000"> Meta:
        model </span>= <span style="background-color: #ff99cc">CourseOrg</span>                            <span style="color: #008000">#</span><span style="color: #008000"> 设置要将数据库表类转换成表单验证类的名称</span>
        fields = [<span style="color: #800000">'</span><span style="color: #800000">name</span><span style="color: #800000">'</span>,<span style="color: #800000">'</span><span style="color: #800000">category</span><span style="color: #800000">'</span>,<span style="color: #800000">'</span><span style="color: #800000">fav_nums</span><span style="color: #800000">'</span>]      <span style="color: #008000">#</span><span style="color: #008000"> 要使用的字段</span></pre>
</div>
<p>&nbsp;</p></div>第三百一十一节，Django框架，Form表单验证


			<div id="cnblogs_post_body" class="blogpost-body"><p><strong>第三百一十一节，Django框架，Form表单验证</strong></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong>表单提交</strong></span></p>
<p><span style="color: #0000ff"><strong>html</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">&lt;!</span><span style="color: #ff00ff">DOCTYPE html</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">html </span><span style="color: #ff0000">lang</span><span style="color: #0000ff">="en"</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">head</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">meta </span><span style="color: #ff0000">charset</span><span style="color: #0000ff">="UTF-8"</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">title</span><span style="color: #0000ff">&gt;</span>Title<span style="color: #0000ff">&lt;/</span><span style="color: #800000">title</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">link </span><span style="color: #ff0000">rel</span><span style="color: #0000ff">="stylesheet"</span><span style="color: #ff0000"> type</span><span style="color: #0000ff">="text/css"</span><span style="color: #ff0000"> href</span><span style="color: #0000ff">="/static/css/tou.css"</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">head</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">body</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">form </span><span style="color: #ff0000">action</span><span style="color: #0000ff">="<span style="background-color: #ff99cc">/bug<span style="background-color: #ffff00">articles</span>/</span>"</span><span style="color: #ff0000"> method</span><span style="color: #0000ff">="post"</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="text"</span><span style="color: #ff0000"> name</span><span style="color: #0000ff">="user"</span><span style="color: #0000ff">/&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="text"</span><span style="color: #ff0000"> name</span><span style="color: #0000ff">="pwd"</span><span style="color: #0000ff">/&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="submit"</span><span style="color: #ff0000"> value</span><span style="color: #0000ff">="提交"</span><span style="color: #0000ff">/&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">form</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">body</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">html</span><span style="color: #0000ff">&gt;</span></pre>
</div>
<p><span style="color: #0000ff"><strong>路由映射</strong></span></p>
<div class="cnblogs_code">
<pre>urlpatterns =<span style="color: #000000"> [
    url(r</span><span style="color: #800000">'</span><span style="color: #800000">admin/</span><span style="color: #800000">'</span>, admin.site.urls),   <span style="color: #008000">#</span><span style="color: #008000">路由映射admin数据库管理</span>
    url(r<span style="color: #800000">'</span><span style="color: #800000"><span style="background-color: #ffff00">articles</span>/</span><span style="color: #800000">'</span><span style="color: #000000">, <span style="background-color: #ffff00">views.special</span>)    
]</span></pre>
</div>
<p><span style="color: #0000ff"><strong>逻辑处理</strong></span></p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">method</span>属性获取用户请求方式，post或者get</strong></span><br><strong>使用方式：请求对象.method</strong></p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">POST</span>获取用户post请求方式的信息</strong></span><br><strong>使用方式：请求对象.POST</strong></p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">POST.get()</span>获取用户POST请求方式的表单name名称对应的值，参数是表单name名</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">from</span> django.shortcuts <span style="color: #0000ff">import</span><span style="color: #000000"> render
</span><span style="color: #0000ff">from</span> app1.models <span style="color: #0000ff">import</span> *    <span style="color: #008000">#</span><span style="color: #008000">导入数据库操作模块</span>

<span style="color: #008000">#</span><span style="color: #008000">逻辑处理模块</span>
<span style="color: #0000ff">def</span><span style="color: #000000"><span style="background-color: #ffff00"> special</span>(request):  　　　　　　　　　　　　　 <span style="color: #008080">#自定义参数接收用户请求对象
    </span></span><span style="color: #0000ff">if</span> request.method == <span style="color: #800000">"</span><span style="color: #800000">POST</span><span style="color: #800000">"</span><span style="color: #000000">:　　　　　　　　 <span style="color: #008080">#判断用户请求如果是post方式
        </span></span><span style="color: #0000ff">print</span>(request.POST.get(<span style="color: #800000">'</span><span style="color: #800000">user</span><span style="color: #800000">'</span>,None))  <span style="color: #008000">#</span><span style="color: #008000">接收用户表单提交的name名称对应的值</span>
        <span style="color: #0000ff">print</span>(request.POST.get(<span style="color: #800000">'</span><span style="color: #800000">pwd</span><span style="color: #800000">'</span>, None))  <span style="color: #008000">#</span><span style="color: #008000">接收用户表单提交的name名称对应的值</span>
    <span style="color: #0000ff">return</span> render(request, <span style="color: #800000">'</span><span style="color: #800000">app1/index.html</span><span style="color: #800000">'</span>, locals())  <span style="color: #008000">#</span><span style="color: #008000"> 打开页面</span></pre>
</div>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong>表单提交验证，获取数据与获取错误信息</strong></span></p>
<p><span style="color: #000000"><strong>1、创建表单验证模块，必须继承</strong><span style="color: #0000ff"><strong>Django的表单验证forms.Form类</strong></span></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> <span style="background-color: #ff99cc">django <span style="color: #0000ff">import</span> forms</span>        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(<span style="background-color: #ff99cc">forms.Form</span>):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    <span style="background-color: #ff99cc">user</span> = forms.CharField()    <span style="color: #008000">#</span><span style="color: #008000">接收逻辑处理时，创建yhbd类时传进来的POST对象，里的表单name名对应的值进行验证</span>
    <span style="background-color: #ff99cc">pwd</span> = forms.CharField()     <span style="color: #008000">#</span><span style="color: #008000">#接收逻辑处理时，创建yhbd类时传进来的POST对象，里的表单name名对应的值进行验证</span></pre>
</div>
<p><strong>2、逻辑处理，创建表单验证模块里的验证类，并将用户请求的<span style="color: #0000ff">POST对象</span>，传入验证类进行验证，验证后获取验证通过的提交信息，或者验证没通过的错误信息</strong></p>
<p><span style="color: #0000ff"><strong>如果出现错误，将错误信息对象以字典方式传到html页面</strong></span></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">is_valid()</span>返回验证是否通过的布尔值</strong></span><br><strong>使用方式：验证类.is_valid()</strong></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">cleaned_data</span>获取验证通过后的所有提交数据，返回字典</strong></span><br><strong>使用方式：验证类.cleaned_data</strong></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">errors</span>获取验证错误信息，返回所有表单的错误信息对象</strong></span><br><strong>使用方法：验证类.errors</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">from</span> django.shortcuts <span style="color: #0000ff">import</span><span style="color: #000000"> render
</span><span style="color: #0000ff">from</span> app1.models <span style="color: #0000ff">import</span> *    <span style="color: #008000">#</span><span style="color: #008000">导入数据库操作模块</span>
<span style="color: #0000ff">from</span> app1.biaodan <span style="color: #0000ff">import</span> *   <span style="color: #008000">#</span><span style="color: #008000">导入自定义表单验证模块</span><span style="color: #008000">
#</span><span style="color: #008000">逻辑处理模块</span>
<span style="color: #0000ff">def</span><span style="color: #000000"> special(request):
    </span><span style="color: #0000ff">if</span> request.method == <span style="color: #800000">'</span><span style="color: #800000">GET</span><span style="color: #800000">'</span><span style="color: #000000">:
        </span><span style="color: #0000ff">return</span> render(request, <span style="color: #800000">'</span><span style="color: #800000">app1/index.html</span><span style="color: #800000">'</span>, locals())  <span style="color: #008000">#</span><span style="color: #008000"> 打开页面</span>

    <span style="background-color: #ff99cc"><span style="color: #0000ff">if</span> request.method == <span style="color: #800000">"</span><span style="color: #800000">POST</span><span style="color: #800000">"</span><span style="color: #000000">:
        </span></span><span style="color: #008000">#</span><span style="color: #008000"> print(request.POST.get('user',None))          #接收用户表单提交的name名称对应的值</span>
        <span style="color: #008000">#</span><span style="color: #008000"> print(request.POST.get('pwd', None))          #接收用户表单提交的name名称对应的值</span>
<span style="background-color: #ff99cc"><span style="color: #000000">
        f </span>= yhbd(request.POST)</span>                          <span style="color: #008000">#</span><span style="color: #008000">创建验证表单类，将用户请求POST对象传进表单验证类进行验证</span>

        <span style="color: #008000">#</span><span style="color: #008000"> ret = f.is_valid()                            #返回验证是否通过</span>
        <span style="color: #008000">#</span><span style="color: #008000"> print(ret)                                    #返回布尔值</span>

       <span style="background-color: #ff99cc"> <span style="color: #0000ff">if</span> f.is_valid():</span>                                <span style="color: #008000">#</span><span style="color: #008000">判断验证如果通过</span>
            <span style="background-color: #ff99cc"><span style="color: #0000ff">print</span>(f.cleaned_data)</span>                       <span style="color: #008000">#</span><span style="color: #008000">获取到用户提交信息,字典方式</span>
        <span style="color: #0000ff">else</span>:                                           <span style="color: #008000">#</span><span style="color: #008000">如果没通过</span>
            <span style="background-color: #ff99cc"><span style="color: #0000ff">print</span>(f.errors)</span>                             <span style="color: #008000">#</span><span style="color: #008000">获取错误对象</span>

        <span style="color: #0000ff">return</span> render(request, <span style="color: #800000">'</span><span style="color: #800000">app1/index.html</span><span style="color: #800000">'</span>,<span style="background-color: #ff99cc">{<span style="color: #800000">'</span><span style="color: #800000">cuow</span><span style="color: #800000">'</span>:f.errors}</span>)  <span style="color: #008000">#</span><span style="color: #008000"> 打开页面，将错误信息用字典方式传到html页面</span></pre>
</div>
<p><strong>3、在html页面接收逻辑处理<span style="color: #0000ff">以字典形式</span>传过来的错误对象，分别获取不同表单的错误信息</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">&lt;!</span><span style="color: #ff00ff">DOCTYPE html</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">html </span><span style="color: #ff0000">lang</span><span style="color: #0000ff">="en"</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">head</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">meta </span><span style="color: #ff0000">charset</span><span style="color: #0000ff">="UTF-8"</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">title</span><span style="color: #0000ff">&gt;</span>Title<span style="color: #0000ff">&lt;/</span><span style="color: #800000">title</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">link </span><span style="color: #ff0000">rel</span><span style="color: #0000ff">="stylesheet"</span><span style="color: #ff0000"> type</span><span style="color: #0000ff">="text/css"</span><span style="color: #ff0000"> href</span><span style="color: #0000ff">="/static/css/tou.css"</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">head</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">body</span><span style="color: #0000ff">&gt;</span>

<span style="color: #0000ff">&lt;</span><span style="color: #800000">form </span><span style="color: #ff0000">action</span><span style="color: #0000ff">="/bugarticles/"</span><span style="color: #ff0000"> method</span><span style="color: #0000ff">="post"</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="text"</span><span style="color: #ff0000"> name</span><span style="color: #0000ff">="user"</span><span style="color: #0000ff">/&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span><span style="background-color: #ff99cc">{{ cuow.user.0 }}</span><span style="color: #0000ff">&lt;/</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span>     <span style="color: #008000">&lt;!--</span><span style="color: #008000"> 接收错误信息里的user的错误信息 </span><span style="color: #008000">--&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="text"</span><span style="color: #ff0000"> name</span><span style="color: #0000ff">="pwd"</span><span style="color: #0000ff">/&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span><span style="background-color: #ff99cc">{{ cuow.pwd.0 }}</span><span style="color: #0000ff">&lt;/</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span>      <span style="color: #008000">&lt;!--</span><span style="color: #008000"> 接收错误信息里的pwd的错误信息 </span><span style="color: #008000">--&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="submit"</span><span style="color: #ff0000"> value</span><span style="color: #0000ff">="提交"</span><span style="color: #0000ff">/&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">form</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">body</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">html</span><span style="color: #0000ff">&gt;</span></pre>
</div>
<p>&nbsp;<img src="https://images2015.cnblogs.com/blog/955761/201707/955761-20170716170032722-817776133.png" alt=""></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong>利用表单类自动创建表单标签</strong></span></p>
<p><span style="background-color: #ffffff"><strong>以上表单的&lt;input&gt;是我们自己手动写的，还可以用表单类来自动创建表单标签，好处是不用自己写表单标签，还有就是当用户填写的表单不合法提交时提示错误信息不清空表单</strong></span></p>
<p>&nbsp;</p>
<p><span style="background-color: #ffff00; color: #0000ff"><strong>注意：表单类根据字段创建的表单标签，当用户输入内容时，首先要经过浏览器默认行为的表单验证，如果浏览器<strong>默认行为的表单验证都没有通过那么将无法提交</strong></strong></span></p>
<p><span style="background-color: #ffff00; color: #0000ff"><strong><strong><strong>浏览器<strong>默认行为的表单验证，通过了在进行我们定义的表单类验证，验证合法获取用户提交信息，不合法返回错误信息</strong></strong></strong></strong></span></p>
<p><span style="background-color: #ffffff; color: #0000ff"><strong><strong><strong><strong>利用表单类自动创建表单标签</strong></strong></strong></strong></span></p>
<p><span style="background-color: #ffffff"><strong><strong><strong><strong>1、首先在get访问页面时，创建表单类不传参数，然后把这个表单类传到html页面，在html页面通过，<span style="color: #ff0000">表单类.字段名称</span>，来自动创建表单标签</strong></strong></strong></strong></span></p>
<p><span style="background-color: #ffffff"><strong><strong><strong><strong>　　每一种表单字段类型，都有一个默认的表单标签，这个标签是可以更改的，所以表单类可以创建任何表单标签</strong></strong></strong></strong></span></p>
<p><span style="background-color: #ffffff"><strong><strong><strong><strong>2、在post访问时，再次创建表单类需要传参，将post请求对象传入表单类进行验证表单，如果表单不合法，将错误信息对象传到html显示错误信息，将这次创建的表单类传到html页面替换get时创建的表单类</strong></strong></strong></strong></span></p>
<p><span style="color: #0000ff; background-color: #ffffff"><strong>逻辑处理</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">from</span> django.shortcuts <span style="color: #0000ff">import</span><span style="color: #000000"> render
</span><span style="color: #0000ff">from</span> app1.models <span style="color: #0000ff">import</span> *    <span style="color: #008000">#</span><span style="color: #008000">导入数据库操作模块</span>
<span style="color: #0000ff">from</span> app1.biaodan <span style="color: #0000ff">import</span> *   <span style="color: #008000">#</span><span style="color: #008000">导入自定义表单验证模块</span><span style="color: #008000">
#</span><span style="color: #008000">逻辑处理模块</span>
<span style="color: #0000ff">def</span><span style="color: #000000"> special(request):
    </span><span style="color: #0000ff">if</span> request.method == <span style="color: #800000">'</span><span style="color: #800000; background-color: #ffff00">GET</span><span style="color: #800000">'</span><span style="color: #000000">:
        <span style="background-color: #ffff00">f </span></span><span style="background-color: #ffff00">= yhbd()</span>                                            <span style="color: #008000">#</span><span style="color: #008000">创建表单验证类，不传参</span>
        <span style="color: #0000ff">return</span> render(request, <span style="color: #800000">'</span><span style="color: #800000">app1/index.html</span><span style="color: #800000">'</span>,{<span style="background-color: #ffff00"><span style="color: #800000">'</span><span style="color: #800000">form</span><span style="color: #800000">'</span>:f</span>})  <span style="color: #008000">#</span><span style="color: #008000"> 打开页面，并将表单验证类传到html生成表单标签</span>

    <span style="color: #0000ff">if</span> request.method == <span style="color: #800000">"</span><span style="color: #800000; background-color: #ff99cc">POST</span><span style="color: #800000">"</span><span style="color: #000000">:
        <span style="background-color: #ff99cc">f </span></span><span style="background-color: #ff99cc">= yhbd(request.POST)</span>                          <span style="color: #008000">#</span><span style="color: #008000">创建验证表单类，将用户请求POST对象传进表单验证类进行验证</span>

        <span style="background-color: #ff99cc"><span style="color: #0000ff">if</span> f.is_valid():</span>                                <span style="color: #008000">#</span><span style="color: #008000">判断验证如果通过</span>
            <span style="background-color: #ff99cc"><span style="color: #0000ff">print</span>(f.cleaned_data)</span>                       <span style="color: #008000">#</span><span style="color: #008000">获取到用户提交信息,字典方式</span>
        <span style="color: #0000ff">else</span>:                                           <span style="color: #008000">#</span><span style="color: #008000">如果没通过</span>
            <span style="color: #008000">#</span><span style="color: #008000"><span style="background-color: #ff99cc"> print(f.errors)</span>                           #获取错误对象</span>
            <span style="color: #0000ff">pass</span>

        <span style="color: #0000ff">return</span> render(request, <span style="color: #800000">'</span><span style="color: #800000">app1/index.html</span><span style="color: #800000">'</span>,{<span style="background-color: #ff99cc"><span style="color: #800000">'</span><span style="color: #800000">cuow</span><span style="color: #800000">'</span>:f.errors</span>,<span style="background-color: #ff99cc"><span style="color: #800000">'</span><span style="color: #800000">form</span><span style="color: #800000">'</span>:f</span>})  <span style="color: #008000">#</span><span style="color: #008000"> 打开页面，将错误信息用字典方式传到html页面，并且将表单类传到html页面替换没传参的表单验证类</span></pre>
</div>
<p><span style="color: #0000ff"><strong>html</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">&lt;!</span><span style="color: #ff00ff">DOCTYPE html</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">html </span><span style="color: #ff0000">lang</span><span style="color: #0000ff">="en"</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">head</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">meta </span><span style="color: #ff0000">charset</span><span style="color: #0000ff">="UTF-8"</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">title</span><span style="color: #0000ff">&gt;</span>Title<span style="color: #0000ff">&lt;/</span><span style="color: #800000">title</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">link </span><span style="color: #ff0000">rel</span><span style="color: #0000ff">="stylesheet"</span><span style="color: #ff0000"> type</span><span style="color: #0000ff">="text/css"</span><span style="color: #ff0000"> href</span><span style="color: #0000ff">="/static/css/tou.css"</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">head</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">body</span><span style="color: #0000ff">&gt;</span>

<span style="color: #0000ff">&lt;</span><span style="color: #800000">form </span><span style="color: #ff0000">action</span><span style="color: #0000ff">="/bugarticles/"</span><span style="color: #ff0000"> method</span><span style="color: #0000ff">="post"</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span><span style="color: #000000; background-color: #ffff00">
        {{ form.user }}                                     </span><span style="color: #008000">&lt;!--</span><span style="color: #008000"> 接收get请求时创建的表单类，生成表单标签 </span><span style="color: #008000">--&gt;</span><span style="background-color: #ff99cc"><span style="color: #000000">
        {% if cuow.user.0 %}
            </span><span style="color: #0000ff">&lt;</span><span style="color: #800000">span </span><span style="color: #ff0000">class</span><span style="color: #0000ff">="cuow"</span><span style="color: #0000ff">&gt;</span>{{ cuow.user.0 }}<span style="color: #0000ff">&lt;/</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span>     <span style="color: #008000">&lt;!--</span><span style="color: #008000"> 接收错误信息里的user的错误信息 </span><span style="color: #008000">--&gt;</span><span style="color: #000000">
        {% endif %}
    </span></span><span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span><span style="color: #000000; background-color: #ffff00">
        {{ form.pwd }}                                      </span><span style="color: #008000">&lt;!--</span><span style="color: #008000"> 接收get请求时创建的表单类，生成表单标签 </span><span style="color: #008000">--&gt;</span><span style="background-color: #ff99cc"><span style="color: #000000">
        {% if cuow.pwd.0 %}
            </span><span style="color: #0000ff">&lt;</span><span style="color: #800000">span </span><span style="color: #ff0000">class</span><span style="color: #0000ff">="cuow"</span><span style="color: #0000ff">&gt;</span>{{ cuow.pwd.0 }}<span style="color: #0000ff">&lt;/</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span>      <span style="color: #008000">&lt;!--</span><span style="color: #008000"> 接收错误信息里的pwd的错误信息 </span><span style="color: #008000">--&gt;</span><span style="color: #000000">
        {% endif %}
    </span></span><span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="submit"</span><span style="color: #ff0000"> value</span><span style="color: #0000ff">="提交"</span><span style="color: #0000ff">/&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">form</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">body</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">html</span><span style="color: #0000ff">&gt;</span></pre>
</div>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong>常用的内置验证字段</strong></span></p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">EmailField()</span>验证邮箱字段</strong></span><br><span style="color: #ff0000"><strong><span style="color: #0000ff">CharField()</span>验证字符串字段</strong></span><br><span style="color: #ff0000"><strong><span style="color: #0000ff">URLField()</span>验证url地址字段</strong></span><br><span style="color: #ff0000"><strong><span style="color: #0000ff">IntegerField()</span>验证数字字段</strong></span><br><span style="color: #ff0000"><strong><span style="color: #0000ff">GenericIPAddressField()</span>验证IP字段</strong></span></p>
<p><span style="color: #0000ff"><strong>注意：虽然有很多内置验证字段，但是我们还是要根据我们自己的需求来验证，所以</strong></span></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong>验证字段的参数</strong></span></p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">required</span>设置字段是否可以为空</strong></span><br><strong>	　　True不可以为空</strong><br><strong>	　　False可以为空</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user = forms.CharField(<span style="background-color: #ff99cc">required=True</span>)   <span style="color: #008000">#</span><span style="color: #008000">True不可以为空</span>
    pwd = forms.CharField()</pre>
</div>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">max_length</span>最大字符数</strong></span><br><span style="color: #ff0000"><strong><span style="color: #0000ff">min_length</span>最小字符数</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user = forms.CharField(<span style="background-color: #ff99cc">max_length=4</span>,<span style="background-color: #ff99cc">min_length=2</span><span style="color: #000000">)
    pwd </span>= forms.CharField()</pre>
</div>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">error_messages</span>自定义错误提示信息</strong></span><br><strong>　　参数是一个字典{'验证名称':'错误提示'}</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        <span style="background-color: #ffff00">required</span></span>=<span style="color: #000000">True,
        <span style="background-color: #ffff00">max_length</span></span>=4<span style="color: #000000">,
        <span style="background-color: #ffff00">min_length</span></span>=2<span style="color: #000000">,
<span style="background-color: #ff99cc">        error_messages</span></span><span style="background-color: #ff99cc">=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000; background-color: #ffff00">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000; background-color: #ffff00">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000; background-color: #ffff00">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span></span><span style="color: #000000"><span style="background-color: #ff99cc">
        }</span>
    )
    pwd </span>= forms.CharField()</pre>
</div>
<p><strong><span style="color: #0000ff">invalid</span>设置邮箱格式错误提示信息</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        required</span>=<span style="color: #000000">True,
        max_length</span>=4<span style="color: #000000">,
        min_length</span>=2<span style="color: #000000">,
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span><span style="color: #000000">
        }
    )
    pwd </span>=<span style="color: #000000"> forms.<span style="background-color: #ff99cc">EmailField</span>(
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>: <span style="color: #800000">'</span><span style="color: #800000">邮箱不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="background-color: #ff99cc"><span style="color: #800000">'</span><span style="color: #800000">invalid</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">邮箱格式不正确</span><span style="color: #800000">'</span></span><span style="color: #000000">
        }
    )</span></pre>
</div>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">widget</span>设置表单字段在html页面的类型</strong></span><br><strong>	　　使用方式：widget=forms.Textarea()</strong><br><strong>	　　Textarea(): &lt;textarea&gt;标签类型</strong><br><strong>	　　TextInput()：&lt;input&gt;标签类型</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        required</span>=<span style="color: #000000">True,
        max_length</span>=4<span style="color: #000000">,
        min_length</span>=2<span style="color: #000000">,
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span><span style="color: #000000">
        }
    )
    pwd </span>=<span style="color: #000000"> forms.CharField(
        <span style="background-color: #ff99cc">widget</span></span>=<span style="color: #000000">forms.<span style="background-color: #ff99cc">TextInput()</span>,
    )</span></pre>
</div>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">attrs</span>给表单标签设置属性，可以给标签元素设置class样式，和input标签的各种type属性</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        required</span>=<span style="color: #000000">True,
        max_length</span>=4<span style="color: #000000">,
        min_length</span>=2<span style="color: #000000">,
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span><span style="color: #000000">
        }
    )
    pwd </span>=<span style="color: #000000"> forms.CharField(
        widget</span>=forms.TextInput(<span style="background-color: #ff99cc">attrs={<span style="background-color: #ffff00"><span style="color: #800000">'</span><span style="color: #800000">type</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">password</span><span style="color: #800000">'</span></span>,<span style="background-color: #ffff00"><span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">c1</span><span style="color: #800000">'</span></span></span><span style="color: #000000"><span style="background-color: #ff99cc">}</span>),
    )</span></pre>
</div>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">Select</span>生成表单，select标签，下拉选项框</strong></span><br><strong>	　　参数:</strong><br><strong>		　　　　<span style="color: #0000ff">choices</span>设置下拉数据，元组类型</strong><br><strong>		　　　　<span style="color: #0000ff">attrs</span>设置select标签属性</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        required</span>=<span style="color: #000000">True,
        max_length</span>=4<span style="color: #000000">,
        min_length</span>=2<span style="color: #000000">,
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span><span style="color: #000000">
        }
    )

<span style="background-color: #ffff00">    zhi </span></span><span style="background-color: #ffff00">=<span style="color: #000000"> (
        (0, </span><span style="color: #800000">'</span><span style="color: #800000">普通会员</span><span style="color: #800000">'</span><span style="color: #000000">),
        (</span>1, <span style="color: #800000">'</span><span style="color: #800000">超级会员</span><span style="color: #800000">'</span><span style="color: #000000">),
        (</span>2, <span style="color: #800000">'</span><span style="color: #800000">黄金会员</span><span style="color: #800000">'</span><span style="color: #000000">),
        (</span>3, <span style="color: #800000">'</span><span style="color: #800000">白银会员</span><span style="color: #800000">'</span><span style="color: #000000">),
        (</span>4, <span style="color: #800000">'</span><span style="color: #800000">vip会员</span><span style="color: #800000">'</span></span><span style="color: #000000"><span style="background-color: #ffff00">)
    )</span>
    pwd </span>=<span style="color: #000000"> forms.CharField(
        widget</span>=forms.<span style="background-color: #ff99cc">widgets.Select(<span style="background-color: #ffff00">choices=zhi</span>,attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">c1</span><span style="color: #800000">'</span></span><span style="color: #000000"><span style="background-color: #ff99cc">})</span>
    )</span></pre>
</div>
<p><img src="https://images2015.cnblogs.com/blog/955761/201707/955761-20170717194742910-289353552.png" alt=""></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>下拉框结合数据库应用</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>
<span style="background-color: #ffff00"><span style="color: #0000ff">from</span> app1.models <span style="color: #0000ff">import</span> *</span>       <span style="color: #008000">#</span><span style="color: #008000">导入数据库操作</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        required</span>=<span style="color: #000000">True,
        max_length</span>=4<span style="color: #000000">,
        min_length</span>=2<span style="color: #000000">,
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span><span style="color: #000000">
        }
    )

    <span style="background-color: #ffff00">a </span></span><span style="background-color: #ffff00">= shengf.objects.all().values_list(<span style="color: #800000">'</span><span style="color: #800000">id</span><span style="color: #800000">'</span>,<span style="color: #800000">'</span><span style="color: #800000">shf</span><span style="color: #800000">'</span>) <span style="color: #008000">#</span><span style="color: #008000">获取数据库里shengf表里的id和shf字段的数据</span></span>
    pwd =<span style="color: #000000"> forms.CharField(
        widget</span>=forms.widgets.<span style="background-color: #ff99cc">Select(<span style="background-color: #ffff00">choices=a</span>,attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">c1</span><span style="color: #800000">'</span>})</span> <span style="color: #008000">#</span><span style="color: #008000">将数据库的数据显示到下拉框</span>
    )</pre>
</div>
<p>&nbsp;<img src="https://images2015.cnblogs.com/blog/955761/201707/955761-20170717194742910-289353552.png" alt=""></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>下拉框结合数据库应用，防止数据库添加了数据，或者删除了数据，页面缓存了下拉框数据，无法事实数据同步</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>
<span style="color: #0000ff">from</span> app1.models <span style="color: #0000ff">import</span> *       <span style="color: #008000">#</span><span style="color: #008000">导入数据库操作</span>

<span style="color: #0000ff">class</span> <span style="background-color: #ff99cc">yhbd</span>(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        required</span>=<span style="color: #000000">True,
        max_length</span>=4<span style="color: #000000">,
        min_length</span>=2<span style="color: #000000">,
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span><span style="color: #000000">
        }
    )

    a </span>= shengf.objects.all().values_list(<span style="color: #800000">'</span><span style="color: #800000">id</span><span style="color: #800000">'</span>,<span style="color: #800000">'</span><span style="color: #800000">shf</span><span style="color: #800000">'</span>) <span style="color: #008000">#</span><span style="color: #008000">获取数据库里shengf表里的id和shf字段的数据</span>
    <span style="background-color: #ff99cc">pwd</span> =<span style="color: #000000"> forms.CharField(
        widget</span>=forms.widgets.Select(choices=a,attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">c1</span><span style="color: #800000">'</span>}) <span style="color: #008000">#</span><span style="color: #008000">将数据库的数据显示到下拉框</span>
<span style="color: #000000">    )

    </span><span style="color: #008000">#</span><span style="color: #008000">防止数据库添加了数据，或者删除了数据，页面缓存了下拉框数据，无法事实数据同步</span>
    <span style="color: #0000ff">def</span> <span style="color: #800080">__init__</span>(self,*args, **kwargs):                                     <span style="color: #008000">#</span><span style="color: #008000">创建类的__init__方法，每次创建类时都会执行</span>
        super(<span style="background-color: #ff99cc">yhbd</span>,self).<span style="color: #800080">__init__</span>(*args, **kwargs)                          <span style="color: #008000">#</span><span style="color: #008000">获取当前类的父类里的__init__方法执行</span>
        a = shengf.objects.all().values_list(<span style="color: #800000">'</span><span style="color: #800000">id</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">shf</span><span style="color: #800000">'</span>)                   <span style="color: #008000">#</span><span style="color: #008000">重新获取数据库里shengf表里的id和shf字段的数据</span>
        self.fields[<span style="background-color: #ff99cc"><span style="color: #800000">'</span><span style="color: #800000">pwd</span><span style="color: #800000">'</span></span>] = forms.CharField(widget=forms.widgets.Select(choices=a,attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">c1</span><span style="color: #800000">'</span>}))  <span style="color: #008000">#</span><span style="color: #008000">更新一下表单pwd字段的数据</span></pre>
</div>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>自定义验证规则</strong></span></p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">validators</span>设置自定义验证规则，参数是一个列表，列表里是自定义验证方法名称</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>
<span style="color: #0000ff">from</span> django.core.exceptions <span style="color: #0000ff">import</span><span style="color: #000000"> ValidationError
</span><span style="color: #0000ff">import</span><span style="color: #000000"> re

</span><span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        required</span>=<span style="color: #000000">True,
        max_length</span>=4<span style="color: #000000">,
        min_length</span>=2<span style="color: #000000">,
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span><span style="color: #000000">
        }
    )


    </span><span style="color: #008000">#</span><span style="color: #008000">自定义验证规则</span>
<span style="background-color: #ffff00">    <span style="color: #0000ff">def</span><span style="color: #000000"> shouji(value):
        mobile_re </span>= re.compile(r<span style="color: #800000">'</span><span style="color: #800000">^(13[0-9]|15[012356789]|17[678]|18[0-9]|14[57])[0-9]{8}$</span><span style="color: #800000">'</span><span style="color: #000000">)
        </span><span style="color: #0000ff">if</span> <span style="color: #0000ff">not</span><span style="color: #000000"> mobile_re.match(value):
            </span><span style="color: #0000ff">raise</span> ValidationError(<span style="color: #800000">'</span><span style="color: #800000">手机号码格式错误</span><span style="color: #800000">'</span>)   <span style="color: #008000">#</span><span style="color: #008000">如果不匹配返回错误信息</span></span>
<span style="color: #000000">

    pwd </span>=<span style="color: #000000"> forms.CharField(
        <span style="background-color: #ffff00">validators</span></span><span style="background-color: #ffff00">=[shouji, ],   <span style="color: #008000">#</span><span style="color: #008000">设置自定义验证规则</span></span>
        required=<span style="color: #000000">True,
        widget</span>=<span style="color: #000000">forms.TextInput(
            attrs</span>=<span style="color: #000000">{
                </span><span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>: <span style="color: #800000">"</span><span style="color: #800000">cl</span><span style="color: #800000">"</span><span style="color: #000000">,
                </span><span style="color: #800000">'</span><span style="color: #800000">placeholder</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">手机号码</span><span style="color: #800000">'</span><span style="color: #000000">
            }
        ),
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">手机不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
        }
    )</span></pre>
</div>
<p><img src="https://images2015.cnblogs.com/blog/955761/201707/955761-20170717232723411-1592842803.png" alt=""></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>其他</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span>
<span style="color: #0000ff">import</span><span style="color: #000000"> re
</span><span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span><span style="color: #000000"> forms
</span><span style="color: #0000ff">from</span> django.core.exceptions <span style="color: #0000ff">import</span><span style="color: #000000"> ValidationError


</span><span style="color: #0000ff">def</span><span style="color: #000000"> mobile_validate(value):
    mobile_re </span>= re.compile(r<span style="color: #800000">'</span><span style="color: #800000">^(13[0-9]|15[012356789]|17[678]|18[0-9]|14[57])[0-9]{8}$</span><span style="color: #800000">'</span><span style="color: #000000">)
    </span><span style="color: #0000ff">if</span> <span style="color: #0000ff">not</span><span style="color: #000000"> mobile_re.match(value):
        </span><span style="color: #0000ff">raise</span> ValidationError(<span style="color: #800000">'</span><span style="color: #800000">手机号码格式错误</span><span style="color: #800000">'</span><span style="color: #000000">)


</span><span style="color: #0000ff">class</span><span style="color: #000000"> PublishForm(forms.Form):

    user_type_choice </span>=<span style="color: #000000"> (
        (0, u</span><span style="color: #800000">'</span><span style="color: #800000">普通用户</span><span style="color: #800000">'</span><span style="color: #000000">),
        (</span>1, u<span style="color: #800000">'</span><span style="color: #800000">高级用户</span><span style="color: #800000">'</span><span style="color: #000000">),
    )

    user_type </span>= forms.IntegerField(widget=forms.widgets.Select(choices=<span style="color: #000000">user_type_choice,
                                                                  attrs</span>={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>: <span style="color: #800000">"</span><span style="color: #800000">form-control</span><span style="color: #800000">"</span><span style="color: #000000">}))

    title </span>= forms.CharField(max_length=20<span style="color: #000000">,
                            min_length</span>=5<span style="color: #000000">,
                            error_messages</span>={<span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">标题不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
                                            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">标题最少为5个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
                                            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">标题最多为20个字符</span><span style="color: #800000">'</span><span style="color: #000000">},
                            widget</span>=forms.TextInput(attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>: <span style="color: #800000">"</span><span style="color: #800000">form-control</span><span style="color: #800000">"</span><span style="color: #000000">,
                                                          </span><span style="color: #800000">'</span><span style="color: #800000">placeholder</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">标题5-20个字符</span><span style="color: #800000">'</span><span style="color: #000000">}))

    memo </span>= forms.CharField(required=<span style="color: #000000">False,
                           max_length</span>=256<span style="color: #000000">,
                           widget</span>=forms.widgets.Textarea(attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>: <span style="color: #800000">"</span><span style="color: #800000">form-control no-radius</span><span style="color: #800000">"</span>, <span style="color: #800000">'</span><span style="color: #800000">placeholder</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">详细描述</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">rows</span><span style="color: #800000">'</span>: 3<span style="color: #000000">}))

    phone </span>= forms.CharField(validators=<span style="color: #000000">[mobile_validate, ],
                            error_messages</span>={<span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">手机不能为空</span><span style="color: #800000">'</span><span style="color: #000000">},
                            widget</span>=forms.TextInput(attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>: <span style="color: #800000">"</span><span style="color: #800000">form-control</span><span style="color: #800000">"</span><span style="color: #000000">,
                                                          </span><span style="color: #800000">'</span><span style="color: #800000">placeholder</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">手机号码</span><span style="color: #800000">'</span><span style="color: #000000">}))

    email </span>= forms.EmailField(required=<span style="color: #000000">False,
                            error_messages</span>={<span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">邮箱不能为空</span><span style="color: #800000">'</span>,<span style="color: #800000">'</span><span style="color: #800000">invalid</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">邮箱格式错误</span><span style="color: #800000">'</span><span style="color: #000000">},
                            widget</span>=forms.TextInput(attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>: <span style="color: #800000">"</span><span style="color: #800000">form-control</span><span style="color: #800000">"</span>, <span style="color: #800000">'</span><span style="color: #800000">placeholder</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">邮箱</span><span style="color: #800000">'</span>}))</pre>
</div>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>注意：如果表单是通过Ajax提交的，页面不刷新，那么html页面将无法获取到错误信息，那么我们只能将所有错误信息构造成字典，然后以json的方式返回给Ajax，添加到页面</strong></span></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>将models数据库表类转换成表单验证类【必要使用】</strong></span></p>
<p><span style="color: #000000"><strong>这样可以少写表单验证代码，使用的是数据库字段的验证规则</strong></span></p>
<p><span style="color: #ff0000"><strong>models.py</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">from</span> django.db <span style="color: #0000ff">import</span> models        <span style="color: #008000">#</span><span style="color: #008000"> 导入models对象</span>

<span style="color: #0000ff">class</span><span style="color: #000000"><span style="background-color: #ff99cc"> CourseOrg</span>(models.Model):
    <span style="background-color: #ff99cc">name </span></span><span style="background-color: #ff99cc">= models.CharField(max_length=50, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">机构名称</span><span style="color: #800000">'</span></span><span style="color: #000000"><span style="background-color: #ff99cc">)</span>
    desc </span>= models.TextField(verbose_name=<span style="color: #800000">'</span><span style="color: #800000">机构描述</span><span style="color: #800000">'</span><span style="color: #000000">)
    <span style="background-color: #ff99cc">category </span></span><span style="background-color: #ff99cc">= models.CharField(max_length=20, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">机构类别</span><span style="color: #800000">'</span>, default=<span style="color: #800000">'</span><span style="color: #800000">pxjg</span><span style="color: #800000">'</span>, choices=((<span style="color: #800000">'</span><span style="color: #800000">pxjg</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">培训机构</span><span style="color: #800000">'</span>), (<span style="color: #800000">'</span><span style="color: #800000">gx</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">高校</span><span style="color: #800000">'</span>), (<span style="color: #800000">'</span><span style="color: #800000">gr</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">个人</span><span style="color: #800000">'</span></span><span style="color: #000000"><span style="background-color: #ff99cc">)))</span>
    click </span>= models.IntegerField(default=0, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">点击数</span><span style="color: #800000">'</span><span style="color: #000000">)
    <span style="background-color: #ff99cc">fav_nums </span></span><span style="background-color: #ff99cc">= models.IntegerField(default=0, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">收藏数</span><span style="color: #800000">'</span></span><span style="color: #000000"><span style="background-color: #ff99cc">)</span>
    image </span>= models.ImageField(upload_to=<span style="color: #800000">'</span><span style="color: #800000">org/%Y/%m</span><span style="color: #800000">'</span>, storage=ImageStorage(), verbose_name=<span style="color: #800000">'</span><span style="color: #800000">封面图</span><span style="color: #800000">'</span>, max_length=100<span style="color: #000000">)
    address </span>= models.CharField(max_length=150, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">机构地址</span><span style="color: #800000">'</span><span style="color: #000000">)
    city </span>= models.ForeignKey(CityDict, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">外键城市表</span><span style="color: #800000">'</span><span style="color: #000000">)
    add_time </span>= models.DateTimeField(default=datetime.now, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">添加日期</span><span style="color: #800000">'</span><span style="color: #000000">)

    </span><span style="color: #0000ff">class</span><span style="color: #000000"> Meta:
        verbose_name </span>= <span style="color: #800000">'</span><span style="color: #800000">课程机构表</span><span style="color: #800000">'</span><span style="color: #000000">
        verbose_name_plural </span>=<span style="color: #000000"> verbose_name

    </span><span style="color: #0000ff">def</span> <span style="color: #800080">__str__</span><span style="color: #000000">(self):
        </span><span style="color: #0000ff">return</span> self.name</pre>
</div>
<p><span style="color: #ff0000"><strong>forms.py</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf8 -*-</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> <span style="background-color: #ff99cc">forms</span>                             <span style="color: #008000">#</span><span style="color: #008000"> 导入Django的表单验证模块</span>
<span style="color: #0000ff">from</span> app_organization.models <span style="color: #0000ff">import</span> <span style="background-color: #ff99cc"><strong>CourseOrg</strong></span>        <span style="color: #008000">#</span><span style="color: #008000"> 导入数据库表类</span>


<span style="color: #0000ff">class</span><span style="color: #000000"> CourseOrgForm(<span style="background-color: #ff99cc">forms.ModelForm</span>):
    zdyi </span>= forms.CharField()                         <span style="color: #008000">#</span><span style="color: #008000"> 自定义表单验证字段</span>

    <span style="color: #0000ff">class</span><span style="color: #000000"> Meta:
        model </span>= <span style="background-color: #ff99cc">CourseOrg</span>                            <span style="color: #008000">#</span><span style="color: #008000"> 设置要将数据库表类转换成表单验证类的名称</span>
        fields = [<span style="color: #800000">'</span><span style="color: #800000">name</span><span style="color: #800000">'</span>,<span style="color: #800000">'</span><span style="color: #800000">category</span><span style="color: #800000">'</span>,<span style="color: #800000">'</span><span style="color: #800000">fav_nums</span><span style="color: #800000">'</span>]      <span style="color: #008000">#</span><span style="color: #008000"> 要使用的字段</span></pre>
</div>
<p>&nbsp;</p></div>第三百一十一节，Django框架，Form表单验证


			<div id="cnblogs_post_body" class="blogpost-body"><p><strong>第三百一十一节，Django框架，Form表单验证</strong></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong>表单提交</strong></span></p>
<p><span style="color: #0000ff"><strong>html</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">&lt;!</span><span style="color: #ff00ff">DOCTYPE html</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">html </span><span style="color: #ff0000">lang</span><span style="color: #0000ff">="en"</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">head</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">meta </span><span style="color: #ff0000">charset</span><span style="color: #0000ff">="UTF-8"</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">title</span><span style="color: #0000ff">&gt;</span>Title<span style="color: #0000ff">&lt;/</span><span style="color: #800000">title</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">link </span><span style="color: #ff0000">rel</span><span style="color: #0000ff">="stylesheet"</span><span style="color: #ff0000"> type</span><span style="color: #0000ff">="text/css"</span><span style="color: #ff0000"> href</span><span style="color: #0000ff">="/static/css/tou.css"</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">head</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">body</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">form </span><span style="color: #ff0000">action</span><span style="color: #0000ff">="<span style="background-color: #ff99cc">/bug<span style="background-color: #ffff00">articles</span>/</span>"</span><span style="color: #ff0000"> method</span><span style="color: #0000ff">="post"</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="text"</span><span style="color: #ff0000"> name</span><span style="color: #0000ff">="user"</span><span style="color: #0000ff">/&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="text"</span><span style="color: #ff0000"> name</span><span style="color: #0000ff">="pwd"</span><span style="color: #0000ff">/&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="submit"</span><span style="color: #ff0000"> value</span><span style="color: #0000ff">="提交"</span><span style="color: #0000ff">/&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">form</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">body</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">html</span><span style="color: #0000ff">&gt;</span></pre>
</div>
<p><span style="color: #0000ff"><strong>路由映射</strong></span></p>
<div class="cnblogs_code">
<pre>urlpatterns =<span style="color: #000000"> [
    url(r</span><span style="color: #800000">'</span><span style="color: #800000">admin/</span><span style="color: #800000">'</span>, admin.site.urls),   <span style="color: #008000">#</span><span style="color: #008000">路由映射admin数据库管理</span>
    url(r<span style="color: #800000">'</span><span style="color: #800000"><span style="background-color: #ffff00">articles</span>/</span><span style="color: #800000">'</span><span style="color: #000000">, <span style="background-color: #ffff00">views.special</span>)    
]</span></pre>
</div>
<p><span style="color: #0000ff"><strong>逻辑处理</strong></span></p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">method</span>属性获取用户请求方式，post或者get</strong></span><br><strong>使用方式：请求对象.method</strong></p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">POST</span>获取用户post请求方式的信息</strong></span><br><strong>使用方式：请求对象.POST</strong></p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">POST.get()</span>获取用户POST请求方式的表单name名称对应的值，参数是表单name名</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">from</span> django.shortcuts <span style="color: #0000ff">import</span><span style="color: #000000"> render
</span><span style="color: #0000ff">from</span> app1.models <span style="color: #0000ff">import</span> *    <span style="color: #008000">#</span><span style="color: #008000">导入数据库操作模块</span>

<span style="color: #008000">#</span><span style="color: #008000">逻辑处理模块</span>
<span style="color: #0000ff">def</span><span style="color: #000000"><span style="background-color: #ffff00"> special</span>(request):  　　　　　　　　　　　　　 <span style="color: #008080">#自定义参数接收用户请求对象
    </span></span><span style="color: #0000ff">if</span> request.method == <span style="color: #800000">"</span><span style="color: #800000">POST</span><span style="color: #800000">"</span><span style="color: #000000">:　　　　　　　　 <span style="color: #008080">#判断用户请求如果是post方式
        </span></span><span style="color: #0000ff">print</span>(request.POST.get(<span style="color: #800000">'</span><span style="color: #800000">user</span><span style="color: #800000">'</span>,None))  <span style="color: #008000">#</span><span style="color: #008000">接收用户表单提交的name名称对应的值</span>
        <span style="color: #0000ff">print</span>(request.POST.get(<span style="color: #800000">'</span><span style="color: #800000">pwd</span><span style="color: #800000">'</span>, None))  <span style="color: #008000">#</span><span style="color: #008000">接收用户表单提交的name名称对应的值</span>
    <span style="color: #0000ff">return</span> render(request, <span style="color: #800000">'</span><span style="color: #800000">app1/index.html</span><span style="color: #800000">'</span>, locals())  <span style="color: #008000">#</span><span style="color: #008000"> 打开页面</span></pre>
</div>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong>表单提交验证，获取数据与获取错误信息</strong></span></p>
<p><span style="color: #000000"><strong>1、创建表单验证模块，必须继承</strong><span style="color: #0000ff"><strong>Django的表单验证forms.Form类</strong></span></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> <span style="background-color: #ff99cc">django <span style="color: #0000ff">import</span> forms</span>        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(<span style="background-color: #ff99cc">forms.Form</span>):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    <span style="background-color: #ff99cc">user</span> = forms.CharField()    <span style="color: #008000">#</span><span style="color: #008000">接收逻辑处理时，创建yhbd类时传进来的POST对象，里的表单name名对应的值进行验证</span>
    <span style="background-color: #ff99cc">pwd</span> = forms.CharField()     <span style="color: #008000">#</span><span style="color: #008000">#接收逻辑处理时，创建yhbd类时传进来的POST对象，里的表单name名对应的值进行验证</span></pre>
</div>
<p><strong>2、逻辑处理，创建表单验证模块里的验证类，并将用户请求的<span style="color: #0000ff">POST对象</span>，传入验证类进行验证，验证后获取验证通过的提交信息，或者验证没通过的错误信息</strong></p>
<p><span style="color: #0000ff"><strong>如果出现错误，将错误信息对象以字典方式传到html页面</strong></span></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">is_valid()</span>返回验证是否通过的布尔值</strong></span><br><strong>使用方式：验证类.is_valid()</strong></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">cleaned_data</span>获取验证通过后的所有提交数据，返回字典</strong></span><br><strong>使用方式：验证类.cleaned_data</strong></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">errors</span>获取验证错误信息，返回所有表单的错误信息对象</strong></span><br><strong>使用方法：验证类.errors</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">from</span> django.shortcuts <span style="color: #0000ff">import</span><span style="color: #000000"> render
</span><span style="color: #0000ff">from</span> app1.models <span style="color: #0000ff">import</span> *    <span style="color: #008000">#</span><span style="color: #008000">导入数据库操作模块</span>
<span style="color: #0000ff">from</span> app1.biaodan <span style="color: #0000ff">import</span> *   <span style="color: #008000">#</span><span style="color: #008000">导入自定义表单验证模块</span><span style="color: #008000">
#</span><span style="color: #008000">逻辑处理模块</span>
<span style="color: #0000ff">def</span><span style="color: #000000"> special(request):
    </span><span style="color: #0000ff">if</span> request.method == <span style="color: #800000">'</span><span style="color: #800000">GET</span><span style="color: #800000">'</span><span style="color: #000000">:
        </span><span style="color: #0000ff">return</span> render(request, <span style="color: #800000">'</span><span style="color: #800000">app1/index.html</span><span style="color: #800000">'</span>, locals())  <span style="color: #008000">#</span><span style="color: #008000"> 打开页面</span>

    <span style="background-color: #ff99cc"><span style="color: #0000ff">if</span> request.method == <span style="color: #800000">"</span><span style="color: #800000">POST</span><span style="color: #800000">"</span><span style="color: #000000">:
        </span></span><span style="color: #008000">#</span><span style="color: #008000"> print(request.POST.get('user',None))          #接收用户表单提交的name名称对应的值</span>
        <span style="color: #008000">#</span><span style="color: #008000"> print(request.POST.get('pwd', None))          #接收用户表单提交的name名称对应的值</span>
<span style="background-color: #ff99cc"><span style="color: #000000">
        f </span>= yhbd(request.POST)</span>                          <span style="color: #008000">#</span><span style="color: #008000">创建验证表单类，将用户请求POST对象传进表单验证类进行验证</span>

        <span style="color: #008000">#</span><span style="color: #008000"> ret = f.is_valid()                            #返回验证是否通过</span>
        <span style="color: #008000">#</span><span style="color: #008000"> print(ret)                                    #返回布尔值</span>

       <span style="background-color: #ff99cc"> <span style="color: #0000ff">if</span> f.is_valid():</span>                                <span style="color: #008000">#</span><span style="color: #008000">判断验证如果通过</span>
            <span style="background-color: #ff99cc"><span style="color: #0000ff">print</span>(f.cleaned_data)</span>                       <span style="color: #008000">#</span><span style="color: #008000">获取到用户提交信息,字典方式</span>
        <span style="color: #0000ff">else</span>:                                           <span style="color: #008000">#</span><span style="color: #008000">如果没通过</span>
            <span style="background-color: #ff99cc"><span style="color: #0000ff">print</span>(f.errors)</span>                             <span style="color: #008000">#</span><span style="color: #008000">获取错误对象</span>

        <span style="color: #0000ff">return</span> render(request, <span style="color: #800000">'</span><span style="color: #800000">app1/index.html</span><span style="color: #800000">'</span>,<span style="background-color: #ff99cc">{<span style="color: #800000">'</span><span style="color: #800000">cuow</span><span style="color: #800000">'</span>:f.errors}</span>)  <span style="color: #008000">#</span><span style="color: #008000"> 打开页面，将错误信息用字典方式传到html页面</span></pre>
</div>
<p><strong>3、在html页面接收逻辑处理<span style="color: #0000ff">以字典形式</span>传过来的错误对象，分别获取不同表单的错误信息</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">&lt;!</span><span style="color: #ff00ff">DOCTYPE html</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">html </span><span style="color: #ff0000">lang</span><span style="color: #0000ff">="en"</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">head</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">meta </span><span style="color: #ff0000">charset</span><span style="color: #0000ff">="UTF-8"</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">title</span><span style="color: #0000ff">&gt;</span>Title<span style="color: #0000ff">&lt;/</span><span style="color: #800000">title</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">link </span><span style="color: #ff0000">rel</span><span style="color: #0000ff">="stylesheet"</span><span style="color: #ff0000"> type</span><span style="color: #0000ff">="text/css"</span><span style="color: #ff0000"> href</span><span style="color: #0000ff">="/static/css/tou.css"</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">head</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">body</span><span style="color: #0000ff">&gt;</span>

<span style="color: #0000ff">&lt;</span><span style="color: #800000">form </span><span style="color: #ff0000">action</span><span style="color: #0000ff">="/bugarticles/"</span><span style="color: #ff0000"> method</span><span style="color: #0000ff">="post"</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="text"</span><span style="color: #ff0000"> name</span><span style="color: #0000ff">="user"</span><span style="color: #0000ff">/&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span><span style="background-color: #ff99cc">{{ cuow.user.0 }}</span><span style="color: #0000ff">&lt;/</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span>     <span style="color: #008000">&lt;!--</span><span style="color: #008000"> 接收错误信息里的user的错误信息 </span><span style="color: #008000">--&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="text"</span><span style="color: #ff0000"> name</span><span style="color: #0000ff">="pwd"</span><span style="color: #0000ff">/&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span><span style="background-color: #ff99cc">{{ cuow.pwd.0 }}</span><span style="color: #0000ff">&lt;/</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span>      <span style="color: #008000">&lt;!--</span><span style="color: #008000"> 接收错误信息里的pwd的错误信息 </span><span style="color: #008000">--&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="submit"</span><span style="color: #ff0000"> value</span><span style="color: #0000ff">="提交"</span><span style="color: #0000ff">/&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">form</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">body</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">html</span><span style="color: #0000ff">&gt;</span></pre>
</div>
<p>&nbsp;<img src="https://images2015.cnblogs.com/blog/955761/201707/955761-20170716170032722-817776133.png" alt=""></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong>利用表单类自动创建表单标签</strong></span></p>
<p><span style="background-color: #ffffff"><strong>以上表单的&lt;input&gt;是我们自己手动写的，还可以用表单类来自动创建表单标签，好处是不用自己写表单标签，还有就是当用户填写的表单不合法提交时提示错误信息不清空表单</strong></span></p>
<p>&nbsp;</p>
<p><span style="background-color: #ffff00; color: #0000ff"><strong>注意：表单类根据字段创建的表单标签，当用户输入内容时，首先要经过浏览器默认行为的表单验证，如果浏览器<strong>默认行为的表单验证都没有通过那么将无法提交</strong></strong></span></p>
<p><span style="background-color: #ffff00; color: #0000ff"><strong><strong><strong>浏览器<strong>默认行为的表单验证，通过了在进行我们定义的表单类验证，验证合法获取用户提交信息，不合法返回错误信息</strong></strong></strong></strong></span></p>
<p><span style="background-color: #ffffff; color: #0000ff"><strong><strong><strong><strong>利用表单类自动创建表单标签</strong></strong></strong></strong></span></p>
<p><span style="background-color: #ffffff"><strong><strong><strong><strong>1、首先在get访问页面时，创建表单类不传参数，然后把这个表单类传到html页面，在html页面通过，<span style="color: #ff0000">表单类.字段名称</span>，来自动创建表单标签</strong></strong></strong></strong></span></p>
<p><span style="background-color: #ffffff"><strong><strong><strong><strong>　　每一种表单字段类型，都有一个默认的表单标签，这个标签是可以更改的，所以表单类可以创建任何表单标签</strong></strong></strong></strong></span></p>
<p><span style="background-color: #ffffff"><strong><strong><strong><strong>2、在post访问时，再次创建表单类需要传参，将post请求对象传入表单类进行验证表单，如果表单不合法，将错误信息对象传到html显示错误信息，将这次创建的表单类传到html页面替换get时创建的表单类</strong></strong></strong></strong></span></p>
<p><span style="color: #0000ff; background-color: #ffffff"><strong>逻辑处理</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">from</span> django.shortcuts <span style="color: #0000ff">import</span><span style="color: #000000"> render
</span><span style="color: #0000ff">from</span> app1.models <span style="color: #0000ff">import</span> *    <span style="color: #008000">#</span><span style="color: #008000">导入数据库操作模块</span>
<span style="color: #0000ff">from</span> app1.biaodan <span style="color: #0000ff">import</span> *   <span style="color: #008000">#</span><span style="color: #008000">导入自定义表单验证模块</span><span style="color: #008000">
#</span><span style="color: #008000">逻辑处理模块</span>
<span style="color: #0000ff">def</span><span style="color: #000000"> special(request):
    </span><span style="color: #0000ff">if</span> request.method == <span style="color: #800000">'</span><span style="color: #800000; background-color: #ffff00">GET</span><span style="color: #800000">'</span><span style="color: #000000">:
        <span style="background-color: #ffff00">f </span></span><span style="background-color: #ffff00">= yhbd()</span>                                            <span style="color: #008000">#</span><span style="color: #008000">创建表单验证类，不传参</span>
        <span style="color: #0000ff">return</span> render(request, <span style="color: #800000">'</span><span style="color: #800000">app1/index.html</span><span style="color: #800000">'</span>,{<span style="background-color: #ffff00"><span style="color: #800000">'</span><span style="color: #800000">form</span><span style="color: #800000">'</span>:f</span>})  <span style="color: #008000">#</span><span style="color: #008000"> 打开页面，并将表单验证类传到html生成表单标签</span>

    <span style="color: #0000ff">if</span> request.method == <span style="color: #800000">"</span><span style="color: #800000; background-color: #ff99cc">POST</span><span style="color: #800000">"</span><span style="color: #000000">:
        <span style="background-color: #ff99cc">f </span></span><span style="background-color: #ff99cc">= yhbd(request.POST)</span>                          <span style="color: #008000">#</span><span style="color: #008000">创建验证表单类，将用户请求POST对象传进表单验证类进行验证</span>

        <span style="background-color: #ff99cc"><span style="color: #0000ff">if</span> f.is_valid():</span>                                <span style="color: #008000">#</span><span style="color: #008000">判断验证如果通过</span>
            <span style="background-color: #ff99cc"><span style="color: #0000ff">print</span>(f.cleaned_data)</span>                       <span style="color: #008000">#</span><span style="color: #008000">获取到用户提交信息,字典方式</span>
        <span style="color: #0000ff">else</span>:                                           <span style="color: #008000">#</span><span style="color: #008000">如果没通过</span>
            <span style="color: #008000">#</span><span style="color: #008000"><span style="background-color: #ff99cc"> print(f.errors)</span>                           #获取错误对象</span>
            <span style="color: #0000ff">pass</span>

        <span style="color: #0000ff">return</span> render(request, <span style="color: #800000">'</span><span style="color: #800000">app1/index.html</span><span style="color: #800000">'</span>,{<span style="background-color: #ff99cc"><span style="color: #800000">'</span><span style="color: #800000">cuow</span><span style="color: #800000">'</span>:f.errors</span>,<span style="background-color: #ff99cc"><span style="color: #800000">'</span><span style="color: #800000">form</span><span style="color: #800000">'</span>:f</span>})  <span style="color: #008000">#</span><span style="color: #008000"> 打开页面，将错误信息用字典方式传到html页面，并且将表单类传到html页面替换没传参的表单验证类</span></pre>
</div>
<p><span style="color: #0000ff"><strong>html</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">&lt;!</span><span style="color: #ff00ff">DOCTYPE html</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">html </span><span style="color: #ff0000">lang</span><span style="color: #0000ff">="en"</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">head</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">meta </span><span style="color: #ff0000">charset</span><span style="color: #0000ff">="UTF-8"</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">title</span><span style="color: #0000ff">&gt;</span>Title<span style="color: #0000ff">&lt;/</span><span style="color: #800000">title</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">link </span><span style="color: #ff0000">rel</span><span style="color: #0000ff">="stylesheet"</span><span style="color: #ff0000"> type</span><span style="color: #0000ff">="text/css"</span><span style="color: #ff0000"> href</span><span style="color: #0000ff">="/static/css/tou.css"</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">head</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">body</span><span style="color: #0000ff">&gt;</span>

<span style="color: #0000ff">&lt;</span><span style="color: #800000">form </span><span style="color: #ff0000">action</span><span style="color: #0000ff">="/bugarticles/"</span><span style="color: #ff0000"> method</span><span style="color: #0000ff">="post"</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span><span style="color: #000000; background-color: #ffff00">
        {{ form.user }}                                     </span><span style="color: #008000">&lt;!--</span><span style="color: #008000"> 接收get请求时创建的表单类，生成表单标签 </span><span style="color: #008000">--&gt;</span><span style="background-color: #ff99cc"><span style="color: #000000">
        {% if cuow.user.0 %}
            </span><span style="color: #0000ff">&lt;</span><span style="color: #800000">span </span><span style="color: #ff0000">class</span><span style="color: #0000ff">="cuow"</span><span style="color: #0000ff">&gt;</span>{{ cuow.user.0 }}<span style="color: #0000ff">&lt;/</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span>     <span style="color: #008000">&lt;!--</span><span style="color: #008000"> 接收错误信息里的user的错误信息 </span><span style="color: #008000">--&gt;</span><span style="color: #000000">
        {% endif %}
    </span></span><span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span><span style="color: #000000; background-color: #ffff00">
        {{ form.pwd }}                                      </span><span style="color: #008000">&lt;!--</span><span style="color: #008000"> 接收get请求时创建的表单类，生成表单标签 </span><span style="color: #008000">--&gt;</span><span style="background-color: #ff99cc"><span style="color: #000000">
        {% if cuow.pwd.0 %}
            </span><span style="color: #0000ff">&lt;</span><span style="color: #800000">span </span><span style="color: #ff0000">class</span><span style="color: #0000ff">="cuow"</span><span style="color: #0000ff">&gt;</span>{{ cuow.pwd.0 }}<span style="color: #0000ff">&lt;/</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span>      <span style="color: #008000">&lt;!--</span><span style="color: #008000"> 接收错误信息里的pwd的错误信息 </span><span style="color: #008000">--&gt;</span><span style="color: #000000">
        {% endif %}
    </span></span><span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="submit"</span><span style="color: #ff0000"> value</span><span style="color: #0000ff">="提交"</span><span style="color: #0000ff">/&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">form</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">body</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">html</span><span style="color: #0000ff">&gt;</span></pre>
</div>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong>常用的内置验证字段</strong></span></p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">EmailField()</span>验证邮箱字段</strong></span><br><span style="color: #ff0000"><strong><span style="color: #0000ff">CharField()</span>验证字符串字段</strong></span><br><span style="color: #ff0000"><strong><span style="color: #0000ff">URLField()</span>验证url地址字段</strong></span><br><span style="color: #ff0000"><strong><span style="color: #0000ff">IntegerField()</span>验证数字字段</strong></span><br><span style="color: #ff0000"><strong><span style="color: #0000ff">GenericIPAddressField()</span>验证IP字段</strong></span></p>
<p><span style="color: #0000ff"><strong>注意：虽然有很多内置验证字段，但是我们还是要根据我们自己的需求来验证，所以</strong></span></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong>验证字段的参数</strong></span></p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">required</span>设置字段是否可以为空</strong></span><br><strong>	　　True不可以为空</strong><br><strong>	　　False可以为空</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user = forms.CharField(<span style="background-color: #ff99cc">required=True</span>)   <span style="color: #008000">#</span><span style="color: #008000">True不可以为空</span>
    pwd = forms.CharField()</pre>
</div>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">max_length</span>最大字符数</strong></span><br><span style="color: #ff0000"><strong><span style="color: #0000ff">min_length</span>最小字符数</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user = forms.CharField(<span style="background-color: #ff99cc">max_length=4</span>,<span style="background-color: #ff99cc">min_length=2</span><span style="color: #000000">)
    pwd </span>= forms.CharField()</pre>
</div>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">error_messages</span>自定义错误提示信息</strong></span><br><strong>　　参数是一个字典{'验证名称':'错误提示'}</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        <span style="background-color: #ffff00">required</span></span>=<span style="color: #000000">True,
        <span style="background-color: #ffff00">max_length</span></span>=4<span style="color: #000000">,
        <span style="background-color: #ffff00">min_length</span></span>=2<span style="color: #000000">,
<span style="background-color: #ff99cc">        error_messages</span></span><span style="background-color: #ff99cc">=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000; background-color: #ffff00">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000; background-color: #ffff00">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000; background-color: #ffff00">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span></span><span style="color: #000000"><span style="background-color: #ff99cc">
        }</span>
    )
    pwd </span>= forms.CharField()</pre>
</div>
<p><strong><span style="color: #0000ff">invalid</span>设置邮箱格式错误提示信息</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        required</span>=<span style="color: #000000">True,
        max_length</span>=4<span style="color: #000000">,
        min_length</span>=2<span style="color: #000000">,
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span><span style="color: #000000">
        }
    )
    pwd </span>=<span style="color: #000000"> forms.<span style="background-color: #ff99cc">EmailField</span>(
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>: <span style="color: #800000">'</span><span style="color: #800000">邮箱不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="background-color: #ff99cc"><span style="color: #800000">'</span><span style="color: #800000">invalid</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">邮箱格式不正确</span><span style="color: #800000">'</span></span><span style="color: #000000">
        }
    )</span></pre>
</div>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">widget</span>设置表单字段在html页面的类型</strong></span><br><strong>	　　使用方式：widget=forms.Textarea()</strong><br><strong>	　　Textarea(): &lt;textarea&gt;标签类型</strong><br><strong>	　　TextInput()：&lt;input&gt;标签类型</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        required</span>=<span style="color: #000000">True,
        max_length</span>=4<span style="color: #000000">,
        min_length</span>=2<span style="color: #000000">,
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span><span style="color: #000000">
        }
    )
    pwd </span>=<span style="color: #000000"> forms.CharField(
        <span style="background-color: #ff99cc">widget</span></span>=<span style="color: #000000">forms.<span style="background-color: #ff99cc">TextInput()</span>,
    )</span></pre>
</div>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">attrs</span>给表单标签设置属性，可以给标签元素设置class样式，和input标签的各种type属性</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        required</span>=<span style="color: #000000">True,
        max_length</span>=4<span style="color: #000000">,
        min_length</span>=2<span style="color: #000000">,
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span><span style="color: #000000">
        }
    )
    pwd </span>=<span style="color: #000000"> forms.CharField(
        widget</span>=forms.TextInput(<span style="background-color: #ff99cc">attrs={<span style="background-color: #ffff00"><span style="color: #800000">'</span><span style="color: #800000">type</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">password</span><span style="color: #800000">'</span></span>,<span style="background-color: #ffff00"><span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">c1</span><span style="color: #800000">'</span></span></span><span style="color: #000000"><span style="background-color: #ff99cc">}</span>),
    )</span></pre>
</div>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">Select</span>生成表单，select标签，下拉选项框</strong></span><br><strong>	　　参数:</strong><br><strong>		　　　　<span style="color: #0000ff">choices</span>设置下拉数据，元组类型</strong><br><strong>		　　　　<span style="color: #0000ff">attrs</span>设置select标签属性</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        required</span>=<span style="color: #000000">True,
        max_length</span>=4<span style="color: #000000">,
        min_length</span>=2<span style="color: #000000">,
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span><span style="color: #000000">
        }
    )

<span style="background-color: #ffff00">    zhi </span></span><span style="background-color: #ffff00">=<span style="color: #000000"> (
        (0, </span><span style="color: #800000">'</span><span style="color: #800000">普通会员</span><span style="color: #800000">'</span><span style="color: #000000">),
        (</span>1, <span style="color: #800000">'</span><span style="color: #800000">超级会员</span><span style="color: #800000">'</span><span style="color: #000000">),
        (</span>2, <span style="color: #800000">'</span><span style="color: #800000">黄金会员</span><span style="color: #800000">'</span><span style="color: #000000">),
        (</span>3, <span style="color: #800000">'</span><span style="color: #800000">白银会员</span><span style="color: #800000">'</span><span style="color: #000000">),
        (</span>4, <span style="color: #800000">'</span><span style="color: #800000">vip会员</span><span style="color: #800000">'</span></span><span style="color: #000000"><span style="background-color: #ffff00">)
    )</span>
    pwd </span>=<span style="color: #000000"> forms.CharField(
        widget</span>=forms.<span style="background-color: #ff99cc">widgets.Select(<span style="background-color: #ffff00">choices=zhi</span>,attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">c1</span><span style="color: #800000">'</span></span><span style="color: #000000"><span style="background-color: #ff99cc">})</span>
    )</span></pre>
</div>
<p><img src="https://images2015.cnblogs.com/blog/955761/201707/955761-20170717194742910-289353552.png" alt=""></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>下拉框结合数据库应用</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>
<span style="background-color: #ffff00"><span style="color: #0000ff">from</span> app1.models <span style="color: #0000ff">import</span> *</span>       <span style="color: #008000">#</span><span style="color: #008000">导入数据库操作</span>

<span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        required</span>=<span style="color: #000000">True,
        max_length</span>=4<span style="color: #000000">,
        min_length</span>=2<span style="color: #000000">,
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span><span style="color: #000000">
        }
    )

    <span style="background-color: #ffff00">a </span></span><span style="background-color: #ffff00">= shengf.objects.all().values_list(<span style="color: #800000">'</span><span style="color: #800000">id</span><span style="color: #800000">'</span>,<span style="color: #800000">'</span><span style="color: #800000">shf</span><span style="color: #800000">'</span>) <span style="color: #008000">#</span><span style="color: #008000">获取数据库里shengf表里的id和shf字段的数据</span></span>
    pwd =<span style="color: #000000"> forms.CharField(
        widget</span>=forms.widgets.<span style="background-color: #ff99cc">Select(<span style="background-color: #ffff00">choices=a</span>,attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">c1</span><span style="color: #800000">'</span>})</span> <span style="color: #008000">#</span><span style="color: #008000">将数据库的数据显示到下拉框</span>
    )</pre>
</div>
<p>&nbsp;<img src="https://images2015.cnblogs.com/blog/955761/201707/955761-20170717194742910-289353552.png" alt=""></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>下拉框结合数据库应用，防止数据库添加了数据，或者删除了数据，页面缓存了下拉框数据，无法事实数据同步</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>
<span style="color: #0000ff">from</span> app1.models <span style="color: #0000ff">import</span> *       <span style="color: #008000">#</span><span style="color: #008000">导入数据库操作</span>

<span style="color: #0000ff">class</span> <span style="background-color: #ff99cc">yhbd</span>(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        required</span>=<span style="color: #000000">True,
        max_length</span>=4<span style="color: #000000">,
        min_length</span>=2<span style="color: #000000">,
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span><span style="color: #000000">
        }
    )

    a </span>= shengf.objects.all().values_list(<span style="color: #800000">'</span><span style="color: #800000">id</span><span style="color: #800000">'</span>,<span style="color: #800000">'</span><span style="color: #800000">shf</span><span style="color: #800000">'</span>) <span style="color: #008000">#</span><span style="color: #008000">获取数据库里shengf表里的id和shf字段的数据</span>
    <span style="background-color: #ff99cc">pwd</span> =<span style="color: #000000"> forms.CharField(
        widget</span>=forms.widgets.Select(choices=a,attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">c1</span><span style="color: #800000">'</span>}) <span style="color: #008000">#</span><span style="color: #008000">将数据库的数据显示到下拉框</span>
<span style="color: #000000">    )

    </span><span style="color: #008000">#</span><span style="color: #008000">防止数据库添加了数据，或者删除了数据，页面缓存了下拉框数据，无法事实数据同步</span>
    <span style="color: #0000ff">def</span> <span style="color: #800080">__init__</span>(self,*args, **kwargs):                                     <span style="color: #008000">#</span><span style="color: #008000">创建类的__init__方法，每次创建类时都会执行</span>
        super(<span style="background-color: #ff99cc">yhbd</span>,self).<span style="color: #800080">__init__</span>(*args, **kwargs)                          <span style="color: #008000">#</span><span style="color: #008000">获取当前类的父类里的__init__方法执行</span>
        a = shengf.objects.all().values_list(<span style="color: #800000">'</span><span style="color: #800000">id</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">shf</span><span style="color: #800000">'</span>)                   <span style="color: #008000">#</span><span style="color: #008000">重新获取数据库里shengf表里的id和shf字段的数据</span>
        self.fields[<span style="background-color: #ff99cc"><span style="color: #800000">'</span><span style="color: #800000">pwd</span><span style="color: #800000">'</span></span>] = forms.CharField(widget=forms.widgets.Select(choices=a,attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">c1</span><span style="color: #800000">'</span>}))  <span style="color: #008000">#</span><span style="color: #008000">更新一下表单pwd字段的数据</span></pre>
</div>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>自定义验证规则</strong></span></p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">validators</span>设置自定义验证规则，参数是一个列表，列表里是自定义验证方法名称</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span><span style="color: #008000">
#</span><span style="color: #008000">表单验证</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> forms        <span style="color: #008000">#</span><span style="color: #008000">导入Django的表单验证模块</span>
<span style="color: #0000ff">from</span> django.core.exceptions <span style="color: #0000ff">import</span><span style="color: #000000"> ValidationError
</span><span style="color: #0000ff">import</span><span style="color: #000000"> re

</span><span style="color: #0000ff">class</span> yhbd(forms.Form):         <span style="color: #008000">#</span><span style="color: #008000">自定义验证表单类，继承Django的表单验证类</span>
    user =<span style="color: #000000"> forms.CharField(
        required</span>=<span style="color: #000000">True,
        max_length</span>=4<span style="color: #000000">,
        min_length</span>=2<span style="color: #000000">,
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">用户名不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最大长度不得超过4个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">最小长度不得少于2个字符</span><span style="color: #800000">'</span><span style="color: #000000">
        }
    )


    </span><span style="color: #008000">#</span><span style="color: #008000">自定义验证规则</span>
<span style="background-color: #ffff00">    <span style="color: #0000ff">def</span><span style="color: #000000"> shouji(value):
        mobile_re </span>= re.compile(r<span style="color: #800000">'</span><span style="color: #800000">^(13[0-9]|15[012356789]|17[678]|18[0-9]|14[57])[0-9]{8}$</span><span style="color: #800000">'</span><span style="color: #000000">)
        </span><span style="color: #0000ff">if</span> <span style="color: #0000ff">not</span><span style="color: #000000"> mobile_re.match(value):
            </span><span style="color: #0000ff">raise</span> ValidationError(<span style="color: #800000">'</span><span style="color: #800000">手机号码格式错误</span><span style="color: #800000">'</span>)   <span style="color: #008000">#</span><span style="color: #008000">如果不匹配返回错误信息</span></span>
<span style="color: #000000">

    pwd </span>=<span style="color: #000000"> forms.CharField(
        <span style="background-color: #ffff00">validators</span></span><span style="background-color: #ffff00">=[shouji, ],   <span style="color: #008000">#</span><span style="color: #008000">设置自定义验证规则</span></span>
        required=<span style="color: #000000">True,
        widget</span>=<span style="color: #000000">forms.TextInput(
            attrs</span>=<span style="color: #000000">{
                </span><span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>: <span style="color: #800000">"</span><span style="color: #800000">cl</span><span style="color: #800000">"</span><span style="color: #000000">,
                </span><span style="color: #800000">'</span><span style="color: #800000">placeholder</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">手机号码</span><span style="color: #800000">'</span><span style="color: #000000">
            }
        ),
        error_messages</span>=<span style="color: #000000">{
            </span><span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">手机不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
        }
    )</span></pre>
</div>
<p><img src="https://images2015.cnblogs.com/blog/955761/201707/955761-20170717232723411-1592842803.png" alt=""></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>其他</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span>
<span style="color: #0000ff">import</span><span style="color: #000000"> re
</span><span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span><span style="color: #000000"> forms
</span><span style="color: #0000ff">from</span> django.core.exceptions <span style="color: #0000ff">import</span><span style="color: #000000"> ValidationError


</span><span style="color: #0000ff">def</span><span style="color: #000000"> mobile_validate(value):
    mobile_re </span>= re.compile(r<span style="color: #800000">'</span><span style="color: #800000">^(13[0-9]|15[012356789]|17[678]|18[0-9]|14[57])[0-9]{8}$</span><span style="color: #800000">'</span><span style="color: #000000">)
    </span><span style="color: #0000ff">if</span> <span style="color: #0000ff">not</span><span style="color: #000000"> mobile_re.match(value):
        </span><span style="color: #0000ff">raise</span> ValidationError(<span style="color: #800000">'</span><span style="color: #800000">手机号码格式错误</span><span style="color: #800000">'</span><span style="color: #000000">)


</span><span style="color: #0000ff">class</span><span style="color: #000000"> PublishForm(forms.Form):

    user_type_choice </span>=<span style="color: #000000"> (
        (0, u</span><span style="color: #800000">'</span><span style="color: #800000">普通用户</span><span style="color: #800000">'</span><span style="color: #000000">),
        (</span>1, u<span style="color: #800000">'</span><span style="color: #800000">高级用户</span><span style="color: #800000">'</span><span style="color: #000000">),
    )

    user_type </span>= forms.IntegerField(widget=forms.widgets.Select(choices=<span style="color: #000000">user_type_choice,
                                                                  attrs</span>={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>: <span style="color: #800000">"</span><span style="color: #800000">form-control</span><span style="color: #800000">"</span><span style="color: #000000">}))

    title </span>= forms.CharField(max_length=20<span style="color: #000000">,
                            min_length</span>=5<span style="color: #000000">,
                            error_messages</span>={<span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">标题不能为空</span><span style="color: #800000">'</span><span style="color: #000000">,
                                            </span><span style="color: #800000">'</span><span style="color: #800000">min_length</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">标题最少为5个字符</span><span style="color: #800000">'</span><span style="color: #000000">,
                                            </span><span style="color: #800000">'</span><span style="color: #800000">max_length</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">标题最多为20个字符</span><span style="color: #800000">'</span><span style="color: #000000">},
                            widget</span>=forms.TextInput(attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>: <span style="color: #800000">"</span><span style="color: #800000">form-control</span><span style="color: #800000">"</span><span style="color: #000000">,
                                                          </span><span style="color: #800000">'</span><span style="color: #800000">placeholder</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">标题5-20个字符</span><span style="color: #800000">'</span><span style="color: #000000">}))

    memo </span>= forms.CharField(required=<span style="color: #000000">False,
                           max_length</span>=256<span style="color: #000000">,
                           widget</span>=forms.widgets.Textarea(attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>: <span style="color: #800000">"</span><span style="color: #800000">form-control no-radius</span><span style="color: #800000">"</span>, <span style="color: #800000">'</span><span style="color: #800000">placeholder</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">详细描述</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">rows</span><span style="color: #800000">'</span>: 3<span style="color: #000000">}))

    phone </span>= forms.CharField(validators=<span style="color: #000000">[mobile_validate, ],
                            error_messages</span>={<span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">手机不能为空</span><span style="color: #800000">'</span><span style="color: #000000">},
                            widget</span>=forms.TextInput(attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>: <span style="color: #800000">"</span><span style="color: #800000">form-control</span><span style="color: #800000">"</span><span style="color: #000000">,
                                                          </span><span style="color: #800000">'</span><span style="color: #800000">placeholder</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">手机号码</span><span style="color: #800000">'</span><span style="color: #000000">}))

    email </span>= forms.EmailField(required=<span style="color: #000000">False,
                            error_messages</span>={<span style="color: #800000">'</span><span style="color: #800000">required</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">邮箱不能为空</span><span style="color: #800000">'</span>,<span style="color: #800000">'</span><span style="color: #800000">invalid</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">邮箱格式错误</span><span style="color: #800000">'</span><span style="color: #000000">},
                            widget</span>=forms.TextInput(attrs={<span style="color: #800000">'</span><span style="color: #800000">class</span><span style="color: #800000">'</span>: <span style="color: #800000">"</span><span style="color: #800000">form-control</span><span style="color: #800000">"</span>, <span style="color: #800000">'</span><span style="color: #800000">placeholder</span><span style="color: #800000">'</span>: u<span style="color: #800000">'</span><span style="color: #800000">邮箱</span><span style="color: #800000">'</span>}))</pre>
</div>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>注意：如果表单是通过Ajax提交的，页面不刷新，那么html页面将无法获取到错误信息，那么我们只能将所有错误信息构造成字典，然后以json的方式返回给Ajax，添加到页面</strong></span></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>将models数据库表类转换成表单验证类【必要使用】</strong></span></p>
<p><span style="color: #000000"><strong>这样可以少写表单验证代码，使用的是数据库字段的验证规则</strong></span></p>
<p><span style="color: #ff0000"><strong>models.py</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">from</span> django.db <span style="color: #0000ff">import</span> models        <span style="color: #008000">#</span><span style="color: #008000"> 导入models对象</span>

<span style="color: #0000ff">class</span><span style="color: #000000"><span style="background-color: #ff99cc"> CourseOrg</span>(models.Model):
    <span style="background-color: #ff99cc">name </span></span><span style="background-color: #ff99cc">= models.CharField(max_length=50, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">机构名称</span><span style="color: #800000">'</span></span><span style="color: #000000"><span style="background-color: #ff99cc">)</span>
    desc </span>= models.TextField(verbose_name=<span style="color: #800000">'</span><span style="color: #800000">机构描述</span><span style="color: #800000">'</span><span style="color: #000000">)
    <span style="background-color: #ff99cc">category </span></span><span style="background-color: #ff99cc">= models.CharField(max_length=20, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">机构类别</span><span style="color: #800000">'</span>, default=<span style="color: #800000">'</span><span style="color: #800000">pxjg</span><span style="color: #800000">'</span>, choices=((<span style="color: #800000">'</span><span style="color: #800000">pxjg</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">培训机构</span><span style="color: #800000">'</span>), (<span style="color: #800000">'</span><span style="color: #800000">gx</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">高校</span><span style="color: #800000">'</span>), (<span style="color: #800000">'</span><span style="color: #800000">gr</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">个人</span><span style="color: #800000">'</span></span><span style="color: #000000"><span style="background-color: #ff99cc">)))</span>
    click </span>= models.IntegerField(default=0, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">点击数</span><span style="color: #800000">'</span><span style="color: #000000">)
    <span style="background-color: #ff99cc">fav_nums </span></span><span style="background-color: #ff99cc">= models.IntegerField(default=0, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">收藏数</span><span style="color: #800000">'</span></span><span style="color: #000000"><span style="background-color: #ff99cc">)</span>
    image </span>= models.ImageField(upload_to=<span style="color: #800000">'</span><span style="color: #800000">org/%Y/%m</span><span style="color: #800000">'</span>, storage=ImageStorage(), verbose_name=<span style="color: #800000">'</span><span style="color: #800000">封面图</span><span style="color: #800000">'</span>, max_length=100<span style="color: #000000">)
    address </span>= models.CharField(max_length=150, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">机构地址</span><span style="color: #800000">'</span><span style="color: #000000">)
    city </span>= models.ForeignKey(CityDict, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">外键城市表</span><span style="color: #800000">'</span><span style="color: #000000">)
    add_time </span>= models.DateTimeField(default=datetime.now, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">添加日期</span><span style="color: #800000">'</span><span style="color: #000000">)

    </span><span style="color: #0000ff">class</span><span style="color: #000000"> Meta:
        verbose_name </span>= <span style="color: #800000">'</span><span style="color: #800000">课程机构表</span><span style="color: #800000">'</span><span style="color: #000000">
        verbose_name_plural </span>=<span style="color: #000000"> verbose_name

    </span><span style="color: #0000ff">def</span> <span style="color: #800080">__str__</span><span style="color: #000000">(self):
        </span><span style="color: #0000ff">return</span> self.name</pre>
</div>
<p><span style="color: #ff0000"><strong>forms.py</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf8 -*-</span>
<span style="color: #0000ff">from</span> django <span style="color: #0000ff">import</span> <span style="background-color: #ff99cc">forms</span>                             <span style="color: #008000">#</span><span style="color: #008000"> 导入Django的表单验证模块</span>
<span style="color: #0000ff">from</span> app_organization.models <span style="color: #0000ff">import</span> <span style="background-color: #ff99cc"><strong>CourseOrg</strong></span>        <span style="color: #008000">#</span><span style="color: #008000"> 导入数据库表类</span>


<span style="color: #0000ff">class</span><span style="color: #000000"> CourseOrgForm(<span style="background-color: #ff99cc">forms.ModelForm</span>):
    zdyi </span>= forms.CharField()                         <span style="color: #008000">#</span><span style="color: #008000"> 自定义表单验证字段</span>

    <span style="color: #0000ff">class</span><span style="color: #000000"> Meta:
        model </span>= <span style="background-color: #ff99cc">CourseOrg</span>                            <span style="color: #008000">#</span><span style="color: #008000"> 设置要将数据库表类转换成表单验证类的名称</span>
        fields = [<span style="color: #800000">'</span><span style="color: #800000">name</span><span style="color: #800000">'</span>,<span style="color: #800000">'</span><span style="color: #800000">category</span><span style="color: #800000">'</span>,<span style="color: #800000">'</span><span style="color: #800000">fav_nums</span><span style="color: #800000">'</span>]      <span style="color: #008000">#</span><span style="color: #008000"> 要使用的字段</span></pre>
</div>
<p>&nbsp;</p></div>