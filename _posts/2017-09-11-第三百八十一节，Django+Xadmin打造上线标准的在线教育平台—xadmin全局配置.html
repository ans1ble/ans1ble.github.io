第三百八十一节，Django+Xadmin打造上线标准的在线教育平台—xadmin全局配置


			<div id="cnblogs_post_body" class="blogpost-body"><p><strong>第三百八十一节，Django+Xadmin打造上线标准的在线教育平台—xadmin全局配置</strong></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>1、xadmin主题设置</strong></span></p>
<p><span style="color: #000000"><strong>要使用xadmin主题，需要在一个app下的adminx.py后台注册文件里，写一个主题管理器绑定xadmin的views.BaseAdminView注册</strong></span><br><span style="color: #000000"><strong>一般我们会在用户相关的app下的adminx.py后台注册文件里写</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf8 -*-</span>

<span style="color: #0000ff">import</span><span style="color: #000000"> xadmin
</span><span style="background-color: #ffff00"><span style="color: #0000ff">from</span> xadmin <span style="color: #0000ff">import</span> views                <span style="color: #008000">#</span><span style="color: #008000"> 导入xadmin的views</span></span>

<span style="color: #0000ff">from</span> .models <span style="color: #0000ff">import</span><span style="color: #000000"> Users, Email, Banner


</span><span style="background-color: #ffff00"><span style="color: #0000ff">class</span> BasdSetting(object):              <span style="color: #008000">#</span><span style="color: #008000"> 主题管理器</span>
    enable_themes = True                <span style="color: #008000">#</span><span style="color: #008000"> 使用主题</span>
    use_bootswatch =<span style="color: #000000"> True
xadmin.site.register(views.BaseAdminView, BasdSetting)      </span><span style="color: #008000">#</span><span style="color: #008000"> 将主题管理器绑定views.BaseAdminView注册</span></span>


<span style="color: #0000ff">class</span> UsersAdmin(object):               <span style="color: #008000">#</span><span style="color: #008000"> 自定义用户信息数据表管理器类</span>
    <span style="color: #008000">#</span><span style="color: #008000"> 设置xadmin后台显示字段</span>
    list_display = [<span style="color: #800000">'</span><span style="color: #800000">username</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">password</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">nick_name</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">gender</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">email</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">address</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">mobile</span><span style="color: #800000">'</span><span style="color: #000000">,
                    </span><span style="color: #800000">'</span><span style="color: #800000">first_name</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">last_name</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">is_active</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">birday</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">last_login</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">date_joined</span><span style="color: #800000">'</span><span style="color: #000000">]
    </span><span style="color: #008000">#</span><span style="color: #008000"> 设置xadmin后台搜索字段，注意：搜索字段如果有时间类型会报错</span>
    search_fields = [<span style="color: #800000">'</span><span style="color: #800000">username</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">password</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">nick_name</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">gender</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">email</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">address</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">mobile</span><span style="color: #800000">'</span><span style="color: #000000">]
    </span><span style="color: #008000">#</span><span style="color: #008000"> 设置xadmin后台过滤器帅选字段，时间用过滤器来做</span>
    list_filter = [<span style="color: #800000">'</span><span style="color: #800000">username</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">password</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">nick_name</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">gender</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">email</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">address</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">mobile</span><span style="color: #800000">'</span><span style="color: #000000">,
                    </span><span style="color: #800000">'</span><span style="color: #800000">first_name</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">last_name</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">is_active</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">birday</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">last_login</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">date_joined</span><span style="color: #800000">'</span><span style="color: #000000">]
xadmin.site.register(Users, UsersAdmin)     </span><span style="color: #008000">#</span><span style="color: #008000"> 将户信息数据表注册到xadmin后台显示</span>


<span style="color: #0000ff">class</span><span style="color: #000000"> EmailAdmin(object):
    list_display </span>= [<span style="color: #800000">'</span><span style="color: #800000">code</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">email</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">send_type</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">send_time</span><span style="color: #800000">'</span><span style="color: #000000">]
    search_fields </span>= [<span style="color: #800000">'</span><span style="color: #800000">code</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">email</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">send_type</span><span style="color: #800000">'</span><span style="color: #000000">]
    list_filter </span>= [<span style="color: #800000">'</span><span style="color: #800000">code</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">email</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">send_type</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">send_time</span><span style="color: #800000">'</span><span style="color: #000000">]
xadmin.site.register(Email, EmailAdmin)


</span><span style="color: #0000ff">class</span><span style="color: #000000"> BannerAdmin(object):
    list_display </span>= [<span style="color: #800000">'</span><span style="color: #800000">title</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">index</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">image</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">url</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">add_time</span><span style="color: #800000">'</span><span style="color: #000000">]
    search_fields </span>= [<span style="color: #800000">'</span><span style="color: #800000">title</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">index</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">image</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">url</span><span style="color: #800000">'</span><span style="color: #000000">]
    list_filter </span>= [<span style="color: #800000">'</span><span style="color: #800000">title</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">index</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">image</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">url</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">add_time</span><span style="color: #800000">'</span><span style="color: #000000">]
xadmin.site.register(Banner, BannerAdmin)</span></pre>
</div>
<p><img src="https://images2017.cnblogs.com/blog/955761/201709/955761-20170911145357235-553443810.png" alt=""></p>
<p>&nbsp;</p>
<p><br><span style="color: #ff0000"><strong>2、头部系统名称和底部版权以及导航折叠设置</strong></span><br><strong>需要在一个app下的adminx.py后台注册文件里，写一个头部系统名称和底部版权管理器绑定xadmin的views.CommAdminView注册</strong><br><strong>一般我们会在用户相关的app下的adminx.py后台注册文件里写</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">import</span><span style="color: #000000"> xadmin
</span><span style="background-color: #ffff00"><span style="color: #0000ff">from</span> xadmin <span style="color: #0000ff">import</span> views                <span style="color: #008000">#</span><span style="color: #008000"> 导入xadmin的views</span></span>

<span style="color: #0000ff">from</span> .models <span style="color: #0000ff">import</span><span style="color: #000000"> Users, Email, Banner


</span><span style="color: #0000ff">class</span> BasdSetting(object):              <span style="color: #008000">#</span><span style="color: #008000"> 主题管理器</span>
    enable_themes = True                <span style="color: #008000">#</span><span style="color: #008000"> 使用主题</span>
    use_bootswatch =<span style="color: #000000"> True
xadmin.site.register(views.BaseAdminView, BasdSetting)      </span><span style="color: #008000">#</span><span style="color: #008000"> 将主题管理器绑定views.BaseAdminView注册</span>


<span style="background-color: #ffff00"><span style="color: #0000ff">class</span> GlobalSettings(object):                               <span style="color: #008000">#</span><span style="color: #008000"> 头部系统名称和底部版权管理器</span>
    site_title = <span style="color: #800000">'</span><span style="color: #800000">玉秀管理系统</span><span style="color: #800000">'</span>                              <span style="color: #008000">#</span><span style="color: #008000"> 头部系统名称</span>
    site_footer = <span style="color: #800000">'</span><span style="color: #800000">玉秀管理系统，玉秀公司版权所有</span><span style="color: #800000">'</span>             <span style="color: #008000">#</span><span style="color: #008000"> 底部版权</span>
    menu_style = <span style="color: #800000">'</span><span style="color: #800000">accordion</span><span style="color: #800000">'</span>                                <span style="color: #008000">#</span><span style="color: #008000"> 设置数据管理导航折叠，以每一个app为一个折叠框</span>
xadmin.site.register(views.CommAdminView, GlobalSettings)   <span style="color: #008000">#</span><span style="color: #008000"> 头部系统名称和底部版权管理器绑定views.CommAdminView注册</span></span>


<span style="color: #0000ff">class</span> UsersAdmin(object):               <span style="color: #008000">#</span><span style="color: #008000"> 自定义用户信息数据表管理器类</span>
    <span style="color: #008000">#</span><span style="color: #008000"> 设置xadmin后台显示字段</span>
    list_display = [<span style="color: #800000">'</span><span style="color: #800000">username</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">password</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">nick_name</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">gender</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">email</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">address</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">mobile</span><span style="color: #800000">'</span><span style="color: #000000">,
                    </span><span style="color: #800000">'</span><span style="color: #800000">first_name</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">last_name</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">is_active</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">birday</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">last_login</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">date_joined</span><span style="color: #800000">'</span><span style="color: #000000">]
    </span><span style="color: #008000">#</span><span style="color: #008000"> 设置xadmin后台搜索字段，注意：搜索字段如果有时间类型会报错</span>
    search_fields = [<span style="color: #800000">'</span><span style="color: #800000">username</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">password</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">nick_name</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">gender</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">email</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">address</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">mobile</span><span style="color: #800000">'</span><span style="color: #000000">]
    </span><span style="color: #008000">#</span><span style="color: #008000"> 设置xadmin后台过滤器帅选字段，时间用过滤器来做</span>
    list_filter = [<span style="color: #800000">'</span><span style="color: #800000">username</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">password</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">nick_name</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">gender</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">email</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">address</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">mobile</span><span style="color: #800000">'</span><span style="color: #000000">,
                    </span><span style="color: #800000">'</span><span style="color: #800000">first_name</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">last_name</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">is_active</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">birday</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">last_login</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">date_joined</span><span style="color: #800000">'</span><span style="color: #000000">]
xadmin.site.register(Users, UsersAdmin)     </span><span style="color: #008000">#</span><span style="color: #008000"> 将户信息数据表注册到xadmin后台显示</span>


<span style="color: #0000ff">class</span><span style="color: #000000"> EmailAdmin(object):
    list_display </span>= [<span style="color: #800000">'</span><span style="color: #800000">code</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">email</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">send_type</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">send_time</span><span style="color: #800000">'</span><span style="color: #000000">]
    search_fields </span>= [<span style="color: #800000">'</span><span style="color: #800000">code</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">email</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">send_type</span><span style="color: #800000">'</span><span style="color: #000000">]
    list_filter </span>= [<span style="color: #800000">'</span><span style="color: #800000">code</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">email</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">send_type</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">send_time</span><span style="color: #800000">'</span><span style="color: #000000">]
xadmin.site.register(Email, EmailAdmin)


</span><span style="color: #0000ff">class</span><span style="color: #000000"> BannerAdmin(object):
    list_display </span>= [<span style="color: #800000">'</span><span style="color: #800000">title</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">index</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">image</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">url</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">add_time</span><span style="color: #800000">'</span><span style="color: #000000">]
    search_fields </span>= [<span style="color: #800000">'</span><span style="color: #800000">title</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">index</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">image</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">url</span><span style="color: #800000">'</span><span style="color: #000000">]
    list_filter </span>= [<span style="color: #800000">'</span><span style="color: #800000">title</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">index</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">image</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">url</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">add_time</span><span style="color: #800000">'</span><span style="color: #000000">]
xadmin.site.register(Banner, BannerAdmin)</span></pre>
</div>
<p><img src="https://images2017.cnblogs.com/blog/955761/201709/955761-20170911171033078-1240766998.png" alt=""></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>3、导航app名称设置成中文，需要以下两步</strong></span></p>
<p><span style="color: #000000"><strong>在当前app目录下的apps.py文件里配置后台要显示的中文名称</strong></span></p>
<p><span style="color: #0000ff"><strong><strong>apps.py文件</strong></strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span>
<span style="color: #0000ff">from</span> django.apps <span style="color: #0000ff">import</span><span style="color: #000000"> AppConfig


</span><span style="color: #0000ff">class</span><span style="color: #000000"><span style="background-color: #ff99cc"> AppCoursesConfig(AppConfig)</span>:
    <span style="background-color: #ffff00">name </span></span><span style="background-color: #ffff00">= <span style="color: #800000">'</span><span style="color: #800000">app_courses</span><span style="color: #800000">'</span>            <span style="color: #008000">#</span><span style="color: #008000"> 当前app名称</span></span>
    <span style="background-color: #ffff00">verbose_name = <span style="color: #800000">'</span><span style="color: #800000">课程管理</span><span style="color: #800000">'</span>        <span style="color: #008000">#</span><span style="color: #008000"> 要设置的中文名称</span></span></pre>
</div>
<p><strong>在当前app目录下的__init__.py文件里应用app中文名称设置类的路径</strong></p>
<p><strong>default_app_config = app中文名称设置类的路径，从app开始到类</strong></p>
<p><span style="color: #0000ff"><strong><strong>__init__.py文件</strong></strong></span></p>
<div class="cnblogs_code">
<pre>default_app_config = <span style="color: #800000">'</span><span style="color: #800000; background-color: #ff99cc">app_courses.apps.AppCoursesConfig</span><span style="color: #800000">'</span></pre>
</div>
<p><img src="https://images2017.cnblogs.com/blog/955761/201709/955761-20170911173415157-156209427.png" alt=""></p>
<p>&nbsp;</p></div>