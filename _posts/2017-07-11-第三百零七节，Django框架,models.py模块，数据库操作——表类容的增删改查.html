第三百零七节，Django框架,models.py模块，数据库操作——表类容的增删改查


			<div id="cnblogs_post_body" class="blogpost-body"><p><strong>Django框架,models.py模块，数据库操作——表类容的增删改查</strong></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong>增加数据</strong></span></p>
<p><span style="color: #ff0000"><strong>create()方法，增加数据</strong></span></p>
<p><span style="color: #ff0000"><strong>save()方法，写入数据</strong></span></p>
<p><span style="color: #0000ff"><strong>第一种方式</strong></span></p>
<p><span style="color: #0000ff"><strong><strong>表类名称(字段=值)</strong></strong></span></p>
<p><span style="color: #0000ff"><strong><strong>需要<strong>save()方法，写入数据</strong></strong></strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">from</span> django.shortcuts <span style="color: #0000ff">import</span><span style="color: #000000"> render
</span><span style="background-color: #ff99cc"><span style="color: #0000ff">from</span> app1.models <span style="color: #0000ff">import</span> *</span>    <span style="color: #008000">#</span><span style="color: #008000">导入数据库操作模块</span>

<span style="color: #008000">#</span><span style="color: #008000">逻辑处理模块</span>
<span style="color: #0000ff">def</span><span style="color: #000000"> special(request):

    <span style="background-color: #ff99cc">a </span></span><span style="background-color: #ff99cc">= yhubiao(anem=<span style="color: #800000">'</span><span style="color: #800000">张三</span><span style="color: #800000">'</span>,mim=<span style="color: #800000">'</span><span style="color: #800000">279819</span><span style="color: #800000">'</span>)   <span style="color: #008000">#</span><span style="color: #008000">第一种添加数据，实例化表类，在实例化里传参为字段和值</span>
    a.save()                                <span style="color: #008000">#</span><span style="color: #008000">写入数据库</span></span>

    <span style="color: #0000ff">return</span> render(request,<span style="color: #800000">'</span><span style="color: #800000">index.html</span><span style="color: #800000">'</span>)   <span style="color: #008000">#</span><span style="color: #008000">打开页面</span></pre>
</div>
<p><span style="color: #0000ff"><strong>第二种方式：表类名称.objects.create（字段=值）</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">from</span> django.shortcuts <span style="color: #0000ff">import</span><span style="color: #000000"> render
</span><span style="background-color: #ff99cc"><span style="color: #0000ff">from</span> app1.models <span style="color: #0000ff">import</span> *</span>    <span style="color: #008000">#</span><span style="color: #008000">导入数据库操作模块</span>

<span style="color: #008000">#</span><span style="color: #008000">逻辑处理模块</span>
<span style="color: #0000ff">def</span><span style="color: #000000"> special(request):
    <span style="background-color: #ff99cc">yhubiao.objects.create(anem</span></span><span style="background-color: #ff99cc">=<span style="color: #800000">'</span><span style="color: #800000">张三2</span><span style="color: #800000">'</span>,mim=<span style="color: #800000">'</span><span style="color: #800000">279819</span><span style="color: #800000">'</span><span style="color: #000000">)

    </span></span><span style="color: #0000ff">return</span> render(request,<span style="color: #800000">'</span><span style="color: #800000">index.html</span><span style="color: #800000">'</span>)   <span style="color: #008000">#</span><span style="color: #008000">打开页面</span></pre>
</div>
<p><span style="color: #0000ff"><strong>第三种方式【推荐】</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">from</span> django.shortcuts <span style="color: #0000ff">import</span><span style="color: #000000"> render
</span><span style="background-color: #ff99cc"><span style="color: #0000ff">from</span> app1.models <span style="color: #0000ff">import</span> *</span>    <span style="color: #008000">#</span><span style="color: #008000">导入数据库操作模块</span>

<span style="color: #008000">#</span><span style="color: #008000">逻辑处理模块</span>
<span style="color: #0000ff">def</span><span style="color: #000000"> special(request):


    <span style="background-color: #ff99cc">a </span></span><span style="background-color: #ff99cc">= {<span style="color: #800000">'</span><span style="color: #800000">anem</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">李四</span><span style="color: #800000">'</span>,               <span style="color: #008000">#</span><span style="color: #008000">将要写入的数据组合成字典，键为字段值为数据</span>
         <span style="color: #800000">'</span><span style="color: #800000">mim</span><span style="color: #800000">'</span>:<span style="color: #800000">'</span><span style="color: #800000">279819</span><span style="color: #800000">'</span><span style="color: #000000">
         }
    yhubiao.objects.create(</span>**a)       <span style="color: #008000">#</span><span style="color: #008000">添加到数据库，注意字典变量名称一定要加**</span></span>

    <span style="color: #0000ff">return</span> render(request,<span style="color: #800000">'</span><span style="color: #800000">index.html</span><span style="color: #800000">'</span>)   <span style="color: #008000">#</span><span style="color: #008000">打开页面</span></pre>
</div>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong>查询数据</strong></span></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">get()</span>获取单条数据，不存在报错，存在多条也报错【不推荐】</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">from</span> django.shortcuts <span style="color: #0000ff">import</span><span style="color: #000000"> render
</span><span style="color: #0000ff">from</span> app1.models <span style="color: #0000ff">import</span> *    <span style="color: #008000">#</span><span style="color: #008000">导入数据库操作模块</span>

<span style="color: #008000">#</span><span style="color: #008000">逻辑处理模块</span>
<span style="color: #0000ff">def</span><span style="color: #000000"> special(request):
    <span style="background-color: #ff99cc">a </span></span><span style="background-color: #ff99cc">= yhubiao.objects.get(id=2)    <span style="color: #008000">#</span><span style="color: #008000">获取单条数据，不存在报错，存在多条也报错</span>
    <span style="color: #0000ff">print</span><span style="color: #000000">(a)

    </span></span><span style="color: #0000ff">return</span> render(request,<span style="color: #800000">'</span><span style="color: #800000">index.html</span><span style="color: #800000">'</span>,locals())   <span style="color: #008000">#</span><span style="color: #008000">打开页面<br></span></pre>
<pre><span style="color: #008080">#返回：张三</span></pre>
<pre><span style="color: #008000">&nbsp;</span></pre>
</div>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">all()</span>获取表里的全部信息</strong></span></p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong>【重点】注意：查询数据库返回的<span style="color: #0000ff">QuerySet对象</span>，而且每一行数据又是一个对象，所以我们需要通过<span style="color: #0000ff">values()方法</span>，和<span style="color: #0000ff">values_list()方法</span>来将每行数据转换</strong></span></p>
<p><span style="color: #ff0000"><strong><strong><span style="color: #0000ff">values()方法</span>，获取<strong><span style="color: #0000ff">QuerySet对象</span>里的，行数据返回字典，无参返回整行数据字典，有参参数是要获取的字段，返回要获取的字段字典</strong></strong></strong></span></p>
<p><span style="color: #ff0000"><strong><strong><span style="color: #0000ff">values_list()方法</span>，<strong><strong>获取<strong><span style="color: #0000ff">QuerySet对象</span>里的，<strong><strong><strong>行数据返回列表，无参返回整行数据<strong><strong><strong><strong><strong><strong><strong><strong>列表</strong></strong></strong></strong></strong></strong></strong></strong>，有参参数是要获取的字段，返回要获取的字段<strong><strong><strong><strong><strong><strong><strong><strong>列表</strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">from</span> django.shortcuts <span style="color: #0000ff">import</span><span style="color: #000000"> render
</span><span style="color: #0000ff">from</span> app1.models <span style="color: #0000ff">import</span> *    <span style="color: #008000">#</span><span style="color: #008000">导入数据库操作模块</span>

<span style="color: #008000">#</span><span style="color: #008000">逻辑处理模块</span>
<span style="color: #0000ff">def</span><span style="color: #000000"> special(request):
    <span style="background-color: #ff99cc">a </span></span><span style="background-color: #ff99cc">= yhubiao.objects.all()    <span style="color: #008000">#</span><span style="color: #008000">获取表里的全部信息</span>
    <span style="color: #0000ff">print</span>(a)                     <span style="color: #008000">#</span><span style="color: #008000">返回的QuerySet对象，而且每一行数据又是一个对象</span>
</span><span style="color: #000000">
    b </span>= <span style="background-color: #ffff99">a.values()               <span style="color: #008000">#</span><span style="color: #008000">将每一行数据对象转换成字典</span>
    <span style="color: #0000ff">print</span></span><span style="color: #000000"><span style="background-color: #ffff99">(b)</span>

    <span style="background-color: #ccffcc">c </span></span><span style="background-color: #ccffcc">= a.values_list()          <span style="color: #008000">#</span><span style="color: #008000">将每一行数据对象转换成列表</span>
    <span style="color: #0000ff">print</span><span style="color: #000000">(c)

    </span></span><span style="color: #008000">#</span><span style="color: #008000">一般我们使用字典的方式，我们通过循环得到数据</span>
    <span style="background-color: #cc99ff"><span style="color: #0000ff">for</span> i <span style="color: #0000ff">in</span><span style="color: #000000"> b:
        </span><span style="color: #0000ff">print</span>(i[<span style="color: #800000">'</span><span style="color: #800000">id</span><span style="color: #800000">'</span>],i[<span style="color: #800000">'</span><span style="color: #800000">anem</span><span style="color: #800000">'</span>],i[<span style="color: #800000">'</span><span style="color: #800000">mim</span><span style="color: #800000">'</span><span style="color: #000000">])


    </span></span><span style="color: #0000ff">return</span> render(request,<span style="color: #800000">'</span><span style="color: #800000">index.html</span><span style="color: #800000">'</span>,locals())   <span style="color: #008000">#</span><span style="color: #008000">打开页面</span>

<span style="color: #008000">#</span><span style="color: #008000">返回</span><span style="color: #008000">
#</span><span style="color: #008000; background-color: #ff99cc"> &lt;QuerySet [&lt;yhubiao: 张三&gt;, &lt;yhubiao: 张三2&gt;, &lt;yhubiao: 李四&gt;]&gt;</span><span style="color: #008000">
#</span><span style="color: #008000; background-color: #ffff00"> &lt;QuerySet [{'id': 1, 'mim': '279819', 'anem': '张三'}, {'id': 2, 'mim': '279819', 'anem': '张三2'}, {'id': 3, 'mim': '279819', 'anem': '李四'}]&gt;</span><span style="color: #008000">
#</span><span style="color: #008000; background-color: #ccffcc"> &lt;QuerySet [(1, '张三', '279819'), (2, '张三2', '279819'), (3, '李四', '279819')]&gt;</span><span style="background-color: #cc99ff"><span style="color: #008000">
#</span><span style="color: #008000"> 1 张三 279819</span><span style="color: #008000">
#</span><span style="color: #008000"> 2 张三2 279819</span><span style="color: #008000">
#</span><span style="color: #008000"> 3 李四 279819</span></span></pre>
</div>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">filter()</span>获取指定条件的数据</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">from</span> django.shortcuts <span style="color: #0000ff">import</span><span style="color: #000000"> render
</span><span style="color: #0000ff">from</span> app1.models <span style="color: #0000ff">import</span> *    <span style="color: #008000">#</span><span style="color: #008000">导入数据库操作模块</span>

<span style="color: #008000">#</span><span style="color: #008000">逻辑处理模块</span>
<span style="color: #0000ff">def</span><span style="color: #000000"> special(request):
    <span style="background-color: #ff99cc">a </span></span><span style="background-color: #ff99cc">= yhubiao.objects.filter(id=2)   <span style="color: #008000">#</span><span style="color: #008000">获取指定条件的数据</span>
    <span style="color: #0000ff">print</span>(a) </span>                          <span style="color: #008000">#</span><span style="color: #008000">返回的QuerySet对象，而且每一行数据又是一个对象</span>
<span style="color: #000000">
    b </span>=<span style="color: #000000"> a.values()
    </span><span style="color: #0000ff">print</span><span style="color: #000000">(b)

    </span><span style="color: #0000ff">return</span> render(request,<span style="color: #800000">'</span><span style="color: #800000">index.html</span><span style="color: #800000">'</span>,locals())   <span style="color: #008000">#</span><span style="color: #008000">打开页面</span>

<span style="color: #008000">#</span><span style="color: #008000">返回</span><span style="color: #008000">
#</span><span style="color: #008000"> &lt;QuerySet [&lt;yhubiao: 张三2&gt;]&gt;</span><span style="color: #008000">
#</span><span style="color: #008000"> &lt;QuerySet [{'id': 2, 'mim': '279819', 'anem': '张三2'}]&gt;</span></pre>
</div>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">count()</span>获取数据个数，一般在获取到数据后面使用</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">from</span> django.shortcuts <span style="color: #0000ff">import</span><span style="color: #000000"> render
</span><span style="color: #0000ff">from</span> app1.models <span style="color: #0000ff">import</span> *    <span style="color: #008000">#</span><span style="color: #008000">导入数据库操作模块</span>

<span style="color: #008000">#</span><span style="color: #008000">逻辑处理模块</span>
<span style="color: #0000ff">def</span><span style="color: #000000"> special(request):
    a </span>= yhubiao.objects.filter(mim=279819)   <span style="color: #008000">#</span><span style="color: #008000">获取指定条件的数据</span>
    <span style="color: #0000ff">print</span>(a)                                 <span style="color: #008000">#</span><span style="color: #008000">返回的QuerySet对象，而且每一行数据又是一个对象</span>
<span style="background-color: #ff99cc"><span style="color: #000000">
    b </span>=<span style="color: #000000"> a.count()
    </span><span style="color: #0000ff">print</span>(b) </span>                                <span style="color: #008000">#</span><span style="color: #008000">获取数据个数</span>

    <span style="color: #0000ff">return</span> render(request,<span style="color: #800000">'</span><span style="color: #800000">index.html</span><span style="color: #800000">'</span>,locals())   <span style="color: #008000">#</span><span style="color: #008000">打开页面</span>

<span style="color: #008000">#</span><span style="color: #008000">返回</span><span style="color: #008000">
#</span><span style="color: #008000"> &lt;QuerySet [&lt;yhubiao: 张三&gt;, &lt;yhubiao: 张三2&gt;, &lt;yhubiao: 李四&gt;]&gt;</span><span style="color: #008000">
#</span><span style="color: #008000; background-color: #ff99cc"> 3</span></pre>
</div>
<p><span style="color: #ff0000"><strong>查询条件：大于小于</strong></span></p>
<p><span style="color: #ff0000"><strong>需要结合，<strong><span style="color: #0000ff">filter()</span>获取指定条件的方法</strong></strong></span></p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">__gt</span> 大于</strong></span><br><span style="color: #ff0000"><strong><span style="color: #0000ff">__gte</span> 大于等于</strong></span><br><span style="color: #ff0000"><strong><span style="color: #0000ff">__lt</span> 小于</strong></span><br><span style="color: #ff0000"><strong><span style="color: #0000ff">__lte</span> 小于等于</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">from</span> django.shortcuts <span style="color: #0000ff">import</span><span style="color: #000000"> render
</span><span style="color: #0000ff">from</span> app1.models <span style="color: #0000ff">import</span> *    <span style="color: #008000">#</span><span style="color: #008000">导入数据库操作模块</span>

<span style="color: #008000">#</span><span style="color: #008000">逻辑处理模块</span>
<span style="color: #0000ff">def</span><span style="color: #000000"> special(request):
    a </span>= yhubiao.objects.filter(id<span style="background-color: #ff99cc">__gt</span>=1)              <span style="color: #008000">#</span><span style="color: #008000"> 获取id大于1的值</span>
    <span style="color: #008000">#</span><span style="color: #008000"> yhubiao.objects.filter(id<span style="background-color: #ff99cc">__gte</span>=1)              # 获取id大于等于1的值</span>
    <span style="color: #008000">#</span><span style="color: #008000"> yhubiao.objects.filter(id<span style="background-color: #ff99cc">__lt</span>=10)             # 获取id小于10的值</span>
    <span style="color: #008000">#</span><span style="color: #008000"> yhubiao.objects.filter(id<span style="background-color: #ff99cc">__lte</span>=10)             # 获取id小于10的值</span>
    <span style="color: #008000">#</span><span style="color: #008000"> yhubiao.objects.filter(id<span style="background-color: #ff99cc">__lt</span>=10, id<span style="background-color: #ff99cc">__gt</span>=1)   # 获取id大于1 且 小于10的值</span>

    <span style="color: #0000ff">print</span>(a)                                        <span style="color: #008000">#</span><span style="color: #008000">返回的QuerySet对象，而且每一行数据又是一个对象</span>
    <span style="color: #0000ff">return</span> render(request,<span style="color: #800000">'</span><span style="color: #800000">index.html</span><span style="color: #800000">'</span>,locals())   <span style="color: #008000">#</span><span style="color: #008000">打开页面</span>

<span style="color: #008000">#</span><span style="color: #008000">返回</span><span style="color: #008000">
#</span><span style="color: #008000"> &lt;QuerySet [&lt;yhubiao: 张三2&gt;, &lt;yhubiao: 李四&gt;]&gt;</span></pre>
</div>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">__in </span>在里面的&nbsp;</strong></span></p>
<p><strong><span style="color: #ff0000"><span style="color: #0000ff">exclude()</span>排除取反</span>&nbsp;</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">from</span> django.shortcuts <span style="color: #0000ff">import</span><span style="color: #000000"> render
</span><span style="color: #0000ff">from</span> app1.models <span style="color: #0000ff">import</span> *    <span style="color: #008000">#</span><span style="color: #008000">导入数据库操作模块</span>

<span style="color: #008000">#</span><span style="color: #008000">逻辑处理模块</span>
<span style="color: #0000ff">def</span><span style="color: #000000"> special(request):
    a </span>= yhubiao.objects.filter(id<span style="background-color: #ff99cc">__in</span>=[2,3])        <span style="color: #008000">#</span><span style="color: #008000"> 获取id在里面的数据</span>
    <span style="color: #0000ff">print</span>(a)                                        <span style="color: #008000">#</span><span style="color: #008000">返回的QuerySet对象，而且每一行数据又是一个对象</span>
<span style="color: #000000">
    b </span>= yhubiao.objects.<span style="background-color: #ff99cc">exclude(id__in=[2, 3])</span>      <span style="color: #008000">#</span><span style="color: #008000">获取id不在里面的数据，exclude()排除取反</span>
    <span style="color: #0000ff">print</span><span style="color: #000000">(b)
    </span><span style="color: #0000ff">return</span> render(request,<span style="color: #800000">'</span><span style="color: #800000">index.html</span><span style="color: #800000">'</span>,locals())   <span style="color: #008000">#</span><span style="color: #008000">打开页面</span>

<span style="color: #008000">#</span><span style="color: #008000">返回</span><span style="color: #008000">
#</span><span style="color: #008000"> &lt;QuerySet [&lt;yhubiao: 张三2&gt;, &lt;yhubiao: 李四&gt;]&gt;</span><span style="color: #008000">
#</span><span style="color: #008000"> &lt;QuerySet [&lt;yhubiao: 张三&gt;]&gt;</span></pre>
</div>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">__isnull</span> 获取字段可以为空，没有设置数据，默认为null的字段</strong></span><br><strong>	　　True获取默认为null的字段</strong><br><strong>	　　False获取不为null的字段</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">from</span> django.shortcuts <span style="color: #0000ff">import</span><span style="color: #000000"> render
</span><span style="color: #0000ff">from</span> app1.models <span style="color: #0000ff">import</span> *    <span style="color: #008000">#</span><span style="color: #008000">导入数据库操作模块</span>

<span style="color: #008000">#</span><span style="color: #008000">逻辑处理模块</span>
<span style="color: #0000ff">def</span><span style="color: #000000"> special(request):
    a </span>= yhubiao.objects.filter(mim<span style="background-color: #ff99cc">__isnull=True</span>)    <span style="color: #008000">#</span><span style="color: #008000"> 获取mim字段为null，也就是默认空的字段</span>
    <span style="color: #0000ff">print</span>(a)                                        <span style="color: #008000">#</span><span style="color: #008000">返回的QuerySet对象，而且每一行数据又是一个对象</span>
    b = yhubiao.objects.filter(mim<span style="background-color: #ff99cc">__isnull=False</span>)   <span style="color: #008000">#</span><span style="color: #008000">获取字段不为null的字段</span>
    <span style="color: #0000ff">print</span><span style="color: #000000">(b)


    </span><span style="color: #0000ff">return</span> render(request,<span style="color: #800000">'</span><span style="color: #800000">index.html</span><span style="color: #800000">'</span>,locals())   <span style="color: #008000">#</span><span style="color: #008000">打开页面</span>

<span style="color: #008000">#</span><span style="color: #008000">返回</span><span style="color: #008000">
#</span><span style="color: #008000"> &lt;QuerySet [&lt;yhubiao: 王五&gt;]&gt;</span><span style="color: #008000">
#</span><span style="color: #008000"> &lt;QuerySet [&lt;yhubiao: 张三&gt;, &lt;yhubiao: 张三2&gt;, &lt;yhubiao: 李四&gt;]&gt;</span></pre>
</div>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">__contains</span> 包含，区分大小写</strong></span><br><span style="color: #ff0000"><strong><span style="color: #0000ff">__icontains</span> 包含，不区分大小写</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">from</span> django.shortcuts <span style="color: #0000ff">import</span><span style="color: #000000"> render
</span><span style="color: #0000ff">from</span> app1.models <span style="color: #0000ff">import</span> *    <span style="color: #008000">#</span><span style="color: #008000">导入数据库操作模块</span>

<span style="color: #008000">#</span><span style="color: #008000">逻辑处理模块</span>
<span style="color: #0000ff">def</span><span style="color: #000000"> special(request):
    a </span>= yhubiao.objects.filter(anem<span style="background-color: #ff99cc">__contains</span>=<span style="color: #800000">'</span><span style="color: #800000">a</span><span style="color: #800000">'</span>)    <span style="color: #008000">#</span><span style="color: #008000"> 获取字段包含5的数据,区分大小写</span>
    <span style="color: #0000ff">print</span><span style="color: #000000">(a)
    b </span>= yhubiao.objects.filter(anem<span style="background-color: #ff99cc">__icontains</span>=<span style="color: #800000">'</span><span style="color: #800000">a</span><span style="color: #800000">'</span>)    <span style="color: #008000">#</span><span style="color: #008000">包含，不区分大小写</span>
    <span style="color: #0000ff">print</span><span style="color: #000000">(b)
    c </span>= yhubiao.objects.<span style="background-color: #ff99cc">exclude(anem__contains=<span style="color: #800000">'</span><span style="color: #800000">a</span><span style="color: #800000">'</span>)</span>    <span style="color: #008000">#</span><span style="color: #008000">取反，获取字段不包含a的数据</span>
    <span style="color: #0000ff">print</span><span style="color: #000000">(c)

    </span><span style="color: #0000ff">return</span> render(request,<span style="color: #800000">'</span><span style="color: #800000">index.html</span><span style="color: #800000">'</span>,locals())   <span style="color: #008000">#</span><span style="color: #008000">打开页面</span>

<span style="color: #008000">#</span><span style="color: #008000">返回</span><span style="color: #008000">
#</span><span style="color: #008000"> &lt;QuerySet [&lt;yhubiao: adc&gt;]&gt;</span><span style="color: #008000">
#</span><span style="color: #008000"> &lt;QuerySet [&lt;yhubiao: adc&gt;, &lt;yhubiao: ADC&gt;]&gt;</span><span style="color: #008000">
#</span><span style="color: #008000"> &lt;QuerySet [&lt;yhubiao: 张三&gt;, &lt;yhubiao: 张三2&gt;, &lt;yhubiao: 李四&gt;, &lt;yhubiao: 王五&gt;, &lt;yhubiao: ADC&gt;]&gt;</span></pre>
</div>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">__range</span> 范围</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">from</span> django.shortcuts <span style="color: #0000ff">import</span><span style="color: #000000"> render
</span><span style="color: #0000ff">from</span> app1.models <span style="color: #0000ff">import</span> *    <span style="color: #008000">#</span><span style="color: #008000">导入数据库操作模块</span>

<span style="color: #008000">#</span><span style="color: #008000">逻辑处理模块</span>
<span style="color: #0000ff">def</span><span style="color: #000000"> special(request):
    a </span>= yhubiao.objects.filter(id<span style="background-color: #ff99cc">__range</span>=[1,6])    <span style="color: #008000">#</span><span style="color: #008000">获取id范围在1至6的数据</span>
    <span style="color: #0000ff">print</span><span style="color: #000000">(a)

    </span><span style="color: #0000ff">return</span> render(request,<span style="color: #800000">'</span><span style="color: #800000">index.html</span><span style="color: #800000">'</span>,locals())   <span style="color: #008000">#</span><span style="color: #008000">打开页面</span>

<span style="color: #008000">#</span><span style="color: #008000">返回</span><span style="color: #008000">
#</span><span style="color: #008000"> &lt;QuerySet [&lt;yhubiao: 张三&gt;, &lt;yhubiao: 张三2&gt;, &lt;yhubiao: 李四&gt;, &lt;yhubiao: 王五&gt;, &lt;yhubiao: adc&gt;, &lt;yhubiao: ADC&gt;]&gt;</span></pre>
</div>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">__istartswith</span> 以...开头</strong></span><br><span style="color: #ff0000"><strong><span style="color: #0000ff">__iendswith</span> 以…结尾</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">from</span> django.shortcuts <span style="color: #0000ff">import</span><span style="color: #000000"> render
</span><span style="color: #0000ff">from</span> app1.models <span style="color: #0000ff">import</span> *    <span style="color: #008000">#</span><span style="color: #008000">导入数据库操作模块</span>

<span style="color: #008000">#</span><span style="color: #008000">逻辑处理模块</span>
<span style="color: #0000ff">def</span><span style="color: #000000"> special(request):
    a </span>= yhubiao.objects.filter(anem__istartswith=<span style="color: #800000">'</span><span style="color: #800000">李</span><span style="color: #800000">'</span>)    <span style="color: #008000">#</span><span style="color: #008000">获取字段以李开头的数据</span>
    <span style="color: #0000ff">print</span><span style="color: #000000">(a)
    b </span>= yhubiao.objects.filter(anem__iendswith=2)         <span style="color: #008000">#</span><span style="color: #008000">获取字段以2结尾的数据</span>
    <span style="color: #0000ff">print</span><span style="color: #000000">(b)

    </span><span style="color: #0000ff">return</span> render(request,<span style="color: #800000">'</span><span style="color: #800000">index.html</span><span style="color: #800000">'</span>,locals())   <span style="color: #008000">#</span><span style="color: #008000">打开页面</span>

<span style="color: #008000">#</span><span style="color: #008000">返回</span><span style="color: #008000">
#</span><span style="color: #008000"> &lt;QuerySet [&lt;yhubiao: 李四&gt;]&gt;</span><span style="color: #008000">
#</span><span style="color: #008000"> &lt;QuerySet [&lt;yhubiao: 张三2&gt;]&gt;</span></pre>
</div>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">order_by()</span>排序，参数：'字段名' 称升序、'-字段名' 称降序</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">from</span> django.shortcuts <span style="color: #0000ff">import</span><span style="color: #000000"> render
</span><span style="color: #0000ff">from</span> app1.models <span style="color: #0000ff">import</span> *    <span style="color: #008000">#</span><span style="color: #008000">导入数据库操作模块</span>

<span style="color: #008000">#</span><span style="color: #008000">逻辑处理模块</span>
<span style="color: #0000ff">def</span><span style="color: #000000"> special(request):
    a </span>= yhubiao.objects.filter(id__range=[1,6])<span style="background-color: #ff99cc">.order_by(<span style="color: #800000">'</span><span style="color: #800000">id</span><span style="color: #800000">'</span>)</span>  <span style="color: #008000">#</span><span style="color: #008000">order_by()排序，参数：'字段名'称升序、'-字段名'称降序</span>
    <span style="color: #0000ff">print</span><span style="color: #000000">(a.values())
    b </span>= yhubiao.objects.filter(id__range=[1,6])<span style="background-color: #ff99cc">.order_by(<span style="color: #800000">'</span><span style="color: #800000">-id</span><span style="color: #800000">'</span><span style="color: #000000">)
    </span></span><span style="color: #0000ff">print</span><span style="color: #000000">(b.values())

    </span><span style="color: #0000ff">return</span> render(request,<span style="color: #800000">'</span><span style="color: #800000">index.html</span><span style="color: #800000">'</span>,locals())   <span style="color: #008000">#</span><span style="color: #008000">打开页面</span>

<span style="color: #008000">#</span><span style="color: #008000">返回</span><span style="color: #008000">
#</span><span style="color: #008000"> &lt;QuerySet [{'anem': '张三', 'id': 1, 'mim': '279819'}, {'anem': '张三2', 'id': 2, 'mim': '2345'}, {'anem': '李四', 'id': 3, 'mim': '279819'}, {'anem': '王五', 'id': 4, 'mim': None}, {'anem': 'adc', 'id': 5, 'mim': '1988'}, {'anem': 'ADC', 'id': 6, 'mim': '8868'}]&gt;</span><span style="color: #008000">
#</span><span style="color: #008000"> &lt;QuerySet [{'anem': 'ADC', 'id': 6, 'mim': '8868'}, {'anem': 'adc', 'id': 5, 'mim': '1988'}, {'anem': '王五', 'id': 4, 'mim': None}, {'anem': '李四', 'id': 3, 'mim': '279819'}, {'anem': '张三2', 'id': 2, 'mim': '2345'}, {'anem': '张三', 'id': 1, 'mim': '279819'}]&gt;</span></pre>
</div>
<p><strong>&nbsp;group by，分组</strong></p>
<p><strong>字段 </strong><br><strong>nid &nbsp; cl &nbsp; id &nbsp; &nbsp;num</strong></p>
<div class="cnblogs_code">
<pre> <span style="color: #008000">#</span><span style="color: #008000"> from django.db.models import Count, Min, Max, Sum</span>
 <span style="color: #008000">#</span><span style="color: #008000"> models.Tb1.<span style="background-color: #ffff99">objects.filter(c1=1)</span>.<span style="background-color: #ff99cc">values('id').annotate(c=Count('num'))</span></span>
 <span style="color: #008000">#</span><span style="color: #008000"> SELECT "app01_tb1"."id", COUNT("app01_tb1"."num") AS "c" FROM "app01_tb1" WHERE "app01_tb1"."c1" = 1 GROUP BY "app01_tb1"."id"</span></pre>
</div>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">from</span> django.shortcuts <span style="color: #0000ff">import</span><span style="color: #000000"> render
</span><span style="color: #0000ff">from</span> app1.models <span style="color: #0000ff">import</span> *    <span style="color: #008000">#</span><span style="color: #008000">导入数据库操作模块</span>

<span style="color: #0000ff">from</span> django.db.models <span style="color: #0000ff">import</span> F,Q   <span style="color: #008000">#</span><span style="color: #008000">导入F和Q</span>

<span style="color: #0000ff">from</span> django.db.models <span style="color: #0000ff">import</span><span style="color: #000000"><span style="background-color: #ff99cc"> Count</span>, Min, Max, Sum

</span><span style="color: #008000">#</span><span style="color: #008000">逻辑处理模块</span>
<span style="color: #0000ff">def</span><span style="color: #000000"> special(request):
    </span><span style="color: #008000">#</span><span style="color: #008000">获取表里shf字段等于普通会员的数据，以shf字符分组，计算出所属普通会员的数据有多少条</span>
    a = yu_wen_lao_shi.objects.filter(shf=<span style="color: #800000">'</span><span style="color: #800000">普通会员</span><span style="color: #800000">'</span>).values(<span style="color: #800000">'</span><span style="color: #800000">shf</span><span style="color: #800000">'</span>).<span style="background-color: #ff99cc">annotate(c=Count(<span style="color: #800000">'</span><span style="color: #800000">shf</span><span style="color: #800000">'</span><span style="color: #000000">))
    </span></span><span style="color: #0000ff">print</span><span style="color: #000000">(a)

    </span><span style="color: #008000">#</span><span style="color: #008000"> 获取表里的所有数据，以shf字符分组，计算出所分组的数据有多少条</span>
    b = yu_wen_lao_shi.objects.all().values(<span style="color: #800000">'</span><span style="color: #800000">shf</span><span style="color: #800000">'</span>).<span style="background-color: #ff99cc">annotate(c=Count(<span style="color: #800000">'</span><span style="color: #800000">shf</span><span style="color: #800000">'</span><span style="color: #000000">))
    </span></span><span style="color: #0000ff">print</span><span style="color: #000000">(b)

    </span><span style="color: #0000ff">return</span> render(request,<span style="color: #800000">'</span><span style="color: #800000">index.html</span><span style="color: #800000">'</span>,locals())   <span style="color: #008000">#</span><span style="color: #008000">打开页面</span><span style="color: #008000">
#</span><span style="color: #008000"> 返回：</span><span style="color: #008000">
#</span><span style="color: #008000"> &lt;QuerySet [{'shf': '普通会员', 'c': 4}]&gt;</span><span style="color: #008000">
#</span><span style="color: #008000"> &lt;QuerySet [{'shf': '普通会员', 'c': 4}, {'shf': '黄金会员', 'c': 2}, {'shf': '超级会员', 'c': 1}]&gt;</span></pre>
</div>
<p>&nbsp;</p>
<p><strong>limit 、offset，分页</strong></p>
<div class="cnblogs_code">
<pre>        <span style="color: #008000">#</span><span style="color: #008000"> limit 、offset</span>
        <span style="color: #008000">#
</span>        <span style="color: #008000">#</span><span style="color: #008000"> models.Tb1.objects.all()[10:20]</span></pre>
</div>
<p>&nbsp;</p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">from</span> django.shortcuts <span style="color: #0000ff">import</span><span style="color: #000000"> render
</span><span style="color: #0000ff">from</span> app1.models <span style="color: #0000ff">import</span> *    <span style="color: #008000">#</span><span style="color: #008000">导入数据库操作模块</span>

<span style="color: #0000ff">from</span> django.db.models <span style="color: #0000ff">import</span> F,Q   <span style="color: #008000">#</span><span style="color: #008000">导入F和Q</span>

<span style="color: #0000ff">from</span> django.db.models <span style="color: #0000ff">import</span><span style="color: #000000"> Count, Min, Max, Sum

</span><span style="color: #008000">#</span><span style="color: #008000">逻辑处理模块</span>
<span style="color: #0000ff">def</span><span style="color: #000000"> special(request):
    </span><span style="color: #008000">#</span><span style="color: #008000">从第二条开始，获取到第五条</span>
    b = yu_wen_lao_shi.objects.all()<span style="background-color: #ff99cc">[2:5<span style="color: #000000">]
    </span></span><span style="color: #0000ff">print</span><span style="color: #000000">(b.values())

    </span><span style="color: #0000ff">return</span> render(request,<span style="color: #800000">'</span><span style="color: #800000">index.html</span><span style="color: #800000">'</span>,locals())   <span style="color: #008000">#</span><span style="color: #008000">打开页面</span><span style="color: #008000">
#</span><span style="color: #008000"> 返回：</span><span style="color: #008000">
#</span><span style="color: #008000"> &lt;QuerySet [{'xm': '张三3', 'id': 3, 'shf': '黄金会员'}, {'xm': '张三4', 'id': 4, 'shf': '普通会员'}, {'xm': '张三5', 'id': 5, 'shf': '超级会员'}]&gt;</span></pre>
</div>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="color: #000000"><strong>regex正则匹配，iregex 不区分大小写</strong></span></p>
<div class="cnblogs_code">
<pre>        <span style="color: #008000">#</span><span style="color: #008000"> Entry.objects.get(title__regex=r'^(An?|The) +')</span>
        <span style="color: #008000">#</span><span style="color: #008000"> Entry.objects.get(title__iregex=r'^(an?|the) +')</span></pre>
</div>
<p><strong>date日期</strong></p>
<div class="cnblogs_code">
<pre>        <span style="color: #008000">#</span><span style="color: #008000"> Entry.objects.filter(pub_date__date=datetime.date(2005, 1, 1))</span>
        <span style="color: #008000">#</span><span style="color: #008000"> Entry.objects.filter(pub_date__date__gt=datetime.date(2005, 1, 1))</span></pre>
</div>
<p><strong>year年</strong></p>
<div class="cnblogs_code">
<pre>        <span style="color: #008000">#</span><span style="color: #008000"> Entry.objects.filter(pub_date__year=2005)</span>
        <span style="color: #008000">#</span><span style="color: #008000"> Entry.objects.filter(pub_date__year__gte=2005)</span></pre>
</div>
<p><strong>month月</strong></p>
<div class="cnblogs_code">
<pre>        <span style="color: #008000">#</span><span style="color: #008000"> Entry.objects.filter(pub_date__month=12)</span>
        <span style="color: #008000">#</span><span style="color: #008000"> Entry.objects.filter(pub_date__month__gte=6)</span></pre>
</div>
<p><strong>day天</strong></p>
<div class="cnblogs_code">
<pre>        <span style="color: #008000">#</span><span style="color: #008000"> Entry.objects.filter(pub_date__day=3)</span>
        <span style="color: #008000">#</span><span style="color: #008000"> Entry.objects.filter(pub_date__day__gte=3)</span></pre>
</div>
<p><strong>week_day</strong></p>
<div class="cnblogs_code">
<pre>        <span style="color: #008000">#</span><span style="color: #008000"> Entry.objects.filter(pub_date__week_day=2)</span>
        <span style="color: #008000">#</span><span style="color: #008000"> Entry.objects.filter(pub_date__week_day__gte=2)</span></pre>
</div>
<p><strong>hour小时</strong></p>
<div class="cnblogs_code">
<pre>        <span style="color: #008000">#</span><span style="color: #008000"> Event.objects.filter(timestamp__hour=23)</span>
        <span style="color: #008000">#</span><span style="color: #008000"> Event.objects.filter(time__hour=5)</span>
        <span style="color: #008000">#</span><span style="color: #008000"> Event.objects.filter(timestamp__hour__gte=12)</span></pre>
</div>
<p><strong>minute</strong></p>
<div class="cnblogs_code">
<pre>        <span style="color: #008000">#</span><span style="color: #008000"> Event.objects.filter(timestamp__minute=29)</span>
        <span style="color: #008000">#</span><span style="color: #008000"> Event.objects.filter(time__minute=46)</span>
        <span style="color: #008000">#</span><span style="color: #008000"> Event.objects.filter(timestamp__minute__gte=29)</span></pre>
</div>
<p><strong>second</strong></p>
<div class="cnblogs_code">
<pre>        <span style="color: #008000">#</span><span style="color: #008000"> Event.objects.filter(timestamp__second=31)</span>
        <span style="color: #008000">#</span><span style="color: #008000"> Event.objects.filter(time__second=2)</span>
        <span style="color: #008000">#</span><span style="color: #008000"> Event.objects.filter(timestamp__second__gte=31)</span></pre>
</div>
<p>&nbsp;</p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong>删除数据</strong></span></p>
<p><span style="color: #ff0000; background-color: #ffffff"><strong><span style="color: #0000ff">delete()</span>删除数据</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">from</span> django.shortcuts <span style="color: #0000ff">import</span><span style="color: #000000"> render
</span><span style="color: #0000ff">from</span> app1.models <span style="color: #0000ff">import</span> *    <span style="color: #008000">#</span><span style="color: #008000">导入数据库操作模块</span>

<span style="color: #008000">#</span><span style="color: #008000">逻辑处理模块</span>
<span style="color: #0000ff">def</span><span style="color: #000000"> special(request):
    a </span>= yhubiao.objects.filter(mim=2345).<span style="background-color: #ff99cc">delete()</span>  <span style="color: #008000">#</span><span style="color: #008000">删除mim字段等于2345的条数据</span>
    <span style="color: #0000ff">print</span><span style="color: #000000">(a)

    </span><span style="color: #0000ff">return</span> render(request,<span style="color: #800000">'</span><span style="color: #800000">index.html</span><span style="color: #800000">'</span>,locals())   <span style="color: #008000">#</span><span style="color: #008000">打开页面</span>

<span style="color: #008000">#</span><span style="color: #008000">返回</span></pre>
</div>
<p>&nbsp;</p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong>修改数据</strong></span></p>
<p><span style="color: #ff0000; background-color: #ffffff"><strong><span style="color: #0000ff">update(字段=值)</span>修改数据</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">from</span> django.shortcuts <span style="color: #0000ff">import</span><span style="color: #000000"> render
</span><span style="color: #0000ff">from</span> app1.models <span style="color: #0000ff">import</span> *    <span style="color: #008000">#</span><span style="color: #008000">导入数据库操作模块</span>

<span style="color: #008000">#</span><span style="color: #008000">逻辑处理模块</span>
<span style="color: #0000ff">def</span><span style="color: #000000"> special(request):
    a </span>= yhubiao.objects.filter(mim=1988).update(mim=123)  <span style="color: #008000">#</span><span style="color: #008000">找到mim字段等于1988的数据，将mim字段值改为123，</span><span style="color: #008080">将指定条件的数据更新，均支持 **kwargs，支持字典</span></pre>
<pre> <span style="color: #0000ff">print</span><span style="color: #000000">(a) </span><span style="color: #0000ff">return</span> render(request,<span style="color: #800000">'</span><span style="color: #800000">index.html</span><span style="color: #800000">'</span>,locals()) <span style="color: #008000">#</span><span style="color: #008000">打开页面</span> <span style="color: #008000">#</span><span style="color: #008000">返回</span></pre>
</div>
<p><strong>方式二【不推荐】</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">from</span> django.shortcuts <span style="color: #0000ff">import</span><span style="color: #000000"> render
</span><span style="color: #0000ff">from</span> app1.models <span style="color: #0000ff">import</span> *    <span style="color: #008000">#</span><span style="color: #008000">导入数据库操作模块</span>

<span style="color: #008000">#</span><span style="color: #008000">逻辑处理模块</span>
<span style="color: #0000ff">def</span><span style="color: #000000"> special(request):
    obj </span>= yhubiao.objects.get(id=6<span style="color: #000000">)
    obj.mim </span>= <span style="color: #800000">'</span><span style="color: #800000">111</span><span style="color: #800000">'</span><span style="color: #000000">
    obj.save()

    </span><span style="color: #0000ff">return</span> render(request,<span style="color: #800000">'</span><span style="color: #800000">index.html</span><span style="color: #800000">'</span>,locals())   <span style="color: #008000">#</span><span style="color: #008000">打开页面</span>

<span style="color: #008000">#</span><span style="color: #008000">返回</span></pre>
</div>
<p>&nbsp;</p>
<p><strong>query &nbsp;查看sql语句</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">from</span> django.shortcuts <span style="color: #0000ff">import</span><span style="color: #000000"> render
</span><span style="color: #0000ff">from</span> app1.models <span style="color: #0000ff">import</span> *    <span style="color: #008000">#</span><span style="color: #008000">导入数据库操作模块</span>

<span style="color: #008000">#</span><span style="color: #008000">逻辑处理模块</span>
<span style="color: #0000ff">def</span><span style="color: #000000"> special(request):
    obj </span>=<span style="color: #000000"> yhubiao.objects.all()
    </span><span style="color: #0000ff">print</span>(obj.<span style="background-color: #ff99cc">query</span>)         <span style="color: #008000">#</span><span style="color: #008000">查看sql语句</span>

    <span style="color: #0000ff">return</span> render(request,<span style="color: #800000">'</span><span style="color: #800000">index.html</span><span style="color: #800000">'</span>,locals())   <span style="color: #008000">#</span><span style="color: #008000">打开页面</span>

<span style="color: #008000">#</span><span style="color: #008000">返回</span><span style="color: #008000">
#</span><span style="color: #008000"> SELECT `app1_yhubiao`.`id`, `app1_yhubiao`.`anem`, `app1_yhubiao`.`mim` FROM `app1_yhubiao`</span></pre>
</div>
<p>&nbsp;</p></div>