第一百三十八节，JavaScript，封装库--插件


			<div id="cnblogs_post_body" class="blogpost-body"><p><span style="color: #0000ff"><strong>JavaScript，封装库--插件</strong></span></p>
<p align="left"><strong>库主要是用来封装一般JavaScript的常规操作代码，而拖拽这种特效代码属于功能性代码，并不是必须的，所以这种类型的代码，我们建议另外封装，在需要的时候作为插件形式引入到库中，作为扩展。</strong></p>
<p align="left">&nbsp;</p>
<p align="left"><span style="color: #ff0000"><strong>在基础库设置一个extend()方法，来扩展插件</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">/*</span><span style="color: #008000">* 插件入口，简单的理解就是通过extend()方法，向此基础库添加一个原型方法
 *  此extend()方法，一般是给插件文件使用的，插件就是通过extend()方法，将插件方法添加到基础库原型的
 *  接收两个参数
 *  参数1是传入要添加的方法名称
 *  参数2是此方法的执行函数（包含代码）
 *</span><span style="color: #008000">*/</span><span style="color: #000000">
feng_zhuang_ku.prototype.extend </span>= <span style="color: #0000ff">function</span><span style="color: #000000"> (name,fn) {
    feng_zhuang_ku.prototype[name] </span>=<span style="color: #000000"> fn;
};</span></pre>
</div>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>插件扩展方式，如:拖拽为列</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">/*</span><span style="color: #008000">* tuo_zhuai()方法，将一个弹窗元素实现拖拽功能
 * 注意：有参设置拖拽点区块，只有弹窗的这个拖拽点区块才能拖拽，无参整个弹窗可以拖拽
 * 注意：一般需要在css文件将弹窗元素里的某一个区块光标设置成提示可以拖拽，如：cursor: move; （设置拖拽点）
 * 有一个参数，参数是弹窗元素里的拖拽点区块的字符串class值（设置拖拽点的class值）设置后弹窗元素里的这个拖拽点区块才能拖拽
 *</span><span style="color: #008000">*/</span>
<span style="color: #008000">//</span><span style="color: #008000">调用基础库extend()方法，创建基础库原型tuo_zhuai()方法</span>
$().extend('tuo_zhuai', <span style="color: #0000ff">function</span><span style="color: #000000"> (tuo_zhuai_dian) {
    </span><span style="color: #0000ff">if</span> (<span style="color: #0000ff">this</span>.jie_dian.length == 1<span style="color: #000000">) {
        </span><span style="color: #0000ff">var</span> yan_su = <span style="color: #0000ff">null</span><span style="color: #000000">;
        </span><span style="color: #0000ff">var</span> sum =<span style="color: #000000"> arguments.length;
        </span><span style="color: #0000ff">for</span> (<span style="color: #0000ff">var</span> i = 0; i &lt; <span style="color: #0000ff">this</span>.jie_dian.length; i++<span style="color: #000000">) {
            yan_su </span>= <span style="color: #0000ff">this</span><span style="color: #000000">.jie_dian[i];
        }
        addEvent(yan_su, </span>'mousedown', <span style="color: #0000ff">function</span><span style="color: #000000"> (e) {
            </span><span style="color: #0000ff">if</span> (trim(yan_su.innerHTML).length == 0<span style="color: #000000">)e.preventDefault();
            </span><span style="color: #0000ff">var</span> e1 = getEvent(e);  <span style="color: #008000">//</span><span style="color: #008000">getEvent()函数库函数，跨浏览器获取事件对象,事件event对象,</span>
            <span style="color: #0000ff">var</span> diffx = e1.clientX -<span style="color: #000000"> yan_su.offsetLeft;
            </span><span style="color: #0000ff">var</span> diffy = e1.clientY -<span style="color: #000000"> yan_su.offsetTop;
            </span><span style="color: #0000ff">if</span> (sum == 1<span style="color: #000000">) {
                </span><span style="color: #0000ff">if</span> (e.target.className ===<span style="color: #000000"> tuo_zhuai_dian) {
                    addEvent(document, </span>'mousemove'<span style="color: #000000">, move);
                    addEvent(document, </span>'mouseup'<span style="color: #000000">, up);
                }
            } </span><span style="color: #0000ff">else</span> <span style="color: #0000ff">if</span> (sum == 0<span style="color: #000000">) {
                addEvent(document, </span>'mousemove'<span style="color: #000000">, move);
                addEvent(document, </span>'mouseup'<span style="color: #000000">, up);
            }
            </span><span style="color: #0000ff">function</span><span style="color: #000000"> move(e) {
                </span><span style="color: #0000ff">var</span> e2 =<span style="color: #000000"> getEvent(e);
                </span><span style="color: #0000ff">var</span> left = e2.clientX -<span style="color: #000000"> diffx;
                </span><span style="color: #0000ff">var</span> top = e2.clientY -<span style="color: #000000"> diffy;
                </span><span style="color: #0000ff">if</span> (left &lt; 0<span style="color: #000000">) {
                    left </span>= 0<span style="color: #000000">;
                } </span><span style="color: #0000ff">else</span> <span style="color: #0000ff">if</span> (left &gt; getInner().width -<span style="color: #000000"> yan_su.offsetWidth) {
                    left </span>= getInner().width -<span style="color: #000000"> yan_su.offsetWidth;
                }
                </span><span style="color: #0000ff">if</span> (top &lt; 0<span style="color: #000000">) {
                    top </span>= 0<span style="color: #000000">;
                } </span><span style="color: #0000ff">else</span> <span style="color: #0000ff">if</span> (top &gt; getInner().height -<span style="color: #000000"> yan_su.offsetHeight) {
                    top </span>= getInner().height -<span style="color: #000000"> yan_su.offsetHeight;
                }
                yan_su.style.left </span>= left + 'px'<span style="color: #000000">;
                yan_su.style.top </span>= top + 'px'<span style="color: #000000">;
                </span><span style="color: #0000ff">if</span> (<span style="color: #0000ff">typeof</span> yan_su.setCapture != 'undefined'<span style="color: #000000">) {
                    yan_su.setCapture();
                }
            }

            </span><span style="color: #0000ff">function</span><span style="color: #000000"> up() {
                removeEvent(document, </span>'mousemove'<span style="color: #000000">, move);
                removeEvent(document, </span>'mouseup'<span style="color: #000000">, up);
                </span><span style="color: #0000ff">if</span> (<span style="color: #0000ff">typeof</span> yan_su.releaseCapture != 'undefined'<span style="color: #000000">) {
                    yan_su.releaseCapture();
                }
            }
        });
    } </span><span style="color: #0000ff">else</span><span style="color: #000000"> {
        alert(</span>"将一个弹窗元素实现拖拽功能,只能设置一个弹窗元素，目前jie_dian数组里是多个元素请检查！"<span style="color: #000000">)
    }
    </span><span style="color: #0000ff">return</span> <span style="color: #0000ff">this</span><span style="color: #000000">;
});</span></pre>
</div>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>插件说明</strong></span></p>
<pre><strong>/**------------------------------------------------插件说明--------------------------------------------**/</strong><br><strong>/** 插件是通过基础库的extend()方法，向基础库原型添加的插件方法</strong><br><strong> *  前台使用说明：</strong><br><strong> *  1.获取到目标对象，执行插件方法，如：$().huo_qu_id('login');</strong><br><strong> *  2.页面引入插件js文件，如：&lt;script type="text/javascript" src="feng_zhuang_ku/cha_jian/tuo_zhuai.js" charset="utf-8"&gt;&lt;/script&gt;</strong><br><strong> **/</strong><br><strong>/**------------------------------------------------插件说明--------------------------------------------**/</strong><br><strong>tuo_zhuai()方法，将一个弹窗元素实现拖拽功能</strong></pre></div>