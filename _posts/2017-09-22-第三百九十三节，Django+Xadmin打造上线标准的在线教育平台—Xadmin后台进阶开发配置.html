第三百九十三节，Django+Xadmin打造上线标准的在线教育平台—Xadmin后台进阶开发配置


			<div id="cnblogs_post_body" class="blogpost-body"><p><strong>第三百九十三节，Django+Xadmin打造上线标准的在线教育平台—Xadmin后台进阶开发配置</strong></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>设置后台某个字段的排序规则</strong></span></p>
<p><strong>在当前APP里的adminx.py文件里的数据表管理器里设置</strong></p>
<p><span style="color: #ff0000"><strong>ordering = ['-要排序的字段名称']-为倒序排序</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf8 -*-</span>

<span style="color: #0000ff">import</span><span style="color: #000000"> xadmin
</span><span style="color: #0000ff">from</span> xadmin <span style="color: #0000ff">import</span> views                <span style="color: #008000">#</span><span style="color: #008000"> 导入xadmin的views</span>

<span style="color: #0000ff">from</span> .models <span style="color: #0000ff">import</span><span style="color: #000000"> Users, Email, Banner


</span><span style="color: #0000ff">class</span> BasdSetting(object):              <span style="color: #008000">#</span><span style="color: #008000"> 主题管理器</span>
    enable_themes = True                <span style="color: #008000">#</span><span style="color: #008000"> 使用主题</span>
    use_bootswatch =<span style="color: #000000"> True
xadmin.site.register(views.BaseAdminView, BasdSetting)      </span><span style="color: #008000">#</span><span style="color: #008000"> 将主题管理器绑定views.BaseAdminView注册</span>


<span style="color: #0000ff">class</span> GlobalSettings(object):                               <span style="color: #008000">#</span><span style="color: #008000"> 头部系统名称和底部版权管理器</span>
    site_title = <span style="color: #800000">'</span><span style="color: #800000">玉秀管理系统</span><span style="color: #800000">'</span>                              <span style="color: #008000">#</span><span style="color: #008000"> 头部系统名称</span>
    site_footer = <span style="color: #800000">'</span><span style="color: #800000">玉秀管理系统，玉秀公司版权所有</span><span style="color: #800000">'</span>             <span style="color: #008000">#</span><span style="color: #008000"> 底部版权</span>
    menu_style = <span style="color: #800000">'</span><span style="color: #800000">accordion</span><span style="color: #800000">'</span>                                <span style="color: #008000">#</span><span style="color: #008000"> 设置数据管理导航折叠，以每一个app为一个折叠框</span>
xadmin.site.register(views.CommAdminView, GlobalSettings)   <span style="color: #008000">#</span><span style="color: #008000"> 头部系统名称和底部版权管理器绑定views.CommAdminView注册</span>


<span style="color: #0000ff">class</span> UsersAdmin(object):               <span style="color: #008000">#</span><span style="color: #008000"> 自定义用户信息数据表管理器类</span>
    <span style="color: #008000">#</span><span style="color: #008000"> 设置xadmin后台显示字段</span>
    list_display = [<span style="color: #800000">'</span><span style="color: #800000">username</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">password</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">nick_name</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">gender</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">email</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">address</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">mobile</span><span style="color: #800000">'</span><span style="color: #000000">,
                    </span><span style="color: #800000">'</span><span style="color: #800000">first_name</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">last_name</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">is_active</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">birday</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">last_login</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">date_joined</span><span style="color: #800000">'</span><span style="color: #000000">]
    </span><span style="color: #008000">#</span><span style="color: #008000"> 设置xadmin后台搜索字段，注意：搜索字段如果有时间类型会报错</span>
    search_fields = [<span style="color: #800000">'</span><span style="color: #800000">username</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">password</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">nick_name</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">gender</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">email</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">address</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">mobile</span><span style="color: #800000">'</span><span style="color: #000000">]
    </span><span style="color: #008000">#</span><span style="color: #008000"> 设置xadmin后台过滤器帅选字段，时间用过滤器来做</span>
    list_filter = [<span style="color: #800000">'</span><span style="color: #800000">username</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">password</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">nick_name</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">gender</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">email</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">address</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">mobile</span><span style="color: #800000">'</span><span style="color: #000000">,
                    </span><span style="color: #800000">'</span><span style="color: #800000">first_name</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">last_name</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">is_active</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">birday</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">last_login</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">date_joined</span><span style="color: #800000">'</span><span style="color: #000000">]
    model_icon </span>= <span style="color: #800000">'</span><span style="color: #800000">fa fa-user-plus</span><span style="color: #800000">'</span><span style="background-color: #ff99cc"><span style="color: #000000">
    ordering </span>= [<span style="color: #800000">'</span><span style="color: #800000">-id</span><span style="color: #800000">'</span></span><span style="color: #000000"><span style="background-color: #ff99cc">]</span>
xadmin.site.register(Users, UsersAdmin)     </span><span style="color: #008000">#</span><span style="color: #008000"> 将户信息数据表注册到xadmin后台显示</span></pre>
</div>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>设置后台某个字段为只读，不能修改</strong></span></p>
<p><strong><strong>在当前APP里的adminx.py文件里的数据表管理器里设置</strong></strong></p>
<p><span style="color: #ff0000"><strong><strong>readonly_fields = ['要设置只读的字段名称']</strong></strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf8 -*-</span>

<span style="color: #0000ff">import</span><span style="color: #000000"> xadmin
</span><span style="color: #0000ff">from</span> xadmin <span style="color: #0000ff">import</span> views                <span style="color: #008000">#</span><span style="color: #008000"> 导入xadmin的views</span>

<span style="color: #0000ff">from</span> .models <span style="color: #0000ff">import</span><span style="color: #000000"> Users, Email, Banner


</span><span style="color: #0000ff">class</span> BasdSetting(object):              <span style="color: #008000">#</span><span style="color: #008000"> 主题管理器</span>
    enable_themes = True                <span style="color: #008000">#</span><span style="color: #008000"> 使用主题</span>
    use_bootswatch =<span style="color: #000000"> True
xadmin.site.register(views.BaseAdminView, BasdSetting)      </span><span style="color: #008000">#</span><span style="color: #008000"> 将主题管理器绑定views.BaseAdminView注册</span>


<span style="color: #0000ff">class</span> GlobalSettings(object):                               <span style="color: #008000">#</span><span style="color: #008000"> 头部系统名称和底部版权管理器</span>
    site_title = <span style="color: #800000">'</span><span style="color: #800000">玉秀管理系统</span><span style="color: #800000">'</span>                              <span style="color: #008000">#</span><span style="color: #008000"> 头部系统名称</span>
    site_footer = <span style="color: #800000">'</span><span style="color: #800000">玉秀管理系统，玉秀公司版权所有</span><span style="color: #800000">'</span>             <span style="color: #008000">#</span><span style="color: #008000"> 底部版权</span>
    menu_style = <span style="color: #800000">'</span><span style="color: #800000">accordion</span><span style="color: #800000">'</span>                                <span style="color: #008000">#</span><span style="color: #008000"> 设置数据管理导航折叠，以每一个app为一个折叠框</span>
xadmin.site.register(views.CommAdminView, GlobalSettings)   <span style="color: #008000">#</span><span style="color: #008000"> 头部系统名称和底部版权管理器绑定views.CommAdminView注册</span>


<span style="color: #0000ff">class</span> UsersAdmin(object):               <span style="color: #008000">#</span><span style="color: #008000"> 自定义用户信息数据表管理器类</span>
    <span style="color: #008000">#</span><span style="color: #008000"> 设置xadmin后台显示字段</span>
    list_display = [<span style="color: #800000">'</span><span style="color: #800000">username</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">password</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">nick_name</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">gender</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">email</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">address</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">mobile</span><span style="color: #800000">'</span><span style="color: #000000">,
                    </span><span style="color: #800000">'</span><span style="color: #800000">first_name</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">last_name</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">is_active</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">birday</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">last_login</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">date_joined</span><span style="color: #800000">'</span><span style="color: #000000">]
    </span><span style="color: #008000">#</span><span style="color: #008000"> 设置xadmin后台搜索字段，注意：搜索字段如果有时间类型会报错</span>
    search_fields = [<span style="color: #800000">'</span><span style="color: #800000">username</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">password</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">nick_name</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">gender</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">email</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">address</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">mobile</span><span style="color: #800000">'</span><span style="color: #000000">]
    </span><span style="color: #008000">#</span><span style="color: #008000"> 设置xadmin后台过滤器帅选字段，时间用过滤器来做</span>
    list_filter = [<span style="color: #800000">'</span><span style="color: #800000">username</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">password</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">nick_name</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">gender</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">email</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">address</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">mobile</span><span style="color: #800000">'</span><span style="color: #000000">,
                    </span><span style="color: #800000">'</span><span style="color: #800000">first_name</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">last_name</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">is_active</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">birday</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">last_login</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">date_joined</span><span style="color: #800000">'</span><span style="color: #000000">]
    model_icon </span>= <span style="color: #800000">'</span><span style="color: #800000">fa fa-user-plus</span><span style="color: #800000">'</span><span style="color: #000000">
    ordering </span>= [<span style="color: #800000">'</span><span style="color: #800000">-id</span><span style="color: #800000">'</span><span style="color: #000000">]
    <span style="background-color: #ff99cc">readonly_fields </span></span><span style="background-color: #ff99cc">= [<span style="color: #800000">'</span><span style="color: #800000">password</span><span style="color: #800000">'</span></span><span style="color: #000000"><span style="background-color: #ff99cc">]</span>
xadmin.site.register(Users, UsersAdmin)     </span><span style="color: #008000">#</span><span style="color: #008000"> 将户信息数据表注册到xadmin后台显示</span></pre>
</div>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>设置后台某个字段不显示</strong></span></p>
<p><strong>在当前APP里的adminx.py文件里的数据表管理器里设置</strong></p>
<p><span style="color: #ff0000"><strong>exclude = ['要隐藏的字段']</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf8 -*-</span>

<span style="color: #0000ff">import</span><span style="color: #000000"> xadmin
</span><span style="color: #0000ff">from</span> xadmin <span style="color: #0000ff">import</span> views                <span style="color: #008000">#</span><span style="color: #008000"> 导入xadmin的views</span>

<span style="color: #0000ff">from</span> .models <span style="color: #0000ff">import</span><span style="color: #000000"> Users, Email, Banner


</span><span style="color: #0000ff">class</span> BasdSetting(object):              <span style="color: #008000">#</span><span style="color: #008000"> 主题管理器</span>
    enable_themes = True                <span style="color: #008000">#</span><span style="color: #008000"> 使用主题</span>
    use_bootswatch =<span style="color: #000000"> True
xadmin.site.register(views.BaseAdminView, BasdSetting)      </span><span style="color: #008000">#</span><span style="color: #008000"> 将主题管理器绑定views.BaseAdminView注册</span>


<span style="color: #0000ff">class</span> GlobalSettings(object):                               <span style="color: #008000">#</span><span style="color: #008000"> 头部系统名称和底部版权管理器</span>
    site_title = <span style="color: #800000">'</span><span style="color: #800000">玉秀管理系统</span><span style="color: #800000">'</span>                              <span style="color: #008000">#</span><span style="color: #008000"> 头部系统名称</span>
    site_footer = <span style="color: #800000">'</span><span style="color: #800000">玉秀管理系统，玉秀公司版权所有</span><span style="color: #800000">'</span>             <span style="color: #008000">#</span><span style="color: #008000"> 底部版权</span>
    menu_style = <span style="color: #800000">'</span><span style="color: #800000">accordion</span><span style="color: #800000">'</span>                                <span style="color: #008000">#</span><span style="color: #008000"> 设置数据管理导航折叠，以每一个app为一个折叠框</span>
xadmin.site.register(views.CommAdminView, GlobalSettings)   <span style="color: #008000">#</span><span style="color: #008000"> 头部系统名称和底部版权管理器绑定views.CommAdminView注册</span>


<span style="color: #0000ff">class</span> UsersAdmin(object):               <span style="color: #008000">#</span><span style="color: #008000"> 自定义用户信息数据表管理器类</span>
    <span style="color: #008000">#</span><span style="color: #008000"> 设置xadmin后台显示字段</span>
    list_display = [<span style="color: #800000">'</span><span style="color: #800000">username</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">password</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">nick_name</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">gender</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">email</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">address</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">mobile</span><span style="color: #800000">'</span><span style="color: #000000">,
                    </span><span style="color: #800000">'</span><span style="color: #800000">first_name</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">last_name</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">is_active</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">birday</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">last_login</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">date_joined</span><span style="color: #800000">'</span><span style="color: #000000">]
    </span><span style="color: #008000">#</span><span style="color: #008000"> 设置xadmin后台搜索字段，注意：搜索字段如果有时间类型会报错</span>
    search_fields = [<span style="color: #800000">'</span><span style="color: #800000">username</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">password</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">nick_name</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">gender</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">email</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">address</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">mobile</span><span style="color: #800000">'</span><span style="color: #000000">]
    </span><span style="color: #008000">#</span><span style="color: #008000"> 设置xadmin后台过滤器帅选字段，时间用过滤器来做</span>
    list_filter = [<span style="color: #800000">'</span><span style="color: #800000">username</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">password</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">nick_name</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">gender</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">email</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">address</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">mobile</span><span style="color: #800000">'</span><span style="color: #000000">,
                    </span><span style="color: #800000">'</span><span style="color: #800000">first_name</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">last_name</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">is_active</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">birday</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">last_login</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">date_joined</span><span style="color: #800000">'</span><span style="color: #000000">]
    model_icon </span>= <span style="color: #800000">'</span><span style="color: #800000">fa fa-user-plus</span><span style="color: #800000">'</span><span style="color: #000000">
    ordering </span>= [<span style="color: #800000">'</span><span style="color: #800000">-id</span><span style="color: #800000">'</span><span style="color: #000000">]
    readonly_fields </span>= [<span style="color: #800000">'</span><span style="color: #800000">password</span><span style="color: #800000">'</span><span style="color: #000000">]
    <span style="background-color: #ff99cc">exclude </span></span><span style="background-color: #ff99cc">= [<span style="color: #800000">'</span><span style="color: #800000">first_name</span><span style="color: #800000">'</span>,<span style="color: #800000">'</span><span style="color: #800000">last_name</span><span style="color: #800000">'</span></span><span style="color: #000000"><span style="background-color: #ff99cc">]</span>
xadmin.site.register(Users, UsersAdmin)     </span><span style="color: #008000">#</span><span style="color: #008000"> 将户信息数据表注册到xadmin后台显示</span></pre>
</div>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>设置后台某个外键字段，点击后不完全将数据加载出来，如果数据太大就很有用了，设置后会根据用户搜索词来显示外键，也就是自动ajax请求数据</strong></span></p>
<p><strong>注意：这个要设置在外键连接的表里，不是设置在外键表里【重点】</strong></p>
<p><span style="color: #ff0000"><strong>在当前APP里的adminx.py文件里的数据表管理器里设置</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">class</span><span style="color: #000000"><span style="background-color: #ff99cc"> CityDict</span>Admin(object):
    list_display </span>= [<span style="color: #800000">'</span><span style="color: #800000">name</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">desc</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">add_time</span><span style="color: #800000">'</span><span style="color: #000000">]
    search_fields </span>= [<span style="color: #800000">'</span><span style="color: #800000">name</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">desc</span><span style="color: #800000">'</span><span style="color: #000000">]
    list_filter </span>= [<span style="color: #800000">'</span><span style="color: #800000">name</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">desc</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">add_time</span><span style="color: #800000">'</span><span style="color: #000000">]
    model_icon </span>= <span style="color: #800000">'</span><span style="color: #800000">fa fa-flag-o</span><span style="color: #800000">'</span><span style="background-color: #ff99cc"><span style="color: #000000">
    relfield_style </span>= <span style="color: #800000">'</span><span style="color: #800000">fk-ajax</span><span style="color: #800000">'</span></span><span style="color: #000000">
xadmin.site.register(<span style="background-color: #ff99cc">CityDict</span>, CityDictAdmin)</span></pre>
</div>
<p><strong>数据库文件</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span>
<span style="color: #0000ff">from</span> <span style="color: #800080">__future__</span> <span style="color: #0000ff">import</span><span style="color: #000000"> unicode_literals
</span><span style="color: #0000ff">from</span> datetime <span style="color: #0000ff">import</span><span style="color: #000000"> datetime

</span><span style="color: #0000ff">from</span> django.db <span style="color: #0000ff">import</span> models        <span style="color: #008000">#</span><span style="color: #008000"> 导入models对象</span>

<span style="color: #0000ff">from</span> system.storage <span style="color: #0000ff">import</span><span style="color: #000000"> ImageStorage


</span><span style="color: #0000ff">class</span><span style="color: #000000"><span style="background-color: #ff99cc"> CityDict</span>(models.Model):
    name </span>= models.CharField(max_length=20, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">城市</span><span style="color: #800000">'</span><span style="color: #000000">)
    desc </span>= models.CharField(max_length=200, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">描述</span><span style="color: #800000">'</span><span style="color: #000000">)
    add_time </span>= models.DateTimeField(default=datetime.now, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">添加日期</span><span style="color: #800000">'</span><span style="color: #000000">)

    </span><span style="color: #0000ff">class</span><span style="color: #000000"> Meta:
        verbose_name </span>= <span style="color: #800000">'</span><span style="color: #800000">城市表</span><span style="color: #800000">'</span><span style="color: #000000">
        verbose_name_plural </span>=<span style="color: #000000"> verbose_name

    </span><span style="color: #0000ff">def</span> <span style="color: #800080">__str__</span><span style="color: #000000">(self):
        </span><span style="color: #0000ff">return</span><span style="color: #000000"> self.name


</span><span style="color: #0000ff">class</span><span style="color: #000000"><span style="background-color: #ffff00"> CourseOrg</span>(models.Model):
    name </span>= models.CharField(max_length=50, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">机构名称</span><span style="color: #800000">'</span><span style="color: #000000">)
    desc </span>= models.TextField(verbose_name=<span style="color: #800000">'</span><span style="color: #800000">机构描述</span><span style="color: #800000">'</span><span style="color: #000000">)
    category </span>= models.CharField(max_length=20, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">机构类别</span><span style="color: #800000">'</span>, default=<span style="color: #800000">'</span><span style="color: #800000">pxjg</span><span style="color: #800000">'</span>, choices=((<span style="color: #800000">'</span><span style="color: #800000">pxjg</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">培训机构</span><span style="color: #800000">'</span>), (<span style="color: #800000">'</span><span style="color: #800000">gx</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">高校</span><span style="color: #800000">'</span>), (<span style="color: #800000">'</span><span style="color: #800000">gr</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">个人</span><span style="color: #800000">'</span><span style="color: #000000">)))
    click </span>= models.IntegerField(default=0, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">点击数</span><span style="color: #800000">'</span><span style="color: #000000">)
    fav_nums </span>= models.IntegerField(default=0, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">收藏数</span><span style="color: #800000">'</span><span style="color: #000000">)
    image </span>= models.ImageField(upload_to=<span style="color: #800000">'</span><span style="color: #800000">org/%Y/%m</span><span style="color: #800000">'</span>, storage=ImageStorage(), verbose_name=<span style="color: #800000">'</span><span style="color: #800000">封面图</span><span style="color: #800000">'</span>, max_length=100<span style="color: #000000">)
    address </span>= models.CharField(max_length=150, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">机构地址</span><span style="color: #800000">'</span><span style="color: #000000">)
    <span style="background-color: #ffff00">city </span></span><span style="background-color: #ffff00">= models.ForeignKey(CityDict, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">外键城市表</span><span style="color: #800000">'</span></span><span style="color: #000000"><span style="background-color: #ffff00">)</span>
    add_time </span>= models.DateTimeField(default=datetime.now, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">添加日期</span><span style="color: #800000">'</span><span style="color: #000000">)

    </span><span style="color: #0000ff">class</span><span style="color: #000000"> Meta:
        verbose_name </span>= <span style="color: #800000">'</span><span style="color: #800000">课程机构表</span><span style="color: #800000">'</span><span style="color: #000000">
        verbose_name_plural </span>=<span style="color: #000000"> verbose_name

    </span><span style="color: #0000ff">def</span> <span style="color: #800080">__str__</span><span style="color: #000000">(self):
        </span><span style="color: #0000ff">return</span> self.name</pre>
</div>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>当添加或者编辑被外键表数据时，将外键表自动组装到被外键表</strong></span></p>
<p><strong><strong>在当前APP里的adminx.py文件里的数据表管理器里设置</strong></strong></p>
<p><span style="color: #ff0000"><strong>&nbsp;注意：只能将外键表组装到被外键表</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf8 -*-</span>
<span style="color: #0000ff">import</span><span style="color: #000000"> xadmin

</span><span style="color: #0000ff">from</span> .models <span style="color: #0000ff">import</span><span style="color: #000000"> CityDict, CourseOrg, Teacher


</span><span style="background-color: #ff99cc"><span style="color: #0000ff">class</span> Lessonline(object):                           <span style="color: #008000">#</span><span style="color: #008000"> 自定义类来组装，当添加或者编辑被外键表数据时，将外键表自动组装到被外键表</span>
    model =CourseOrg                                <span style="color: #008000">#</span><span style="color: #008000"> 设置外键表类名称</span>
    extra =<span style="color: #000000"> 0


</span></span><span style="background-color: #ccffff"><span style="color: #0000ff">class</span> CityDictAdmin(object):                        <span style="color: #008000">#</span><span style="color: #008000"> 城市表被机构表外键</span>
    list_display = [<span style="color: #800000">'</span><span style="color: #800000">name</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">desc</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">add_time</span><span style="color: #800000">'</span><span style="color: #000000">]
    search_fields </span>= [<span style="color: #800000">'</span><span style="color: #800000">name</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">desc</span><span style="color: #800000">'</span><span style="color: #000000">]
    list_filter </span>= [<span style="color: #800000">'</span><span style="color: #800000">name</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">desc</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">add_time</span><span style="color: #800000">'</span><span style="color: #000000">]
    model_icon </span>= <span style="color: #800000">'</span><span style="color: #800000">fa fa-flag-o</span><span style="color: #800000">'</span><span style="color: #000000">
    relfield_style </span>= <span style="color: #800000">'</span><span style="color: #800000">fk-ajax</span><span style="color: #800000">'</span><span style="background-color: #ff99cc"><span style="color: #000000">
    inlines </span>= [Lessonline]</span>                          <span style="color: #008000">#</span><span style="color: #008000"> 在被外键表写入inlines = 组装来</span>
<span style="color: #000000">xadmin.site.register(CityDict, CityDictAdmin)


</span></span><span style="background-color: #ccffcc"><span style="color: #0000ff">class</span> CourseOrgAdmin(object):                       <span style="color: #008000">#</span><span style="color: #008000"> 机构表外键了城市表</span>
    list_display = [<span style="color: #800000">'</span><span style="color: #800000">name</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">desc</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">click</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">fav_nums</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">image</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">address</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">city</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">add_time</span><span style="color: #800000">'</span><span style="color: #000000">]
    search_fields </span>= [<span style="color: #800000">'</span><span style="color: #800000">name</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">desc</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">fav_nums</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">address</span><span style="color: #800000">'</span><span style="color: #000000">]
    list_filter </span>= [<span style="color: #800000">'</span><span style="color: #800000">name</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">desc</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">click</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">fav_nums</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">image</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">address</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">city</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">add_time</span><span style="color: #800000">'</span><span style="color: #000000">]
    model_icon </span>= <span style="color: #800000">'</span><span style="color: #800000">fa fa-graduation-cap </span><span style="color: #800000">'</span><span style="color: #000000">
xadmin.site.register(CourseOrg, CourseOrgAdmin)</span></span></pre>
</div>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>后台显示两张表名称，管理的同一张表</strong></span></p>
<p><span style="color: #ff0000"><strong>实现原理，在models重新定义一个数据表类，继承原来的表，不写任何字段设置表名称，设置不生成表，然后将新定义的表类注册到后台即可，注册和显示字段等配置给原理的注册同理</strong></span></p>
<p><span style="color: #0000ff"><strong><strong>models</strong></strong></span></p>
<p><span style="color: #ff0000"><strong><strong>注意：<strong><strong>models里一定要设置&nbsp;</strong></strong>proxy = True 否则会生成新的表</strong></strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">class</span><span style="color: #000000"><span style="background-color: #ff99cc"> CourseOrg</span>(models.Model):
    name </span>= models.CharField(max_length=50, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">机构名称</span><span style="color: #800000">'</span><span style="color: #000000">)
    desc </span>= models.TextField(verbose_name=<span style="color: #800000">'</span><span style="color: #800000">机构描述</span><span style="color: #800000">'</span><span style="color: #000000">)
    category </span>= models.CharField(max_length=20, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">机构类别</span><span style="color: #800000">'</span>, default=<span style="color: #800000">'</span><span style="color: #800000">pxjg</span><span style="color: #800000">'</span>, choices=((<span style="color: #800000">'</span><span style="color: #800000">pxjg</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">培训机构</span><span style="color: #800000">'</span>), (<span style="color: #800000">'</span><span style="color: #800000">gx</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">高校</span><span style="color: #800000">'</span>), (<span style="color: #800000">'</span><span style="color: #800000">gr</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">个人</span><span style="color: #800000">'</span><span style="color: #000000">)))
    click </span>= models.IntegerField(default=0, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">点击数</span><span style="color: #800000">'</span><span style="color: #000000">)
    fav_nums </span>= models.IntegerField(default=0, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">收藏数</span><span style="color: #800000">'</span><span style="color: #000000">)
    image </span>= models.ImageField(upload_to=<span style="color: #800000">'</span><span style="color: #800000">org/%Y/%m</span><span style="color: #800000">'</span>, storage=ImageStorage(), verbose_name=<span style="color: #800000">'</span><span style="color: #800000">封面图</span><span style="color: #800000">'</span>, max_length=100<span style="color: #000000">)
    address </span>= models.CharField(max_length=150, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">机构地址</span><span style="color: #800000">'</span><span style="color: #000000">)
    city </span>= models.ForeignKey(CityDict, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">外键城市表</span><span style="color: #800000">'</span><span style="color: #000000">)
    add_time </span>= models.DateTimeField(default=datetime.now, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">添加日期</span><span style="color: #800000">'</span><span style="color: #000000">)

    </span><span style="color: #0000ff">class</span><span style="color: #000000"> Meta:
        verbose_name </span>= <span style="color: #800000">'</span><span style="color: #800000">课程机构表</span><span style="color: #800000">'</span><span style="color: #000000">
        verbose_name_plural </span>=<span style="color: #000000"> verbose_name

    </span><span style="color: #0000ff">def</span> <span style="color: #800080">__str__</span><span style="color: #000000">(self):
        </span><span style="color: #0000ff">return</span><span style="color: #000000"> self.name


</span><span style="background-color: #ff99cc"><span style="color: #0000ff">class</span> CourseOrg2(CourseOrg):                    <span style="color: #008000">#</span><span style="color: #008000"> 继承机构表</span>
    <span style="color: #0000ff">class</span><span style="color: #000000"> Meta:
        verbose_name </span>= <span style="color: #800000">'</span><span style="color: #800000">课程机构表2</span><span style="color: #800000">'</span><span style="color: #000000">
        verbose_name_plural </span>=<span style="color: #000000"> verbose_name
        proxy </span>= True                            <span style="color: #008000">#</span><span style="color: #008000"> 表示不生成表</span></span></pre>
</div>
<p><span style="color: #0000ff"><strong><strong>在当前APP里的adminx.py文件里的数据表管理器里设置</strong></strong></span></p>
<div class="cnblogs_code">
<pre><span style="background-color: #ff99cc"><span style="color: #0000ff">class</span><span style="color: #000000"> CourseOrg2Admin(object):
    </span><span style="color: #008000">#</span><span style="color: #008000"> 设置xadmin后台显示字段</span>
    list_display = [<span style="color: #800000">'</span><span style="color: #800000">name</span><span style="color: #800000">'</span><span style="color: #000000">]
xadmin.site.register(CourseOrg2, CourseOrg2Admin)</span></span></pre>
</div>
<p><img src="https://images2017.cnblogs.com/blog/955761/201709/955761-20170922173506212-879197076.png" alt=""></p>
<p>&nbsp;</p></div>