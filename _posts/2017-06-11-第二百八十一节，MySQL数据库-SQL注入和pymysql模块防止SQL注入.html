第二百八十一节，MySQL数据库-SQL注入和pymysql模块防止SQL注入


			<div id="cnblogs_post_body" class="blogpost-body"><p><strong>MySQL数据库-SQL注入和pymysql模块防止SQL注入</strong></p>
<p><span style="color: #ff0000"><strong><strong>SQL注入就是通过<strong>SQL语句绕开程序判断，获取到数据库的内容</strong></strong></strong></span></p>
<p><span style="color: #ff0000"><strong><strong><strong>下面以一个简单的程序登录<strong><strong><strong>SQL注入举例：</strong></strong></strong></strong></strong></strong></span></p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong><strong><strong><strong><strong><strong>正常登录</strong></strong></strong></strong></strong></strong></span></p>
<p><span style="color: #ff0000"><strong><strong><strong><strong><strong><strong>1、数据库有一张会员表</strong></strong></strong></strong></strong></strong></span></p>
<p><span style="color: #ff0000"><strong><strong><strong><strong><strong><strong><img src="https://images2015.cnblogs.com/blog/955761/201706/955761-20170611164151637-393515660.png" alt=""></strong></strong></strong></strong></strong></strong></span></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>2、用户输入账号和密码，到数据库查找此用户是否存在，存在登录成功，不存在登录失败</strong></span></p>
<p><span style="color: #ff0000"><strong><img src="https://images2015.cnblogs.com/blog/955761/201706/955761-20170611164508403-882566367.png" alt=""></strong></span></p>
<p>&nbsp;</p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000">coding:utf-8</span>

<span style="color: #0000ff">import</span><span style="color: #000000"> tornado.ioloop
</span><span style="color: #0000ff">import</span> tornado.web                                              <span style="color: #008000">#</span><span style="color: #008000">导入tornado模块下的web文件</span>
<span style="background-color: #ffff00"><span style="color: #0000ff">import</span> pymysql</span>                                                  <span style="color: #008000">#</span><span style="color: #008000">导入数据库模块</span>

<span style="color: #0000ff">class</span><span style="color: #000000"> khdHandler(tornado.web.RequestHandler):
    </span><span style="color: #0000ff">def</span><span style="color: #000000"> get(self):
        self.render(</span><span style="color: #800000">"</span><span style="color: #800000">khd.html</span><span style="color: #800000">"</span><span style="color: #000000">)
    </span><span style="background-color: #ffff00"><span style="background-color: #ffcc99"><span style="color: #0000ff">def</span><span style="color: #000000"> post(self):
        yhm </span>= self.get_argument(<span style="color: #800000">'</span><span style="color: #800000">yhm</span><span style="color: #800000">'</span>)  <span style="color: #008000">#</span><span style="color: #008000">接收用户名</span>
        mim = self.get_argument(<span style="color: #800000">'</span><span style="color: #800000">mim</span><span style="color: #800000">'</span>)  <span style="color: #008000">#</span><span style="color: #008000">接收密码</span></span>

        <span style="color: #008000">#</span><span style="color: #008000">连接数据库</span>
        conn = pymysql.connect(host=<span style="color: #800000">'</span><span style="color: #800000">127.0.0.1</span><span style="color: #800000">'</span>, port=3306, user=<span style="color: #800000">'</span><span style="color: #800000">root</span><span style="color: #800000">'</span>, passwd=<span style="color: #800000">'</span><span style="color: #800000">279819</span><span style="color: #800000">'</span>, db=<span style="color: #800000">'</span><span style="color: #800000">cshi</span><span style="color: #800000">'</span>,charset=<span style="color: #800000">'</span><span style="color: #800000">utf8</span><span style="color: #800000">'</span><span style="color: #000000">)
        </span><span style="color: #008000">#</span><span style="color: #008000"> 创建游标</span>
        cursor =<span style="color: #000000"> conn.cursor()

        <span style="background-color: #ffcc99">temp </span></span><span style="background-color: #ffcc99">= <span style="color: #800000">"</span><span style="color: #800000">select yhm from yhxx where yhm='%s' and mim='%s'</span><span style="color: #800000">"</span>%(yhm,mim) <span style="color: #008000">#</span><span style="color: #008000">字符串拼接SQL查询语句</span></span>
        <span style="color: #0000ff">print</span><span style="color: #000000">(temp)

        </span><span style="color: #008000">#</span><span style="color: #008000"> 执行SQL，并返回收影响行数</span>
        <span style="background-color: #ffcc99">effect_row =</span><span style="color: #000000"><span style="background-color: #ffcc99"> cursor.execute(temp)</span>

        shuju </span>= cursor.fetchall()  <span style="color: #008000">#</span><span style="color: #008000"> 获取游标里的数据</span>
        <span style="color: #0000ff">print</span><span style="color: #000000">(shuju)
        </span><span style="color: #008000">#</span><span style="color: #008000"> 提交，不然无法保存新建或者修改的数据</span>
        <span style="color: #008000">#</span><span style="color: #008000"> conn.commit()</span>

        <span style="color: #008000">#</span><span style="color: #008000"> 关闭游标</span>
<span style="color: #000000">        cursor.close()
        </span><span style="color: #008000">#</span><span style="color: #008000"> 关闭连接</span>
<span style="color: #000000">        conn.close()
        
        
        </span></span><span style="background-color: #ffcc99"><span style="color: #0000ff">if</span> shuju:                       <span style="color: #008000">#</span><span style="color: #008000">判断数据库存在用户</span>
            self.write(<span style="color: #800000">'</span><span style="color: #800000">登录成功</span><span style="color: #800000">'</span>)       <span style="color: #008000">#</span><span style="color: #008000">登录成功</span>
        <span style="color: #0000ff">else</span>:                           <span style="color: #008000">#</span><span style="color: #008000">数据库不存在用户</span>
            self.write(<span style="color: #800000">'</span><span style="color: #800000">登录失败</span><span style="color: #800000">'</span>)       <span style="color: #008000">#</span><span style="color: #008000">登录失败</span>
</span><span style="color: #000000">

settings </span>= {                                            <span style="color: #008000">#</span><span style="color: #008000">html文件归类配置，设置一个字典</span>
    <span style="color: #800000">"</span><span style="color: #800000">template_path</span><span style="color: #800000">"</span>:<span style="color: #800000">"</span><span style="color: #800000">views</span><span style="color: #800000">"</span>,                            <span style="color: #008000">#</span><span style="color: #008000">键为template_path固定的，值为要存放HTML的文件夹名称</span>
    <span style="color: #800000">"</span><span style="color: #800000">static_path</span><span style="color: #800000">"</span>:<span style="color: #800000">"</span><span style="color: #800000">statics</span><span style="color: #800000">"</span>,                            <span style="color: #008000">#</span><span style="color: #008000">键为static_path固定的，值为要存放js和css的文件夹名称</span>
<span style="color: #000000">}

</span><span style="color: #008000">#</span><span style="color: #008000">路由映射</span>
application = tornado.web.Application([                 <span style="color: #008000">#</span><span style="color: #008000">创建一个变量等于tornado.web下的Application方法</span>
    (r<span style="color: #800000">"</span><span style="color: #800000">/khd</span><span style="color: #800000">"</span><span style="color: #000000">, khdHandler),
],</span>**settings)                                           <span style="color: #008000">#</span><span style="color: #008000">将html文件归类配置字典，写在路由映射的第二个参数里</span>

<span style="color: #0000ff">if</span> <span style="color: #800080">__name__</span> == <span style="color: #800000">"</span><span style="color: #800000">__main__</span><span style="color: #800000">"</span><span style="color: #000000">:
    </span><span style="color: #008000">#</span><span style="color: #008000">内部socket运行起来</span>
    application.listen(8002)                            <span style="color: #008000">#</span><span style="color: #008000">设置端口</span>
    tornado.ioloop.IOLoop.instance().start()</pre>
</div>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>3、正常登录</strong></span></p>
<p><img src="https://images2015.cnblogs.com/blog/955761/201706/955761-20170611165419106-739911360.png" alt=""></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000">coding:utf-8</span>

<span style="color: #0000ff">import</span><span style="color: #000000"> tornado.ioloop
</span><span style="color: #0000ff">import</span> tornado.web                                              <span style="color: #008000">#</span><span style="color: #008000">导入tornado模块下的web文件</span>
<span style="color: #0000ff">import</span> pymysql                                                  <span style="color: #008000">#</span><span style="color: #008000">导入数据库模块</span>

<span style="color: #0000ff">class</span><span style="color: #000000"> khdHandler(tornado.web.RequestHandler):
    </span><span style="color: #0000ff">def</span><span style="color: #000000"> get(self):
        self.render(</span><span style="color: #800000">"</span><span style="color: #800000">khd.html</span><span style="color: #800000">"</span><span style="color: #000000">)
    </span><span style="color: #0000ff">def</span><span style="color: #000000"> post(self):
        <span style="background-color: #ff99cc">yhm </span></span><span style="background-color: #ff99cc">= self.get_argument(<span style="color: #800000">'</span><span style="color: #800000">yhm</span><span style="color: #800000">'</span>)  <span style="color: #008000">#</span><span style="color: #008000">接收用户名</span>
        mim = self.get_argument(<span style="color: #800000">'</span><span style="color: #800000">mim</span><span style="color: #800000">'</span>)  <span style="color: #008000">#</span><span style="color: #008000">接收密码</span></span>

        <span style="color: #008000">#</span><span style="color: #008000">连接数据库</span>
        conn = pymysql.connect(host=<span style="color: #800000">'</span><span style="color: #800000">127.0.0.1</span><span style="color: #800000">'</span>, port=3306, user=<span style="color: #800000">'</span><span style="color: #800000">root</span><span style="color: #800000">'</span>, passwd=<span style="color: #800000">'</span><span style="color: #800000">279819</span><span style="color: #800000">'</span>, db=<span style="color: #800000">'</span><span style="color: #800000">cshi</span><span style="color: #800000">'</span>,charset=<span style="color: #800000">'</span><span style="color: #800000">utf8</span><span style="color: #800000">'</span><span style="color: #000000">)
        </span><span style="color: #008000">#</span><span style="color: #008000"> 创建游标</span>
        cursor =<span style="color: #000000"> conn.cursor()

        <span style="background-color: #ff99cc">temp </span></span><span style="background-color: #ff99cc">= <span style="color: #800000">"</span><span style="color: #800000">select yhm from yhxx where yhm='%s' and mim='%s'</span><span style="color: #800000">"</span>%(yhm,mim) <span style="color: #008000">#</span><span style="color: #008000">字符串拼接SQL查询语句</span></span>
        <span style="color: #0000ff">print</span><span style="color: #000000">(temp)

        </span><span style="color: #008000">#</span><span style="color: #008000"> 执行SQL，并返回收影响行数</span>
       <span style="background-color: #ff99cc"> effect_row =</span><span style="color: #000000"><span style="background-color: #ff99cc"> cursor.execute(temp)</span>

        <span style="background-color: #ff99cc">shuju </span></span><span style="background-color: #ff99cc">= cursor.fetchall()  <span style="color: #008000">#</span><span style="color: #008000"> 获取游标里的数据</span></span>
        <span style="color: #0000ff">print</span><span style="color: #000000">(shuju)
        </span><span style="color: #008000">#</span><span style="color: #008000"> 提交，不然无法保存新建或者修改的数据</span>
        <span style="color: #008000">#</span><span style="color: #008000"> conn.commit()</span>

        <span style="color: #008000">#</span><span style="color: #008000"> 关闭游标</span>
<span style="color: #000000">        cursor.close()
        </span><span style="color: #008000">#</span><span style="color: #008000"> 关闭连接</span>
<span style="color: #000000">        conn.close()


        </span><span style="background-color: #ff99cc"><span style="color: #0000ff">if</span> shuju:                       <span style="color: #008000">#</span><span style="color: #008000">判断数据库存在用户</span>
            self.write(<span style="color: #800000">'</span><span style="color: #800000">登录成功</span><span style="color: #800000">'</span>)       <span style="color: #008000">#</span><span style="color: #008000">登录成功</span>
        <span style="color: #0000ff">else</span>:                           <span style="color: #008000">#</span><span style="color: #008000">数据库不存在用户</span>
            self.write(<span style="color: #800000">'</span><span style="color: #800000">登录失败</span><span style="color: #800000">'</span>)       <span style="color: #008000">#</span><span style="color: #008000">登录失败</span>
</span><span style="color: #000000">

settings </span>= {                                            <span style="color: #008000">#</span><span style="color: #008000">html文件归类配置，设置一个字典</span>
    <span style="color: #800000">"</span><span style="color: #800000">template_path</span><span style="color: #800000">"</span>:<span style="color: #800000">"</span><span style="color: #800000">views</span><span style="color: #800000">"</span>,                            <span style="color: #008000">#</span><span style="color: #008000">键为template_path固定的，值为要存放HTML的文件夹名称</span>
    <span style="color: #800000">"</span><span style="color: #800000">static_path</span><span style="color: #800000">"</span>:<span style="color: #800000">"</span><span style="color: #800000">statics</span><span style="color: #800000">"</span>,                            <span style="color: #008000">#</span><span style="color: #008000">键为static_path固定的，值为要存放js和css的文件夹名称</span>
<span style="color: #000000">}

</span><span style="color: #008000">#</span><span style="color: #008000">路由映射</span>
application = tornado.web.Application([                 <span style="color: #008000">#</span><span style="color: #008000">创建一个变量等于tornado.web下的Application方法</span>
    (r<span style="color: #800000">"</span><span style="color: #800000">/khd</span><span style="color: #800000">"</span><span style="color: #000000">, khdHandler),
],</span>**settings)                                           <span style="color: #008000">#</span><span style="color: #008000">将html文件归类配置字典，写在路由映射的第二个参数里</span>

<span style="color: #0000ff">if</span> <span style="color: #800080">__name__</span> == <span style="color: #800000">"</span><span style="color: #800000">__main__</span><span style="color: #800000">"</span><span style="color: #000000">:
    </span><span style="color: #008000">#</span><span style="color: #008000">内部socket运行起来</span>
    application.listen(8002)                            <span style="color: #008000">#</span><span style="color: #008000">设置端口</span>
    tornado.ioloop.IOLoop.instance().start()</pre>
</div>
<p><span style="color: #ff0000"><strong>实际SQL查询语句</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">select</span> yhm <span style="color: #0000ff">from</span> yhxx <span style="color: #0000ff">where</span> yhm<span style="color: #808080">=</span><span style="color: #ff0000">'</span><span style="color: #ff0000">张三</span><span style="color: #ff0000">'</span> <span style="color: #808080">and</span> mim<span style="color: #808080">=</span><span style="color: #ff0000">'</span><span style="color: #ff0000">123456</span><span style="color: #ff0000">'</span></pre>
</div>
<p><img src="https://images2015.cnblogs.com/blog/955761/201706/955761-20170611165753075-1023439970.png" alt=""></p>
<p><span style="color: #ff0000"><strong>数据库返回</strong></span></p>
<p><span style="color: #0000ff"><strong>(('张三',),)　　　　返回了元祖类型的数据库查到的数据</strong></span></p>
<p><img src="https://images2015.cnblogs.com/blog/955761/201706/955761-20170611170018778-512300142.png" alt=""></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong>SQL注入绕开密码</strong></span></p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong><img src="https://images2015.cnblogs.com/blog/955761/201706/955761-20170611170222418-277368922.png" alt=""></strong></span></p>
<p><span style="color: #ff0000; background-color: #ffffff"><strong><strong>实际SQL查询语句</strong></strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">select</span> yhm <span style="color: #0000ff">from</span> yhxx <span style="color: #0000ff">where</span> yhm<span style="color: #808080">=</span><span style="color: #ff0000">'</span><span style="color: #ff0000">张三</span><span style="color: #ff0000">'</span> <span style="color: #008080">--</span><span style="color: #008080"> j' and mim='789'</span></pre>
</div>
<p><span style="color: #ff0000"><strong><img src="https://images2015.cnblogs.com/blog/955761/201706/955761-20170611170915762-1270462474.png" alt=""></strong></span></p>
<p><span style="color: #ff0000"><strong>可以看到实际用户密码已经被注释了，也就不起作用了，只要用户名存在就可以登录，对于密码已经失效</strong></span></p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong><img src="https://images2015.cnblogs.com/blog/955761/201706/955761-20170611170740622-1155524743.png" alt=""></strong></span></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong><strong>SQL注入绕开用户名和密码</strong></strong></span></p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong><img src="https://images2015.cnblogs.com/blog/955761/201706/955761-20170611171050903-984944148.png" alt=""></strong></span></p>
<p><span style="color: #ff0000; background-color: #ffffff"><strong><strong>实际SQL查询语句</strong></strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008080">--</span><span style="color: #008080"> 查询yhxx表的yhm字典等于张飞，或者 1 = 1，即使yhm字段没有张飞，也能查询到所有数据</span>
<span style="color: #0000ff">select</span> yhm <span style="color: #0000ff">from</span> yhxx <span style="color: #0000ff">where</span> yhm<span style="color: #808080">=</span><span style="color: #ff0000">'</span><span style="color: #ff0000">张飞</span><span style="color: #ff0000">'</span> <span style="color: #808080">or</span> <span style="color: #800000; font-weight: bold">1</span> <span style="color: #808080">=</span> <span style="color: #800000; font-weight: bold">1</span> <span style="color: #008080">--</span><span style="color: #008080"> d' and mim='789'</span></pre>
</div>
<p><img src="https://images2015.cnblogs.com/blog/955761/201706/955761-20170611171537747-202898305.png" alt=""></p>
<p><span style="color: #ff0000; background-color: #ffffff"><strong>可以看到实际<strong>SQL查询语句，已经绕开了用户名和密码，直接获取了全部数据</strong></strong></span></p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong><img src="https://images2015.cnblogs.com/blog/955761/201706/955761-20170611172035215-1263755824.png" alt=""></strong></span></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>pymysql模块防止SQL注入</strong></span></p>
<p><span style="color: #ff0000"><strong><strong>pymysql模块的execute()方法，的参数2 字符串占位符变量，在参数2格式化<strong>SQL语句字符串，会自动调用<strong>pymysql模块里的mogrify()方法，将第二个参数的字符串里含有'号转化成\号，这样就防止了<strong>SQL注入</strong></strong></strong></strong></strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000">coding:utf-8</span>

<span style="color: #0000ff">import</span><span style="color: #000000"> tornado.ioloop
</span><span style="color: #0000ff">import</span> tornado.web                                              <span style="color: #008000">#</span><span style="color: #008000">导入tornado模块下的web文件</span>
<span style="color: #0000ff">import</span> pymysql                                                  <span style="color: #008000">#</span><span style="color: #008000">导入数据库模块</span>

<span style="color: #0000ff">class</span><span style="color: #000000"> khdHandler(tornado.web.RequestHandler):
    </span><span style="color: #0000ff">def</span><span style="color: #000000"> get(self):
        self.render(</span><span style="color: #800000">"</span><span style="color: #800000">khd.html</span><span style="color: #800000">"</span><span style="color: #000000">)
    </span><span style="color: #0000ff">def</span><span style="color: #000000"> post(self):
        <span style="background-color: #ffff00"><strong>yhm </strong></span></span><span style="background-color: #ff99cc">= self.get_argument(<span style="color: #800000">'</span><span style="color: #800000">yhm</span><span style="color: #800000">'</span>)  <span style="color: #008000">#</span><span style="color: #008000">接收用户名</span>
        <span style="background-color: #ffff00"><strong>mim</strong></span> = self.get_argument(<span style="color: #800000">'</span><span style="color: #800000">mim</span><span style="color: #800000">'</span>)  <span style="color: #008000">#</span><span style="color: #008000">接收密码</span></span>

        <span style="color: #008000">#</span><span style="color: #008000">连接数据库</span>
        <span style="background-color: #ff99cc">conn = pymysql.connect(host=<span style="color: #800000">'</span><span style="color: #800000">127.0.0.1</span><span style="color: #800000">'</span>, port=3306, user=<span style="color: #800000">'</span><span style="color: #800000">root</span><span style="color: #800000">'</span>, passwd=<span style="color: #800000">'</span><span style="color: #800000">279819</span><span style="color: #800000">'</span>, db=<span style="color: #800000">'</span><span style="color: #800000">cshi</span><span style="color: #800000">'</span>,charset=<span style="color: #800000">'</span><span style="color: #800000">utf8</span><span style="color: #800000">'</span><span style="color: #000000">)
        </span></span><span style="color: #008000">#</span><span style="color: #008000"> 创建游标</span>
        <span style="background-color: #ff99cc">cursor =<span style="color: #000000"> conn.cursor()

        </span></span><span style="color: #008000">#</span><span style="color: #008000">查看execute()方法调用的mogrify()方法，将接收到的数据，会把有'转换成\</span>
        <span style="background-color: #ff99cc">quer = <span style="background-color: #ffff00">cursor.mogrify</span>(<span style="color: #800000">"</span><span style="color: #800000">select yhm from yhxx where yhm=%s and mim=%s</span><span style="color: #800000">"</span><span style="color: #000000">,<strong><span style="background-color: #ffff00">(yhm,mim))
        </span></strong></span><span style="color: #0000ff">print</span><span style="color: #000000">(quer)


        </span></span><span style="color: #008000">#</span><span style="color: #008000"> 执行SQL，并返回收影响行数</span>
        <span style="background-color: #ff99cc">effect_row = <span style="background-color: #ffff00">cursor.execute</span>(<span style="color: #800000">"</span><span style="color: #800000">select yhm from yhxx where yhm=%s and mim=%s</span><span style="color: #800000">"</span></span><span style="color: #000000"><span style="background-color: #ff99cc">,<strong><span style="background-color: #ffff00">(yhm,mim))
</span></strong></span>
        <span style="background-color: #ff99cc">shuju </span></span><span style="background-color: #ff99cc">= cursor.fetchall()  <span style="color: #008000">#</span><span style="color: #008000"> 获取游标里的数据</span>
        <span style="color: #0000ff">print</span><span style="color: #000000">(shuju)
        </span></span><span style="color: #008000">#</span><span style="color: #008000"> 提交，不然无法保存新建或者修改的数据</span>
        <span style="color: #008000">#</span><span style="color: #008000"> conn.commit()</span>

        <span style="color: #008000">#</span><span style="color: #008000"> 关闭游标</span>
<span style="color: #000000">        cursor.close()
        </span><span style="color: #008000">#</span><span style="color: #008000"> 关闭连接</span>
<span style="color: #000000">        conn.close()


        </span><span style="background-color: #ff99cc"><span style="color: #0000ff">if</span> shuju:                       <span style="color: #008000">#</span><span style="color: #008000">判断数据库存在用户</span>
            self.write(<span style="color: #800000">'</span><span style="color: #800000">登录成功</span><span style="color: #800000">'</span>)       <span style="color: #008000">#</span><span style="color: #008000">登录成功</span>
        <span style="color: #0000ff">else</span>:                           <span style="color: #008000">#</span><span style="color: #008000">数据库不存在用户</span>
            self.write(<span style="color: #800000">'</span><span style="color: #800000">登录失败</span><span style="color: #800000">'</span>)       <span style="color: #008000">#</span><span style="color: #008000">登录失败</span></span>
<span style="color: #000000">

settings </span>= {                                            <span style="color: #008000">#</span><span style="color: #008000">html文件归类配置，设置一个字典</span>
    <span style="color: #800000">"</span><span style="color: #800000">template_path</span><span style="color: #800000">"</span>:<span style="color: #800000">"</span><span style="color: #800000">views</span><span style="color: #800000">"</span>,                            <span style="color: #008000">#</span><span style="color: #008000">键为template_path固定的，值为要存放HTML的文件夹名称</span>
    <span style="color: #800000">"</span><span style="color: #800000">static_path</span><span style="color: #800000">"</span>:<span style="color: #800000">"</span><span style="color: #800000">statics</span><span style="color: #800000">"</span>,                            <span style="color: #008000">#</span><span style="color: #008000">键为static_path固定的，值为要存放js和css的文件夹名称</span>
<span style="color: #000000">}

</span><span style="color: #008000">#</span><span style="color: #008000">路由映射</span>
application = tornado.web.Application([                 <span style="color: #008000">#</span><span style="color: #008000">创建一个变量等于tornado.web下的Application方法</span>
    (r<span style="color: #800000">"</span><span style="color: #800000">/khd</span><span style="color: #800000">"</span><span style="color: #000000">, khdHandler),
],</span>**settings)                                           <span style="color: #008000">#</span><span style="color: #008000">将html文件归类配置字典，写在路由映射的第二个参数里</span>

<span style="color: #0000ff">if</span> <span style="color: #800080">__name__</span> == <span style="color: #800000">"</span><span style="color: #800000">__main__</span><span style="color: #800000">"</span><span style="color: #000000">:
    </span><span style="color: #008000">#</span><span style="color: #008000">内部socket运行起来</span>
    application.listen(8002)                            <span style="color: #008000">#</span><span style="color: #008000">设置端口</span>
    tornado.ioloop.IOLoop.instance().start()</pre>
</div>
<p><img src="https://images2015.cnblogs.com/blog/955761/201706/955761-20170611184751809-276986729.png" alt=""></p>
<p><span style="color: #ff0000"><strong>被mogrify()方法，转换后的实际SQL语句</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">select</span> yhm <span style="color: #0000ff">from</span> yhxx <span style="color: #0000ff">where</span> yhm<span style="color: #808080">=</span><span style="color: #ff0000">'</span><span style="color: #ff0000">张飞\</span><span style="color: #ff0000">'</span> <span style="color: #808080">or</span> <span style="color: #800000; font-weight: bold">1</span> <span style="color: #808080">=</span> <span style="color: #800000; font-weight: bold">1</span> <span style="color: #008080">--</span><span style="color: #008080"> d' and mim='123456'</span></pre>
</div>
<p><span style="color: #ff0000"><strong>可以看到用户输入的'已经被转换成了\了，这样就防止了SQL注入</strong></span></p>
<p>&nbsp;</p></div>