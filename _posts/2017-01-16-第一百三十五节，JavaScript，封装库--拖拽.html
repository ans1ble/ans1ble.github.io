第一百三十五节，JavaScript，封装库--拖拽


			<div id="cnblogs_post_body" class="blogpost-body"><p><span style="color: #0000ff"><strong>JavaScript，封装库--拖拽</strong></span></p>
<p><span style="color: #ff0000"><strong><strong>封装库新增1个<strong>拖拽</strong>方法</strong></strong></span></p>
<p>&nbsp;</p>
<div class="cnblogs_code">
<pre><span style="color: #008000">/*</span><span style="color: #008000">* tuo_zhuai()方法，将一个弹窗元素实现拖拽功能
 * 注意：一般需要在css文件将元素里的某一个区块光标设置成提示可以拖拽，如：cursor: move;
 * 无参
 *</span><span style="color: #008000">*/</span><span style="color: #000000">
feng_zhuang_ku.prototype.tuo_zhuai </span>= <span style="color: #0000ff">function</span><span style="color: #000000"> () {
    </span><span style="color: #0000ff">if</span> (<span style="color: #0000ff">this</span>.jie_dian.length == 1<span style="color: #000000">) {
        </span><span style="color: #0000ff">var</span> yan_su = <span style="color: #0000ff">null</span><span style="color: #000000">;
        </span><span style="color: #0000ff">for</span> (<span style="color: #0000ff">var</span> i = 0; i &lt; <span style="color: #0000ff">this</span>.jie_dian.length; i++<span style="color: #000000">) {
            yan_su </span>= <span style="color: #0000ff">this</span><span style="color: #000000">.jie_dian[i];
        }
        yan_su.onmousedown </span>= <span style="color: #0000ff">function</span><span style="color: #000000"> (e) {
           </span><span style="color: #008000">//</span><span style="color: #008000"> preDef(e);  //preDef()函数库函数，阻止事件默认行为,</span>
            <span style="color: #0000ff">var</span> e1 = getEvent(e);  <span style="color: #008000">//</span><span style="color: #008000">getEvent()函数库函数，跨浏览器获取事件对象,事件event对象,</span>
            <span style="color: #0000ff">var</span> diffx = e1.clientX -<span style="color: #000000"> yan_su.offsetLeft;
            </span><span style="color: #0000ff">var</span> diffy = e1.clientY -<span style="color: #000000"> yan_su.offsetTop;
            </span><span style="color: #0000ff">if</span>(<span style="color: #0000ff">typeof</span> yan_su.setCapture != 'undefined'<span style="color: #000000">){
                yan_su.setCapture();
            }
            document.onmousemove </span>= <span style="color: #0000ff">function</span><span style="color: #000000"> (e) {
                </span><span style="color: #0000ff">var</span> e2 =<span style="color: #000000"> getEvent(e);
                </span><span style="color: #0000ff">var</span> left = e2.clientX -<span style="color: #000000"> diffx;
                </span><span style="color: #0000ff">var</span> top = e2.clientY -<span style="color: #000000"> diffy;
                </span><span style="color: #0000ff">if</span> (left &lt; 0<span style="color: #000000">){
                    left </span>= 0<span style="color: #000000">;
                }</span><span style="color: #0000ff">else</span> <span style="color: #0000ff">if</span>(left &gt; getInner().width -<span style="color: #000000"> yan_su.offsetWidth){
                    left </span>= getInner().width -<span style="color: #000000"> yan_su.offsetWidth;
                }
                </span><span style="color: #0000ff">if</span> (top &lt; 0<span style="color: #000000">){
                    top </span>= 0<span style="color: #000000">;
                }</span><span style="color: #0000ff">else</span> <span style="color: #0000ff">if</span>(top &gt; getInner().height -<span style="color: #000000"> yan_su.offsetHeight){
                    top </span>= getInner().height -<span style="color: #000000"> yan_su.offsetHeight;
                }
                yan_su.style.left </span>= left + 'px'<span style="color: #000000">;
                yan_su.style.top </span>= top + 'px'<span style="color: #000000">;
            };
            document.onmouseup </span>= <span style="color: #0000ff">function</span><span style="color: #000000"> () {
                document.onmousemove </span>= <span style="color: #0000ff">null</span><span style="color: #000000">;
                document.onmouseup </span>= <span style="color: #0000ff">null</span><span style="color: #000000">;
                </span><span style="color: #0000ff">if</span> (<span style="color: #0000ff">typeof</span> yan_su.releaseCapture != 'undefined'<span style="color: #000000">) {
                    yan_su.releaseCapture();
                }
            };
        };
    } </span><span style="color: #0000ff">else</span><span style="color: #000000"> {
        alert(</span>"将一个弹窗元素实现拖拽功能,只能设置一个弹窗元素，目前jie_dian数组里是多个元素请检查！"<span style="color: #000000">)
    }
    </span><span style="color: #0000ff">return</span> <span style="color: #0000ff">this</span><span style="color: #000000">;
};</span></pre>
</div>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>HTML代码</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">&lt;</span><span style="color: #800000">div </span><span style="color: #ff0000">id</span><span style="color: #0000ff">="login"</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">h2</span><span style="color: #0000ff">&gt;&lt;</span><span style="color: #800000">img </span><span style="color: #ff0000">src</span><span style="color: #0000ff">="img/close.png"</span><span style="color: #ff0000"> alt</span><span style="color: #0000ff">=""</span><span style="color: #ff0000"> class</span><span style="color: #0000ff">="close"</span> <span style="color: #0000ff">/&gt;</span>网站登录<span style="color: #0000ff">&lt;/</span><span style="color: #800000">h2</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div </span><span style="color: #ff0000">class</span><span style="color: #0000ff">="user"</span><span style="color: #0000ff">&gt;</span>帐 号：<span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="text"</span><span style="color: #ff0000"> name</span><span style="color: #0000ff">="user"</span><span style="color: #ff0000"> class</span><span style="color: #0000ff">="text"</span> <span style="color: #0000ff">/&gt;&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div </span><span style="color: #ff0000">class</span><span style="color: #0000ff">="pass"</span><span style="color: #0000ff">&gt;</span>密 码：<span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="password"</span><span style="color: #ff0000"> name</span><span style="color: #0000ff">="pass"</span><span style="color: #ff0000"> class</span><span style="color: #0000ff">="text"</span> <span style="color: #0000ff">/&gt;&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div </span><span style="color: #ff0000">class</span><span style="color: #0000ff">="button"</span><span style="color: #0000ff">&gt;&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="button"</span><span style="color: #ff0000"> class</span><span style="color: #0000ff">="submit"</span><span style="color: #ff0000"> value</span><span style="color: #0000ff">=""</span> <span style="color: #0000ff">/&gt;&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div </span><span style="color: #ff0000">class</span><span style="color: #0000ff">="other"</span><span style="color: #0000ff">&gt;</span>注册新用户 | 忘记密码？<span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span></pre>
</div>
<p>&nbsp;</p>
<p><strong><span style="color: #ff0000">css代码</span></strong></p>
<p>&nbsp;</p>
<div class="cnblogs_code">
<pre><span style="color: #008000">/*</span><span style="color: #008000">登录框</span><span style="color: #008000">*/</span><span style="color: #800000">
#login</span>{<span style="color: #ff0000">
    width</span>:<span style="color: #0000ff"> 350px</span>;<span style="color: #ff0000">
    height</span>:<span style="color: #0000ff"> 250px</span>;<span style="color: #ff0000">
    border</span>:<span style="color: #0000ff"> 1px solid #ccc</span>;<span style="color: #ff0000">
    position</span>:<span style="color: #0000ff">absolute</span>;<span style="color: #ff0000">
    display</span>:<span style="color: #0000ff"> none</span>;<span style="color: #ff0000">
    z-index</span>:<span style="color: #0000ff"> 9999</span>;<span style="color: #ff0000">
    background-color</span>:<span style="color: #0000ff"> #fff</span>;
}<span style="color: #800000">
#login h2</span>{<span style="color: #ff0000">
    background</span>:<span style="color: #0000ff"> rgba(0, 0, 0, 0) url("img/login_header.png") repeat-x scroll 0 0</span>;<span style="color: #ff0000">
    border-bottom</span>:<span style="color: #0000ff"> 1px solid #ccc</span>;<span style="color: #ff0000">
    color</span>:<span style="color: #0000ff"> #666</span>;<span style="color: #ff0000">
    font-size</span>:<span style="color: #0000ff"> 14px</span>;<span style="color: #ff0000">
    height</span>:<span style="color: #0000ff"> 40px</span>;<span style="color: #ff0000">
    line-height </span>:<span style="color: #0000ff"> 40px</span>;<span style="color: #ff0000">
    text-align</span>:<span style="color: #0000ff"> center</span>;<span style="color: #ff0000">
    letter-spacing</span>:<span style="color: #0000ff"> 1px</span>;<span style="color: #ff0000">
    margin</span>:<span style="color: #0000ff"> 0 0 20px</span>;<span style="color: #ff0000">
    cursor</span>:<span style="color: #0000ff"> move</span>;
}<span style="color: #800000">
#login h2 img</span>{<span style="color: #ff0000">
    cursor</span>:<span style="color: #0000ff"> pointer</span>;<span style="color: #ff0000">
    float</span>:<span style="color: #0000ff"> right</span>;<span style="color: #ff0000">
    position</span>:<span style="color: #0000ff"> relative</span>;<span style="color: #ff0000">
    right</span>:<span style="color: #0000ff"> 8px</span>;<span style="color: #ff0000">
    top</span>:<span style="color: #0000ff"> 14px</span>;
}<span style="color: #800000">
#login div.user, #login div.pass </span>{<span style="color: #ff0000">
    color</span>:<span style="color: #0000ff"> #666</span>;<span style="color: #ff0000">
    font-size</span>:<span style="color: #0000ff"> 14px</span>;<span style="color: #ff0000">
    padding</span>:<span style="color: #0000ff"> 5px 0</span>;<span style="color: #ff0000">
    text-align</span>:<span style="color: #0000ff"> center</span>;
}<span style="color: #800000">
#login input.text </span>{<span style="color: #ff0000">
    background</span>:<span style="color: #0000ff"> #fff none repeat scroll 0 0</span>;<span style="color: #ff0000">
    border</span>:<span style="color: #0000ff"> 1px solid #ccc</span>;<span style="color: #ff0000">
    font-size</span>:<span style="color: #0000ff"> 14px</span>;<span style="color: #ff0000">
    height</span>:<span style="color: #0000ff"> 25px</span>;<span style="color: #ff0000">
    width</span>:<span style="color: #0000ff"> 200px</span>;
}<span style="color: #800000">
#login .button </span>{<span style="color: #ff0000">
    padding</span>:<span style="color: #0000ff"> 20px 0</span>;<span style="color: #ff0000">
    text-align</span>:<span style="color: #0000ff"> center</span>;
}<span style="color: #800000">
#login input.submit </span>{<span style="color: #ff0000">
    background</span>:<span style="color: #0000ff"> rgba(0, 0, 0, 0) url("img/login_button.png") no-repeat scroll 0 0</span>;<span style="color: #ff0000">
    border</span>:<span style="color: #0000ff"> medium none</span>;<span style="color: #ff0000">
    cursor</span>:<span style="color: #0000ff"> pointer</span>;<span style="color: #ff0000">
    height</span>:<span style="color: #0000ff"> 30px</span>;<span style="color: #ff0000">
    width</span>:<span style="color: #0000ff"> 107px</span>;
}<span style="color: #800000">
#login .other </span>{<span style="color: #ff0000">
    color</span>:<span style="color: #0000ff"> #666</span>;<span style="color: #ff0000">
    padding</span>:<span style="color: #0000ff"> 15px 10px</span>;<span style="color: #ff0000">
    text-align</span>:<span style="color: #0000ff"> right</span>;
}
<span style="color: #008000">/*</span><span style="color: #008000">遮罩锁屏区块</span><span style="color: #008000">*/</span><span style="color: #800000">
#suo_ping</span>{<span style="color: #ff0000">
    z-index</span>:<span style="color: #0000ff"> 9998</span>; <span style="color: #008000">/*</span><span style="color: #008000">注意：如果遮罩层上面有元素，它的层级要大于9998</span><span style="color: #008000">*/</span><span style="color: #ff0000">
    background</span>:<span style="color: #0000ff"> #000</span>;<span style="color: #ff0000">
    filter</span>:<span style="color: #0000ff"> alpha(opacity=50)</span>;<span style="color: #ff0000">
    opacity</span>:<span style="color: #0000ff"> 0.5</span>;<span style="color: #ff0000">
    display</span>:<span style="color: #0000ff"> none</span>;
}</pre>
</div>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>前台js代码</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">//</span><span style="color: #008000">前台调用代码</span>
window.onload = <span style="color: #0000ff">function</span><span style="color: #000000"> (){
    </span><span style="color: #008000">//</span><span style="color: #008000">获取到个人中心元素节点，执行鼠标移入移出方法</span>
    $().huo_qu_class('ge_ren_zhong_xin','tou').shu_biao_yi_ru_yi_chu(<span style="color: #0000ff">function</span><span style="color: #000000"> () {
        </span><span style="color: #008000">//</span><span style="color: #008000">当鼠标移入时，改变个人中心背景图片</span>
        $(<span style="color: #0000ff">this</span>).css('background', 'url(img/arrow2.png) no-repeat right center'<span style="color: #000000">);
        </span><span style="color: #008000">//</span><span style="color: #008000">当鼠标移入时，将ul元素执行显示方法</span>
        $().huo_qu_name('ul'<span style="color: #000000">).xian_shi();
    }, </span><span style="color: #0000ff">function</span><span style="color: #000000"> () {
        </span><span style="color: #008000">//</span><span style="color: #008000">当鼠标移出时，改变个人中心背景图片</span>
        $(<span style="color: #0000ff">this</span>).css('background', 'url(img/arrow.png) no-repeat right center'<span style="color: #000000">);
        </span><span style="color: #008000">//</span><span style="color: #008000">当鼠标移出时，将ul元素执行隐藏方法</span>
        $().huo_qu_name('ul'<span style="color: #000000">).yin_cang();
    });

    </span><span style="color: #008000">//</span><span style="color: #008000">弹出登录框加遮罩锁屏</span>
    <span style="color: #008000">//</span><span style="color: #008000">获取登录框，执行将登录框居中方法，执行浏览器窗口事件方法</span>
    $().huo_qu_id('login').yuan_su_ju_zhong().chuang_kou_shi_jian(<span style="color: #0000ff">function</span><span style="color: #000000"> () {
        </span><span style="color: #008000">//</span><span style="color: #008000">获取登录框，执行将登录框居中方法</span>
        $().huo_qu_id('login'<span style="color: #000000">);
        </span><span style="color: #008000">//</span><span style="color: #008000">获取遮罩锁屏元素，执行遮罩锁屏方法</span>
        $().huo_qu_id('suo_ping'<span style="color: #000000">).zhe_zhao_suo_ping();
    });
    </span><span style="color: #008000">//</span><span style="color: #008000">获取登录元素节点，执行点击事件方法</span>
    $().huo_qu_class('deng_lu').on_click(<span style="color: #0000ff">function</span><span style="color: #000000"> () {
        </span><span style="color: #008000">//</span><span style="color: #008000">获取登录框，改变css</span>
        $().huo_qu_id('login'<span style="color: #000000">).xian_shi().yuan_su_ju_zhong();
        </span><span style="color: #008000">//</span><span style="color: #008000">获取遮罩锁屏元素，执行显示方法，执行遮罩锁屏方法</span>
        $().huo_qu_id('suo_ping'<span style="color: #000000">).xian_shi().zhe_zhao_suo_ping();
    });
    </span><span style="color: #008000">//</span><span style="color: #008000">获取登录框里的关闭元素，执行点击事件方法</span>
    $().huo_qu_class('close').on_click(<span style="color: #0000ff">function</span><span style="color: #000000"> () {
        </span><span style="color: #008000">//</span><span style="color: #008000">获取登录框，改变css</span>
        $().huo_qu_id('login'<span style="color: #000000">).yin_cang();
        </span><span style="color: #008000">//</span><span style="color: #008000">获取遮罩锁屏元素，执行隐藏方法</span>
        $().huo_qu_id('suo_ping'<span style="color: #000000">).yin_cang();
    });

    </span><span style="color: #008000">//</span><span style="color: #008000">拖拽</span>
    $().huo_qu_id('login'<span style="color: #000000">).tuo_zhuai();


};</span></pre>
</div>
<p>&nbsp;</p></div>