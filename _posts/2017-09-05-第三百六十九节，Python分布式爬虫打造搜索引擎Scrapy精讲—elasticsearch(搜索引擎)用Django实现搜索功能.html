第三百六十九节，Python分布式爬虫打造搜索引擎Scrapy精讲—elasticsearch(搜索引擎)用Django实现搜索功能


			<div id="cnblogs_post_body" class="blogpost-body"><p><strong>第三百六十九节，Python分布式爬虫打造搜索引擎Scrapy精讲—elasticsearch(搜索引擎)用Django实现搜索功能</strong></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong><strong>Django实现搜索功能</strong></strong></span></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong><strong>1、在<strong><strong>Django配置搜索结果页的路由映射</strong></strong></strong></strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #800000">"""</span><span style="color: #800000">pachong URL Configuration

The `urlpatterns` list routes URLs to views. For more information please see:
    https://docs.djangoproject.com/en/1.10/topics/http/urls/
Examples:
Function views
    1. Add an import:  from my_app import views
    2. Add a URL to urlpatterns:  url(r'^$', views.home, name='home')
Class-based views
    1. Add an import:  from other_app.views import Home
    2. Add a URL to urlpatterns:  url(r'^$', Home.as_view(), name='home')
Including another URLconf
    1. Import the include() function: from django.conf.urls import url, include
    2. Add a URL to urlpatterns:  url(r'^blog/', include('blog.urls'))
</span><span style="color: #800000">"""</span>
<span style="color: #0000ff">from</span> django.conf.urls <span style="color: #0000ff">import</span><span style="color: #000000"> url
</span><span style="color: #0000ff">from</span> django.contrib <span style="color: #0000ff">import</span><span style="color: #000000"> admin
</span><span style="color: #0000ff">from</span> app1 <span style="color: #0000ff">import</span><span style="color: #000000"> views

urlpatterns </span>=<span style="color: #000000"> [
    url(r</span><span style="color: #800000">'</span><span style="color: #800000">^admin/</span><span style="color: #800000">'</span><span style="color: #000000">, admin.site.urls),
    url(r</span><span style="color: #800000">'</span><span style="color: #800000">^$</span><span style="color: #800000">'</span><span style="color: #000000">, views.indexluoji),
    url(r</span><span style="color: #800000">'</span><span style="color: #800000">^index/</span><span style="color: #800000">'</span><span style="color: #000000">, views.indexluoji),
    url(r</span><span style="color: #800000">'</span><span style="color: #800000">^suggest/$</span><span style="color: #800000">'</span>, views.suggestluoji,name=<span style="color: #800000">"</span><span style="color: #800000">suggest</span><span style="color: #800000">"</span>),     <span style="color: #008000">#</span><span style="color: #008000"> 搜索字段补全请求</span>
<span style="background-color: #ffff00">    url(r<span style="color: #800000">'</span><span style="color: #800000">^search/$</span><span style="color: #800000">'</span>, views.searchluoji,name=<span style="color: #800000">"</span><span style="color: #800000">search</span><span style="color: #800000">"</span>),     <span style="color: #008000">#</span><span style="color: #008000"> 搜索</span></span>
<span style="color: #000000">
]</span></pre>
</div>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>2、编写逻辑处理函数</strong></span></p>
<p><span style="color: #ff0000"><strong>在逻辑处理函数里实现搜索数据</strong></span></p>
<p><span style="color: #ff0000"><strong>（1）获取到用户的搜索词</strong></span></p>
<p><span style="color: #ff0000"><strong>（2）利用原生的elasticsearch(搜索引擎)接口，实现搜索，注明：<strong>elasticsearch-dsl就是在原生的<strong>elasticsearch上做了封装</strong></strong></strong></span></p>
<p><span style="color: #ff0000"><strong><strong><strong>　　<span style="color: #0000ff">Elasticsearch()</span>方法，连接原生的elasticsearch服务器</strong></strong></strong></span></p>
<p><span style="color: #ff0000"><strong><strong><strong>　　<span style="color: #0000ff">search()</span>方法，原生elasticsearch查询方法，支持原生的elasticsearch查询语句，返回的原生语句结果也就是字典形式的数据</strong></strong></strong></span></p>
<p><span style="color: #ff0000"><strong><strong><strong>　　<span style="background-color: #ff99cc; color: #0000ff">在查询语句里进行关键词高亮处理</span></strong></strong></strong></span></p>
<p><span style="color: #ff0000"><strong><strong><strong>　　将查询到的结果，循环获取到后返回到html页面</strong></strong></strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">from</span> django.shortcuts <span style="color: #0000ff">import</span><span style="color: #000000"> render

</span><span style="color: #008000">#</span><span style="color: #008000"> Create your views here.</span>
<span style="color: #0000ff">from</span> django.shortcuts <span style="color: #0000ff">import</span><span style="color: #000000"> render,HttpResponse
</span><span style="color: #0000ff">from</span> django.views.generic.base <span style="color: #0000ff">import</span><span style="color: #000000"> View
</span><span style="color: #0000ff">from</span> app1.models <span style="color: #0000ff">import</span> lagouType               <span style="color: #008000">#</span><span style="color: #008000"> 导入操作elasticsearch(搜索引擎)类</span>
<span style="color: #0000ff">import</span><span style="color: #000000"> json
</span><span style="color: #0000ff">from</span> elasticsearch <span style="color: #0000ff">import</span> Elasticsearch         <span style="color: #008000">#</span><span style="color: #008000"> 导入原生的elasticsearch(搜索引擎)接口</span>
client = Elasticsearch(hosts=[<span style="color: #800000">"</span><span style="color: #800000">127.0.0.1</span><span style="color: #800000">"</span>])     <span style="color: #008000">#</span><span style="color: #008000"> 连接原生的elasticsearch</span>


<span style="color: #0000ff">def</span><span style="color: #000000"> indexluoji(request):
    </span><span style="color: #0000ff">print</span>(request.method)  <span style="color: #008000">#</span><span style="color: #008000"> 获取用户请求的路径</span>
    <span style="color: #0000ff">return</span> render(request, <span style="color: #800000">'</span><span style="color: #800000">index.html</span><span style="color: #800000">'</span><span style="color: #000000">)


</span><span style="color: #0000ff">def</span> suggestluoji(request):                                      <span style="color: #008000">#</span><span style="color: #008000"> 搜索自动补全逻辑处理</span>
    key_words = request.GET.get(<span style="color: #800000">'</span><span style="color: #800000">s</span><span style="color: #800000">'</span>, <span style="color: #800000">''</span>)                        <span style="color: #008000">#</span><span style="color: #008000"> 获取到请求词</span>
    re_datas =<span style="color: #000000"> []
    </span><span style="color: #0000ff">if</span><span style="color: #000000"> key_words:
        s </span>= lagouType.search()                                  <span style="color: #008000">#</span><span style="color: #008000"> 实例化elasticsearch(搜索引擎)类的search查询</span>
        s = s.suggest(<span style="color: #800000">'</span><span style="color: #800000">my_suggest</span><span style="color: #800000">'</span>, key_words, completion=<span style="color: #000000">{
            </span><span style="color: #800000">"</span><span style="color: #800000">field</span><span style="color: #800000">"</span>: <span style="color: #800000">"</span><span style="color: #800000">suggest</span><span style="color: #800000">"</span>, <span style="color: #800000">"</span><span style="color: #800000">fuzzy</span><span style="color: #800000">"</span><span style="color: #000000">: {
                </span><span style="color: #800000">"</span><span style="color: #800000">fuzziness</span><span style="color: #800000">"</span>: 1<span style="color: #000000">
            },
            </span><span style="color: #800000">"</span><span style="color: #800000">size</span><span style="color: #800000">"</span>: 5<span style="color: #000000">
        })
        suggestions </span>=<span style="color: #000000"> s.execute_suggest()
        </span><span style="color: #0000ff">for</span> match <span style="color: #0000ff">in</span><span style="color: #000000"> suggestions.my_suggest[0].options:
            source </span>=<span style="color: #000000"> match._source
            re_datas.append(source[</span><span style="color: #800000">"</span><span style="color: #800000">title</span><span style="color: #800000">"</span><span style="color: #000000">])
    </span><span style="color: #0000ff">return</span> HttpResponse(json.dumps(re_datas), content_type=<span style="color: #800000">"</span><span style="color: #800000">application/json</span><span style="color: #800000">"</span><span style="color: #000000">)


</span><span style="background-color: #ffff00"><span style="color: #0000ff">def</span> searchluoji(request):                                       <span style="color: #008000">#</span><span style="color: #008000"> 搜索逻辑处理</span>
    key_words = request.GET.get(<span style="color: #800000">'</span><span style="color: #800000">q</span><span style="color: #800000">'</span>, <span style="color: #800000">''</span>)                        <span style="color: #008000">#</span><span style="color: #008000"> 获取到请求词</span>
    response = client.search(                                   <span style="color: #008000">#</span><span style="color: #008000"> 原生的elasticsearch接口的search()方法，就是搜索，可以支持原生elasticsearch语句查询</span>
        index=<span style="color: #800000">"</span><span style="color: #800000">lagou</span><span style="color: #800000">"</span>,                                          <span style="color: #008000">#</span><span style="color: #008000"> 设置索引名称</span>
        doc_type=<span style="color: #800000">"</span><span style="color: #800000">biao</span><span style="color: #800000">"</span>,                                        <span style="color: #008000">#</span><span style="color: #008000"> 设置表名称</span>
        body={                                                  <span style="color: #008000">#</span><span style="color: #008000"> 书写elasticsearch语句</span>
            <span style="color: #800000">"</span><span style="color: #800000">query</span><span style="color: #800000">"</span><span style="color: #000000">: {
                </span><span style="color: #800000">"</span><span style="color: #800000">multi_match</span><span style="color: #800000">"</span>: {                                <span style="color: #008000">#</span><span style="color: #008000"> multi_match查询</span>
                    <span style="color: #800000">"</span><span style="color: #800000">query</span><span style="color: #800000">"</span>: key_words,                         <span style="color: #008000">#</span><span style="color: #008000"> 查询关键词</span>
                    <span style="color: #800000">"</span><span style="color: #800000">fields</span><span style="color: #800000">"</span>: [<span style="color: #800000">"</span><span style="color: #800000">title</span><span style="color: #800000">"</span>, <span style="color: #800000">"</span><span style="color: #800000">description</span><span style="color: #800000">"</span>]          <span style="color: #008000">#</span><span style="color: #008000"> 查询字段</span>
<span style="color: #000000">                }
            },
            </span><span style="color: #800000">"</span><span style="color: #800000">from</span><span style="color: #800000">"</span>: 0,                                          <span style="color: #008000">#</span><span style="color: #008000"> 从第几条开始获取</span>
            <span style="color: #800000">"</span><span style="color: #800000">size</span><span style="color: #800000">"</span>: 10,                                         <span style="color: #008000">#</span><span style="color: #008000"> 获取多少条数据</span>
<span style="background-color: #ff99cc">            <span style="color: #800000">"</span><span style="color: #800000">highlight</span><span style="color: #800000">"</span>: {                                      <span style="color: #008000">#</span><span style="color: #008000"> 查询关键词高亮处理</span>
                <span style="color: #800000">"</span><span style="color: #800000">pre_tags</span><span style="color: #800000">"</span>: [<span style="color: #800000">'</span><span style="color: #800000">&lt;span class="keyWord"&gt;</span><span style="color: #800000">'</span>],         <span style="color: #008000">#</span><span style="color: #008000"> 高亮开始标签</span>
                <span style="color: #800000">"</span><span style="color: #800000">post_tags</span><span style="color: #800000">"</span>: [<span style="color: #800000">'</span><span style="color: #800000">&lt;/span&gt;</span><span style="color: #800000">'</span>],                       <span style="color: #008000">#</span><span style="color: #008000"> 高亮结束标签</span>
                <span style="color: #800000">"</span><span style="color: #800000">fields</span><span style="color: #800000">"</span>: {                                     <span style="color: #008000">#</span><span style="color: #008000"> 高亮设置</span>
                    <span style="color: #800000">"</span><span style="color: #800000">title</span><span style="color: #800000">"</span>: {},                                <span style="color: #008000">#</span><span style="color: #008000"> 高亮字段</span>
                    <span style="color: #800000">"</span><span style="color: #800000">description</span><span style="color: #800000">"</span>: {}                           <span style="color: #008000">#</span><span style="color: #008000"> 高亮字段</span>
</span><span style="color: #000000"><span style="background-color: #ff99cc">                }</span>
            }
        }
    )
    total_nums </span>= response[<span style="color: #800000">"</span><span style="color: #800000">hits</span><span style="color: #800000">"</span>][<span style="color: #800000">"</span><span style="color: #800000">total</span><span style="color: #800000">"</span>]                      <span style="color: #008000">#</span><span style="color: #008000"> 获取查询结果的总条数</span>
    hit_list = []                                               <span style="color: #008000">#</span><span style="color: #008000"> 设置一个列表来储存搜索到的信息，返回给html页面</span>
    <span style="color: #0000ff">for</span> hit <span style="color: #0000ff">in</span> response[<span style="color: #800000">"</span><span style="color: #800000">hits</span><span style="color: #800000">"</span>][<span style="color: #800000">"</span><span style="color: #800000">hits</span><span style="color: #800000">"</span>]:                        <span style="color: #008000">#</span><span style="color: #008000"> 循环查询到的结果</span>
        hit_dict = {}                                           <span style="color: #008000">#</span><span style="color: #008000"> 设置一个字典来储存循环结果</span>
        <span style="color: #0000ff">if</span> <span style="color: #800000">"</span><span style="color: #800000">title</span><span style="color: #800000">"</span> <span style="color: #0000ff">in</span> hit[<span style="color: #800000">"</span><span style="color: #800000">highlight</span><span style="color: #800000">"</span>]:                         <span style="color: #008000">#</span><span style="color: #008000"> 判断title字段，如果高亮字段有类容</span>
            hit_dict[<span style="color: #800000">"</span><span style="color: #800000">title</span><span style="color: #800000">"</span>] = <span style="color: #800000">""</span>.join(hit[<span style="color: #800000">"</span><span style="color: #800000">highlight</span><span style="color: #800000">"</span>][<span style="color: #800000">"</span><span style="color: #800000">title</span><span style="color: #800000">"</span>])      <span style="color: #008000">#</span><span style="color: #008000"> 获取高亮里的title</span>
        <span style="color: #0000ff">else</span><span style="color: #000000">:
            hit_dict[</span><span style="color: #800000">"</span><span style="color: #800000">title</span><span style="color: #800000">"</span>] = hit[<span style="color: #800000">"</span><span style="color: #800000">_source</span><span style="color: #800000">"</span>][<span style="color: #800000">"</span><span style="color: #800000">title</span><span style="color: #800000">"</span>]                 <span style="color: #008000">#</span><span style="color: #008000"> 否则获取不是高亮里的title</span>

        <span style="color: #0000ff">if</span> <span style="color: #800000">"</span><span style="color: #800000">description</span><span style="color: #800000">"</span> <span style="color: #0000ff">in</span> hit[<span style="color: #800000">"</span><span style="color: #800000">highlight</span><span style="color: #800000">"</span>]:                           <span style="color: #008000">#</span><span style="color: #008000"> 判断description字段，如果高亮字段有类容</span>
            hit_dict[<span style="color: #800000">"</span><span style="color: #800000">description</span><span style="color: #800000">"</span>] = <span style="color: #800000">""</span>.join(hit[<span style="color: #800000">"</span><span style="color: #800000">highlight</span><span style="color: #800000">"</span>][<span style="color: #800000">"</span><span style="color: #800000">description</span><span style="color: #800000">"</span>])[:500]    <span style="color: #008000">#</span><span style="color: #008000"> 获取高亮里的description</span>
        <span style="color: #0000ff">else</span><span style="color: #000000">:
            hit_dict[</span><span style="color: #800000">"</span><span style="color: #800000">description</span><span style="color: #800000">"</span>] = hit[<span style="color: #800000">"</span><span style="color: #800000">_source</span><span style="color: #800000">"</span>][<span style="color: #800000">"</span><span style="color: #800000">description</span><span style="color: #800000">"</span>]     <span style="color: #008000">#</span><span style="color: #008000"> 否则获取不是高亮里的description</span>
<span style="color: #000000">
        hit_dict[</span><span style="color: #800000">"</span><span style="color: #800000">url</span><span style="color: #800000">"</span>] = hit[<span style="color: #800000">"</span><span style="color: #800000">_source</span><span style="color: #800000">"</span>][<span style="color: #800000">"</span><span style="color: #800000">url</span><span style="color: #800000">"</span>]                         <span style="color: #008000">#</span><span style="color: #008000"> 获取返回url</span>
<span style="color: #000000">
        hit_list.append(hit_dict)                                       </span><span style="color: #008000">#</span><span style="color: #008000"> 将获取到内容的字典，添加到列表</span>
    <span style="color: #0000ff">return</span> render(request, <span style="color: #800000">'</span><span style="color: #800000">result.html</span><span style="color: #800000">'</span>, {<span style="color: #800000">"</span><span style="color: #800000">all_hits</span><span style="color: #800000">"</span>: hit_list, <span style="color: #800000">"</span><span style="color: #800000">key_words</span><span style="color: #800000">"</span>: key_words})       <span style="color: #008000">#</span><span style="color: #008000">显示页面和将列表和搜索词返回到html</span></span></pre>
</div>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>3、html页面接收搜索结果</strong></span></p>
<p><span style="color: #ff0000"><strong>注意：因为<strong><strong>Django实现了防止恶意代码写入，凡是通过变量传输到html页面的html类型代码，将会被自动转换成字符串方式显示，索引我们需要在接收变量的字段用：<span style="color: #0000ff">{% autoescape off %} {{ 接收变量 }} {% endautoescape %}</span>，来显示html代码，</strong></strong></strong></span></p>
<p><span style="color: #ff0000"><strong><strong><strong>搜索后因为进行了一次跳转，所以搜索框里的搜索词将不存在，我们需要在传递搜索结果到页面的时候，将搜索词也传递进来填充到搜索框</strong></strong></strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">&lt;!</span><span style="color: #ff00ff">DOCTYPE html </span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">html </span><span style="color: #ff0000">xmlns</span><span style="color: #0000ff">="http://www.w3.org/1999/xhtml"</span><span style="color: #0000ff">&gt;</span><span style="color: #000000">
{#引入静态文件路径#}
{% load staticfiles %}
</span><span style="color: #0000ff">&lt;</span><span style="color: #800000">head</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">meta </span><span style="color: #ff0000">http-equiv</span><span style="color: #0000ff">="X-UA-Compatible"</span><span style="color: #ff0000"> content</span><span style="color: #0000ff">="IE=emulateIE7"</span> <span style="color: #0000ff">/&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">meta </span><span style="color: #ff0000">http-equiv</span><span style="color: #0000ff">="Content-Type"</span><span style="color: #ff0000"> content</span><span style="color: #0000ff">="text/html; charset=utf-8"</span> <span style="color: #0000ff">/&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">title</span><span style="color: #0000ff">&gt;</span>python-lcv-search搜索引擎<span style="color: #0000ff">&lt;/</span><span style="color: #800000">title</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">link </span><span style="color: #ff0000">href</span><span style="color: #0000ff">="{% static 'css/style.css'%}"</span><span style="color: #ff0000"> rel</span><span style="color: #0000ff">="stylesheet"</span><span style="color: #ff0000"> type</span><span style="color: #0000ff">="text/css"</span> <span style="color: #0000ff">/&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">link </span><span style="color: #ff0000">href</span><span style="color: #0000ff">="{% static 'css/result.css'%}"</span><span style="color: #ff0000"> rel</span><span style="color: #0000ff">="stylesheet"</span><span style="color: #ff0000"> type</span><span style="color: #0000ff">="text/css"</span> <span style="color: #0000ff">/&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">head</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">body</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">div </span><span style="color: #ff0000">id</span><span style="color: #0000ff">="container"</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div </span><span style="color: #ff0000">id</span><span style="color: #0000ff">="hd"</span><span style="color: #ff0000"> class</span><span style="color: #0000ff">="ue-clear"</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">a </span><span style="color: #ff0000">href</span><span style="color: #0000ff">="/"</span><span style="color: #0000ff">&gt;&lt;</span><span style="color: #800000">div </span><span style="color: #ff0000">class</span><span style="color: #0000ff">="logo"</span><span style="color: #0000ff">&gt;&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;&lt;/</span><span style="color: #800000">a</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">div </span><span style="color: #ff0000">class</span><span style="color: #0000ff">="inputArea"</span><span style="color: #0000ff">&gt;</span>
            <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="text"</span><span style="color: #ff0000"> class</span><span style="color: #0000ff">="searchInput"</span><span style="color: #ff0000"> value</span><span style="color: #0000ff">="<span style="background-color: #ffff00">{{ key_words }}</span>"</span><span style="color: #0000ff">/&gt;</span>
            <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="button"</span><span style="color: #ff0000"> class</span><span style="color: #0000ff">="searchButton"</span><span style="color: #ff0000"> onclick</span><span style="color: #0000ff">="add_search()"</span><span style="color: #0000ff">/&gt;</span>
        <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div </span><span style="color: #ff0000">class</span><span style="color: #0000ff">="nav"</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">ul </span><span style="color: #ff0000">class</span><span style="color: #0000ff">="searchList"</span><span style="color: #0000ff">&gt;</span>
            <span style="color: #0000ff">&lt;</span><span style="color: #800000">li </span><span style="color: #ff0000">class</span><span style="color: #0000ff">="searchItem current"</span><span style="color: #ff0000"> data-type</span><span style="color: #0000ff">="article"</span><span style="color: #0000ff">&gt;</span>文章<span style="color: #0000ff">&lt;/</span><span style="color: #800000">li</span><span style="color: #0000ff">&gt;</span>
            <span style="color: #0000ff">&lt;</span><span style="color: #800000">li </span><span style="color: #ff0000">class</span><span style="color: #0000ff">="searchItem"</span><span style="color: #ff0000"> data-type</span><span style="color: #0000ff">="question"</span><span style="color: #0000ff">&gt;</span>问答<span style="color: #0000ff">&lt;/</span><span style="color: #800000">li</span><span style="color: #0000ff">&gt;</span>
            <span style="color: #0000ff">&lt;</span><span style="color: #800000">li </span><span style="color: #ff0000">class</span><span style="color: #0000ff">="searchItem"</span><span style="color: #ff0000"> data-type</span><span style="color: #0000ff">="job"</span><span style="color: #0000ff">&gt;</span>职位<span style="color: #0000ff">&lt;/</span><span style="color: #800000">li</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;/</span><span style="color: #800000">ul</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div </span><span style="color: #ff0000">id</span><span style="color: #0000ff">="bd"</span><span style="color: #ff0000"> class</span><span style="color: #0000ff">="ue-clear"</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">div </span><span style="color: #ff0000">id</span><span style="color: #0000ff">="main"</span><span style="color: #0000ff">&gt;</span>
            <span style="color: #0000ff">&lt;</span><span style="color: #800000">div </span><span style="color: #ff0000">class</span><span style="color: #0000ff">="sideBar"</span><span style="color: #0000ff">&gt;</span>
                
                <span style="color: #0000ff">&lt;</span><span style="color: #800000">div </span><span style="color: #ff0000">class</span><span style="color: #0000ff">="subfield"</span><span style="color: #0000ff">&gt;</span>网站<span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
                <span style="color: #0000ff">&lt;</span><span style="color: #800000">ul </span><span style="color: #ff0000">class</span><span style="color: #0000ff">="subfieldContext"</span><span style="color: #0000ff">&gt;</span>
                    <span style="color: #0000ff">&lt;</span><span style="color: #800000">li</span><span style="color: #0000ff">&gt;</span>
                        <span style="color: #0000ff">&lt;</span><span style="color: #800000">span </span><span style="color: #ff0000">class</span><span style="color: #0000ff">="name"</span><span style="color: #0000ff">&gt;</span>伯乐在线<span style="color: #0000ff">&lt;/</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span>
                        <span style="color: #0000ff">&lt;</span><span style="color: #800000">span </span><span style="color: #ff0000">class</span><span style="color: #0000ff">="unit"</span><span style="color: #0000ff">&gt;</span>(None)<span style="color: #0000ff">&lt;/</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span>
                    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">li</span><span style="color: #0000ff">&gt;</span>
                    <span style="color: #0000ff">&lt;</span><span style="color: #800000">li</span><span style="color: #0000ff">&gt;</span>
                        <span style="color: #0000ff">&lt;</span><span style="color: #800000">span </span><span style="color: #ff0000">class</span><span style="color: #0000ff">="name"</span><span style="color: #0000ff">&gt;</span>知乎<span style="color: #0000ff">&lt;/</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span>
                        <span style="color: #0000ff">&lt;</span><span style="color: #800000">span </span><span style="color: #ff0000">class</span><span style="color: #0000ff">="unit"</span><span style="color: #0000ff">&gt;</span>(9862)<span style="color: #0000ff">&lt;/</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span>
                    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">li</span><span style="color: #0000ff">&gt;</span>
                    <span style="color: #0000ff">&lt;</span><span style="color: #800000">li</span><span style="color: #0000ff">&gt;</span>
                        <span style="color: #0000ff">&lt;</span><span style="color: #800000">span </span><span style="color: #ff0000">class</span><span style="color: #0000ff">="name"</span><span style="color: #0000ff">&gt;</span>拉勾网<span style="color: #0000ff">&lt;/</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span>
                        <span style="color: #0000ff">&lt;</span><span style="color: #800000">span </span><span style="color: #ff0000">class</span><span style="color: #0000ff">="unit"</span><span style="color: #0000ff">&gt;</span>(9862)<span style="color: #0000ff">&lt;/</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span>
                    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">li</span><span style="color: #0000ff">&gt;</span>
                    <span style="color: #0000ff">&lt;</span><span style="color: #800000">li </span><span style="color: #ff0000">class</span><span style="color: #0000ff">="more"</span><span style="color: #0000ff">&gt;</span>
                        <span style="color: #0000ff">&lt;</span><span style="color: #800000">a </span><span style="color: #ff0000">href</span><span style="color: #0000ff">="javascript:;"</span><span style="color: #0000ff">&gt;</span>
                            <span style="color: #0000ff">&lt;</span><span style="color: #800000">span </span><span style="color: #ff0000">class</span><span style="color: #0000ff">="text"</span><span style="color: #0000ff">&gt;</span>更多<span style="color: #0000ff">&lt;/</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span>
                            <span style="color: #0000ff">&lt;</span><span style="color: #800000">i </span><span style="color: #ff0000">class</span><span style="color: #0000ff">="moreIcon"</span><span style="color: #0000ff">&gt;&lt;/</span><span style="color: #800000">i</span><span style="color: #0000ff">&gt;</span>
                        <span style="color: #0000ff">&lt;/</span><span style="color: #800000">a</span><span style="color: #0000ff">&gt;</span>
                    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">li</span><span style="color: #0000ff">&gt;</span>
                <span style="color: #0000ff">&lt;/</span><span style="color: #800000">ul</span><span style="color: #0000ff">&gt;</span>
                
                            
                <span style="color: #0000ff">&lt;</span><span style="color: #800000">div </span><span style="color: #ff0000">class</span><span style="color: #0000ff">="sideBarShowHide"</span><span style="color: #0000ff">&gt;</span>
                    <span style="color: #0000ff">&lt;</span><span style="color: #800000">a </span><span style="color: #ff0000">href</span><span style="color: #0000ff">="javascript:;"</span><span style="color: #ff0000"> class</span><span style="color: #0000ff">="icon"</span><span style="color: #0000ff">&gt;&lt;/</span><span style="color: #800000">a</span><span style="color: #0000ff">&gt;</span>
                <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
            <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
            <span style="color: #0000ff">&lt;</span><span style="color: #800000">div </span><span style="color: #ff0000">class</span><span style="color: #0000ff">="resultArea"</span><span style="color: #0000ff">&gt;</span>
                <span style="color: #0000ff">&lt;</span><span style="color: #800000">p </span><span style="color: #ff0000">class</span><span style="color: #0000ff">="resultTotal"</span><span style="color: #0000ff">&gt;</span>
                    <span style="color: #0000ff">&lt;</span><span style="color: #800000">span </span><span style="color: #ff0000">class</span><span style="color: #0000ff">="info"</span><span style="color: #0000ff">&gt;</span>找到约<span style="color: #ff0000">&amp;nbsp;</span><span style="color: #0000ff">&lt;</span><span style="color: #800000">span </span><span style="color: #ff0000">class</span><span style="color: #0000ff">="totalResult"</span><span style="color: #0000ff">&gt;</span>45<span style="color: #0000ff">&lt;/</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span><span style="color: #ff0000">&amp;nbsp;</span>条结果(用时<span style="color: #0000ff">&lt;</span><span style="color: #800000">span </span><span style="color: #ff0000">class</span><span style="color: #0000ff">="time"</span><span style="color: #0000ff">&gt;</span>0.643128<span style="color: #0000ff">&lt;/</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span>秒)，共约<span style="color: #0000ff">&lt;</span><span style="color: #800000">span </span><span style="color: #ff0000">class</span><span style="color: #0000ff">="totalPage"</span><span style="color: #0000ff">&gt;</span>5<span style="color: #0000ff">&lt;/</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span>页<span style="color: #0000ff">&lt;/</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span>
                <span style="color: #0000ff">&lt;/</span><span style="color: #800000">p</span><span style="color: #0000ff">&gt;</span>
                <span style="color: #0000ff">&lt;</span><span style="color: #800000">div </span><span style="color: #ff0000">class</span><span style="color: #0000ff">="resultList"</span><span style="color: #0000ff">&gt;</span><span style="color: #000000; background-color: #ff99cc">
                    {% for hit in all_hits %}
                    </span><span style="color: #0000ff">&lt;</span><span style="color: #800000">div </span><span style="color: #ff0000">class</span><span style="color: #0000ff">="resultItem"</span><span style="color: #0000ff">&gt;</span>
                            <span style="color: #0000ff">&lt;</span><span style="color: #800000">div </span><span style="color: #ff0000">class</span><span style="color: #0000ff">="itemHead"</span><span style="color: #0000ff">&gt;</span>
                                <span style="color: #0000ff">&lt;</span><span style="color: #800000">a </span><span style="color: #ff0000">href</span><span style="color: #0000ff">="<span style="background-color: #ccffff">{% autoescape off %} <span style="background-color: #ffff00">{{ hit.url }}</span> {% endautoescape %}</span>"</span><span style="color: #ff0000">  target</span><span style="color: #0000ff">="_blank"</span><span style="color: #ff0000"> class</span><span style="color: #0000ff">="title"</span><span style="color: #0000ff">&gt;</span><span style="background-color: #ccffff">{% autoescape off %} <span style="background-color: #ffff00">{{ hit.title }}</span> {% endautoescape %}</span><span style="color: #0000ff">&lt;/</span><span style="color: #800000">a</span><span style="color: #0000ff">&gt;</span>
                                <span style="color: #0000ff">&lt;</span><span style="color: #800000">span </span><span style="color: #ff0000">class</span><span style="color: #0000ff">="divsion"</span><span style="color: #0000ff">&gt;</span>-<span style="color: #0000ff">&lt;/</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span>
                                <span style="color: #0000ff">&lt;</span><span style="color: #800000">span </span><span style="color: #ff0000">class</span><span style="color: #0000ff">="fileType"</span><span style="color: #0000ff">&gt;</span>
                                    <span style="color: #0000ff">&lt;</span><span style="color: #800000">span </span><span style="color: #ff0000">class</span><span style="color: #0000ff">="label"</span><span style="color: #0000ff">&gt;</span>来源：<span style="color: #0000ff">&lt;/</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span>
                                    <span style="color: #0000ff">&lt;</span><span style="color: #800000">span </span><span style="color: #ff0000">class</span><span style="color: #0000ff">="value"</span><span style="color: #0000ff">&gt;</span>网络<span style="color: #0000ff">&lt;/</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span>
                                <span style="color: #0000ff">&lt;/</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span>
                                <span style="color: #0000ff">&lt;</span><span style="color: #800000">span </span><span style="color: #ff0000">class</span><span style="color: #0000ff">="dependValue"</span><span style="color: #0000ff">&gt;</span>
                                    <span style="color: #0000ff">&lt;</span><span style="color: #800000">span </span><span style="color: #ff0000">class</span><span style="color: #0000ff">="label"</span><span style="color: #0000ff">&gt;</span>得分：<span style="color: #0000ff">&lt;/</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span>
                                    <span style="color: #0000ff">&lt;</span><span style="color: #800000">span </span><span style="color: #ff0000">class</span><span style="color: #0000ff">="value"</span><span style="color: #0000ff">&gt;</span>3.401155<span style="color: #0000ff">&lt;/</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span>
                                <span style="color: #0000ff">&lt;/</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span>
                            <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
                            <span style="color: #0000ff">&lt;</span><span style="color: #800000">div </span><span style="color: #ff0000">class</span><span style="color: #0000ff">="itemBody"</span><span style="color: #0000ff">&gt;</span><span style="color: #000000; background-color: #ccffff">
                                {% autoescape off %} <span style="background-color: #ffff00">{{ hit.description }}</span> {% endautoescape %}
                            </span><span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
                        <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span><span style="color: #000000; background-color: #ff99cc">
                    {% endfor %}
                </span><span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
                <span style="color: #008000">&lt;!--</span><span style="color: #008000"> 分页 </span><span style="color: #008000">--&gt;</span>
                <span style="color: #0000ff">&lt;</span><span style="color: #800000">div </span><span style="color: #ff0000">class</span><span style="color: #0000ff">="pagination ue-clear"</span><span style="color: #0000ff">&gt;&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
                <span style="color: #008000">&lt;!--</span><span style="color: #008000"> 相关搜索 </span><span style="color: #008000">--&gt;</span>
                
                
                
            <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
            <span style="color: #0000ff">&lt;</span><span style="color: #800000">div </span><span style="color: #ff0000">class</span><span style="color: #0000ff">="historyArea"</span><span style="color: #0000ff">&gt;</span>
                <span style="color: #0000ff">&lt;</span><span style="color: #800000">div </span><span style="color: #ff0000">class</span><span style="color: #0000ff">="hotSearch"</span><span style="color: #0000ff">&gt;</span>
                    <span style="color: #0000ff">&lt;</span><span style="color: #800000">h6</span><span style="color: #0000ff">&gt;</span>热门搜索<span style="color: #0000ff">&lt;/</span><span style="color: #800000">h6</span><span style="color: #0000ff">&gt;</span>
                    <span style="color: #0000ff">&lt;</span><span style="color: #800000">ul </span><span style="color: #ff0000">class</span><span style="color: #0000ff">="historyList"</span><span style="color: #0000ff">&gt;</span>
                        
                            <span style="color: #0000ff">&lt;</span><span style="color: #800000">li</span><span style="color: #0000ff">&gt;&lt;</span><span style="color: #800000">a </span><span style="color: #ff0000">href</span><span style="color: #0000ff">="/search?q=linux"</span><span style="color: #0000ff">&gt;</span>linux<span style="color: #0000ff">&lt;/</span><span style="color: #800000">a</span><span style="color: #0000ff">&gt;&lt;/</span><span style="color: #800000">li</span><span style="color: #0000ff">&gt;</span>
                        
                    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">ul</span><span style="color: #0000ff">&gt;</span>
                <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
                <span style="color: #0000ff">&lt;</span><span style="color: #800000">div </span><span style="color: #ff0000">class</span><span style="color: #0000ff">="mySearch"</span><span style="color: #0000ff">&gt;</span>
                    <span style="color: #0000ff">&lt;</span><span style="color: #800000">h6</span><span style="color: #0000ff">&gt;</span>我的搜索<span style="color: #0000ff">&lt;/</span><span style="color: #800000">h6</span><span style="color: #0000ff">&gt;</span>
                    <span style="color: #0000ff">&lt;</span><span style="color: #800000">ul </span><span style="color: #ff0000">class</span><span style="color: #0000ff">="historyList"</span><span style="color: #0000ff">&gt;</span>

                    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">ul</span><span style="color: #0000ff">&gt;</span>
                <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
            <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span><span style="color: #008000">&lt;!--</span><span style="color: #008000"> End of main </span><span style="color: #008000">--&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span><span style="color: #008000">&lt;!--</span><span style="color: #008000">End of bd</span><span style="color: #008000">--&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>

<span style="color: #0000ff">&lt;</span><span style="color: #800000">div </span><span style="color: #ff0000">id</span><span style="color: #0000ff">="foot"</span><span style="color: #0000ff">&gt;</span>Copyright <span style="color: #ff0000">&amp;copy;</span>projectsedu.com 版权所有  E-mail:admin@projectsedu.com<span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">body</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">script </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="text/javascript"</span><span style="color: #ff0000"> src</span><span style="color: #0000ff">="{% static 'js/jquery.js'%}"</span><span style="color: #0000ff">&gt;&lt;/</span><span style="color: #800000">script</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">script </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="text/javascript"</span><span style="color: #ff0000"> src</span><span style="color: #0000ff">="{% static 'js/global.js'%}"</span><span style="color: #0000ff">&gt;&lt;/</span><span style="color: #800000">script</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">script </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="text/javascript"</span><span style="color: #ff0000"> src</span><span style="color: #0000ff">="{% static 'js/pagination.js'%}"</span><span style="color: #0000ff">&gt;&lt;/</span><span style="color: #800000">script</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">script </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="text/javascript"</span><span style="color: #0000ff">&gt;</span>
    <span style="background-color: #f5f5f5; color: #0000ff">var</span><span style="background-color: #f5f5f5; color: #000000"> search_url </span><span style="background-color: #f5f5f5; color: #000000">=</span> <span style="background-color: #f5f5f5; color: #000000">"</span><span style="background-color: #f5f5f5; color: #000000">/search/</span><span style="background-color: #f5f5f5; color: #000000">"</span><span style="background-color: #f5f5f5; color: #000000">

    $(</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">.searchList</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">).on(</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">click</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">, </span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">.searchItem</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">, </span><span style="background-color: #f5f5f5; color: #0000ff">function</span><span style="background-color: #f5f5f5; color: #000000">(){
        $(</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">.searchList .searchItem</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">).removeClass(</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">current</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">);
        $(</span><span style="background-color: #f5f5f5; color: #0000ff">this</span><span style="background-color: #f5f5f5; color: #000000">).addClass(</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">current</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">);    
    });
    
    $.each($(</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">.subfieldContext</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">), </span><span style="background-color: #f5f5f5; color: #0000ff">function</span><span style="background-color: #f5f5f5; color: #000000">(i, item){
        $(</span><span style="background-color: #f5f5f5; color: #0000ff">this</span><span style="background-color: #f5f5f5; color: #000000">).find(</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">li:gt(2)</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">).hide().end().find(</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">li:last</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">).show();        
    });

    </span><span style="background-color: #f5f5f5; color: #0000ff">function</span><span style="background-color: #f5f5f5; color: #000000"> removeByValue(arr, val) {
      </span><span style="background-color: #f5f5f5; color: #0000ff">for</span><span style="background-color: #f5f5f5; color: #000000">(</span><span style="background-color: #f5f5f5; color: #0000ff">var</span><span style="background-color: #f5f5f5; color: #000000"> i</span><span style="background-color: #f5f5f5; color: #000000">=</span><span style="background-color: #f5f5f5; color: #000000">0</span><span style="background-color: #f5f5f5; color: #000000">; i</span><span style="background-color: #f5f5f5; color: #000000">&lt;</span><span style="background-color: #f5f5f5; color: #000000">arr.length; i</span><span style="background-color: #f5f5f5; color: #000000">++</span><span style="background-color: #f5f5f5; color: #000000">) {
        </span><span style="background-color: #f5f5f5; color: #0000ff">if</span><span style="background-color: #f5f5f5; color: #000000">(arr[i] </span><span style="background-color: #f5f5f5; color: #000000">==</span><span style="background-color: #f5f5f5; color: #000000"> val) {
          arr.splice(i, </span><span style="background-color: #f5f5f5; color: #000000">1</span><span style="background-color: #f5f5f5; color: #000000">);
          </span><span style="background-color: #f5f5f5; color: #0000ff">break</span><span style="background-color: #f5f5f5; color: #000000">;
        }
      }
    }
    $(</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">.subfieldContext .more</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">).click(</span><span style="background-color: #f5f5f5; color: #0000ff">function</span><span style="background-color: #f5f5f5; color: #000000">(e){
        </span><span style="background-color: #f5f5f5; color: #0000ff">var</span><span style="background-color: #f5f5f5; color: #000000"> $more </span><span style="background-color: #f5f5f5; color: #000000">=</span><span style="background-color: #f5f5f5; color: #000000"> $(</span><span style="background-color: #f5f5f5; color: #0000ff">this</span><span style="background-color: #f5f5f5; color: #000000">).parent(</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">.subfieldContext</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">).find(</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">.more</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">);
        </span><span style="background-color: #f5f5f5; color: #0000ff">if</span><span style="background-color: #f5f5f5; color: #000000">($more.hasClass(</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">show</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">)){
            
            </span><span style="background-color: #f5f5f5; color: #0000ff">if</span><span style="background-color: #f5f5f5; color: #000000">($(</span><span style="background-color: #f5f5f5; color: #0000ff">this</span><span style="background-color: #f5f5f5; color: #000000">).hasClass(</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">define</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">)){
                $(</span><span style="background-color: #f5f5f5; color: #0000ff">this</span><span style="background-color: #f5f5f5; color: #000000">).parent(</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">.subfieldContext</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">).find(</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">.more</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">).removeClass(</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">show</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">).find(</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">.text</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">).text(</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">自定义</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">);
            }</span><span style="background-color: #f5f5f5; color: #0000ff">else</span><span style="background-color: #f5f5f5; color: #000000">{
                $(</span><span style="background-color: #f5f5f5; color: #0000ff">this</span><span style="background-color: #f5f5f5; color: #000000">).parent(</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">.subfieldContext</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">).find(</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">.more</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">).removeClass(</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">show</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">).find(</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">.text</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">).text(</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">更多</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">);    
            }
            $(</span><span style="background-color: #f5f5f5; color: #0000ff">this</span><span style="background-color: #f5f5f5; color: #000000">).parent(</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">.subfieldContext</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">).find(</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">li:gt(2)</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">).hide().end().find(</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">li:last</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">).show();
        }</span><span style="background-color: #f5f5f5; color: #0000ff">else</span><span style="background-color: #f5f5f5; color: #000000">{
            $(</span><span style="background-color: #f5f5f5; color: #0000ff">this</span><span style="background-color: #f5f5f5; color: #000000">).parent(</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">.subfieldContext</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">).find(</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">.more</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">).addClass(</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">show</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">).find(</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">.text</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">).text(</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">收起</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">);
            $(</span><span style="background-color: #f5f5f5; color: #0000ff">this</span><span style="background-color: #f5f5f5; color: #000000">).parent(</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">.subfieldContext</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">).find(</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">li:gt(2)</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">).show();    
        }
        
    });
    
    $(</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">.sideBarShowHide a</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">).click(</span><span style="background-color: #f5f5f5; color: #0000ff">function</span><span style="background-color: #f5f5f5; color: #000000">(e) {
        </span><span style="background-color: #f5f5f5; color: #0000ff">if</span><span style="background-color: #f5f5f5; color: #000000">($(</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">#main</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">).hasClass(</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">sideBarHide</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">)){
            $(</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">#main</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">).removeClass(</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">sideBarHide</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">);
            $(</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">#container</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">).removeClass(</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">sideBarHide</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">);
        }</span><span style="background-color: #f5f5f5; color: #0000ff">else</span><span style="background-color: #f5f5f5; color: #000000">{
            $(</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">#main</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">).addClass(</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">sideBarHide</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">);    
            $(</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">#container</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">).addClass(</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">sideBarHide</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">);
        }
        
    });
    </span><span style="background-color: #f5f5f5; color: #0000ff">var</span><span style="background-color: #f5f5f5; color: #000000"> key_words </span><span style="background-color: #f5f5f5; color: #000000">=</span> <span style="background-color: #f5f5f5; color: #000000">"</span><span style="background-color: #f5f5f5; color: #000000">java</span><span style="background-color: #f5f5f5; color: #000000">"</span>
    <span style="background-color: #f5f5f5; color: #008000">//</span><span style="background-color: #f5f5f5; color: #008000">分页</span>
<span style="background-color: #f5f5f5; color: #000000">    $(</span><span style="background-color: #f5f5f5; color: #000000">"</span><span style="background-color: #f5f5f5; color: #000000">.pagination</span><span style="background-color: #f5f5f5; color: #000000">"</span><span style="background-color: #f5f5f5; color: #000000">).pagination(</span><span style="background-color: #f5f5f5; color: #000000">45</span><span style="background-color: #f5f5f5; color: #000000">, {
        current_page :</span><span style="background-color: #f5f5f5; color: #000000">0</span><span style="background-color: #f5f5f5; color: #000000">, </span><span style="background-color: #f5f5f5; color: #008000">//</span><span style="background-color: #f5f5f5; color: #008000">当前页码</span>
<span style="background-color: #f5f5f5; color: #000000">        items_per_page :</span><span style="background-color: #f5f5f5; color: #000000">10</span><span style="background-color: #f5f5f5; color: #000000">,
        display_msg :</span><span style="background-color: #f5f5f5; color: #0000ff">true</span><span style="background-color: #f5f5f5; color: #000000">,
        callback :pageselectCallback
    });
    </span><span style="background-color: #f5f5f5; color: #0000ff">function</span><span style="background-color: #f5f5f5; color: #000000"> pageselectCallback(page_id, jq) {
        window.location.href</span><span style="background-color: #f5f5f5; color: #000000">=</span><span style="background-color: #f5f5f5; color: #000000">search_url</span><span style="background-color: #f5f5f5; color: #000000">+</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">?q=</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">+</span><span style="background-color: #f5f5f5; color: #000000">key_words</span><span style="background-color: #f5f5f5; color: #000000">+</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">&amp;p=</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">+</span><span style="background-color: #f5f5f5; color: #000000">page_id
    }
    
    setHeight();
    $(window).resize(</span><span style="background-color: #f5f5f5; color: #0000ff">function</span><span style="background-color: #f5f5f5; color: #000000">(){
        setHeight();    
    });
    
    </span><span style="background-color: #f5f5f5; color: #0000ff">function</span><span style="background-color: #f5f5f5; color: #000000"> setHeight(){
        </span><span style="background-color: #f5f5f5; color: #0000ff">if</span><span style="background-color: #f5f5f5; color: #000000">($(</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">#container</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">).outerHeight() </span><span style="background-color: #f5f5f5; color: #000000">&lt;</span><span style="background-color: #f5f5f5; color: #000000"> $(window).height()){
            $(</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">#container</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">).height($(window).height()</span><span style="background-color: #f5f5f5; color: #000000">-</span><span style="background-color: #f5f5f5; color: #000000">33</span><span style="background-color: #f5f5f5; color: #000000">);
        }    
    }
</span><span style="color: #0000ff">&lt;/</span><span style="color: #800000">script</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">script </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="text/javascript"</span><span style="color: #0000ff">&gt;</span><span style="background-color: #f5f5f5; color: #000000">
    $(</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">.searchList</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">).on(</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">click</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">, </span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">.searchItem</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">, </span><span style="background-color: #f5f5f5; color: #0000ff">function</span><span style="background-color: #f5f5f5; color: #000000">(){
        $(</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">.searchList .searchItem</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">).removeClass(</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">current</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">);
        $(</span><span style="background-color: #f5f5f5; color: #0000ff">this</span><span style="background-color: #f5f5f5; color: #000000">).addClass(</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">current</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">);
    });

    </span><span style="background-color: #f5f5f5; color: #008000">//</span><span style="background-color: #f5f5f5; color: #008000"> 联想下拉显示隐藏</span>
<span style="background-color: #f5f5f5; color: #000000">    $(</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">.searchInput</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">).on(</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">focus</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">, </span><span style="background-color: #f5f5f5; color: #0000ff">function</span><span style="background-color: #f5f5f5; color: #000000">(){
        $(</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">.dataList</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">).show()
    });

    </span><span style="background-color: #f5f5f5; color: #008000">//</span><span style="background-color: #f5f5f5; color: #008000"> 联想下拉点击</span>
<span style="background-color: #f5f5f5; color: #000000">    $(</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">.dataList</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">).on(</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">click</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">, </span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">li</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">, </span><span style="background-color: #f5f5f5; color: #0000ff">function</span><span style="background-color: #f5f5f5; color: #000000">(){
        </span><span style="background-color: #f5f5f5; color: #0000ff">var</span><span style="background-color: #f5f5f5; color: #000000"> text </span><span style="background-color: #f5f5f5; color: #000000">=</span><span style="background-color: #f5f5f5; color: #000000"> $(</span><span style="background-color: #f5f5f5; color: #0000ff">this</span><span style="background-color: #f5f5f5; color: #000000">).text();
        $(</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">.searchInput</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">).val(text);
        $(</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">.dataList</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">).hide()
    });

    hideElement($(</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">.dataList</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">), $(</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">.searchInput</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">));
</span><span style="color: #0000ff">&lt;/</span><span style="color: #800000">script</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">script</span><span style="color: #0000ff">&gt;</span>
    <span style="background-color: #f5f5f5; color: #0000ff">var</span><span style="background-color: #f5f5f5; color: #000000"> searchArr;
    </span><span style="background-color: #f5f5f5; color: #008000">//</span><span style="background-color: #f5f5f5; color: #008000">定义一个search的，判断浏览器有无数据存储（搜索历史）</span>
    <span style="background-color: #f5f5f5; color: #0000ff">if</span><span style="background-color: #f5f5f5; color: #000000">(localStorage.search){
        </span><span style="background-color: #f5f5f5; color: #008000">//</span><span style="background-color: #f5f5f5; color: #008000">如果有，转换成 数组的形式存放到searchArr的数组里（localStorage以字符串的形式存储，所以要把它转换成数组的形式）</span>
<span style="background-color: #f5f5f5; color: #000000">        searchArr</span><span style="background-color: #f5f5f5; color: #000000">=</span><span style="background-color: #f5f5f5; color: #000000"> localStorage.search.split(</span><span style="background-color: #f5f5f5; color: #000000">"</span><span style="background-color: #f5f5f5; color: #000000">,</span><span style="background-color: #f5f5f5; color: #000000">"</span><span style="background-color: #f5f5f5; color: #000000">)
    }</span><span style="background-color: #f5f5f5; color: #0000ff">else</span><span style="background-color: #f5f5f5; color: #000000">{
        </span><span style="background-color: #f5f5f5; color: #008000">//</span><span style="background-color: #f5f5f5; color: #008000">如果没有，则定义searchArr为一个空的数组</span>
<span style="background-color: #f5f5f5; color: #000000">        searchArr </span><span style="background-color: #f5f5f5; color: #000000">=</span><span style="background-color: #f5f5f5; color: #000000"> [];
    }
    </span><span style="background-color: #f5f5f5; color: #008000">//</span><span style="background-color: #f5f5f5; color: #008000">把存储的数据显示出来作为搜索历史</span>
<span style="background-color: #f5f5f5; color: #000000">    MapSearchArr();

    </span><span style="background-color: #f5f5f5; color: #0000ff">function</span><span style="background-color: #f5f5f5; color: #000000"> add_search(){
        </span><span style="background-color: #f5f5f5; color: #0000ff">var</span><span style="background-color: #f5f5f5; color: #000000"> val </span><span style="background-color: #f5f5f5; color: #000000">=</span><span style="background-color: #f5f5f5; color: #000000"> $(</span><span style="background-color: #f5f5f5; color: #000000">"</span><span style="background-color: #f5f5f5; color: #000000">.searchInput</span><span style="background-color: #f5f5f5; color: #000000">"</span><span style="background-color: #f5f5f5; color: #000000">).val();
        </span><span style="background-color: #f5f5f5; color: #0000ff">if</span><span style="background-color: #f5f5f5; color: #000000"> (val.length</span><span style="background-color: #f5f5f5; color: #000000">&gt;=</span><span style="background-color: #f5f5f5; color: #000000">2</span><span style="background-color: #f5f5f5; color: #000000">){
            </span><span style="background-color: #f5f5f5; color: #008000">//</span><span style="background-color: #f5f5f5; color: #008000">点击搜索按钮时，去重</span>
<span style="background-color: #f5f5f5; color: #000000">            KillRepeat(val);
            </span><span style="background-color: #f5f5f5; color: #008000">//</span><span style="background-color: #f5f5f5; color: #008000">去重后把数组存储到浏览器localStorage</span>
<span style="background-color: #f5f5f5; color: #000000">            localStorage.search </span><span style="background-color: #f5f5f5; color: #000000">=</span><span style="background-color: #f5f5f5; color: #000000"> searchArr;
            </span><span style="background-color: #f5f5f5; color: #008000">//</span><span style="background-color: #f5f5f5; color: #008000">然后再把搜索内容显示出来</span>
<span style="background-color: #f5f5f5; color: #000000">            MapSearchArr();
        }

        window.location.href</span><span style="background-color: #f5f5f5; color: #000000">=</span><span style="background-color: #f5f5f5; color: #000000">search_url</span><span style="background-color: #f5f5f5; color: #000000">+</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">?q=</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">+</span><span style="background-color: #f5f5f5; color: #000000">val</span><span style="background-color: #f5f5f5; color: #000000">+</span><span style="background-color: #f5f5f5; color: #000000">"</span><span style="background-color: #f5f5f5; color: #000000">&amp;s_type=</span><span style="background-color: #f5f5f5; color: #000000">"</span><span style="background-color: #f5f5f5; color: #000000">+</span><span style="background-color: #f5f5f5; color: #000000">$(</span><span style="background-color: #f5f5f5; color: #000000">"</span><span style="background-color: #f5f5f5; color: #000000">.searchItem.current</span><span style="background-color: #f5f5f5; color: #000000">"</span><span style="background-color: #f5f5f5; color: #000000">).attr(</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">data-type</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">)

    }

    </span><span style="background-color: #f5f5f5; color: #0000ff">function</span><span style="background-color: #f5f5f5; color: #000000"> MapSearchArr(){
        </span><span style="background-color: #f5f5f5; color: #0000ff">var</span><span style="background-color: #f5f5f5; color: #000000"> tmpHtml </span><span style="background-color: #f5f5f5; color: #000000">=</span> <span style="background-color: #f5f5f5; color: #000000">""</span><span style="background-color: #f5f5f5; color: #000000">;
        </span><span style="background-color: #f5f5f5; color: #0000ff">var</span><span style="background-color: #f5f5f5; color: #000000"> arrLen </span><span style="background-color: #f5f5f5; color: #000000">=</span> <span style="background-color: #f5f5f5; color: #000000">0</span>
        <span style="background-color: #f5f5f5; color: #0000ff">if</span><span style="background-color: #f5f5f5; color: #000000"> (searchArr.length </span><span style="background-color: #f5f5f5; color: #000000">&gt;</span> <span style="background-color: #f5f5f5; color: #000000">6</span><span style="background-color: #f5f5f5; color: #000000">){
            arrLen </span><span style="background-color: #f5f5f5; color: #000000">=</span> <span style="background-color: #f5f5f5; color: #000000">6</span><span style="background-color: #f5f5f5; color: #000000">
        }</span><span style="background-color: #f5f5f5; color: #0000ff">else</span><span style="background-color: #f5f5f5; color: #000000"> {
            arrLen </span><span style="background-color: #f5f5f5; color: #000000">=</span><span style="background-color: #f5f5f5; color: #000000"> searchArr.length
        }
        </span><span style="background-color: #f5f5f5; color: #0000ff">for</span><span style="background-color: #f5f5f5; color: #000000"> (</span><span style="background-color: #f5f5f5; color: #0000ff">var</span><span style="background-color: #f5f5f5; color: #000000"> i</span><span style="background-color: #f5f5f5; color: #000000">=</span><span style="background-color: #f5f5f5; color: #000000">0</span><span style="background-color: #f5f5f5; color: #000000">;i</span><span style="background-color: #f5f5f5; color: #000000">&lt;</span><span style="background-color: #f5f5f5; color: #000000">arrLen;i</span><span style="background-color: #f5f5f5; color: #000000">++</span><span style="background-color: #f5f5f5; color: #000000">){
            tmpHtml </span><span style="background-color: #f5f5f5; color: #000000">+=</span> <span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">&lt;li&gt;&lt;a href="/search?q=</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">+</span><span style="background-color: #f5f5f5; color: #000000">searchArr[i]</span><span style="background-color: #f5f5f5; color: #000000">+</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">"&gt;</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">+</span><span style="background-color: #f5f5f5; color: #000000">searchArr[i]</span><span style="background-color: #f5f5f5; color: #000000">+</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">&lt;/a&gt;&lt;/li&gt;</span><span style="background-color: #f5f5f5; color: #000000">'</span><span style="background-color: #f5f5f5; color: #000000">
        }
        $(</span><span style="background-color: #f5f5f5; color: #000000">"</span><span style="background-color: #f5f5f5; color: #000000">.mySearch .historyList</span><span style="background-color: #f5f5f5; color: #000000">"</span><span style="background-color: #f5f5f5; color: #000000">).append(tmpHtml);
    }
    </span><span style="background-color: #f5f5f5; color: #008000">//</span><span style="background-color: #f5f5f5; color: #008000">去重</span>
    <span style="background-color: #f5f5f5; color: #0000ff">function</span><span style="background-color: #f5f5f5; color: #000000"> KillRepeat(val){
        </span><span style="background-color: #f5f5f5; color: #0000ff">var</span><span style="background-color: #f5f5f5; color: #000000"> kill </span><span style="background-color: #f5f5f5; color: #000000">=</span> <span style="background-color: #f5f5f5; color: #000000">0</span><span style="background-color: #f5f5f5; color: #000000">;
        </span><span style="background-color: #f5f5f5; color: #0000ff">for</span><span style="background-color: #f5f5f5; color: #000000"> (</span><span style="background-color: #f5f5f5; color: #0000ff">var</span><span style="background-color: #f5f5f5; color: #000000"> i</span><span style="background-color: #f5f5f5; color: #000000">=</span><span style="background-color: #f5f5f5; color: #000000">0</span><span style="background-color: #f5f5f5; color: #000000">;i</span><span style="background-color: #f5f5f5; color: #000000">&lt;</span><span style="background-color: #f5f5f5; color: #000000">searchArr.length;i</span><span style="background-color: #f5f5f5; color: #000000">++</span><span style="background-color: #f5f5f5; color: #000000">){
            </span><span style="background-color: #f5f5f5; color: #0000ff">if</span><span style="background-color: #f5f5f5; color: #000000">(val</span><span style="background-color: #f5f5f5; color: #000000">===</span><span style="background-color: #f5f5f5; color: #000000">searchArr[i]){
                kill </span><span style="background-color: #f5f5f5; color: #000000">++</span><span style="background-color: #f5f5f5; color: #000000">;
            }
        }
        </span><span style="background-color: #f5f5f5; color: #0000ff">if</span><span style="background-color: #f5f5f5; color: #000000">(kill</span><span style="background-color: #f5f5f5; color: #000000">&lt;</span><span style="background-color: #f5f5f5; color: #000000">1</span><span style="background-color: #f5f5f5; color: #000000">){
            searchArr.unshift(val);
        }</span><span style="background-color: #f5f5f5; color: #0000ff">else</span><span style="background-color: #f5f5f5; color: #000000"> {
            removeByValue(searchArr, val)
            searchArr.unshift(val)
        }
    }
</span><span style="color: #0000ff">&lt;/</span><span style="color: #800000">script</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">html</span><span style="color: #0000ff">&gt;</span></pre>
</div>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>最终效果</strong></span></p>
<p><span style="color: #ff0000"><strong><img src="https://images2017.cnblogs.com/blog/955761/201709/955761-20170905192054241-920290083.png" alt=""></strong></span></p>
<p>&nbsp;</p></div>