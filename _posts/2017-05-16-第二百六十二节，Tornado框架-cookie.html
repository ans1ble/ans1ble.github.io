第二百六十二节，Tornado框架-cookie


			<div id="cnblogs_post_body" class="blogpost-body"><p><strong>Tornado框架-cookie</strong></p>
<p><strong>Cookie 是网站用来在客户端保存识别用户的一种小文件。一般来用库可以保存用户登 录信息、购物数据信息等一系列微小信息。</strong></p>
<p><span style="color: #ff0000"><strong>self.set_cookie()方法，创建cookie必写参数，cookie名称和cookie值，后面有可选参数</strong></span><br><span style="color: #ff0000"><strong>self.get_cookie()方法，获取指定cookie值，必写参数要获取的cookie名称</strong></span></p>
<p><span style="color: #0000ff"><strong>模板引擎</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000">coding:utf-8</span>

<span style="color: #0000ff">import</span><span style="color: #000000"> tornado.ioloop
</span><span style="color: #0000ff">import</span> tornado.web                              <span style="color: #008000">#</span><span style="color: #008000">导入tornado模块下的web文件</span>
<span style="color: #0000ff">import</span><span style="color: #000000"> uimodule

</span><span style="color: #008000">#</span><span style="color: #008000">逻辑处理</span>

<span style="color: #0000ff">class</span> indexHandler(tornado.web.RequestHandler):  <span style="color: #008000">#</span><span style="color: #008000">定义一个类，继承tornado.web下的RequestHandler类</span>
    <span style="color: #0000ff">def</span> get(self):                                              <span style="color: #008000">#</span><span style="color: #008000">get()方法，接收get方式请求</span>
        <span style="color: #0000ff">if</span> <span style="background-color: #ff99cc">self.get_cookie</span>(<span style="color: #800000">"</span><span style="color: #800000">admin</span><span style="color: #800000">"</span>) == <span style="color: #800000">"</span><span style="color: #800000">admin</span><span style="color: #800000">"</span>:                 <span style="color: #008000">#</span><span style="color: #008000">判断cookie值等于admin</span>
            self.render(<span style="color: #800000">"</span><span style="color: #800000">index.html</span><span style="color: #800000">"</span>)                           <span style="color: #008000">#</span><span style="color: #008000">显示index.html文件</span>
        <span style="color: #0000ff">else</span><span style="color: #000000">:
            self.redirect(</span><span style="color: #800000">"</span><span style="color: #800000">/dlu</span><span style="color: #800000">"</span>)                               <span style="color: #008000">#</span><span style="color: #008000">否则跳转到登录</span>


<span style="color: #0000ff">class</span> dluHandler(tornado.web.RequestHandler):  <span style="color: #008000">#</span><span style="color: #008000">定义一个类，继承tornado.web下的RequestHandler类</span>
    <span style="color: #0000ff">def</span> get(self):                                              <span style="color: #008000">#</span><span style="color: #008000">get()方法，接收get方式请求</span>
        self.render(<span style="color: #800000">"</span><span style="color: #800000">dlu.html</span><span style="color: #800000">"</span>,shib=<span style="color: #800000">""</span>)                         <span style="color: #008000">#</span><span style="color: #008000">显示dlu.html文件</span>
    <span style="color: #0000ff">def</span> post(self, *args, **kwargs):                            <span style="color: #008000">#</span><span style="color: #008000">处理post请求</span>
        yhm = self.get_argument(<span style="color: #800000">'</span><span style="color: #800000">yhm</span><span style="color: #800000">'</span>)                          <span style="color: #008000">#</span><span style="color: #008000">接收用户名</span>
        mim = self.get_argument(<span style="color: #800000">'</span><span style="color: #800000">mim</span><span style="color: #800000">'</span>)                          <span style="color: #008000">#</span><span style="color: #008000">接收密码</span>
        <span style="color: #0000ff">if</span> yhm ==<span style="color: #800000">"</span><span style="color: #800000">admin</span><span style="color: #800000">"</span> <span style="color: #0000ff">and</span> mim ==<span style="color: #800000">"</span><span style="color: #800000">admin</span><span style="color: #800000">"</span>:                     <span style="color: #008000">#</span><span style="color: #008000">判断用户名和密码</span>
            <span style="background-color: #ff99cc">self.set_cookie</span>(yhm,mim,expires_days=2)             <span style="color: #008000">#</span><span style="color: #008000">创建cookie</span>
            self.redirect(<span style="color: #800000">"</span><span style="color: #800000">/index</span><span style="color: #800000">"</span>)                             <span style="color: #008000">#</span><span style="color: #008000">跳转用户查看页面</span>
        <span style="color: #0000ff">else</span><span style="color: #000000">:
            self.render(</span><span style="color: #800000">"</span><span style="color: #800000">dlu.html</span><span style="color: #800000">"</span>, shib=<span style="color: #800000">"</span><span style="color: #800000">用户名或密码不正确</span><span style="color: #800000">"</span>)    <span style="color: #008000">#</span><span style="color: #008000">如果用户名和密码不正确，打开登录页面</span>

<span style="color: #0000ff">class</span><span style="color: #000000"> tuichuHandler(tornado.web.RequestHandler):
    </span><span style="color: #0000ff">def</span> get(self):                                              <span style="color: #008000">#</span><span style="color: #008000">处理get方法请求</span>
        <span style="background-color: #ff99cc">self.set_cookie</span>(<span style="color: #800000">"</span><span style="color: #800000">admin</span><span style="color: #800000">"</span>,<span style="color: #800000">"</span><span style="color: #800000">0</span><span style="color: #800000">"</span>,expires=0)                  <span style="color: #008000">#</span><span style="color: #008000">修改cookie值</span>
        self.redirect(<span style="color: #800000">"</span><span style="color: #800000">/index</span><span style="color: #800000">"</span>)                                 <span style="color: #008000">#</span><span style="color: #008000">跳转页面</span>
<span style="color: #000000">

settings </span>= {                                    <span style="color: #008000">#</span><span style="color: #008000">html文件归类配置，设置一个字典</span>
    <span style="color: #800000">"</span><span style="color: #800000">template_path</span><span style="color: #800000">"</span>:<span style="color: #800000">"</span><span style="color: #800000">template</span><span style="color: #800000">"</span>,                 <span style="color: #008000">#</span><span style="color: #008000">键为template_path固定的，值为要存放HTML的文件夹名称</span>
    <span style="color: #800000">"</span><span style="color: #800000">static_path</span><span style="color: #800000">"</span>:<span style="color: #800000">"</span><span style="color: #800000">static</span><span style="color: #800000">"</span>,                     <span style="color: #008000">#</span><span style="color: #008000">键为static_path固定的，值为要存放js和css的文件夹名称</span>
<span style="color: #000000">}

</span><span style="color: #008000">#</span><span style="color: #008000">路由映射</span>
application = tornado.web.Application([         <span style="color: #008000">#</span><span style="color: #008000">创建一个变量等于tornado.web下的Application方法</span>
    (r<span style="color: #800000">"</span><span style="color: #800000">/index</span><span style="color: #800000">"</span>, indexHandler),                   <span style="color: #008000">#</span><span style="color: #008000">判断用户请求路径后缀是否匹配字符串index,如果匹配执行MainHandler方法</span>
    (r<span style="color: #800000">"</span><span style="color: #800000">/dlu</span><span style="color: #800000">"</span><span style="color: #000000">, dluHandler),
    (r</span><span style="color: #800000">"</span><span style="color: #800000">/tuichu</span><span style="color: #800000">"</span><span style="color: #000000">, tuichuHandler),
],</span>**settings)                                   <span style="color: #008000">#</span><span style="color: #008000">将html文件归类配置字典，写在路由映射的第二个参数里</span>

<span style="color: #0000ff">if</span> <span style="color: #800080">__name__</span> == <span style="color: #800000">"</span><span style="color: #800000">__main__</span><span style="color: #800000">"</span><span style="color: #000000">:
    </span><span style="color: #008000">#</span><span style="color: #008000">内部socket运行起来</span>
    application.listen(8888)                    <span style="color: #008000">#</span><span style="color: #008000">设置端口</span>
    tornado.ioloop.IOLoop.instance().start()</pre>
</div>
<p><span style="color: #0000ff"><strong>内容html</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">&lt;!</span><span style="color: #ff00ff">DOCTYPE html</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">html </span><span style="color: #ff0000">lang</span><span style="color: #0000ff">="en"</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">head</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">meta </span><span style="color: #ff0000">charset</span><span style="color: #0000ff">="UTF-8"</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">title</span><span style="color: #0000ff">&gt;</span>Title<span style="color: #0000ff">&lt;/</span><span style="color: #800000">title</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">link </span><span style="color: #ff0000">rel</span><span style="color: #0000ff">="stylesheet"</span><span style="color: #ff0000"> href</span><span style="color: #0000ff">='{{static_url("s1.css")}}'</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">head</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">body</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">h1</span><span style="color: #0000ff">&gt;</span>登录成功后才能看到<span style="color: #0000ff">&lt;/</span><span style="color: #800000">h1</span><span style="color: #0000ff">&gt;&lt;</span><span style="color: #800000">a </span><span style="color: #ff0000">href</span><span style="color: #0000ff">="/tuichu"</span><span style="color: #0000ff">&gt;</span>退出<span style="color: #0000ff">&lt;/</span><span style="color: #800000">a</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">body</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">html</span><span style="color: #0000ff">&gt;</span></pre>
</div>
<p><span style="color: #0000ff"><strong>登录html</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">&lt;!</span><span style="color: #ff00ff">DOCTYPE html</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">html </span><span style="color: #ff0000">lang</span><span style="color: #0000ff">="en"</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">head</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">meta </span><span style="color: #ff0000">charset</span><span style="color: #0000ff">="UTF-8"</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">title</span><span style="color: #0000ff">&gt;</span>Title<span style="color: #0000ff">&lt;/</span><span style="color: #800000">title</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">head</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">body</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">form </span><span style="color: #ff0000">method</span><span style="color: #0000ff">="post"</span><span style="color: #ff0000"> action</span><span style="color: #0000ff">="/dlu"</span><span style="color: #0000ff">&gt;</span><span style="color: #000000">
    用户名：</span><span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="text"</span><span style="color: #ff0000"> name</span><span style="color: #0000ff">="yhm"</span><span style="color: #0000ff">/&gt;</span><span style="color: #000000">
    密码：</span><span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="text"</span><span style="color: #ff0000"> name</span><span style="color: #0000ff">="mim"</span><span style="color: #0000ff">/&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="submit"</span><span style="color: #ff0000"> value</span><span style="color: #0000ff">="提交"</span><span style="color: #0000ff">/&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">span </span><span style="color: #ff0000">style</span><span style="color: #0000ff">="color: #ee1215"</span><span style="color: #0000ff">&gt;</span>{{shib}}<span style="color: #0000ff">&lt;/</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">form</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">body</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">html</span><span style="color: #0000ff">&gt;</span></pre>
</div>
<p><img src="https://images2015.cnblogs.com/blog/955761/201705/955761-20170516203643760-360647891.gif" alt=""></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>self.set_cookie()方法，创建cookie参数详情</strong></span><br><span style="color: #ff0000"><strong>　　1、cookie名称</strong></span><br><span style="color: #ff0000"><strong>　　2、cookie值</strong></span><br><span style="color: #ff0000"><strong>　　3、domain : 'www.jxiou.com', 设置域名，设置域名后，cookie在指定域名下有效 </strong></span><br><span style="color: #ff0000"><strong>　　4、expires:过期时间的时间戳</strong></span><br><span style="color: #ff0000"><strong>　　5、expires_days:过期时间天</strong></span><br><span style="color: #ff0000"><strong>　　6、path:'/', 设置cookie有效路径，/表示全局目录有效</strong></span></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>销毁<strong>cookie</strong></strong></span></p>
<p><span style="color: #ff0000"><strong><strong>将过期时间<strong>expires设置成系统当前时间戳减一，也就是过去了的时间，就会自动销毁<strong><strong>cookie</strong></strong></strong></strong></strong></span></p>
<p>&nbsp;</p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000">coding:utf-8</span>

<span style="color: #0000ff">import</span><span style="color: #000000"> tornado.ioloop
</span><span style="color: #0000ff">import</span> tornado.web                              <span style="color: #008000">#</span><span style="color: #008000">导入tornado模块下的web文件</span>
<span style="color: #0000ff">import</span><span style="color: #000000"> uimodule
</span><span style="background-color: #ff99cc"><span style="color: #0000ff">import</span><span style="color: #000000"> time

</span></span><span style="color: #008000">#</span><span style="color: #008000">逻辑处理</span>

<span style="color: #0000ff">class</span> indexHandler(tornado.web.RequestHandler):  <span style="color: #008000">#</span><span style="color: #008000">定义一个类，继承tornado.web下的RequestHandler类</span>
    <span style="color: #0000ff">def</span> get(self):                                              <span style="color: #008000">#</span><span style="color: #008000">get()方法，接收get方式请求</span>
        <span style="color: #0000ff">if</span> self.get_cookie(<span style="color: #800000">"</span><span style="color: #800000">admin</span><span style="color: #800000">"</span>) == <span style="color: #800000">"</span><span style="color: #800000">admin</span><span style="color: #800000">"</span>:                 <span style="color: #008000">#</span><span style="color: #008000">判断cookie值等于admin</span>
            self.render(<span style="color: #800000">"</span><span style="color: #800000">index.html</span><span style="color: #800000">"</span>)                           <span style="color: #008000">#</span><span style="color: #008000">显示index.html文件</span>
        <span style="color: #0000ff">else</span><span style="color: #000000">:
            self.redirect(</span><span style="color: #800000">"</span><span style="color: #800000">/dlu</span><span style="color: #800000">"</span>)                               <span style="color: #008000">#</span><span style="color: #008000">否则跳转到登录</span>


<span style="color: #0000ff">class</span> dluHandler(tornado.web.RequestHandler):  <span style="color: #008000">#</span><span style="color: #008000">定义一个类，继承tornado.web下的RequestHandler类</span>
    <span style="color: #0000ff">def</span> get(self):                                              <span style="color: #008000">#</span><span style="color: #008000">get()方法，接收get方式请求</span>
        self.render(<span style="color: #800000">"</span><span style="color: #800000">dlu.html</span><span style="color: #800000">"</span>,shib=<span style="color: #800000">""</span>)                         <span style="color: #008000">#</span><span style="color: #008000">显示dlu.html文件</span>
    <span style="color: #0000ff">def</span> post(self, *args, **kwargs):                            <span style="color: #008000">#</span><span style="color: #008000">处理post请求</span>
        yhm = self.get_argument(<span style="color: #800000">'</span><span style="color: #800000">yhm</span><span style="color: #800000">'</span>)                          <span style="color: #008000">#</span><span style="color: #008000">接收用户名</span>
        mim = self.get_argument(<span style="color: #800000">'</span><span style="color: #800000">mim</span><span style="color: #800000">'</span>)                          <span style="color: #008000">#</span><span style="color: #008000">接收密码</span>
        <span style="color: #0000ff">if</span> yhm ==<span style="color: #800000">"</span><span style="color: #800000">admin</span><span style="color: #800000">"</span> <span style="color: #0000ff">and</span> mim ==<span style="color: #800000">"</span><span style="color: #800000">admin</span><span style="color: #800000">"</span>:                     <span style="color: #008000">#</span><span style="color: #008000">判断用户名和密码</span>
            self.set_cookie(yhm,mim,expires_days=2)             <span style="color: #008000">#</span><span style="color: #008000">创建cookie</span>
            self.redirect(<span style="color: #800000">"</span><span style="color: #800000">/index</span><span style="color: #800000">"</span>)                             <span style="color: #008000">#</span><span style="color: #008000">跳转用户查看页面</span>
        <span style="color: #0000ff">else</span><span style="color: #000000">:
            self.render(</span><span style="color: #800000">"</span><span style="color: #800000">dlu.html</span><span style="color: #800000">"</span>, shib=<span style="color: #800000">"</span><span style="color: #800000">用户名或密码不正确</span><span style="color: #800000">"</span>)    <span style="color: #008000">#</span><span style="color: #008000">如果用户名和密码不正确，打开登录页面</span>

<span style="color: #0000ff">class</span><span style="color: #000000"> tuichuHandler(tornado.web.RequestHandler):
    </span><span style="color: #0000ff">def</span> get(self):                                              <span style="color: #008000">#</span><span style="color: #008000">处理get方法请求</span>
        <span style="background-color: #ff99cc">self.set_cookie(<span style="color: #800000">"</span><span style="color: #800000">admin</span><span style="color: #800000">"</span>,<span style="color: #800000">"</span><span style="color: #800000">0</span><span style="color: #800000">"</span>,expires=time.time()-1)</span>                  <span style="color: #008000">#</span><span style="color: #008000">将过期时间设置成当前时间戳减1，成过去时间，销毁cookie</span>
        self.redirect(<span style="color: #800000">"</span><span style="color: #800000">/index</span><span style="color: #800000">"</span>)                                 <span style="color: #008000">#</span><span style="color: #008000">跳转页面</span>
        <span style="color: #0000ff">print</span><span style="color: #000000">()


settings </span>= {                                    <span style="color: #008000">#</span><span style="color: #008000">html文件归类配置，设置一个字典</span>
    <span style="color: #800000">"</span><span style="color: #800000">template_path</span><span style="color: #800000">"</span>:<span style="color: #800000">"</span><span style="color: #800000">template</span><span style="color: #800000">"</span>,                 <span style="color: #008000">#</span><span style="color: #008000">键为template_path固定的，值为要存放HTML的文件夹名称</span>
    <span style="color: #800000">"</span><span style="color: #800000">static_path</span><span style="color: #800000">"</span>:<span style="color: #800000">"</span><span style="color: #800000">static</span><span style="color: #800000">"</span>,                     <span style="color: #008000">#</span><span style="color: #008000">键为static_path固定的，值为要存放js和css的文件夹名称</span>
<span style="color: #000000">}

</span><span style="color: #008000">#</span><span style="color: #008000">路由映射</span>
application = tornado.web.Application([         <span style="color: #008000">#</span><span style="color: #008000">创建一个变量等于tornado.web下的Application方法</span>
    (r<span style="color: #800000">"</span><span style="color: #800000">/index</span><span style="color: #800000">"</span>, indexHandler),                   <span style="color: #008000">#</span><span style="color: #008000">判断用户请求路径后缀是否匹配字符串index,如果匹配执行MainHandler方法</span>
    (r<span style="color: #800000">"</span><span style="color: #800000">/dlu</span><span style="color: #800000">"</span><span style="color: #000000">, dluHandler),
    (r</span><span style="color: #800000">"</span><span style="color: #800000">/tuichu</span><span style="color: #800000">"</span><span style="color: #000000">, tuichuHandler),
],</span>**settings)                                   <span style="color: #008000">#</span><span style="color: #008000">将html文件归类配置字典，写在路由映射的第二个参数里</span>

<span style="color: #0000ff">if</span> <span style="color: #800080">__name__</span> == <span style="color: #800000">"</span><span style="color: #800000">__main__</span><span style="color: #800000">"</span><span style="color: #000000">:
    </span><span style="color: #008000">#</span><span style="color: #008000">内部socket运行起来</span>
    application.listen(8888)                    <span style="color: #008000">#</span><span style="color: #008000">设置端口</span>
    tornado.ioloop.IOLoop.instance().start()</pre>
</div>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>self.set_secure_cookie()方法，创建加密cookie，参数为cookie名称和cookie值</strong></span><br><span style="color: #ff0000"><strong>self.get_secure_cookie()方法，读取加密cookie，参数为要读取加密cookie的名称</strong></span></p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong>注意，self.get_secure_cookie()读取到的cookie值是字节类型需要decode()转换成字符串</strong></span><br><span style="color: #ff0000"><strong>注意，使用self.set_secure_cookie()加密cookie，必须在配置字典里写cookie_secret:密匙</strong></span><br><span style="color: #ff0000"><strong>cookie_secret:密匙，加密会根据这个密匙提高加密级别</strong></span></p>
<p><span style="color: #ff0000"><strong>注意：此加密采用base64加密</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000">coding:utf-8</span>

<span style="color: #0000ff">import</span><span style="color: #000000"> tornado.ioloop
</span><span style="color: #0000ff">import</span> tornado.web                              <span style="color: #008000">#</span><span style="color: #008000">导入tornado模块下的web文件</span>
<span style="color: #0000ff">import</span><span style="color: #000000"> uimodule
</span><span style="color: #0000ff">import</span><span style="color: #000000"> time

</span><span style="color: #008000">#</span><span style="color: #008000">逻辑处理</span>

<span style="color: #0000ff">class</span> indexHandler(tornado.web.RequestHandler):  <span style="color: #008000">#</span><span style="color: #008000">定义一个类，继承tornado.web下的RequestHandler类</span>
    <span style="color: #0000ff">def</span> get(self):                                              <span style="color: #008000">#</span><span style="color: #008000">get()方法，接收get方式请求</span>
        <span style="color: #0000ff">if</span> <span style="background-color: #ff99cc">self.get_secure_cookie</span>(<span style="color: #800000">"</span><span style="color: #800000">admin</span><span style="color: #800000">"</span><span style="color: #000000">):
            ckk </span>= <span style="background-color: #ff99cc">self.get_secure_cookie</span>(<span style="color: #800000">"</span><span style="color: #800000">admin</span><span style="color: #800000">"</span><span style="color: #000000">)
            cke </span>=<span style="color: #000000; background-color: #ff99cc"> ckk.decode()
            </span><span style="color: #0000ff">if</span> cke == <span style="color: #800000">"</span><span style="color: #800000">admin</span><span style="color: #800000">"</span>:                                      <span style="color: #008000">#</span><span style="color: #008000">判断cookie值等于admin</span>
                self.render(<span style="color: #800000">"</span><span style="color: #800000">index.html</span><span style="color: #800000">"</span>)                           <span style="color: #008000">#</span><span style="color: #008000">显示index.html文件</span>
            <span style="color: #0000ff">else</span><span style="color: #000000">:
                self.redirect(</span><span style="color: #800000">"</span><span style="color: #800000">/dlu</span><span style="color: #800000">"</span><span style="color: #000000">)
        </span><span style="color: #0000ff">else</span><span style="color: #000000">:
            self.redirect(</span><span style="color: #800000">"</span><span style="color: #800000">/dlu</span><span style="color: #800000">"</span>)                               <span style="color: #008000">#</span><span style="color: #008000">否则跳转到登录</span>


<span style="color: #0000ff">class</span> dluHandler(tornado.web.RequestHandler):  <span style="color: #008000">#</span><span style="color: #008000">定义一个类，继承tornado.web下的RequestHandler类</span>
    <span style="color: #0000ff">def</span> get(self):                                              <span style="color: #008000">#</span><span style="color: #008000">get()方法，接收get方式请求</span>
        self.render(<span style="color: #800000">"</span><span style="color: #800000">dlu.html</span><span style="color: #800000">"</span>,shib=<span style="color: #800000">""</span>)                         <span style="color: #008000">#</span><span style="color: #008000">显示dlu.html文件</span>
    <span style="color: #0000ff">def</span> post(self, *args, **kwargs):                            <span style="color: #008000">#</span><span style="color: #008000">处理post请求</span>
        yhm = self.get_argument(<span style="color: #800000">'</span><span style="color: #800000">yhm</span><span style="color: #800000">'</span>)                          <span style="color: #008000">#</span><span style="color: #008000">接收用户名</span>
        mim = self.get_argument(<span style="color: #800000">'</span><span style="color: #800000">mim</span><span style="color: #800000">'</span>)                          <span style="color: #008000">#</span><span style="color: #008000">接收密码</span>
        <span style="color: #0000ff">if</span> yhm ==<span style="color: #800000">"</span><span style="color: #800000">admin</span><span style="color: #800000">"</span> <span style="color: #0000ff">and</span> mim ==<span style="color: #800000">"</span><span style="color: #800000">admin</span><span style="color: #800000">"</span>:                     <span style="color: #008000">#</span><span style="color: #008000">判断用户名和密码</span>
<span style="color: #000000"><span style="background-color: #ff99cc">            self.set_secure_cookie</span>(yhm,mim)
            self.redirect(</span><span style="color: #800000">"</span><span style="color: #800000">/index</span><span style="color: #800000">"</span>)                             <span style="color: #008000">#</span><span style="color: #008000">跳转用户查看页面</span>
        <span style="color: #0000ff">else</span><span style="color: #000000">:
            self.render(</span><span style="color: #800000">"</span><span style="color: #800000">dlu.html</span><span style="color: #800000">"</span>, shib=<span style="color: #800000">"</span><span style="color: #800000">用户名或密码不正确</span><span style="color: #800000">"</span>)    <span style="color: #008000">#</span><span style="color: #008000">如果用户名和密码不正确，打开登录页面</span>

<span style="color: #0000ff">class</span><span style="color: #000000"> tuichuHandler(tornado.web.RequestHandler):
    </span><span style="color: #0000ff">def</span> get(self):                                              <span style="color: #008000">#</span><span style="color: #008000">处理get方法请求</span>
        <span style="background-color: #ff99cc">self.set_secure_cookie</span>(<span style="color: #800000">"</span><span style="color: #800000">admin</span><span style="color: #800000">"</span>,<span style="color: #800000">"</span><span style="color: #800000">0</span><span style="color: #800000">"</span>,expires=time.time()-1)                  <span style="color: #008000">#</span><span style="color: #008000">将过期时间设置成当前时间戳减1，成过去时间，销毁cookie</span>
        self.redirect(<span style="color: #800000">"</span><span style="color: #800000">/index</span><span style="color: #800000">"</span>)                                 <span style="color: #008000">#</span><span style="color: #008000">跳转页面</span>
<span style="color: #000000">

settings </span>= {                                        <span style="color: #008000">#</span><span style="color: #008000">html文件归类配置，设置一个字典</span>
    <span style="color: #800000">"</span><span style="color: #800000">template_path</span><span style="color: #800000">"</span>:<span style="color: #800000">"</span><span style="color: #800000">template</span><span style="color: #800000">"</span>,                     <span style="color: #008000">#</span><span style="color: #008000">键为template_path固定的，值为要存放HTML的文件夹名称</span>
    <span style="color: #800000">"</span><span style="color: #800000">static_path</span><span style="color: #800000">"</span>:<span style="color: #800000">"</span><span style="color: #800000">static</span><span style="color: #800000">"</span>,                         <span style="color: #008000">#</span><span style="color: #008000">键为static_path固定的，值为要存放js和css的文件夹名称</span>
    <span style="background-color: #ff99cc"><span style="color: #800000">"</span><span style="color: #800000">cookie_secret</span><span style="color: #800000">"</span>:<span style="color: #800000">"</span><span style="color: #800000">61oETzKXQAGaYdkL5gEmGeJJFuY</span><span style="color: #800000">"</span></span><span style="color: #000000"><span style="background-color: #ff99cc">,</span>
}

</span><span style="color: #008000">#</span><span style="color: #008000">路由映射</span>
application = tornado.web.Application([         <span style="color: #008000">#</span><span style="color: #008000">创建一个变量等于tornado.web下的Application方法</span>
    (r<span style="color: #800000">"</span><span style="color: #800000">/index</span><span style="color: #800000">"</span>, indexHandler),                   <span style="color: #008000">#</span><span style="color: #008000">判断用户请求路径后缀是否匹配字符串index,如果匹配执行MainHandler方法</span>
    (r<span style="color: #800000">"</span><span style="color: #800000">/dlu</span><span style="color: #800000">"</span><span style="color: #000000">, dluHandler),
    (r</span><span style="color: #800000">"</span><span style="color: #800000">/tuichu</span><span style="color: #800000">"</span><span style="color: #000000">, tuichuHandler),
],</span>**settings)                                   <span style="color: #008000">#</span><span style="color: #008000">将html文件归类配置字典，写在路由映射的第二个参数里</span>

<span style="color: #0000ff">if</span> <span style="color: #800080">__name__</span> == <span style="color: #800000">"</span><span style="color: #800000">__main__</span><span style="color: #800000">"</span><span style="color: #000000">:
    </span><span style="color: #008000">#</span><span style="color: #008000">内部socket运行起来</span>
    application.listen(8888)                    <span style="color: #008000">#</span><span style="color: #008000">设置端口</span>
    tornado.ioloop.IOLoop.instance().start()</pre>
</div>
<p>&nbsp;</p></div>