第二百三十节，jQuery EasyUI，后台管理界面---后台管理


			<div id="cnblogs_post_body" class="blogpost-body"><p><strong>jQuery EasyUI，后台管理界面---后台管理</strong></p>
<p><strong><img src="https://images2015.cnblogs.com/blog/955761/201704/955761-20170424150555897-1869038083.png" alt=""></strong></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>一，admin.php，后台管理界面</strong></span></p>
<div class="cnblogs_code">
<pre>&lt;?<span style="color: #000000">php
    </span><span style="color: #008080">session_start</span><span style="color: #000000">();
    </span><span style="color: #0000ff">if</span> (!<span style="color: #0000ff">isset</span>(<span style="color: #800080">$_SESSION</span>['admin'])) {     <span style="color: #008000">//</span><span style="color: #008000">判断用户登录成功时创建的SESSION是否存在</span>
        <span style="color: #008080">header</span>('location:login.php');     <span style="color: #008000">//</span><span style="color: #008000">如果不存在，跳转到登录页面</span>
<span style="color: #000000">    }
</span>?&gt;
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;jQuery Easy UI&lt;/title&gt;
&lt;meta charset="UTF-8" /&gt;
&lt;link rel="stylesheet" type="text/css" href="easyui/themes/default/easyui.css" /&gt;
&lt;link rel="stylesheet" type="text/css" href="easyui/themes/icon.css" /&gt;
&lt;link rel="stylesheet" type="text/css" href="css/admin.css" /&gt;
&lt;/head&gt;
&lt;body <span style="color: #0000ff">class</span>="easyui-layout"&gt;

&lt;div data-options="region:'north',title:'header',split:true,noheader:true" style="height:60px;background:#666;"&gt;
    &lt;div <span style="color: #0000ff">class</span>="logo"&gt;后台管理&lt;/div&gt;
    &lt;div <span style="color: #0000ff">class</span>="logout"&gt;您好，&lt;?php <span style="color: #0000ff">echo</span> <span style="color: #800080">$_SESSION</span>['admin']?&gt; | &lt;a href="logout.php"&gt;退出&lt;/a&gt;&lt;/div&gt;
&lt;/div&gt;   
&lt;div data-options="region:'south',title:'footer',split:true,noheader:true" style="height:35px;line-height:30px;text-align:center;"&gt;
    &amp;<span style="color: #008080">copy</span>;2009-2015 瓢城 Web 俱乐部. Powered by PHP and EasyUI.
&lt;/div&gt;    
&lt;div data-options="region:'west',title:'导航',split:true,iconCls:'icon-world'" style="width:180px;padding:10px;"&gt;
    &lt;ul id="nav"&gt;&lt;/ul&gt;
&lt;/div&gt;   
&lt;div data-options="region:'center'" style="overflow:hidden;"&gt;
    &lt;div id="tabs"&gt;
        &lt;div title="起始页" iconCls="icon-house" style="padding:0 10px;display:block;"&gt;<span style="color: #000000">
            欢迎来到后台管理系统！
        </span>&lt;/div&gt;
    &lt;/div&gt;
&lt;/div&gt; 


&lt;script type="text/javascript" src="easyui/jquery.min.js"&gt;&lt;/script&gt;
&lt;script type="text/javascript" src="easyui/jquery.easyui.min.js"&gt;&lt;/script&gt;
&lt;script type="text/javascript" src="easyui/locale/easyui-lang-zh_CN.js" &gt;&lt;/script&gt;
&lt;script type="text/javascript" src="js/admin.js"&gt;&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>
</div>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>二，logout.php点击退出</strong></span></p>
<p><span style="color: #ff0000"><strong><img src="https://images2015.cnblogs.com/blog/955761/201704/955761-20170424151113225-317401748.png" alt=""></strong></span></p>
<div class="cnblogs_code">
<pre>&lt;?<span style="color: #000000">php
    </span><span style="color: #008080">session_start</span><span style="color: #000000">();
    </span><span style="color: #008080">session_destroy</span>();                  <span style="color: #008000">//</span><span style="color: #008000">清除创建的session</span>
    <span style="color: #008080">header</span>('location:login.php');       <span style="color: #008000">//</span><span style="color: #008000">跳转到登录页面</span>
?&gt;</pre>
</div>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>三，admin.js加载导航</strong></span></p>
<p><span style="color: #ff0000"><strong><img src="https://images2015.cnblogs.com/blog/955761/201704/955761-20170424161245256-201922817.png" alt=""></strong></span></p>
<p><span style="color: #ff0000"><strong>数据库表</strong></span></p>
<p><span style="color: #ff0000"><strong><img src="https://images2015.cnblogs.com/blog/955761/201704/955761-20170424160851584-1606715514.png" alt=""></strong></span></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>admin.js</strong></span></p>
<div class="cnblogs_code">
<pre>$(<span style="color: #0000ff">function</span><span style="color: #000000"> () {
    
    $(</span>'#nav').tree({                                            <span style="color: #008000">//</span><span style="color: #008000">将导航元素执行树形结构方法</span>
        <span style="color: #ff0000">url : 'nav.php',                                        //远程加载树形结构数据</span>
        lines : <span style="color: #0000ff">true</span>,                                            <span style="color: #008000">//</span><span style="color: #008000">显示结构虚线</span>
        onLoadSuccess : <span style="color: #0000ff">function</span> (node, data) {                    <span style="color: #008000">//</span><span style="color: #008000">在数据加载成功后触发</span>
            <span style="color: #0000ff">if</span> (data) {                                            <span style="color: #008000">//</span><span style="color: #008000">data接收的所有目录信息对象，判断目录节点是否存在</span>
                $(data).each(<span style="color: #0000ff">function</span> (index, value) {            <span style="color: #008000">//</span><span style="color: #008000">遍历所有目录</span>
                    <span style="color: #0000ff">if</span> (<span style="color: #0000ff">this</span>.state == 'closed') {                <span style="color: #008000">//</span><span style="color: #008000">判断如果目录对象里的state等于closed,说明此目录有子目录</span>
                        $('#nav').tree('expandAll');            <span style="color: #008000">//</span><span style="color: #008000">展开所有节点</span>
<span style="color: #000000">                    }
                });
            }
        },
        onClick : </span><span style="color: #0000ff">function</span> (node) {                                <span style="color: #008000">//</span><span style="color: #008000">当用户点击一个目录时</span>
            <span style="color: #0000ff">if</span> (node.url) {                                        <span style="color: #008000">//</span><span style="color: #008000">判断当前对象的url是否存在，也就是在数据库里的url连接地址</span>
                <span style="color: #0000ff">if</span> ($('#tabs').tabs('exists', node.text)) {        <span style="color: #008000">//</span><span style="color: #008000">判断当前目录名称的选项卡是否打开</span>
                    $('#tabs').tabs('select', node.text);        <span style="color: #008000">//</span><span style="color: #008000">如果打开的则选择在当前选项卡上</span>
                } <span style="color: #0000ff">else</span> {                                        <span style="color: #008000">//</span><span style="color: #008000">如果当然选项卡没有打开</span>
                    $('#tabs').tabs('add', {                    <span style="color: #008000">//</span><span style="color: #008000">添加一个新选项卡面板</span>
                        title : node.text,                        <span style="color: #008000">//</span><span style="color: #008000">标题为当前目录的名称</span>
                        iconCls : node.iconCls,                    <span style="color: #008000">//</span><span style="color: #008000">图标为当前目录的图标</span>
                        closable : <span style="color: #0000ff">true</span>,                        <span style="color: #008000">//</span><span style="color: #008000">显示关闭按钮</span>
                        href : node.url + '.php',                <span style="color: #008000">//</span><span style="color: #008000">读取远程数据并显示到面板</span>
<span style="color: #000000">                    });
                }
            }
        }
    });
    
    $(</span>'#tabs').tabs({            <span style="color: #008000">//</span><span style="color: #008000">将布局的id为tabs，也就是内容区块执行选项卡组件</span>
        fit : <span style="color: #0000ff">true</span>,                <span style="color: #008000">//</span><span style="color: #008000">铺满容器，</span>
        border : <span style="color: #0000ff">false</span>,            <span style="color: #008000">//</span><span style="color: #008000">不显示选项卡容器边框</span>
<span style="color: #000000">    });
    
});</span></pre>
</div>
<p><span style="color: #ff0000"><strong>nav.php，导航数据页</strong></span></p>
<div class="cnblogs_code">
<pre>&lt;?<span style="color: #000000">php
    </span><span style="color: #0000ff">require</span> 'config.php'<span style="color: #000000">;
    
    </span><span style="color: #800080">$id</span> = <span style="color: #0000ff">isset</span>(<span style="color: #800080">$_POST</span>['id']) ? <span style="color: #800080">$_POST</span>['id'] : 0;       <span style="color: #008000">//</span><span style="color: #008000">判断是否有传递id,如果有id值为id,如果没有id值为0
    //将$id值到数据库去查找nid字段</span>
    <span style="color: #800080">$query</span> = <span style="color: #008080">mysql_query</span>("SELECT id,text,state,iconCls,url FROM easyui_nav WHERE nid='<span style="color: #800080">$id</span>'") or <span style="color: #0000ff">die</span>('SQL 错误！'<span style="color: #000000">);

    
    </span><span style="color: #800080">$json</span> = ''<span style="color: #000000">;
    
    </span><span style="color: #0000ff">while</span> (!!<span style="color: #800080">$row</span> = <span style="color: #008080">mysql_fetch_array</span>(<span style="color: #800080">$query</span>,<span style="color: #000000"> MYSQL_ASSOC)) {
        </span><span style="color: #800080">$json</span> .= json_encode(<span style="color: #800080">$row</span>).','<span style="color: #000000">;
    }

    </span><span style="color: #800080">$json</span> = <span style="color: #008080">substr</span>(<span style="color: #800080">$json</span>, 0, -1<span style="color: #000000">);
    </span><span style="color: #0000ff">echo</span> '['.<span style="color: #800080">$json</span>.']'<span style="color: #000000">;
    </span><span style="color: #008080">mysql_close</span><span style="color: #000000">();
</span>?&gt;</pre>
</div>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>四，点击对应的导航，远程对应的页面获取数据库信息显示到对应的选项卡</strong></span></p>
<p><span style="color: #ff0000"><strong><img src="https://images2015.cnblogs.com/blog/955761/201704/955761-20170426180629631-843218735.png" alt=""></strong></span></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>导航js</strong></span></p>
<div class="cnblogs_code">
<pre>$(<span style="color: #0000ff">function</span><span style="color: #000000"> () {
    
    $(</span>'#nav').tree({                                            <span style="color: #008000">//</span><span style="color: #008000">将导航元素执行树形结构方法</span>
        url : 'nav.php',                                        <span style="color: #008000">//</span><span style="color: #008000">远程加载树形结构数据</span>
        lines : <span style="color: #0000ff">true</span>,                                            <span style="color: #008000">//</span><span style="color: #008000">显示结构虚线</span>
        onLoadSuccess : <span style="color: #0000ff">function</span> (node, data) {                    <span style="color: #008000">//</span><span style="color: #008000">在数据加载成功后触发</span>
            <span style="color: #0000ff">if</span> (data) {                                            <span style="color: #008000">//</span><span style="color: #008000">data接收的所有目录信息对象，判断目录节点是否存在</span>
                $(data).each(<span style="color: #0000ff">function</span> (index, value) {            <span style="color: #008000">//</span><span style="color: #008000">遍历所有目录</span>
                    <span style="color: #0000ff">if</span> (<span style="color: #0000ff">this</span>.state == 'closed') {                <span style="color: #008000">//</span><span style="color: #008000">判断如果目录对象里的state等于closed,说明此目录有子目录</span>
                        $('#nav').tree('expandAll');            <span style="color: #008000">//</span><span style="color: #008000">展开所有节点</span>
<span style="color: #000000">                    }
                });
            }
        },
        <span style="color: #ff0000">onClick : </span></span><span style="color: #ff0000">function (node) {                                //当用户点击一个目录时
            if (node.url) {                                        //判断当前对象的url是否存在，也就是在数据库里的url连接地址
                if ($('#tabs').tabs('exists', node.text)) {        //判断当前目录名称的选项卡是否打开
                    $('#tabs').tabs('select', node.text);        //如果打开的则选择在当前选项卡上
                } else {                                        //如果当然选项卡没有打开
                    $('#tabs').tabs('add', {                    //添加一个新选项卡面板
                        title : node.text,                        //标题为当前目录的名称
                        iconCls : node.iconCls,                    //图标为当前目录的图标
                        closable : true,                        //显示关闭按钮
                        href : node.url + '.php',                //读取远程数据并显示到面板
</span><span style="color: #000000"><span style="color: #ff0000">                    });
                }
            }
        }</span>
    });
    
    $(</span>'#tabs').tabs({            <span style="color: #008000">//</span><span style="color: #008000">将布局的id为tabs，也就是内容区块执行选项卡组件</span>
        fit : <span style="color: #0000ff">true</span>,                <span style="color: #008000">//</span><span style="color: #008000">铺满容器，</span>
        border : <span style="color: #0000ff">false</span>,            <span style="color: #008000">//</span><span style="color: #008000">不显示选项卡容器边框</span>
<span style="color: #000000">    });
    
});</span></pre>
</div>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>&nbsp;选项卡操作</strong></span></p>
<p><img src="https://images2015.cnblogs.com/blog/955761/201704/955761-20170426181237787-1271533367.png" alt=""></p>
<p><strong><span style="color: #ff0000">HTML</span></strong></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">&lt;?</span><span style="color: #ff00ff">php
    session_start();
    if (!isset($_SESSION['admin'])) {
        header('location:login.php');
    }
</span><span style="color: #0000ff">?&gt;</span>

<span style="color: #0000ff">&lt;</span><span style="color: #800000">table </span><span style="color: #ff0000">id</span><span style="color: #0000ff">="manager"</span><span style="color: #0000ff">&gt;&lt;/</span><span style="color: #800000">table</span><span style="color: #0000ff">&gt;</span>

<span style="color: #0000ff">&lt;</span><span style="color: #800000">div </span><span style="color: #ff0000">id</span><span style="color: #0000ff">="manager_tool"</span><span style="color: #ff0000"> style</span><span style="color: #0000ff">="padding:5px;"</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div </span><span style="color: #ff0000">style</span><span style="color: #0000ff">="margin-bottom:5px;"</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">a </span><span style="color: #ff0000">href</span><span style="color: #0000ff">="#"</span><span style="color: #ff0000"> class</span><span style="color: #0000ff">="easyui-linkbutton"</span><span style="color: #ff0000"> iconCls</span><span style="color: #0000ff">="icon-add-new"</span><span style="color: #ff0000"> plain</span><span style="color: #0000ff">="true"</span><span style="color: #ff0000"> onclick</span><span style="color: #0000ff">="manager_tool.add();"</span><span style="color: #0000ff">&gt;</span>添加<span style="color: #0000ff">&lt;/</span><span style="color: #800000">a</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">a </span><span style="color: #ff0000">href</span><span style="color: #0000ff">="#"</span><span style="color: #ff0000"> class</span><span style="color: #0000ff">="easyui-linkbutton"</span><span style="color: #ff0000"> iconCls</span><span style="color: #0000ff">="icon-edit-new"</span><span style="color: #ff0000"> plain</span><span style="color: #0000ff">="true"</span><span style="color: #ff0000"> onclick</span><span style="color: #0000ff">="manager_tool.edit();"</span><span style="color: #0000ff">&gt;</span>修改<span style="color: #0000ff">&lt;/</span><span style="color: #800000">a</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">a </span><span style="color: #ff0000">href</span><span style="color: #0000ff">="#"</span><span style="color: #ff0000"> class</span><span style="color: #0000ff">="easyui-linkbutton"</span><span style="color: #ff0000"> iconCls</span><span style="color: #0000ff">="icon-delete-new"</span><span style="color: #ff0000"> plain</span><span style="color: #0000ff">="true"</span><span style="color: #ff0000"> onclick</span><span style="color: #0000ff">="manager_tool.remove();"</span><span style="color: #0000ff">&gt;</span>删除<span style="color: #0000ff">&lt;/</span><span style="color: #800000">a</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">a </span><span style="color: #ff0000">href</span><span style="color: #0000ff">="#"</span><span style="color: #ff0000"> class</span><span style="color: #0000ff">="easyui-linkbutton"</span><span style="color: #ff0000"> iconCls</span><span style="color: #0000ff">="icon-reload"</span><span style="color: #ff0000"> plain</span><span style="color: #0000ff">="true"</span><span style="color: #ff0000">  onclick</span><span style="color: #0000ff">="manager_tool.reload();"</span><span style="color: #0000ff">&gt;</span>刷新<span style="color: #0000ff">&lt;/</span><span style="color: #800000">a</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">a </span><span style="color: #ff0000">href</span><span style="color: #0000ff">="#"</span><span style="color: #ff0000"> class</span><span style="color: #0000ff">="easyui-linkbutton"</span><span style="color: #ff0000"> iconCls</span><span style="color: #0000ff">="icon-redo"</span><span style="color: #ff0000"> plain</span><span style="color: #0000ff">="true"</span><span style="color: #ff0000"> onclick</span><span style="color: #0000ff">="manager_tool.redo();"</span><span style="color: #0000ff">&gt;</span>取消选择<span style="color: #0000ff">&lt;/</span><span style="color: #800000">a</span><span style="color: #0000ff">&gt;</span>        
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div </span><span style="color: #ff0000">style</span><span style="color: #0000ff">="padding:0 0 0 7px;color:#333;"</span><span style="color: #0000ff">&gt;</span><span style="color: #000000">
        查询帐号：</span><span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="text"</span><span style="color: #ff0000"> class</span><span style="color: #0000ff">="textbox"</span><span style="color: #ff0000"> name</span><span style="color: #0000ff">="user"</span><span style="color: #ff0000"> style</span><span style="color: #0000ff">="width:110px"</span><span style="color: #0000ff">&gt;</span><span style="color: #000000">
        创建时间从：</span><span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="text"</span><span style="color: #ff0000"> name</span><span style="color: #0000ff">="date_from"</span><span style="color: #ff0000"> class</span><span style="color: #0000ff">="easyui-datebox"</span><span style="color: #ff0000"> editable</span><span style="color: #0000ff">="false"</span><span style="color: #ff0000"> style</span><span style="color: #0000ff">="width:110px"</span><span style="color: #0000ff">&gt;</span><span style="color: #000000">
        到：</span><span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="text"</span><span style="color: #ff0000"> name</span><span style="color: #0000ff">="date_to"</span><span style="color: #ff0000"> class</span><span style="color: #0000ff">="easyui-datebox"</span><span style="color: #ff0000"> editable</span><span style="color: #0000ff">="false"</span><span style="color: #ff0000"> style</span><span style="color: #0000ff">="width:110px"</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">a </span><span style="color: #ff0000">href</span><span style="color: #0000ff">="#"</span><span style="color: #ff0000"> class</span><span style="color: #0000ff">="easyui-linkbutton"</span><span style="color: #ff0000"> iconCls</span><span style="color: #0000ff">="icon-search"</span><span style="color: #ff0000"> onclick</span><span style="color: #0000ff">="obj.search();"</span><span style="color: #0000ff">&gt;</span>查询<span style="color: #0000ff">&lt;/</span><span style="color: #800000">a</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>


<span style="color: #0000ff">&lt;</span><span style="color: #800000">form </span><span style="color: #ff0000">id</span><span style="color: #0000ff">="manager_add"</span><span style="color: #ff0000"> style</span><span style="color: #0000ff">="margin:0;padding:5px 0 0 25px;color:#333;"</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">p</span><span style="color: #0000ff">&gt;</span>管理帐号：<span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="text"</span><span style="color: #ff0000"> name</span><span style="color: #0000ff">="manager"</span><span style="color: #ff0000"> class</span><span style="color: #0000ff">="textbox"</span><span style="color: #ff0000"> style</span><span style="color: #0000ff">="width:200px;"</span><span style="color: #0000ff">&gt;&lt;/</span><span style="color: #800000">p</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">p</span><span style="color: #0000ff">&gt;</span>管理密码：<span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="password"</span><span style="color: #ff0000"> name</span><span style="color: #0000ff">="password"</span><span style="color: #ff0000"> class</span><span style="color: #0000ff">="textbox"</span><span style="color: #ff0000"> style</span><span style="color: #0000ff">="width:200px;"</span><span style="color: #0000ff">&gt;&lt;/</span><span style="color: #800000">p</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">p</span><span style="color: #0000ff">&gt;</span>分配权限：<span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">id</span><span style="color: #0000ff">="auth"</span><span style="color: #ff0000"> class</span><span style="color: #0000ff">="textbox"</span><span style="color: #ff0000"> name</span><span style="color: #0000ff">="auth"</span><span style="color: #ff0000"> style</span><span style="color: #0000ff">="width:205px;"</span><span style="color: #0000ff">&gt;&lt;/</span><span style="color: #800000">p</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">form</span><span style="color: #0000ff">&gt;</span>


<span style="color: #0000ff">&lt;</span><span style="color: #800000">form </span><span style="color: #ff0000">id</span><span style="color: #0000ff">="manager_edit"</span><span style="color: #ff0000"> style</span><span style="color: #0000ff">="margin:0;padding:5px 0 0 25px;color:#333;"</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="hidden"</span><span style="color: #ff0000"> name</span><span style="color: #0000ff">="id"</span><span style="color: #ff0000"> class</span><span style="color: #0000ff">="textbox"</span><span style="color: #ff0000"> style</span><span style="color: #0000ff">="width:200px;"</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">p</span><span style="color: #0000ff">&gt;</span>管理帐号：<span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="text"</span><span style="color: #ff0000"> name</span><span style="color: #0000ff">="manager_edit"</span><span style="color: #ff0000"> disabled</span><span style="color: #0000ff">="true"</span><span style="color: #ff0000"> class</span><span style="color: #0000ff">="textbox"</span><span style="color: #ff0000"> style</span><span style="color: #0000ff">="width:200px;"</span><span style="color: #0000ff">&gt;&lt;/</span><span style="color: #800000">p</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">p</span><span style="color: #0000ff">&gt;</span>管理密码：<span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="password"</span><span style="color: #ff0000"> name</span><span style="color: #0000ff">="password_edit"</span><span style="color: #ff0000"> class</span><span style="color: #0000ff">="textbox"</span><span style="color: #ff0000"> style</span><span style="color: #0000ff">="width:200px;"</span><span style="color: #0000ff">&gt;&lt;/</span><span style="color: #800000">p</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">p</span><span style="color: #0000ff">&gt;</span>分配权限：<span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">id</span><span style="color: #0000ff">="auth_edit"</span><span style="color: #ff0000"> class</span><span style="color: #0000ff">="textbox"</span><span style="color: #ff0000"> name</span><span style="color: #0000ff">="auth_edit"</span><span style="color: #ff0000"> style</span><span style="color: #0000ff">="width:205px;"</span><span style="color: #0000ff">&gt;&lt;/</span><span style="color: #800000">p</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">form</span><span style="color: #0000ff">&gt;</span>



<span style="color: #0000ff">&lt;</span><span style="color: #800000">script </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="text/javascript"</span><span style="color: #ff0000"> src</span><span style="color: #0000ff">="js/manager.js"</span><span style="color: #0000ff">&gt;&lt;/</span><span style="color: #800000">script</span><span style="color: #0000ff">&gt;</span></pre>
</div>
<p><span style="color: #ff0000"><strong>js</strong></span></p>
<div class="cnblogs_code">
<pre>$(<span style="color: #0000ff">function</span><span style="color: #000000"> () {
    
    $(</span>'#manager').datagrid({                            <span style="color: #008000">//</span><span style="color: #008000">执行数据表格组件</span>
        url : 'manager_data.php',                        <span style="color: #008000">//</span><span style="color: #008000">获取远程数据</span>
        fit : <span style="color: #0000ff">true</span>,                                        <span style="color: #008000">//</span><span style="color: #008000">面板大小自适应父容器</span>
        fitColumns : <span style="color: #0000ff">true</span>,                                <span style="color: #008000">//</span><span style="color: #008000">表格自适应面板</span>
        striped : <span style="color: #0000ff">true</span>,                                    <span style="color: #008000">//</span><span style="color: #008000">是否显示斑马效果</span>
        rownumbers : <span style="color: #0000ff">true</span>,                                <span style="color: #008000">//</span><span style="color: #008000">显示行号</span>
        border : <span style="color: #0000ff">false</span>,                                    <span style="color: #008000">//</span><span style="color: #008000">是否显示边框</span>
        pagination : <span style="color: #0000ff">true</span>,                                <span style="color: #008000">//</span><span style="color: #008000">是否显示分页</span>
        pageSize : 20,                                    <span style="color: #008000">//</span><span style="color: #008000">每页显示多少条数据</span>
        pageList : [10, 20, 30, 40, 50],                <span style="color: #008000">//</span><span style="color: #008000">可选每页显示多少条数据</span>
        pageNumber : 1,                                    <span style="color: #008000">//</span><span style="color: #008000">起始页</span>
        sortName : 'date',                                <span style="color: #008000">//</span><span style="color: #008000">默认以什么字段排序</span>
        sortOrder : 'desc',                                <span style="color: #008000">//</span><span style="color: #008000">排序方式</span>
        toolbar : '#manager_tool',                        <span style="color: #008000">//</span><span style="color: #008000">加载增删改查工具栏区块</span>
        columns : [[                                    <span style="color: #008000">//</span><span style="color: #008000">表格数据</span>
<span style="color: #000000">            {
                field : </span>'id',                            <span style="color: #008000">//</span><span style="color: #008000">数据库id字段</span>
                title : '自动编号',                        <span style="color: #008000">//</span><span style="color: #008000">标题</span>
                width : 100<span style="color: #000000">,
                checkbox : </span><span style="color: #0000ff">true</span>,                        <span style="color: #008000">//</span><span style="color: #008000">自动编号</span>
<span style="color: #000000">            },
            {
                field : </span>'manager',                        <span style="color: #008000">//</span><span style="color: #008000">数据库管理员字段</span>
                title : '管理员帐号'<span style="color: #000000">,
                width : </span>100<span style="color: #000000">,
            },
            {
                field : </span>'auth',                            <span style="color: #008000">//</span><span style="color: #008000">数据库权限字段</span>
                title : '拥有权限'<span style="color: #000000">,
                width : </span>100<span style="color: #000000">,
            },
            {
                field : </span>'date',                            <span style="color: #008000">//</span><span style="color: #008000">数据库日期字段</span>
                title : '创建日期'<span style="color: #000000">,
                width : </span>100<span style="color: #000000">,
            },
        ]],
    });

    </span><span style="color: #008000">//</span><span style="color: #008000">新增</span>
    $('#manager_add').dialog({                                                    <span style="color: #008000">//</span><span style="color: #008000">执行对话框组件</span>
        width : 350<span style="color: #000000">,
        title : </span>'新增管理'<span style="color: #000000">,
        modal : </span><span style="color: #0000ff">true</span>,                                                            <span style="color: #008000">//</span><span style="color: #008000">遮罩</span>
        closed : <span style="color: #0000ff">true</span>,                                                            <span style="color: #008000">//</span><span style="color: #008000">可以关闭窗口</span>
        iconCls : 'icon-user-add',                                                <span style="color: #008000">//</span><span style="color: #008000">图标</span>
        buttons : [{                                                            <span style="color: #008000">//</span><span style="color: #008000">创建按钮</span>
            text : '提交',                                                        <span style="color: #008000">//</span><span style="color: #008000">提交按钮</span>
            iconCls : 'icon-add-new',                                            <span style="color: #008000">//</span><span style="color: #008000">图标</span>
            handler : <span style="color: #0000ff">function</span> () {                                                <span style="color: #008000">//</span><span style="color: #008000">点击提交按钮后触发</span>
                <span style="color: #0000ff">if</span> ($('#manager_add').form('validate')) {                        <span style="color: #008000">//</span><span style="color: #008000">判断验证表单是否全部合法</span>
                    $.ajax({                                                    <span style="color: #008000">//</span><span style="color: #008000">执行ajax提交</span>
                        url : 'addManager.php'<span style="color: #000000">,
                        type : </span>'post'<span style="color: #000000">,
                        data : {                                                </span><span style="color: #008000">//</span><span style="color: #008000">提交数据</span>
                            manager : $('input[name="manager"]').val(),            <span style="color: #008000">//</span><span style="color: #008000">获取用户名值</span>
                            password : $('input[name="password"]').val(),        <span style="color: #008000">//</span><span style="color: #008000">获取密码值</span>
                            auth : $('#auth').combotree('getText'),                <span style="color: #008000">//</span><span style="color: #008000">权限文本</span>
<span style="color: #000000">                        },
                        beforeSend : </span><span style="color: #0000ff">function</span> () {                                <span style="color: #008000">//</span><span style="color: #008000">提交时</span>
                            $.messager.progress({                                <span style="color: #008000">//</span><span style="color: #008000">进度条信息框</span>
                                text : '正在新增中...'<span style="color: #000000">,
                            });
                        },
                        success : </span><span style="color: #0000ff">function</span> (data, response, status) {            <span style="color: #008000">//</span><span style="color: #008000">提交成功后</span>
                            $.messager.progress('close');                        <span style="color: #008000">//</span><span style="color: #008000">关闭进度条信息框</span>
                            
                            <span style="color: #0000ff">if</span> (data &gt; 0) {                                        <span style="color: #008000">//</span><span style="color: #008000">判断返回添加成功</span>
                                $.messager.show({                                <span style="color: #008000">//</span><span style="color: #008000">消息框</span>
                                    title : '提示'<span style="color: #000000">,
                                    msg : </span>'新增管理成功'<span style="color: #000000">,
                                });
                                $(</span>'#manager_add').dialog('close').form('reset');                        <span style="color: #008000">//</span><span style="color: #008000">关闭对话框，重置表单</span>
                                $('#manager').datagrid('reload');                                        <span style="color: #008000">//</span><span style="color: #008000">重新加载树形表格数据</span>
                            } <span style="color: #0000ff">else</span><span style="color: #000000"> {
                                $.messager.alert(</span>'新增失败！', '未知错误导致失败，请重试！', 'warning');    <span style="color: #008000">//</span><span style="color: #008000">添加失败提示信息</span>
<span style="color: #000000">                            }
                        }
                    });
                }
            },
        },{
            text : </span>'取消',                                                                                <span style="color: #008000">//</span><span style="color: #008000">取消按钮</span>
            iconCls : 'icon-redo'<span style="color: #000000">,
            handler : </span><span style="color: #0000ff">function</span> () {                                                                        <span style="color: #008000">//</span><span style="color: #008000">点击取消按钮后执行函数</span>
                $('#manager_add').dialog('close').form('reset');                                        <span style="color: #008000">//</span><span style="color: #008000">关闭对话框，重置表单</span>
<span style="color: #000000">            },
        }],
    });

    </span><span style="color: #008000">//</span><span style="color: #008000">修改</span>
    $('#manager_edit').dialog({                                                            <span style="color: #008000">//</span><span style="color: #008000">修改对话框</span>
        width : 350<span style="color: #000000">,
        title : </span>'修改管理'<span style="color: #000000">,
        modal : </span><span style="color: #0000ff">true</span>,                                                                    <span style="color: #008000">//</span><span style="color: #008000">遮罩锁屏</span>
        closed : <span style="color: #0000ff">true</span>,                                                                    <span style="color: #008000">//</span><span style="color: #008000">可以关闭窗口</span>
        iconCls : 'icon-user-add',                                                        <span style="color: #008000">//</span><span style="color: #008000">图标</span>
        buttons : [{                                                                    <span style="color: #008000">//</span><span style="color: #008000">设置提交按钮</span>
            text : '提交'<span style="color: #000000">,
            iconCls : </span>'icon-edit-new',                                                    <span style="color: #008000">//</span><span style="color: #008000">按钮图标</span>
            handler : <span style="color: #0000ff">function</span> () {                                                        <span style="color: #008000">//</span><span style="color: #008000">点击提交后执行函数</span>
                <span style="color: #0000ff">if</span> ($('#manager_edit').form('validate')) {                                <span style="color: #008000">//</span><span style="color: #008000">判断表单的数据是否合法</span>
                    $.ajax({                                                            <span style="color: #008000">//</span><span style="color: #008000">ajax提交数据</span>
                        url : 'updateManager.php'<span style="color: #000000">,
                        type : </span>'post'<span style="color: #000000">,
                        data : {                                                        </span><span style="color: #008000">//</span><span style="color: #008000">提交数据</span>
                            id : $('input[name="id"]').val(),                            <span style="color: #008000">//</span><span style="color: #008000">获取用户名</span>
                            password : $('input[name="password_edit"]').val(),            <span style="color: #008000">//</span><span style="color: #008000">获取密码</span>
                            auth : $('#auth_edit').combotree('getText'),                <span style="color: #008000">//</span><span style="color: #008000">获取权限文本</span>
<span style="color: #000000">                        },
                        beforeSend : </span><span style="color: #0000ff">function</span> () {                                        <span style="color: #008000">//</span><span style="color: #008000">提交时</span>
                            $.messager.progress({                                        <span style="color: #008000">//</span><span style="color: #008000">进度条信息框</span>
                                text : '正在修改中...'<span style="color: #000000">,
                            });
                        },
                        success : </span><span style="color: #0000ff">function</span> (data, response, status) {                    <span style="color: #008000">//</span><span style="color: #008000">提交后</span>
                            $.messager.progress('close');                                <span style="color: #008000">//</span><span style="color: #008000">关闭进度条信息框</span>
                            
                            <span style="color: #0000ff">if</span> (data &gt; 0) {                                                <span style="color: #008000">//</span><span style="color: #008000">判断修改是否成功</span>
                                $.messager.show({                                        <span style="color: #008000">//</span><span style="color: #008000">消息框</span>
                                    title : '提示'<span style="color: #000000">,
                                    msg : </span>'修改管理成功'<span style="color: #000000">,
                                });
                                $(</span>'#manager_edit').dialog('close').form('reset');        <span style="color: #008000">//</span><span style="color: #008000">关闭对话框，重置表单</span>
                                $('#manager').datagrid('reload');                        <span style="color: #008000">//</span><span style="color: #008000">重新加载数据表格</span>
                            } <span style="color: #0000ff">else</span><span style="color: #000000"> {
                                $.messager.alert(</span>'修改失败！', '未知错误或没有任何修改，请重试！', 'warning');    <span style="color: #008000">//</span><span style="color: #008000">修改失败提示</span>
<span style="color: #000000">                            }
                        }
                    });
                }
            },
        },{
            text : </span>'取消',                                                                <span style="color: #008000">//</span><span style="color: #008000">取消按钮</span>
            iconCls : 'icon-redo'<span style="color: #000000">,
            handler : </span><span style="color: #0000ff">function</span> () {                                                        <span style="color: #008000">//</span><span style="color: #008000">点击取消按钮执行函数</span>
                $('#manager_edit').dialog('close').form('reset');                        <span style="color: #008000">//</span><span style="color: #008000">关闭对话框，重置表单</span>
<span style="color: #000000">            },
        }],
    });
    
    </span><span style="color: #008000">//</span><span style="color: #008000">管理帐号验证</span>
    $('input[name="manager"]'<span style="color: #000000">).validatebox({
        required : </span><span style="color: #0000ff">true</span><span style="color: #000000">,
        validType : </span>'length[2,20]'<span style="color: #000000">,
        missingMessage : </span>'请输入管理名称'<span style="color: #000000">,
        invalidMessage : </span>'管理名称在 2-20 位'<span style="color: #000000">,
    });
    
    </span><span style="color: #008000">//</span><span style="color: #008000">管理密码验证</span>
    $('input[name="password"]'<span style="color: #000000">).validatebox({
        required : </span><span style="color: #0000ff">true</span><span style="color: #000000">,
        validType : </span>'length[6,30]'<span style="color: #000000">,
        missingMessage : </span>'请输入管理密码'<span style="color: #000000">,
        invalidMessage : </span>'管理密码在 6-30 位'<span style="color: #000000">,
    });
    
    </span><span style="color: #008000">//</span><span style="color: #008000">修改管理密码验证</span>
    $('input[name="password_edit"]'<span style="color: #000000">).validatebox({
        </span><span style="color: #008000">//</span><span style="color: #008000">required : true,</span>
        validType : 'length[6,30]'<span style="color: #000000">,
        missingMessage : </span>'请输入管理密码'<span style="color: #000000">,
        invalidMessage : </span>'管理密码在 6-30 位'<span style="color: #000000">,
    });
    
    </span><span style="color: #008000">//</span><span style="color: #008000">分配权限验证</span>
    $('#auth').combotree({                                    <span style="color: #008000">//</span><span style="color: #008000">树形下拉框</span>
        url : 'nav.php'<span style="color: #000000">,
        required : </span><span style="color: #0000ff">true</span>,                                    <span style="color: #008000">//</span><span style="color: #008000">不能为空</span>
        lines : <span style="color: #0000ff">true</span>,                                        <span style="color: #008000">//</span><span style="color: #008000">显示虚线</span>
        multiple : <span style="color: #0000ff">true</span>,                                    <span style="color: #008000">//</span><span style="color: #008000">支持多选</span>
        checkbox : <span style="color: #0000ff">true</span>,                                    <span style="color: #008000">//</span><span style="color: #008000">显示复选框</span>
        onlyLeafCheck : <span style="color: #0000ff">true</span>,                                <span style="color: #008000">//</span><span style="color: #008000">只有底层目录才显示复选框</span>
        onLoadSuccess : <span style="color: #0000ff">function</span> (node, data) {                <span style="color: #008000">//</span><span style="color: #008000">在数据加载成功后触发</span>
            <span style="color: #0000ff">var</span> _this = <span style="color: #0000ff">this</span><span style="color: #000000">;
            </span><span style="color: #0000ff">if</span> (data) {                                        <span style="color: #008000">//</span><span style="color: #008000">判断目录对象是否存在</span>
                $(data).each(<span style="color: #0000ff">function</span> (index, value) {        <span style="color: #008000">//</span><span style="color: #008000">遍历出目录对象</span>
                    <span style="color: #0000ff">if</span> (<span style="color: #0000ff">this</span>.state == 'closed') {            <span style="color: #008000">//</span><span style="color: #008000">判断如果有子目录</span>
                        $(_this).tree('expandAll');            <span style="color: #008000">//</span><span style="color: #008000">展开所有目录</span>
<span style="color: #000000">                    }
                });
            }
        },
    });
    
    </span><span style="color: #008000">//</span><span style="color: #008000">增删改查执行对象</span>
    manager_tool =<span style="color: #000000"> {
        </span><span style="color: #008000">//</span><span style="color: #008000">刷新</span>
        reload : <span style="color: #0000ff">function</span> () {                                        <span style="color: #008000">//</span><span style="color: #008000">点击刷新执行方法</span>
            $('#manager').datagrid('reload');                        <span style="color: #008000">//</span><span style="color: #008000">重载数据表格</span>
<span style="color: #000000">        },
        </span><span style="color: #008000">//</span><span style="color: #008000">取消全选</span>
        redo : <span style="color: #0000ff">function</span> () {                                        <span style="color: #008000">//</span><span style="color: #008000">点击取消全选</span>
            $('#manager').datagrid('unselectAll');                    <span style="color: #008000">//</span><span style="color: #008000">取消全选</span>
<span style="color: #000000">        },
        </span><span style="color: #008000">//</span><span style="color: #008000">添加</span>
        add : <span style="color: #0000ff">function</span> () {                                            <span style="color: #008000">//</span><span style="color: #008000">点击添加按钮执行</span>
            $('#manager_add').dialog('open');                        <span style="color: #008000">//</span><span style="color: #008000">打开添加对话框</span>
            $('input[name="manager"]').focus();                        <span style="color: #008000">//</span><span style="color: #008000">将光标定位到表单</span>
<span style="color: #000000">        },
        </span><span style="color: #008000">//</span><span style="color: #008000">删除</span>
        remove : <span style="color: #0000ff">function</span> () {                                        <span style="color: #008000">//</span><span style="color: #008000">点击删除按钮执行</span>
            <span style="color: #0000ff">var</span> rows = $('#manager').datagrid('getSelections');        <span style="color: #008000">//</span><span style="color: #008000">获取数据表格所有选中对象</span>
            <span style="color: #0000ff">if</span> (rows.length &gt; 0) {                                    <span style="color: #008000">//</span><span style="color: #008000">判断选中对象长度大于0</span>
                $.messager.confirm('确定操作', '您正在要删除所选的记录吗？', <span style="color: #0000ff">function</span> (flag) {            <span style="color: #008000">//</span><span style="color: #008000">执行消息提示框，确认或者取消</span>
                    <span style="color: #0000ff">if</span> (flag) {                                                            <span style="color: #008000">//</span><span style="color: #008000">点击确认</span>
                        <span style="color: #0000ff">var</span> ids =<span style="color: #000000"> [];
                        </span><span style="color: #0000ff">for</span> (<span style="color: #0000ff">var</span> i = 0; i &lt; rows.length; i ++) {                        <span style="color: #008000">//</span><span style="color: #008000">循环出选中对象</span>
                            ids.push(rows[i].id);                                        <span style="color: #008000">//</span><span style="color: #008000">将选中对象追加到数组</span>
<span style="color: #000000">                        }
                        </span><span style="color: #008000">//</span><span style="color: #008000">console.log(ids.join(','));</span>
                        $.ajax({                                                        <span style="color: #008000">//</span><span style="color: #008000">ajax提交</span>
                            type : 'POST'<span style="color: #000000">,
                            url : </span>'deleteManager.php'<span style="color: #000000">,
                            data : {
                                ids : ids.join(</span>','),                                    <span style="color: #008000">//</span><span style="color: #008000">数组格式化分隔符</span>
<span style="color: #000000">                            },
                            beforeSend : </span><span style="color: #0000ff">function</span> () {                                    <span style="color: #008000">//</span><span style="color: #008000">提交中执行函数</span>
                                $('#manager').datagrid('loading');                        <span style="color: #008000">//</span><span style="color: #008000">显示载入状态</span>
<span style="color: #000000">                            },
                            success : </span><span style="color: #0000ff">function</span> (data) {                                    <span style="color: #008000">//</span><span style="color: #008000">提交成功后</span>
                                <span style="color: #0000ff">if</span> (data) {                                                <span style="color: #008000">//</span><span style="color: #008000">判断是否删除了数据</span>
                                    $('#manager').datagrid('loaded');                    <span style="color: #008000">//</span><span style="color: #008000">隐藏载入状态</span>
                                    $('#manager').datagrid('load');                        <span style="color: #008000">//</span><span style="color: #008000">重新加载数据表格</span>
                                    $('#manager').datagrid('unselectAll');                <span style="color: #008000">//</span><span style="color: #008000">取消所有选中的行</span>
                                    $.messager.show({                                    <span style="color: #008000">//</span><span style="color: #008000">删除消息提示</span>
                                        title : '提示'<span style="color: #000000">,
                                        msg : data </span>+ '个管理被删除成功！'<span style="color: #000000">,
                                    });
                                }
                            },
                        });
                    }
                });
            } </span><span style="color: #0000ff">else</span> {                                                                    <span style="color: #008000">//</span><span style="color: #008000">如果没有选中任何行</span>
                $.messager.alert('提示', '请选择要删除的记录！', 'info');                    <span style="color: #008000">//</span><span style="color: #008000">提示信息</span>
<span style="color: #000000">            }
        },
        </span><span style="color: #008000">//</span><span style="color: #008000">修改</span>
        edit : <span style="color: #0000ff">function</span> () {                                                            <span style="color: #008000">//</span><span style="color: #008000">点击修改执行</span>
            <span style="color: #0000ff">var</span> rows = $('#manager').datagrid('getSelections');                            <span style="color: #008000">//</span><span style="color: #008000">获取选中数组</span>
            <span style="color: #0000ff">if</span> (rows.length &gt; 1) {                                                        <span style="color: #008000">//</span><span style="color: #008000">数组长度大于1</span>
                $.messager.alert('警告操作！', '编辑记录只能选定一条数据！', 'warning');    <span style="color: #008000">//</span><span style="color: #008000">提示只能选中一条</span>
            } <span style="color: #0000ff">else</span> <span style="color: #0000ff">if</span> (rows.length == 1) {                                                <span style="color: #008000">//</span><span style="color: #008000">判断如果只选择了一条</span>
                $.ajax({                                                                <span style="color: #008000">//</span><span style="color: #008000">ajax</span>
                    url : 'getManager.php'<span style="color: #000000">,
                    type : </span>'post'<span style="color: #000000">,
                    data : {
                        id : rows[</span>0].id,                                                <span style="color: #008000">//</span><span style="color: #008000">将要修改的id发送</span>
<span style="color: #000000">                    },
                    beforeSend : </span><span style="color: #0000ff">function</span> () {                                            <span style="color: #008000">//</span><span style="color: #008000">提交时执行</span>
                        $.messager.progress({                                            <span style="color: #008000">//</span><span style="color: #008000">提示信息</span>
                            text : '正在获取中...'<span style="color: #000000">,
                        });
                    },
                    success : </span><span style="color: #0000ff">function</span> (data, response, status) {                        <span style="color: #008000">//</span><span style="color: #008000">提交成功后</span>
                        $.messager.progress('close');                                    <span style="color: #008000">//</span><span style="color: #008000">关闭提示信息</span>
                        
                        <span style="color: #0000ff">if</span> (data) {                                                        <span style="color: #008000">//</span><span style="color: #008000">判断如果获取成功</span>
                            
                            <span style="color: #ff0000">var obj = $.parseJSON(data);                                //将JSON转换成js格式</span>
                            <span style="color: #0000ff">var</span> auth = obj[0].auth.split(',');                            <span style="color: #008000">//</span><span style="color: #008000">获取要修改数据的权限，格式化分隔符</span>
<span style="color: #000000">                            
                            $(</span>'#manager_edit').form('load', {                            <span style="color: #008000">//</span><span style="color: #008000">读取数据填充到表单</span>
                                id : obj[0].id,                                            <span style="color: #008000">//</span><span style="color: #008000">将id填充到name为id输入框</span>
                                manager_edit : obj[0].manager,                            <span style="color: #008000">//</span><span style="color: #008000">将用户名填充到name为manager_edit输入框</span>
                                <span style="color: #008000">//</span><span style="color: #008000">auth_edit : obj[0].auth,</span>
                            }).dialog('open');                                            <span style="color: #008000">//</span><span style="color: #008000">打开对话框</span>
                            
                            <span style="color: #008000">//</span><span style="color: #008000">分配权限</span>
                            $('#auth_edit').combotree({                                    <span style="color: #008000">//</span><span style="color: #008000">树形下拉框</span>
                                url : 'nav.php',                                        <span style="color: #008000">//</span><span style="color: #008000">获取树形目录</span>
                                required : <span style="color: #0000ff">true</span>,                                        <span style="color: #008000">//</span><span style="color: #008000">不能为空</span>
                                lines : <span style="color: #0000ff">true</span>,                                            <span style="color: #008000">//</span><span style="color: #008000">显示虚线</span>
                                multiple : <span style="color: #0000ff">true</span>,                                        <span style="color: #008000">//</span><span style="color: #008000">支持多选</span>
                                checkbox : <span style="color: #0000ff">true</span>,                                        <span style="color: #008000">//</span><span style="color: #008000">显示复选框</span>
                                onlyLeafCheck : <span style="color: #0000ff">true</span>,                                    <span style="color: #008000">//</span><span style="color: #008000">只有底层目录显示复选框</span>
                                onLoadSuccess : <span style="color: #0000ff">function</span> (node, data) {                    <span style="color: #008000">//</span><span style="color: #008000">数据加载成功后触发</span>
                                    <span style="color: #0000ff">var</span> _this = <span style="color: #0000ff">this</span><span style="color: #000000">;
                                    </span><span style="color: #0000ff">if</span> (data) {                                            <span style="color: #008000">//</span><span style="color: #008000">判断获取到树形数据</span>
                                        $(data).each(<span style="color: #0000ff">function</span> (index, value) {            <span style="color: #008000">//</span><span style="color: #008000">遍历目录</span>
                                            <span style="color: #0000ff">if</span> ($.inArray(value.text, auth) != -1) {    <span style="color: #008000">//</span><span style="color: #008000">查找遍历到的权限名称在数组里的下标，是否等于-1</span>
                                                $(_this).tree('check', value.target);    <span style="color: #008000">//</span><span style="color: #008000">勾选指定节点，说明是已有权限</span>
<span style="color: #000000">                                            }
                                            </span><span style="color: #0000ff">if</span> (<span style="color: #0000ff">this</span>.state == 'closed') {                <span style="color: #008000">//</span><span style="color: #008000">判断如果有子目录</span>
                                                $(_this).tree('expandAll');                <span style="color: #008000">//</span><span style="color: #008000">展开所有目录</span>
<span style="color: #000000">                                            }
                                        });
                                    }
                                },
                            });
                            
                        } </span><span style="color: #0000ff">else</span> {                                                                    <span style="color: #008000">//</span><span style="color: #008000">判断如果获取失败</span>
                            $.messager.alert('获取失败！', '未知错误导致失败，请重试！', 'warning');    <span style="color: #008000">//</span><span style="color: #008000">提示失败信息</span>
<span style="color: #000000">                        }
                    }
                });
            } </span><span style="color: #0000ff">else</span> <span style="color: #0000ff">if</span> (rows.length == 0) {                                                            <span style="color: #008000">//</span><span style="color: #008000">如果一条没选中</span>
                $.messager.alert('警告操作！', '编辑记录至少选定一条数据！', 'warning');                <span style="color: #008000">//</span><span style="color: #008000">提示选择信息</span>
<span style="color: #000000">            }
        },
    };
    
    
    
});</span></pre>
</div>
<p><span style="color: #ff0000"><strong>parseJSON()将JSON格式转换成js原生格式</strong></span></p></div>