第一百八十六节，jQuery，验证表单插件，Ajax 表单插件，验证和提交表单


			<div id="cnblogs_post_body" class="blogpost-body"><p><span style="color: #0000ff"><strong>jQuery，验证表单插件，Ajax 表单插件，验证和提交表单</strong></span></p>
<p>&nbsp;</p>
<p><span style="color: #0000ff"><strong>HTML</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">&lt;</span><span style="color: #800000">form </span><span style="color: #ff0000">id</span><span style="color: #0000ff">="reg"</span><span style="color: #ff0000"> method</span><span style="color: #0000ff">="post"</span><span style="color: #ff0000"> action</span><span style="color: #0000ff">="yzh.php"</span><span style="color: #ff0000"> title</span><span style="color: #0000ff">="会员注册"</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">ol </span><span style="color: #ff0000">class</span><span style="color: #0000ff">="reg_error"</span><span style="color: #0000ff">&gt;&lt;/</span><span style="color: #800000">ol</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">p</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">label </span><span style="color: #ff0000">for</span><span style="color: #0000ff">="user"</span><span style="color: #0000ff">&gt;</span>帐号：<span style="color: #0000ff">&lt;/</span><span style="color: #800000">label</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="text"</span><span style="color: #ff0000"> name</span><span style="color: #0000ff">="user"</span><span style="color: #ff0000"> class</span><span style="color: #0000ff">="text"</span><span style="color: #ff0000"> id</span><span style="color: #0000ff">="user"</span><span style="color: #0000ff">/&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">span </span><span style="color: #ff0000">class</span><span style="color: #0000ff">="star"</span><span style="color: #0000ff">&gt;</span>*<span style="color: #0000ff">&lt;/</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">p</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">p</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">label </span><span style="color: #ff0000">for</span><span style="color: #0000ff">="pass"</span><span style="color: #0000ff">&gt;</span>密码：<span style="color: #0000ff">&lt;/</span><span style="color: #800000">label</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="text"</span><span style="color: #ff0000"> name</span><span style="color: #0000ff">="pass"</span><span style="color: #ff0000"> class</span><span style="color: #0000ff">="text"</span><span style="color: #ff0000"> id</span><span style="color: #0000ff">="pass"</span><span style="color: #0000ff">/&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">span </span><span style="color: #ff0000">class</span><span style="color: #0000ff">="star"</span><span style="color: #0000ff">&gt;</span>*<span style="color: #0000ff">&lt;/</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">p</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">p</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">label </span><span style="color: #ff0000">for</span><span style="color: #0000ff">="email"</span><span style="color: #0000ff">&gt;</span>邮箱：<span style="color: #0000ff">&lt;/</span><span style="color: #800000">label</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="text"</span><span style="color: #ff0000"> name</span><span style="color: #0000ff">="email"</span><span style="color: #ff0000"> class</span><span style="color: #0000ff">="text"</span><span style="color: #ff0000"> id</span><span style="color: #0000ff">="email"</span><span style="color: #0000ff">/&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">span </span><span style="color: #ff0000">class</span><span style="color: #0000ff">="star"</span><span style="color: #0000ff">&gt;</span>*<span style="color: #0000ff">&lt;/</span><span style="color: #800000">span</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">p</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">p</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">label</span><span style="color: #0000ff">&gt;</span>性别：<span style="color: #0000ff">&lt;/</span><span style="color: #800000">label</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="radio"</span><span style="color: #ff0000"> name</span><span style="color: #0000ff">="sex"</span><span style="color: #ff0000"> id</span><span style="color: #0000ff">="male"</span><span style="color: #ff0000"> checked</span><span style="color: #0000ff">="checked"</span><span style="color: #ff0000"> value</span><span style="color: #0000ff">="男"</span><span style="color: #0000ff">&gt;&lt;</span><span style="color: #800000">label </span><span style="color: #ff0000">for</span><span style="color: #0000ff">="male"</span><span style="color: #0000ff">&gt;</span>男<span style="color: #0000ff">&lt;/</span><span style="color: #800000">label</span><span style="color: #0000ff">&gt;&lt;/</span><span style="color: #800000">input</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="radio"</span><span style="color: #ff0000"> name</span><span style="color: #0000ff">="sex"</span><span style="color: #ff0000"> id</span><span style="color: #0000ff">="female"</span><span style="color: #ff0000"> value</span><span style="color: #0000ff">="女"</span><span style="color: #0000ff">&gt;&lt;</span><span style="color: #800000">label </span><span style="color: #ff0000">for</span><span style="color: #0000ff">="female"</span><span style="color: #0000ff">&gt;</span>女<span style="color: #0000ff">&lt;/</span><span style="color: #800000">label</span><span style="color: #0000ff">&gt;&lt;/</span><span style="color: #800000">input</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">p</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">p</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">label </span><span style="color: #ff0000">for</span><span style="color: #0000ff">="date"</span><span style="color: #0000ff">&gt;</span>生日：<span style="color: #0000ff">&lt;/</span><span style="color: #800000">label</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">input </span><span style="color: #ff0000">type</span><span style="color: #0000ff">="text"</span><span style="color: #ff0000"> name</span><span style="color: #0000ff">="date"</span><span style="color: #ff0000"> readonly</span><span style="color: #0000ff">="readonly"</span><span style="color: #ff0000"> class</span><span style="color: #0000ff">="text"</span><span style="color: #ff0000"> id</span><span style="color: #0000ff">="date"</span><span style="color: #0000ff">/&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">p</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;/</span><span style="color: #800000">form</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">div </span><span style="color: #ff0000">id</span><span style="color: #0000ff">="loading"</span><span style="color: #0000ff">&gt;</span>数据交互中...<span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span></pre>
</div>
<p><span style="color: #0000ff"><strong>css</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">/*</span><span style="color: #008000">注册框</span><span style="color: #008000">*/</span><span style="color: #800000">
#reg </span>{<span style="color: #ff0000">
    padding</span>:<span style="color: #0000ff"> 15px</span>;<span style="color: #ff0000">
    display</span>:<span style="color: #0000ff"> none</span>;
}<span style="color: #800000">

#reg p </span>{<span style="color: #ff0000">
    margin</span>:<span style="color: #0000ff"> 10px 0</span>;<span style="color: #ff0000">
    padding</span>:<span style="color: #0000ff"> 0</span>;
}<span style="color: #800000">

#reg p label </span>{<span style="color: #ff0000">
    font-size</span>:<span style="color: #0000ff"> 14px</span>;
    <span style="color: #008000">/*</span><span style="color: #008000">color: #666;</span><span style="color: #008000">*/</span>
}<span style="color: #800000">

#reg p .star </span>{<span style="color: #ff0000">
    color</span>:<span style="color: #0000ff"> red</span>;
}<span style="color: #800000">

#reg .text </span>{<span style="color: #ff0000">
    border-radius</span>:<span style="color: #0000ff"> 4px</span>;<span style="color: #ff0000">
    border</span>:<span style="color: #0000ff"> 1px solid #ccc</span>;<span style="color: #ff0000">
    background</span>:<span style="color: #0000ff"> #fff</span>;<span style="color: #ff0000">
    height</span>:<span style="color: #0000ff"> 25px</span>;<span style="color: #ff0000">
    width</span>:<span style="color: #0000ff"> 200px</span>;<span style="color: #ff0000">
    text-indent</span>:<span style="color: #0000ff"> 5px</span>;<span style="color: #ff0000">
    color</span>:<span style="color: #0000ff"> #666</span>;
}<span style="color: #800000">
#reg .reg_error</span>{<span style="color: #ff0000">
    color</span>:<span style="color: #0000ff"> #ff171f</span>;<span style="color: #ff0000">
    padding</span>:<span style="color: #0000ff">0</span>;<span style="color: #ff0000">
    margin</span>:<span style="color: #0000ff">0 0 0 20px</span>;
}<span style="color: #800000">
#reg .succ</span>{<span style="color: #ff0000">
    display</span>:<span style="color: #0000ff">inline-block</span>;<span style="color: #ff0000">
    width</span>:<span style="color: #0000ff">20px</span>;<span style="color: #ff0000">
    background</span>:<span style="color: #0000ff">url(../img/reg_succ.png) no-repeat</span>;
}

<span style="color: #008000">/*</span><span style="color: #008000">ui提示信息</span><span style="color: #008000">*/</span><span style="color: #800000">
.ui-tooltip</span>{<span style="color: #ff0000">
    color</span>:<span style="color: #0000ff"> #ff1c24</span>;
}<span style="color: #800000">

.su</span>{<span style="color: #ff0000">
    width</span>:<span style="color: #0000ff"> 50px</span>;<span style="color: #ff0000">
    height</span>:<span style="color: #0000ff"> 20px</span>;<span style="color: #ff0000">
    background-color</span>:<span style="color: #0000ff"> #2cff24</span>;
}<span style="color: #800000">
#loading </span>{<span style="color: #ff0000">
    line-height</span>:<span style="color: #0000ff">30px</span>;<span style="color: #ff0000">
    font-size</span>:<span style="color: #0000ff">14px</span>;<span style="color: #ff0000">
    font-weight</span>:<span style="color: #0000ff">bold</span>;<span style="color: #ff0000">
    text-indent</span>:<span style="color: #0000ff">40px</span>;<span style="color: #ff0000">
    color</span>:<span style="color: #0000ff">#666</span>;<span style="color: #ff0000">
    padding-left</span>:<span style="color: #0000ff">40px</span>;
}</pre>
</div>
<p><span style="color: #0000ff"><strong>前台js</strong></span></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>closeOnEscape对话框插件属，性阻止点击键盘ESC键关闭dialog</strong></span></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>beforeClose对话框插件属性，值是一个函数，关闭对话框执行函数</strong></span></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>submitHandler表单验证插件属性，值是一个函数，全部验证成功执行函数，接收一个参数是表单对象</strong></span></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>beforeSubmit提交ajax提交插件属性，值是一个函数，提交时执行函数</strong></span></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>success提交ajax提交插件属性，值是一个函数，提交成功后执行函数</strong></span></p>
<p>&nbsp;</p>
<p><br><span style="color: #ff0000"><strong>highlight表单验证插件属性，值是一个函数，当验证不合法时执行函数</strong></span></p>
<p>&nbsp;</p>
<p><br><span style="color: #ff0000"><strong>unhighlight表单验证插件属性，值是一个函数，当验证合法时执行函数</strong></span></p>
<p>&nbsp;</p>
<p><br><span style="color: #ff0000"><strong>showErrors表单验证插件属性，值是一个函数，当验证不合法时执行函数，可以获取不合法句柄</strong></span></p>
<p>&nbsp;</p>
<div class="cnblogs_code">
<pre>$('#loading').dialog({                  <span style="color: #008000">//</span><span style="color: #008000">数据交互提示框，执行对话框方法</span>
        autoOpen : <span style="color: #0000ff">false</span>,                   <span style="color: #008000">//</span><span style="color: #008000">创建对话框关闭</span>
        modal : <span style="color: #0000ff">true</span>,                       <span style="color: #008000">//</span><span style="color: #008000">遮罩</span>
        closeOnEscape : <span style="color: #0000ff">false</span>,              <span style="color: #008000">//</span><span style="color: #008000">阻止点击键盘ESC键关闭dialog</span>
        resizable : <span style="color: #0000ff">false</span>,                  <span style="color: #008000">//</span><span style="color: #008000">阻止调整对话框大小</span>
        draggable : <span style="color: #0000ff">false</span>,                  <span style="color: #008000">//</span><span style="color: #008000">阻止对话框可以移动</span>
        width : 230<span style="color: #000000">,
        height : </span>50<span style="color: #000000">
    }).parent().parent().find(</span>'.ui-widget-header').hide();  <span style="color: #008000">//</span><span style="color: #008000">找到对话框标题隐藏</span>
    <span style="color: #008000">//</span><span style="color: #008000">注册框</span>
    $('#reg_a').on('click',<span style="color: #0000ff">function</span> () {                    <span style="color: #008000">//</span><span style="color: #008000">将注册框，执行对话框方法</span>
        $('#reg'<span style="color: #000000">).dialog({
            autoOpen : </span><span style="color: #0000ff">true</span><span style="color: #000000">,
            modal : </span><span style="color: #0000ff">true</span><span style="color: #000000">,
            resizable : </span><span style="color: #0000ff">false</span><span style="color: #000000">,
            width : </span>320<span style="color: #000000">,
            height : </span>360<span style="color: #000000">,
            buttons : {                                     </span><span style="color: #008000">//</span><span style="color: #008000">注册对话框创建按钮</span>
                '提交' : <span style="color: #0000ff">function</span><span style="color: #000000"> () {
                    $(</span><span style="color: #0000ff">this</span>).submit();                       <span style="color: #008000">//</span><span style="color: #008000">执行提交方法</span>
<span style="color: #000000">                }
            },
            closeText : </span>'关闭对话框'<span style="color: #000000">,
            beforeClose:</span><span style="color: #0000ff">function</span> (e,ui) {                   <span style="color: #008000">//</span><span style="color: #008000">将要关闭，执行回调函数</span>
                $('#reg').resetForm();                                <span style="color: #008000">//</span><span style="color: #008000">Ajax 表单插件方法，重置表单</span>
                $('#reg span.star').html('*').removeClass('succ');    <span style="color: #008000">//</span><span style="color: #008000">改变提示信息</span>
                $('#reg ol').html('');                                <span style="color: #008000">//</span><span style="color: #008000">将提示信息去掉</span>
                $('#reg input').css('border', '1px solid #ccc');      <span style="color: #008000">//</span><span style="color: #008000">改变出错边框颜色</span>
<span style="color: #000000">            }
        }).buttonset().validate({                                           </span><span style="color: #008000">//</span><span style="color: #008000">验证表单</span>
            submitHandler: <span style="color: #0000ff">function</span> (form) {                                <span style="color: #008000">//</span><span style="color: #008000">全部验证成功准备提交</span>
                $(form).ajaxSubmit({                                        <span style="color: #008000">//</span><span style="color: #008000">Ajax 表单插件方法，提交</span>
                    url: 'add.php',                                         <span style="color: #008000">//</span><span style="color: #008000">提交页面</span>
                    type: 'POST',                                           <span style="color: #008000">//</span><span style="color: #008000">提交方式</span>
                    beforeSubmit: <span style="color: #0000ff">function</span> (formData, jqForm, options) {    <span style="color: #008000">//</span><span style="color: #008000">提交时</span>
                        $('#loading').dialog('open');                       <span style="color: #008000">//</span><span style="color: #008000">打开交互对话框</span>
                        $('#reg').dialog('widget').find('button').eq(1).button('disable');                                  <span style="color: #008000">//</span><span style="color: #008000">将注册对话框的提交按钮禁止</span>
                        $('#loading').css('background', 'url(img/743.gif) no-repeat 20px center').html('数据交互中...');     <span style="color: #008000">//</span><span style="color: #008000">载入交互对话框图片</span>
<span style="color: #000000">                    },
                    success: </span><span style="color: #0000ff">function</span> (responseText, statusText) {                                                             <span style="color: #008000">//</span><span style="color: #008000">提交后</span>
                        <span style="color: #0000ff">if</span> (responseText) {                                                                                    <span style="color: #008000">//</span><span style="color: #008000">判断提交成功返回值</span>
                            $('#reg').dialog('widget').find('button').eq(1).button('enable');                                  <span style="color: #008000">//</span><span style="color: #008000">取消阻止注册提交按钮</span>
                            $('#loading').css('background', 'url(img/chg.png) no-repeat 20px center').html('数据新增成功...');  <span style="color: #008000">//</span><span style="color: #008000">载入提交成功图片</span>
                            setTimeout(<span style="color: #0000ff">function</span> () {                                    <span style="color: #008000">//</span><span style="color: #008000">睡眠1秒</span>
                                $('#loading').dialog('close');                          <span style="color: #008000">//</span><span style="color: #008000">关闭交互提示对话框</span>
                                $('#reg').dialog('close');                              <span style="color: #008000">//</span><span style="color: #008000">关闭注册对话框</span>
                                $('#reg').resetForm();                                  <span style="color: #008000">//</span><span style="color: #008000">重置表单</span>
                                $('#reg span.star').html('*').removeClass('succ');      <span style="color: #008000">//</span><span style="color: #008000">改变验证提示信息</span>
                            }, 10000<span style="color: #000000">);
                        }
                    }
                });
            },
            highlight: </span><span style="color: #0000ff">function</span> (element, errorClass) {                             <span style="color: #008000">//</span><span style="color: #008000">如果出错，错误框边框改变颜色</span>
                $(element).css('border', '1px solid #630'<span style="color: #000000">);
                $(element).parent().find(</span>'span').html('*').removeClass('succ');     <span style="color: #008000">//</span><span style="color: #008000">改变验证提示信息</span>
<span style="color: #000000">            },
            unhighlight: </span><span style="color: #0000ff">function</span> (element, errorClass) {                           <span style="color: #008000">//</span><span style="color: #008000">如果正确取消边框改变颜色</span>
                $(element).css('border', '1px solid #ccc'<span style="color: #000000">);
                $(element).parent().find(</span>'span').html('&amp;nbsp;').addClass('succ');   <span style="color: #008000">//</span><span style="color: #008000">显示正确图片</span>
<span style="color: #000000">            },
            showErrors: </span><span style="color: #0000ff">function</span> (errorMap, errorList) {                            <span style="color: #008000">//</span><span style="color: #008000">获取出错句柄</span>
                <span style="color: #0000ff">var</span> errors = <span style="color: #0000ff">this</span><span style="color: #000000">.numberOfInvalids();
                </span><span style="color: #0000ff">if</span> (errors &gt; 0) {                                                   <span style="color: #008000">//</span><span style="color: #008000">判断出错句柄个数来改变对话框的高度</span>
                    $('#reg').dialog('option', 'height', errors * 20 + 360);        <span style="color: #008000">//</span><span style="color: #008000">注册对话框自动根据错误数量来改变高度</span>
                } <span style="color: #0000ff">else</span><span style="color: #000000"> {
                    $(</span>'#reg').dialog('option', 'height', 360);                      <span style="color: #008000">//</span><span style="color: #008000">没有错误还原高度</span>
<span style="color: #000000">                }
                </span><span style="color: #0000ff">this</span><span style="color: #000000">.defaultShowErrors();
            },
            errorLabelContainer: </span>'ol.reg_error',                                    <span style="color: #008000">//</span><span style="color: #008000">有错误时，将所有表单错误信息统一放到class为ol.reg_error的元素里</span>
            wrapper: 'li',                                                          <span style="color: #008000">//</span><span style="color: #008000">将每个错误信息放入一个li标签</span>
            rules : {                                                               <span style="color: #008000">//</span><span style="color: #008000">表单验证规则</span>
                user : {                                                            <span style="color: #008000">//</span><span style="color: #008000">验证用户名</span>
                    required:<span style="color: #0000ff">true</span>,                                                  <span style="color: #008000">//</span><span style="color: #008000">不能为空</span>
                    rangelength:[2,10]                                              <span style="color: #008000">//</span><span style="color: #008000">不得小于2位大于10位</span>
<span style="color: #000000">                },
                pass:{                                                              </span><span style="color: #008000">//</span><span style="color: #008000">验证密码</span>
                    required:<span style="color: #0000ff">true</span>,                                                  <span style="color: #008000">//</span><span style="color: #008000">不能为空</span>
                    rangelength:[6,20]                                              <span style="color: #008000">//</span><span style="color: #008000">不得小于6位大于20位</span>
<span style="color: #000000">                },
                email:{                                                             </span><span style="color: #008000">//</span><span style="color: #008000">验证邮箱</span>
                    required:<span style="color: #0000ff">true</span>,                                                  <span style="color: #008000">//</span><span style="color: #008000">不能为空</span>
                    email:<span style="color: #0000ff">true</span>                                                      <span style="color: #008000">//</span><span style="color: #008000">必须是邮箱格式</span>
<span style="color: #000000">                }
            },
            messages : {                                                            </span><span style="color: #008000">//</span><span style="color: #008000">错误提示</span>
<span style="color: #000000">                user : {
                    required:</span>'用户名不能为空！'<span style="color: #000000">,
                    rangelength:jQuery.format(</span>'用户名不得小于{0}位，大于{1}位'<span style="color: #000000">)
                },
                pass:{
                    required:</span>'密码不能为空'<span style="color: #000000">,
                    rangelength:jQuery.format(</span>'密码不得小于{0}位，大于{1}位'<span style="color: #000000">)
                },
                email:{
                    required:</span>'邮箱不能为空'<span style="color: #000000">,
                    email:</span>'请输入正确的邮箱格式'<span style="color: #000000">
                }
            }
        });


        </span><span style="color: #008000">//</span><span style="color: #008000">邮箱执行自动补全</span>
        $('#email'<span style="color: #000000">).autocomplete({
            autoFocus: </span><span style="color: #0000ff">true</span><span style="color: #000000">,
            delay: </span>0<span style="color: #000000">,
            source: </span><span style="color: #0000ff">function</span><span style="color: #000000"> (request, response) {
                </span><span style="color: #0000ff">var</span> hosts = ['qq.com', '163.com', '263.com', 'gmail.com', 'hotmail.com'], <span style="color: #008000">//</span><span style="color: #008000">起始</span>
                    term = request.term,        <span style="color: #008000">//</span><span style="color: #008000">获取输入值</span>
                    ix = term.indexOf('@'),     <span style="color: #008000">//</span><span style="color: #008000">@</span>
                    name = term,                <span style="color: #008000">//</span><span style="color: #008000">用户名</span>
                    host = '',                  <span style="color: #008000">//</span><span style="color: #008000">域名</span>
                    result = [];                <span style="color: #008000">//</span><span style="color: #008000">结果</span>
                <span style="color: #008000">//</span><span style="color: #008000">结果第一条是自己输入</span>
<span style="color: #000000">                result.push(term);
                </span><span style="color: #0000ff">if</span> (ix &gt; -1) { <span style="color: #008000">//</span><span style="color: #008000">如果有@的时候</span>
                    name = term.slice(0, ix);       <span style="color: #008000">//</span><span style="color: #008000">得到用户名</span>
                    host = term.slice(ix + 1);      <span style="color: #008000">//</span><span style="color: #008000">得到域名</span>
<span style="color: #000000">                }
                </span><span style="color: #0000ff">if</span><span style="color: #000000"> (name) {
                    </span><span style="color: #008000">//</span><span style="color: #008000">得到找到的域名</span>
                    <span style="color: #0000ff">var</span> findedHosts = (host ? $.grep(hosts, <span style="color: #0000ff">function</span><span style="color: #000000"> (value, index) {
                            </span><span style="color: #0000ff">return</span> value.indexOf(host) &gt; -1<span style="color: #000000">;
                        }) : hosts),
                        </span><span style="color: #008000">//</span><span style="color: #008000">最终列表的邮箱</span>
                        findedResults = $.map(findedHosts, <span style="color: #0000ff">function</span><span style="color: #000000"> (value, index) {
                            </span><span style="color: #0000ff">return</span> name + '@' +<span style="color: #000000"> value;
                        });
                    </span><span style="color: #008000">//</span><span style="color: #008000">增加一个自我输入</span>
                    result =<span style="color: #000000"> result.concat(findedResults);
                }
                response(result);
            }
        });

        </span><span style="color: #008000">//</span><span style="color: #008000">将生日执行日历ui</span>
        $('#date'<span style="color: #000000">).datepicker({
            showOtherMonths:</span><span style="color: #0000ff">true</span><span style="color: #000000">,
            changeYear:</span><span style="color: #0000ff">true</span><span style="color: #000000">,
            changeMonth:</span><span style="color: #0000ff">true</span><span style="color: #000000">,
            yearSuffix:</span>''<span style="color: #000000">
        });
    });</span></pre>
</div>
<p><span style="color: #0000ff"><strong>提交PHP文件</strong></span></p>
<div class="cnblogs_code">
<pre>&lt;?<span style="color: #000000">php
    </span><span style="color: #008080">header</span>('Content-Type:text/html; charset=utf-8'<span style="color: #000000">);
    
    </span><span style="color: #008080">define</span>('DB_HOST', 'localhost'<span style="color: #000000">);
    </span><span style="color: #008080">define</span>('DB_USER', 'root'<span style="color: #000000">);
    </span><span style="color: #008080">define</span>('DB_PWD', '279819'<span style="color: #000000">);
    </span><span style="color: #008080">define</span>('DB_NAME', 'zhiwen'<span style="color: #000000">);
    
    </span><span style="color: #800080">$conn</span> = @<span style="color: #008080">mysql_connect</span>(DB_HOST, DB_USER, DB_PWD) or <span style="color: #0000ff">die</span>('数据库链接失败：'.<span style="color: #008080">mysql_error</span><span style="color: #000000">());
    
    @</span><span style="color: #008080">mysql_select_db</span>(DB_NAME) or <span style="color: #0000ff">die</span>('数据库错误：'.<span style="color: #008080">mysql_error</span><span style="color: #000000">());
    
    @</span><span style="color: #008080">mysql_query</span>('SET NAMES UTF8') or <span style="color: #0000ff">die</span>('字符集错误：'.<span style="color: #008080">mysql_error</span><span style="color: #000000">());
    </span><span style="color: #008080">sleep</span>(3<span style="color: #000000">);
    </span><span style="color: #0000ff">require</span> 'config.php'<span style="color: #000000">;
    
    </span><span style="color: #800080">$query</span> = "<span style="color: #000000">INSERT INTO user (user, pass, email, sex, birthday, date) 
            VALUES ('{</span><span style="color: #800080">$_POST</span>['user']}', sha1('{<span style="color: #800080">$_POST</span>['pass']}'), '{<span style="color: #800080">$_POST</span>['email']}', '{<span style="color: #800080">$_POST</span>['sex']}', '{<span style="color: #800080">$_POST</span>['birthday']}', NOW())"<span style="color: #000000">;
    
    </span><span style="color: #008080">mysql_query</span>(<span style="color: #800080">$query</span>) or <span style="color: #0000ff">die</span>('新增失败！'.<span style="color: #008080">mysql_error</span><span style="color: #000000">());
    
    </span><span style="color: #0000ff">echo</span> <span style="color: #008080">mysql_affected_rows</span><span style="color: #000000">();
    
    </span><span style="color: #008080">mysql_close</span><span style="color: #000000">();
</span>?&gt;</pre>
</div>
<p>&nbsp;</p></div>