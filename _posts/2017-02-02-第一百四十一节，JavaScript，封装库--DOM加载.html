第一百四十一节，JavaScript，封装库--DOM加载


			<div id="cnblogs_post_body" class="blogpost-body"><p><span style="color: #0000ff"><strong>JavaScript，封装库--DOM加载</strong></span></p>
<p><span style="color: #ff0000"><strong><strong>DOM加载，跨浏览器封装<strong>DOM加载，当网页文档结构加载完毕后执行函数，不等待图片音频视频等文件加载完毕</strong></strong></strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">/*</span><span style="color: #008000">* dom_jia_zai()函数，DOM页面加载函数，等待页面结构加载完毕后就执行函数，不需要等待页面音频视频等文件加载完毕，提高加载速度
 * 参数是页面结构加载完毕后要执行的函数
 * 一般前写前台js文件时，使用此方法加载DOM页面后执行代码，提高速度
 *</span><span style="color: #008000">*/</span>
<span style="color: #0000ff">function</span><span style="color: #000000"> dom_jia_zai(fn){
    </span><span style="color: #0000ff">var</span> isReady = <span style="color: #0000ff">false</span><span style="color: #000000">;
    </span><span style="color: #0000ff">var</span> timer = <span style="color: #0000ff">null</span><span style="color: #000000">;
    </span><span style="color: #0000ff">function</span><span style="color: #000000"> doReady(fn) {
        </span><span style="color: #0000ff">if</span><span style="color: #000000">(timer) clearInterval(timer);
        </span><span style="color: #0000ff">if</span> (isReady) <span style="color: #0000ff">return</span><span style="color: #000000">;
        isReady </span>= <span style="color: #0000ff">true</span><span style="color: #000000">;
        fn();
    }
    </span><span style="color: #0000ff">if</span> ((sys.opera &amp;&amp; sys.opera &lt; 9) || (sys.firefox &amp;&amp; sys.firefox &lt; 3) || (sys.webkit &amp;&amp; sys.webkit &lt; 525<span style="color: #000000">)){
        timer </span>= setInterval(<span style="color: #0000ff">function</span><span style="color: #000000"> () {
            </span><span style="color: #0000ff">if</span> (document &amp;&amp; document.getElementById &amp;&amp; document.getElementsByTagName &amp;&amp;<span style="color: #000000"> document.body) {
                doReady();
            }
        }, </span>1<span style="color: #000000">);
    }</span><span style="color: #0000ff">else</span> <span style="color: #0000ff">if</span><span style="color: #000000">(document.addEventListener){
        addEvent(document, </span>'DOMContentLoaded', <span style="color: #0000ff">function</span> () {                  <span style="color: #008000">//</span><span style="color: #008000">页面结构树加载完毕后执行函数，不会等待音频视频等文件加载完毕</span>
<span style="color: #000000">            fn();
            removeEvent(document, </span>'DOMContentLoaded'<span style="color: #000000">, arguments.callee);
        });
    }</span><span style="color: #0000ff">else</span> <span style="color: #0000ff">if</span>(sys.ie &amp;&amp; sys.ie &lt; 9<span style="color: #000000">){
        </span><span style="color: #0000ff">var</span> timer = <span style="color: #0000ff">null</span><span style="color: #000000">;
        timer </span>= setInterval(<span style="color: #0000ff">function</span><span style="color: #000000"> () {
            </span><span style="color: #0000ff">try</span><span style="color: #000000"> {
                document.documentElement.doScroll(</span>'left'<span style="color: #000000">);
                doReady();
            } </span><span style="color: #0000ff">catch</span><span style="color: #000000"> (e) {}
        },</span>1<span style="color: #000000">);
    }
}</span></pre>
</div>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>前台js 代码</strong></span></p>
<div class="cnblogs_code">
<pre>dom_jia_zai(<span style="color: #0000ff">function</span><span style="color: #000000"> () {
alert(</span>'111'<span style="color: #000000">);

});</span></pre>
</div>
<p>&nbsp;</p></div>