第三百九十四节，Django+Xadmin打造上线标准的在线教育平台—Xadmin后台进阶开发配置2，以及目录结构说明


			<div id="cnblogs_post_body" class="blogpost-body"><p><strong>第三百九十四节，Django+Xadmin打造上线标准的在线教育平台—Xadmin后台进阶开发配置2，以及目录结构说明</strong></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>设置后台列表页面可以直接修改字段内容</strong></span></p>
<p><strong>在当前APP里的adminx.py文件里的数据表管理器里设置</strong></p>
<p><span style="color: #ff0000"><strong>list_editable = ['可以修改的字段','可以修改的字段']</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">class</span> UsersAdmin(object):               <span style="color: #008000">#</span><span style="color: #008000"> 自定义用户信息数据表管理器类</span>
    <span style="color: #008000">#</span><span style="color: #008000"> 设置xadmin后台显示字段</span>
    list_display = [<span style="color: #800000">'</span><span style="color: #800000">username</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">password</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">nick_name</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">gender</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">email</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">address</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">mobile</span><span style="color: #800000">'</span><span style="color: #000000">,
                    </span><span style="color: #800000">'</span><span style="color: #800000">first_name</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">last_name</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">is_active</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">birday</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">last_login</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">date_joined</span><span style="color: #800000">'</span><span style="color: #000000">]
    </span><span style="color: #008000">#</span><span style="color: #008000"> 设置xadmin后台搜索字段，注意：搜索字段如果有时间类型会报错</span>
    search_fields = [<span style="color: #800000">'</span><span style="color: #800000">username</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">password</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">nick_name</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">gender</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">email</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">address</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">mobile</span><span style="color: #800000">'</span><span style="color: #000000">]
    </span><span style="color: #008000">#</span><span style="color: #008000"> 设置xadmin后台过滤器帅选字段，时间用过滤器来做</span>
    list_filter = [<span style="color: #800000">'</span><span style="color: #800000">username</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">password</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">nick_name</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">gender</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">email</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">address</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">mobile</span><span style="color: #800000">'</span><span style="color: #000000">,
                    </span><span style="color: #800000">'</span><span style="color: #800000">first_name</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">last_name</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">is_active</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">birday</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">last_login</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">date_joined</span><span style="color: #800000">'</span><span style="color: #000000">]
    model_icon </span>= <span style="color: #800000">'</span><span style="color: #800000">fa fa-user-plus</span><span style="color: #800000">'</span><span style="color: #000000">
    ordering </span>= [<span style="color: #800000">'</span><span style="color: #800000">-id</span><span style="color: #800000">'</span><span style="color: #000000">]
    readonly_fields </span>= [<span style="color: #800000">'</span><span style="color: #800000">password</span><span style="color: #800000">'</span><span style="color: #000000">]
    exclude </span>= [<span style="color: #800000">'</span><span style="color: #800000">first_name</span><span style="color: #800000">'</span>,<span style="color: #800000">'</span><span style="color: #800000">last_name</span><span style="color: #800000">'</span><span style="color: #000000">]
   <span style="background-color: #ff99cc"> list_editable </span></span><span style="background-color: #ff99cc">= [<span style="color: #800000">'</span><span style="color: #800000">username</span><span style="color: #800000">'</span>,<span style="color: #800000">'</span><span style="color: #800000">email</span><span style="color: #800000">'</span></span><span style="color: #000000"><span style="background-color: #ff99cc">]</span>
xadmin.site.register(Users, UsersAdmin)     </span><span style="color: #008000">#</span><span style="color: #008000"> 将户信息数据表注册到xadmin后台显示</span></pre>
</div>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>设置后台列表页面，自定义列也就是自定义一个非数据表的字段</strong></span></p>
<p><strong>在<strong>adminx.py文件里的数据表管理器里设置<span style="color: #ff0000">list_display=要显示的数据字段名称</span>，当然也<span style="color: #ff0000">可以设置一个函数名称</span>，在models里定义函数，在后台就会多一列，<span style="color: #ff0000">显示的函数返回值</span></strong></strong></p>
<p><strong><strong><span style="color: #ff0000"><strong><strong>models文件</strong></strong></span></strong></strong></p>
<p><strong><strong><span style="color: #ff0000"><strong><strong>自定义函数名称.short_description = '后台显示名称'</strong></strong></span></strong></strong></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">class</span><span style="color: #000000"> Course(models.Model):
    name </span>= models.CharField(max_length=50, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">课程名称</span><span style="color: #800000">'</span><span style="color: #000000">)
    desc </span>= models.CharField(max_length=300, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">课程描述</span><span style="color: #800000">'</span><span style="color: #000000">)
    detail </span>= models.TextField(verbose_name=<span style="color: #800000">'</span><span style="color: #800000">课程详情</span><span style="color: #800000">'</span><span style="color: #000000">)
    degree </span>= models.CharField(verbose_name=<span style="color: #800000">'</span><span style="color: #800000">课程级别</span><span style="color: #800000">'</span>, choices=((<span style="color: #800000">'</span><span style="color: #800000">cj</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">初级</span><span style="color: #800000">'</span>), (<span style="color: #800000">'</span><span style="color: #800000">zj</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">中级</span><span style="color: #800000">'</span>), (<span style="color: #800000">'</span><span style="color: #800000">gj</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">高级</span><span style="color: #800000">'</span>)), max_length=3<span style="color: #000000">)
    learn_times </span>= models.IntegerField(default=0, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">学习时长(分钟)</span><span style="color: #800000">'</span><span style="color: #000000">)
    students </span>= models.IntegerField(default=0, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">学习人数</span><span style="color: #800000">'</span><span style="color: #000000">)
    fav_nums </span>= models.IntegerField(default=0, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">收藏人数</span><span style="color: #800000">'</span><span style="color: #000000">)
    image </span>= models.ImageField(upload_to=<span style="color: #800000">'</span><span style="color: #800000">courses/%Y/%m</span><span style="color: #800000">'</span>, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">课程封面图</span><span style="color: #800000">'</span>, max_length=100<span style="color: #000000">)
    click_nums </span>= models.IntegerField(default=0, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">点击数</span><span style="color: #800000">'</span><span style="color: #000000">)
    add_time </span>= models.DateTimeField(default=datetime.now, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">添加时间</span><span style="color: #800000">'</span><span style="color: #000000">)

    </span><span style="color: #0000ff">class</span><span style="color: #000000"> Meta:
        verbose_name </span>= <span style="color: #800000">'</span><span style="color: #800000">课程</span><span style="color: #800000">'</span><span style="color: #000000">
        verbose_name_plural </span>=<span style="color: #000000"> verbose_name

    </span><span style="color: #008000">#</span><span style="color: #008000"> 自定义列</span>
<span style="background-color: #ff99cc">    <span style="color: #0000ff">def</span><span style="color: #000000"> hqzhjie(self):
        </span><span style="color: #0000ff">return</span> 555<span style="color: #000000">
    hqzhjie.short_description </span>= <span style="color: #800000">'</span><span style="color: #800000">章节数</span><span style="color: #800000">'</span></span>

    <span style="color: #0000ff">def</span> <span style="color: #800080">__str__</span><span style="color: #000000">(self):
        </span><span style="color: #0000ff">return</span> self.name        <span style="color: #008000">#</span><span style="color: #008000"> 设置在xadmin后台显示字段, 注意如果此表被另外的了外键关联了，这个返回字段就是外键表的外键名称</span></pre>
</div>
<p><span style="color: #ff0000"><strong><strong>adminx.py</strong></strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">class</span> CourseAdmin(object):               <span style="color: #008000">#</span><span style="color: #008000"> 自定义数据表管理器类</span>

    <span style="color: #008000">#</span><span style="color: #008000"> 设置xadmin后台显示字段</span>
    list_display = [<span style="color: #800000">'</span><span style="color: #800000">name</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">desc</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">detail</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">degree</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">learn_times</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">students</span><span style="color: #800000">'</span><span style="color: #000000">,
                    </span><span style="color: #800000">'</span><span style="color: #800000">fav_nums</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">image</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">click_nums</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">add_time</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000; background-color: #ff99cc">hqzhjie</span><span style="color: #800000">'</span><span style="color: #000000">]

    </span><span style="color: #008000">#</span><span style="color: #008000"> 设置xadmin后台搜索字段，注意：搜索字段如果有时间类型会报错</span>
    search_fields = [<span style="color: #800000">'</span><span style="color: #800000">name</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">desc</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">detail</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">degree</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">learn_times</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">students</span><span style="color: #800000">'</span><span style="color: #000000">,
                     </span><span style="color: #800000">'</span><span style="color: #800000">fav_nums</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">image</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">click_nums</span><span style="color: #800000">'</span><span style="color: #000000">]

    </span><span style="color: #008000">#</span><span style="color: #008000"> 设置xadmin后台过滤器帅选字段，时间用过滤器来做</span>
    list_filter = [<span style="color: #800000">'</span><span style="color: #800000">name</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">desc</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">detail</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">degree</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">learn_times</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">students</span><span style="color: #800000">'</span><span style="color: #000000">,
                   </span><span style="color: #800000">'</span><span style="color: #800000">fav_nums</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">image</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">click_nums</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">add_time</span><span style="color: #800000">'</span><span style="color: #000000">]
    model_icon </span>= <span style="color: #800000">'</span><span style="color: #800000">fa fa-clone</span><span style="color: #800000">'</span><span style="color: #000000">
xadmin.site.register(Course, CourseAdmin)     </span><span style="color: #008000">#</span><span style="color: #008000"> 将数据表注册到xadmin后台显示</span></pre>
</div>
<p><span style="color: #ff0000"><strong>结果</strong></span></p>
<p><span style="color: #ff0000"><strong><img src="https://images2017.cnblogs.com/blog/955761/201709/955761-20170923081510040-1118425068.png" alt=""></strong></span></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><strong><strong><span style="color: #ff0000"><strong><strong><strong>设置后台列表页面，自定义列也就是自定义一个非数据表的字段，统计当前id被多少条数据外键关联</strong></strong></strong></span></strong></strong></p>
<p><span style="color: #0000ff; background-color: #ff99cc"><strong><strong><strong><strong><strong>self.外键类名称(小写).all().count() &nbsp;统计外键关联了当前主键的数据</strong></strong></strong></strong></strong></span></p>
<p><strong><strong><span style="color: #ff0000"><strong><strong><strong>注意：只能统计外键关联了当前主键的数据</strong></strong></strong></span></strong></strong></p>
<p><strong>models文件</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">class</span><span style="color: #000000"> Course(models.Model):
    name </span>= models.CharField(max_length=50, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">课程名称</span><span style="color: #800000">'</span><span style="color: #000000">)
    desc </span>= models.CharField(max_length=300, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">课程描述</span><span style="color: #800000">'</span><span style="color: #000000">)
    detail </span>= models.TextField(verbose_name=<span style="color: #800000">'</span><span style="color: #800000">课程详情</span><span style="color: #800000">'</span><span style="color: #000000">)
    degree </span>= models.CharField(verbose_name=<span style="color: #800000">'</span><span style="color: #800000">课程级别</span><span style="color: #800000">'</span>, choices=((<span style="color: #800000">'</span><span style="color: #800000">cj</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">初级</span><span style="color: #800000">'</span>), (<span style="color: #800000">'</span><span style="color: #800000">zj</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">中级</span><span style="color: #800000">'</span>), (<span style="color: #800000">'</span><span style="color: #800000">gj</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">高级</span><span style="color: #800000">'</span>)), max_length=3<span style="color: #000000">)
    learn_times </span>= models.IntegerField(default=0, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">学习时长(分钟)</span><span style="color: #800000">'</span><span style="color: #000000">)
    students </span>= models.IntegerField(default=0, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">学习人数</span><span style="color: #800000">'</span><span style="color: #000000">)
    fav_nums </span>= models.IntegerField(default=0, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">收藏人数</span><span style="color: #800000">'</span><span style="color: #000000">)
    image </span>= models.ImageField(upload_to=<span style="color: #800000">'</span><span style="color: #800000">courses/%Y/%m</span><span style="color: #800000">'</span>, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">课程封面图</span><span style="color: #800000">'</span>, max_length=100<span style="color: #000000">)
    click_nums </span>= models.IntegerField(default=0, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">点击数</span><span style="color: #800000">'</span><span style="color: #000000">)
    add_time </span>= models.DateTimeField(default=datetime.now, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">添加时间</span><span style="color: #800000">'</span><span style="color: #000000">)

    </span><span style="color: #0000ff">class</span><span style="color: #000000"> Meta:
        verbose_name </span>= <span style="color: #800000">'</span><span style="color: #800000">课程</span><span style="color: #800000">'</span><span style="color: #000000">
        verbose_name_plural </span>=<span style="color: #000000"> verbose_name

    </span><span style="color: #008000">#</span><span style="color: #008000"> 自定义列</span>
    <span style="color: #0000ff">def</span><span style="color: #000000"><span style="background-color: #ff99cc"> hqzhjie</span>(self):
        </span><span style="color: #0000ff">return</span><span style="color: #000000"><span style="background-color: #ff99cc"> self.lesson_set.all().count()</span>
    hqzhjie.short_description </span>= <span style="color: #800000">'</span><span style="color: #800000">章节数</span><span style="color: #800000">'</span>

    <span style="color: #0000ff">def</span> <span style="color: #800080">__str__</span><span style="color: #000000">(self):
        </span><span style="color: #0000ff">return</span> self.name        <span style="color: #008000">#</span><span style="color: #008000"> 设置在xadmin后台显示字段, 注意如果此表被另外的了外键关联了，这个返回字段就是外键表的外键名称</span></pre>
</div>
<p><strong>adminx.py</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">class</span> CourseAdmin(object):               <span style="color: #008000">#</span><span style="color: #008000"> 自定义数据表管理器类</span>

    <span style="color: #008000">#</span><span style="color: #008000"> 设置xadmin后台显示字段</span>
    list_display = [<span style="color: #800000">'</span><span style="color: #800000">name</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">desc</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">detail</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">degree</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">learn_times</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">students</span><span style="color: #800000">'</span><span style="color: #000000">,
                    </span><span style="color: #800000">'</span><span style="color: #800000">fav_nums</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">image</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">click_nums</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">add_time</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000; background-color: #ff99cc">hqzhjie</span><span style="color: #800000">'</span><span style="color: #000000">]

    </span><span style="color: #008000">#</span><span style="color: #008000"> 设置xadmin后台搜索字段，注意：搜索字段如果有时间类型会报错</span>
    search_fields = [<span style="color: #800000">'</span><span style="color: #800000">name</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">desc</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">detail</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">degree</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">learn_times</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">students</span><span style="color: #800000">'</span><span style="color: #000000">,
                     </span><span style="color: #800000">'</span><span style="color: #800000">fav_nums</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">image</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">click_nums</span><span style="color: #800000">'</span><span style="color: #000000">]

    </span><span style="color: #008000">#</span><span style="color: #008000"> 设置xadmin后台过滤器帅选字段，时间用过滤器来做</span>
    list_filter = [<span style="color: #800000">'</span><span style="color: #800000">name</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">desc</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">detail</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">degree</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">learn_times</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">students</span><span style="color: #800000">'</span><span style="color: #000000">,
                   </span><span style="color: #800000">'</span><span style="color: #800000">fav_nums</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">image</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">click_nums</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">add_time</span><span style="color: #800000">'</span><span style="color: #000000">]
    model_icon </span>= <span style="color: #800000">'</span><span style="color: #800000">fa fa-clone</span><span style="color: #800000">'</span><span style="color: #000000">
xadmin.site.register(Course, CourseAdmin)     </span><span style="color: #008000">#</span><span style="color: #008000"> 将数据表注册到xadmin后台显示</span></pre>
</div>
<p><img src="https://images2017.cnblogs.com/blog/955761/201709/955761-20170923084936025-1639997412.png" alt=""></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong><strong><strong><strong><strong><strong>设置后台列表页面，自定义列也就是自定义一个非数据表的字段，获取一个字段值拼接成超链接</strong></strong></strong></strong></strong></strong></span></p>
<p><span style="color: #ff0000"><strong>mark_safe() 允许执行里面html代码</strong></span><br><span style="color: #ff0000"><strong>self.image(字段名称) 获取当前字段值</strong></span></p>
<p><strong>models文件</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">class</span> Users(models.Model):       <span style="color: #008000">#</span><span style="color: #008000"> 创建类必须继承models.Model，类名将是在数据库里的表名称</span>
    username = models.CharField(max_length=150, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">用户名</span><span style="color: #800000">'</span>, default=<span style="color: #800000">''</span>, null=False, blank=<span style="color: #000000">False)
    password </span>= models.CharField(max_length=128, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">密码</span><span style="color: #800000">'</span>, default=<span style="color: #800000">''</span>, blank=False)         <span style="color: #008000">#</span><span style="color: #008000"> 密码字段，长度128，默认值为空字符，前端不允许用户输入空</span>
    last_login = models.DateTimeField(verbose_name=<span style="color: #800000">'</span><span style="color: #800000">登录日期</span><span style="color: #800000">'</span>, null=True, blank=True)                 <span style="color: #008000">#</span><span style="color: #008000"> 允许为空</span>
    first_name = models.CharField(max_length=30, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">拓展1</span><span style="color: #800000">'</span>, null=<span style="color: #000000">False)
    last_name </span>= models.CharField(max_length=30, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">拓展2</span><span style="color: #800000">'</span>, null=<span style="color: #000000">False)
    email </span>= models.EmailField(max_length=254, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">邮箱</span><span style="color: #800000">'</span>, null=False, blank=<span style="color: #000000">False)
    is_active </span>= models.BooleanField(max_length=1, default=0, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">是否激活</span><span style="color: #800000">'</span>, null=<span style="color: #000000">False)
    date_joined </span>= models.DateTimeField(verbose_name=<span style="color: #800000">'</span><span style="color: #800000">注册日期</span><span style="color: #800000">'</span>, null=<span style="color: #000000">True)
    nick_name </span>= models.CharField(max_length=50, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">昵称</span><span style="color: #800000">'</span>, default=<span style="color: #800000">''</span><span style="color: #000000">)
    birday </span>= models.DateField(verbose_name=<span style="color: #800000">'</span><span style="color: #800000">生日</span><span style="color: #800000">'</span>, null=<span style="color: #000000">True)
    gender </span>= models.CharField(max_length=6, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">性别</span><span style="color: #800000">'</span>, choices=((<span style="color: #800000">"</span><span style="color: #800000">male</span><span style="color: #800000">"</span>, <span style="color: #800000">"</span><span style="color: #800000">男</span><span style="color: #800000">"</span>), (<span style="color: #800000">"</span><span style="color: #800000">female</span><span style="color: #800000">"</span>, <span style="color: #800000">"</span><span style="color: #800000">女</span><span style="color: #800000">"</span>)), default=<span style="color: #800000">'</span><span style="color: #800000">male</span><span style="color: #800000">'</span><span style="color: #000000">)
    address </span>= models.CharField(max_length=100, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">地区</span><span style="color: #800000">'</span>, default=<span style="color: #800000">''</span><span style="color: #000000">)
    mobile </span>= models.CharField(max_length=11, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">手机</span><span style="color: #800000">'</span>, null=True, blank=<span style="color: #000000">True)
    <span style="background-color: #ff99cc">image </span></span>= models.ImageField(upload_to=<span style="color: #800000">'</span><span style="color: #800000">image/%Y/%m</span><span style="color: #800000">'</span>, verbose_name=<span style="color: #800000">'</span><span style="color: #800000">头像</span><span style="color: #800000">'</span>, default=<span style="color: #800000">'</span><span style="color: #800000">image/default.png</span><span style="color: #800000">'</span>, max_length=100,storage=<span style="color: #000000">ImageStorage())

    </span><span style="color: #0000ff">class</span><span style="color: #000000"> Meta:
        verbose_name </span>= <span style="color: #800000">'</span><span style="color: #800000">用户信息</span><span style="color: #800000">'</span><span style="color: #000000">
        verbose_name_plural </span>=<span style="color: #000000"> verbose_name

    </span><span style="background-color: #ffff00"><span style="color: #008000">#</span><span style="color: #008000"> 自定义列</span>
    <span style="color: #0000ff">def</span><span style="color: #000000"><span style="background-color: #ff99cc"> hqzhjie</span>(self):
        </span><span style="color: #0000ff">from</span> django.utils.safestring <span style="color: #0000ff">import</span> <span style="background-color: #ff99cc">mark_safe</span>                   <span style="color: #008000">#</span><span style="color: #008000"> 允许执行html代码</span>
        pj_url = <span style="color: #800000">'</span><span style="color: #800000">&lt;a href="/media/{0}"&gt;跳转&lt;/a&gt;</span><span style="color: #800000">'</span>.format(<span style="background-color: #ff99cc">self.image</span>)     <span style="color: #008000">#</span><span style="color: #008000"> 获取头像字段拼接成连接地址</span>
        <span style="background-color: #ff99cc"><span style="color: #0000ff">return</span> mark_safe(pj_url)</span>                                        <span style="color: #008000">#</span><span style="color: #008000"> 返回当前头像的连接地址</span>
    hqzhjie.short_description = <span style="color: #800000">'</span><span style="color: #800000">头像</span><span style="color: #800000">'</span>
</span>
    <span style="color: #0000ff">def</span> <span style="color: #800080">__str__</span><span style="color: #000000">(self):
        </span><span style="color: #0000ff">return</span> self.username</pre>
</div>
<p><strong>adminx.py</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">class</span> UsersAdmin(object):               <span style="color: #008000">#</span><span style="color: #008000"> 自定义用户信息数据表管理器类</span>
    <span style="color: #008000">#</span><span style="color: #008000"> 设置xadmin后台显示字段</span>
    list_display = [<span style="color: #800000">'</span><span style="color: #800000">username</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">password</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">nick_name</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">gender</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">email</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">address</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">mobile</span><span style="color: #800000">'</span><span style="color: #000000">,
                    </span><span style="color: #800000">'</span><span style="color: #800000">first_name</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">last_name</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">is_active</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">birday</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">last_login</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">date_joined</span><span style="color: #800000">'</span>,<span style="color: #800000">'</span><span style="color: #800000; background-color: #ff99cc">hqzhjie</span><span style="color: #800000">'</span><span style="color: #000000">]
    </span><span style="color: #008000">#</span><span style="color: #008000"> 设置xadmin后台搜索字段，注意：搜索字段如果有时间类型会报错</span>
    search_fields = [<span style="color: #800000">'</span><span style="color: #800000">username</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">password</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">nick_name</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">gender</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">email</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">address</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">mobile</span><span style="color: #800000">'</span><span style="color: #000000">]
    </span><span style="color: #008000">#</span><span style="color: #008000"> 设置xadmin后台过滤器帅选字段，时间用过滤器来做</span>
    list_filter = [<span style="color: #800000">'</span><span style="color: #800000">username</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">password</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">nick_name</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">gender</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">email</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">address</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">mobile</span><span style="color: #800000">'</span><span style="color: #000000">,
                    </span><span style="color: #800000">'</span><span style="color: #800000">first_name</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">last_name</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">is_active</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">birday</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">last_login</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">date_joined</span><span style="color: #800000">'</span><span style="color: #000000">]
    model_icon </span>= <span style="color: #800000">'</span><span style="color: #800000">fa fa-user-plus</span><span style="color: #800000">'</span><span style="color: #000000">
    ordering </span>= [<span style="color: #800000">'</span><span style="color: #800000">-id</span><span style="color: #800000">'</span><span style="color: #000000">]
    readonly_fields </span>= [<span style="color: #800000">'</span><span style="color: #800000">password</span><span style="color: #800000">'</span><span style="color: #000000">]
    exclude </span>= [<span style="color: #800000">'</span><span style="color: #800000">first_name</span><span style="color: #800000">'</span>,<span style="color: #800000">'</span><span style="color: #800000">last_name</span><span style="color: #800000">'</span><span style="color: #000000">]
xadmin.site.register(Users, UsersAdmin)     </span><span style="color: #008000">#</span><span style="color: #008000"> 将户信息数据表注册到xadmin后台显示</span></pre>
</div>
<p><strong>结果</strong></p>
<p><strong><img src="https://images2017.cnblogs.com/blog/955761/201709/955761-20170923094858696-1991979170.png" alt=""></strong></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>设置后台列表页面，设置自动刷新</strong></span></p>
<p><strong>这是一个插件，放在xadmin/plugins/refresh.py</strong></p>
<p><strong><strong>在当前APP里的adminx.py文件里的<span style="color: #ff0000">数据表管理器里设置</span></strong><span style="color: #ff0000">refresh_times参数即可使用该插件</span></strong></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">class</span> UsersAdmin(object):               <span style="color: #008000">#</span><span style="color: #008000"> 自定义用户信息数据表管理器类</span>
    <span style="color: #008000">#</span><span style="color: #008000"> 设置xadmin后台显示字段</span>
    list_display = [<span style="color: #800000">'</span><span style="color: #800000">username</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">password</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">nick_name</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">gender</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">email</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">address</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">mobile</span><span style="color: #800000">'</span><span style="color: #000000">,
                    </span><span style="color: #800000">'</span><span style="color: #800000">first_name</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">last_name</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">is_active</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">birday</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">last_login</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">date_joined</span><span style="color: #800000">'</span>,<span style="color: #800000">'</span><span style="color: #800000">hqzhjie</span><span style="color: #800000">'</span><span style="color: #000000">]
    </span><span style="color: #008000">#</span><span style="color: #008000"> 设置xadmin后台搜索字段，注意：搜索字段如果有时间类型会报错</span>
    search_fields = [<span style="color: #800000">'</span><span style="color: #800000">username</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">password</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">nick_name</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">gender</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">email</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">address</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">mobile</span><span style="color: #800000">'</span><span style="color: #000000">]
    </span><span style="color: #008000">#</span><span style="color: #008000"> 设置xadmin后台过滤器帅选字段，时间用过滤器来做</span>
    list_filter = [<span style="color: #800000">'</span><span style="color: #800000">username</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">password</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">nick_name</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">gender</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">email</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">address</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">mobile</span><span style="color: #800000">'</span><span style="color: #000000">,
                    </span><span style="color: #800000">'</span><span style="color: #800000">first_name</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">last_name</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">is_active</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">birday</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">last_login</span><span style="color: #800000">'</span>, <span style="color: #800000">'</span><span style="color: #800000">date_joined</span><span style="color: #800000">'</span><span style="color: #000000">]
    model_icon </span>= <span style="color: #800000">'</span><span style="color: #800000">fa fa-user-plus</span><span style="color: #800000">'</span><span style="color: #000000">
    ordering </span>= [<span style="color: #800000">'</span><span style="color: #800000">-id</span><span style="color: #800000">'</span><span style="color: #000000">]
    readonly_fields </span>= [<span style="color: #800000">'</span><span style="color: #800000">password</span><span style="color: #800000">'</span><span style="color: #000000">]
    exclude </span>= [<span style="color: #800000">'</span><span style="color: #800000">first_name</span><span style="color: #800000">'</span>,<span style="color: #800000">'</span><span style="color: #800000">last_name</span><span style="color: #800000">'</span><span style="color: #000000">]
    <span style="background-color: #ff99cc">refresh_times </span></span><span style="background-color: #ff99cc">= [3, 5</span><span style="color: #000000"><span style="background-color: #ff99cc">]</span>
xadmin.site.register(Users, UsersAdmin)     </span><span style="color: #008000">#</span><span style="color: #008000"> 将户信息数据表注册到xadmin后台显示</span></pre>
</div>
<p><strong>结果</strong></p>
<p><strong><img src="https://images2017.cnblogs.com/blog/955761/201709/955761-20170923100122540-1658878137.png" alt=""></strong></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>Xadmin目录结构说明</strong></span></p>
<p><span style="color: #ff0000"><strong>plugins是最重要的一个目录</strong></span></p>
<p><span style="color: #ff0000"><strong><img src="https://images2017.cnblogs.com/blog/955761/201709/955761-20170923104619228-377298221.png" alt=""></strong></span></p>
<p>&nbsp;</p></div>