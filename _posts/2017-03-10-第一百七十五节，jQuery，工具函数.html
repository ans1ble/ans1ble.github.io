第一百七十五节，jQuery，工具函数


			<div id="cnblogs_post_body" class="blogpost-body"><p><strong>jQuery，工具函数</strong></p>
<p>&nbsp;</p>
<p><strong>学习要点： </strong></p>
<p><strong>　　1.字符串操作 </strong></p>
<p><strong>　　2.数组和对象操作 </strong></p>
<p><strong>　　3.测试操作 </strong></p>
<p><strong>　　4.URL 操作 </strong></p>
<p><strong>　　5.浏览器检测 </strong></p>
<p><strong>　　6.其他操作</strong></p>
<p>&nbsp;</p>
<p><strong>工具函数是指直接依附于 jQuery 对象，针对 jQuery 对象本身定义的方法，即全局性 的函数。它的作用主要是提供比如字符串、数组、对象等操作方面的遍历。</strong></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>一．字符串操作 </strong></span></p>
<p><strong>在 jQuery 中，字符串的工具函数只有一个，就是去除字符串左右空格的工具函数：</strong></p>
<p><span style="color: #ff0000"><strong>trim()去掉字符串两边空格</strong></span></p>
<div class="cnblogs_code">
<pre>    <span style="color: #0000ff">var</span> str = '          jQuery '<span style="color: #000000">;
    alert(str);
    alert($.trim(str));  </span><span style="color: #008000">//</span><span style="color: #008000">trim()去掉字符串两边空格</span></pre>
</div>
<p><span style="color: #ff0000"><strong>&nbsp;each()遍历数组和对象，两个参数，参数1是要遍历的对象或者数组，参数2是匿名函数，函数里也有两个形式参数见下列</strong></span></p>
<p><span style="color: #0000ff"><strong><strong>each()遍历数组，参数1是要遍历的数组，参数2是匿名函数，函数有两个形式参数index, value，分别接收数组的下标和值</strong></strong></span></p>
<div class="cnblogs_code">
<pre>    <span style="color: #0000ff">var</span> arr = ['张三', '李四', '王五', '马六'<span style="color: #000000">];
    $.each(arr, </span><span style="color: #0000ff">function</span><span style="color: #000000"> (index, value) {
        $(</span>'#box').html($('#box').html() + index + '.' + value + '&lt;br /&gt;'<span style="color: #000000">);
    });</span></pre>
</div>
<p><span style="color: #0000ff"><strong><strong>each()遍历对象，<strong><strong>参数1是要遍历的对象，参数2是匿名函数，函数有两个形式参数name, fn，分别接收对象的键和值</strong></strong></strong></strong></span></p>
<div class="cnblogs_code">
<pre>    <span style="color: #0000ff">var</span> ojp = {a:1,b:2,c:3<span style="color: #000000">};
    $.each(ojp, </span><span style="color: #0000ff">function</span><span style="color: #000000"> (name, fn) {
        $(</span>'#box').html($('#box').html() + name + '：' + fn + '&lt;br /&gt;&lt;br /&gt;'<span style="color: #000000">);
    })</span></pre>
</div>
<p><span style="color: #0000ff"><strong>注意：$.each()中 index 表示数组元素的编号，默认从 0 开始。</strong></span></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>grep()数组数据筛选，返回<strong>筛选</strong>后的数组，两个参数，参数1要<strong>筛选</strong>的数组，参数2是匿名函数，函数有两个形式参数element, index，分别接收数组的值和下标</strong></span></p>
<div class="cnblogs_code">
<pre>    <span style="color: #0000ff">var</span> arr = [5, 2, 9, 4, 11, 57, 89, 1, 23, 8<span style="color: #000000">];
    </span><span style="color: #0000ff">var</span> arrGrep = $.grep(arr, <span style="color: #0000ff">function</span><span style="color: #000000"> (element, index) {
        </span><span style="color: #0000ff">return</span> element &lt; 6 &amp;&amp; index &lt; 5;   <span style="color: #008000">//</span><span style="color: #008000">返回值小于6并且下标小于5的</span>
<span style="color: #000000">    });
    alert(arrGrep);</span></pre>
</div>
<p><span style="color: #0000ff"><strong>注意：$.grep()方法的 index 是从 0 开始计算的。</strong></span></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>map()修改数组数据，返回修改后的数组，<strong>两个参数，参数1要<strong>修改</strong>的数组，参数2是匿名函数，函数有两个形式参数<strong>element, index，分别接收数组的值和下标</strong></strong></strong></span></p>
<div class="cnblogs_code">
<pre>    <span style="color: #0000ff">var</span> arr = [5, 2, 9, 4, 11, 57, 89, 1, 23, 8<span style="color: #000000">];
    </span><span style="color: #0000ff">var</span> arrMap = $.map(arr, <span style="color: #0000ff">function</span><span style="color: #000000"> (element, index) {
        </span><span style="color: #0000ff">if</span> (element &lt; 6 &amp;&amp; index &lt; 5) {  <span style="color: #008000">//</span><span style="color: #008000">判断值小于6并且下标小于5的</span>
            <span style="color: #0000ff">return</span> element + 1; <span style="color: #008000">//</span><span style="color: #008000">值小于6并且下标小于5的加1</span>
<span style="color: #000000">        }
    });
    alert(arrMap);</span></pre>
</div>
<p>&nbsp;</p>
<p><strong><span style="color: #ff0000">inArray()查找到指定元素的下标，返回下标，两个参数，参数1要查找的指定元素，参数2要查找的数组</span></strong></p>
<p>&nbsp;</p>
<div class="cnblogs_code">
<pre>    <span style="color: #0000ff">var</span> arr = [5, 2, 9, 4, 11, 57, 89, 1, 23, 8<span style="color: #000000">];
    </span><span style="color: #0000ff">var</span> arrInArray = $.inArray(1, arr);  <span style="color: #008000">//</span><span style="color: #008000">查找元素1的下标是多少</span>
    alert(arrInArray);</pre>
</div>
<p>&nbsp;</p>
<p><span style="color: #0000ff"><strong>注意：$.inArray()的下标从 0 开始计算。</strong></span></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><strong><span style="color: #ff0000">merge()合并两个数组，返回一个数组，有两个参数，参数1是数组1，参数2是数组2</span></strong></p>
<p>&nbsp;</p>
<div class="cnblogs_code">
<pre>    <span style="color: #0000ff">var</span> arr = [5, 2, 9, 4, 11, 57, 89, 1, 23, 8<span style="color: #000000">];
    </span><span style="color: #0000ff">var</span> arr2 = [23, 2, 89, 3, 6, 7<span style="color: #000000">];
    alert($.merge(arr, arr2));</span></pre>
</div>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>unique()删除重复的 DOM 元素，参数是要删除重复的<strong>DOM 元素数组</strong></strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">div </span><span style="color: #ff0000">class</span><span style="color: #0000ff">="box"</span><span style="color: #0000ff">&gt;&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">div </span><span style="color: #ff0000">class</span><span style="color: #0000ff">="box"</span><span style="color: #0000ff">&gt;&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">div </span><span style="color: #ff0000">class</span><span style="color: #0000ff">="box"</span><span style="color: #0000ff">&gt;&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span>
<span style="color: #0000ff">&lt;</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span></pre>
</div>
<div class="cnblogs_code">
<pre>    <span style="color: #0000ff">var</span> divs = $('div').get();  <span style="color: #008000">//</span><span style="color: #008000">将所有div转换成原生态数组</span>
    divs = divs.concat($('.box').get());  <span style="color: #008000">//</span><span style="color: #008000">将class为box的元素添加到数组</span>
    alert($(divs).size());  <span style="color: #008000">//</span><span style="color: #008000">查看数组长度</span>
    $.unique(divs);         <span style="color: #008000">//</span><span style="color: #008000">删除重复的div</span>
    alert($(divs).size());  <span style="color: #008000">//</span><span style="color: #008000">查看数组长度</span></pre>
</div>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>toArray()合并多个 DOM 元素组成数组，参数是要组合数组的节点对象集合</strong></span></p>
<div class="cnblogs_code">
<pre>alert($('li').toArray());</pre>
</div>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>三．测试操作 </strong></span></p>
<p><strong>在 jQuery 中，数据有着各种类型和状态。有时，我们希望能通过判断数据的类型和状 态做相应的操作。jQuery 提供了五组测试用的工具函数。</strong></p>
<p><strong><img src="https://images2015.cnblogs.com/blog/955761/201703/955761-20170310230257061-391706404.png" alt=""></strong></p>
<p><span style="color: #ff0000"><strong>isArray(obj) 判断是否为数组对象，是返回 true</strong></span></p>
<div class="cnblogs_code">
<pre>    <span style="color: #008000">//</span><span style="color: #008000">判断是否为数组对象</span>
    <span style="color: #0000ff">var</span> arr = [1, 2, 3<span style="color: #000000">];
    alert($.isArray(arr));</span></pre>
</div>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>isFunction(obj) 判断是否为函数，是返回 true</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">//</span><span style="color: #008000">判断是否为函数</span>
<span style="color: #0000ff">var</span> fn = <span style="color: #0000ff">function</span><span style="color: #000000"> () {};
alert($.isFunction(fn));</span></pre>
</div>
<p><br><span style="color: #ff0000"><strong>isEmptyObject(obj) 判断是否为空对象，是返回 true</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">//</span><span style="color: #008000">判断是否为空对象</span>
<span style="color: #0000ff">var</span> obj =<span style="color: #000000"> {};
alert($.isEmptyObject(obj));</span></pre>
</div>
<p><br><span style="color: #ff0000"><strong>isPlainObjet(obj) 判断是否为纯粹对象，是返回 true</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">//</span><span style="color: #008000">判断是否由{}或 new Object()创造出的对象</span>
<span style="color: #0000ff">var</span> obj =<span style="color: #000000"> window;
alert($.isPlainObject(obj));</span></pre>
</div>
<p><span style="color: #0000ff"><strong>注意：如果使用 new Object('name');传递参数后，返回类型已不是 Object，而是字符串， 所以就不是纯粹的原始对象了。</strong></span></p>
<p><br><span style="color: #ff0000"><strong>contains(obj) 判断 DOM 节点是否含另一个 DOM 节点，是返回 true</strong></span></p>
<p>&nbsp;</p>
<div class="cnblogs_code">
<pre>    <span style="color: #008000">//</span><span style="color: #008000">contains(obj) 判断 DOM 节点是否含另一个 DOM 节点，是返回 true</span>
    alert($.contains($('#box').get(0), $('#pox').get(0<span style="color: #000000">)));
    </span><span style="color: #008000">//</span><span style="color: #008000">判断#pox节点是否在#box里面</span></pre>
</div>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>type(data) 判断数据类型</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">//</span><span style="color: #008000">$.type()检测数据类型</span>
alert($.type(window));</pre>
</div>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>isNumeric(data) 判断数据是否为数值</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">//</span><span style="color: #008000">$.isNumeric 检测数据是否为数值</span>
alert($.isNumeric(5.25));</pre>
</div>
<p><br><span style="color: #ff0000"><strong>isWindow(data) 判断数据是否为 window 对象</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">//</span><span style="color: #008000">$.isWindow 检测数据对象是否为 window 对象</span>
alert($.isWindow(window));</pre>
</div>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>四．URL 操作 </strong></span></p>
<p><strong>URL 地址操作，在之前的 Ajax 章节其实已经讲到过。只有一个方法：$.param()，将对 象的键值对转化为 URL 键值对字符串形式。</strong></p>
<p><span style="color: #ff0000"><strong>param()将对象键值对转换为 URL 字符串键值对，参数是要转换的对象</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">//</span><span style="color: #008000">$.param()将对象键值对转换为 URL 字符串键值对</span>
    <span style="color: #0000ff">var</span> obj =<span style="color: #000000"> {
        name: </span>'Lee'<span style="color: #000000">,
        age: </span>100<span style="color: #000000">
    };
    alert($.param(obj));</span></pre>
</div>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>五．浏览器检测 </strong></span></p>
<p><strong>由于在早期的浏览器中，分 IE 和 W3C 浏览器。而 IE678 使用的覆盖率还很高，所以， 早期的 jQuery 提供了$.browser 工具对象。而现在的 jQuery 已经废弃删除了这个工具对象， 如果还想使用这个对象来获取浏览器版本型号的信息，可以使用兼容插件。</strong></p>
<p><span style="color: #ff0000"><strong>&nbsp;browser 对象属性，浏览器检测，已经删除，如果要使用必须引入jquery-migrate-1.2.1.js文件向下兼容</strong></span></p>
<p><span style="color: #0000ff"><strong>$.browser 对象属性</strong></span></p>
<p><span style="color: #0000ff"><strong>webkit 判断（谷歌） webkit 浏览器，如果是则为 true</strong></span><br><span style="color: #0000ff"><strong>mozilla 判断(火狐) mozilla 浏览器，如果是则为 true</strong></span><br><span style="color: #0000ff"><strong>safari 判断 safari 浏览器，如果是则为 true</strong></span><br><span style="color: #0000ff"><strong>opera 判断 opera 浏览器，如果是则为 true</strong></span><br><span style="color: #0000ff"><strong>msie 判断（IE） IE 浏览器，如果是则为 true</strong></span><br><span style="color: #0000ff"><strong>version 获取浏览器版本号</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">//</span><span style="color: #008000">获取火狐浏览器和版本号</span>
alert($.browser.mozilla + ':' + $.browser.version);</pre>
</div>
<p><strong>注意：火狐采用的是 mozilla 引擎，一般就是指火狐；而谷歌 Chrome 采用的引擎是 webkit，一般验证 Chrome 就用 webkit。</strong></p>
<p>&nbsp;</p>
<p><strong>还有一种浏览器检测，是对浏览器内容的检测。比如：W3C 的透明度为 opacity，而 IE 的透明度为 alpha。这个对象是$.support。</strong></p>
<p><span style="color: #ff0000"><strong>support 对象部分属性，<strong>浏览器内容的检测</strong></strong></span></p>
<p><strong><span style="color: #0000ff">hrefNormalized</span> </strong><br><strong>如果浏览器从 getAttribute("href")返回的是原封不动的结果，则返回 true。在 IE 中会返回 false，因为他</strong><br><strong>的 URLs 已经常规化了</strong></p>
<p><strong><span style="color: #0000ff">htmlSerialize</span> </strong><br><strong>如果浏览器通过 innerHTML 插入链接元素的时候会序列化这些链接，则返回 true，目前 IE 中返回 false</strong></p>
<p><span style="color: #0000ff"><strong>leadingWhitespace </strong></span><br><strong>如果在使用 innerHTML 的时候浏览器会保持前导空白字符，则返回 true，目前在 IE 6-8 中返回 false</strong></p>
<p><span style="color: #0000ff"><strong>objectAll</strong></span><br><strong>如 果 在 某 个 元 素 对 象 上 执 行getElementsByTagName("*")会返回所有子孙元素，则为true，目前在 IE 7 中为 false</strong></p>
<p><strong><span style="color: #0000ff">opacity</span> </strong><br><strong>如果浏览器能适当解释透明度样式属性，则返回 true，目前在 IE 中返回 false，因为他用 alpha 滤镜代替</strong></p>
<p><span style="color: #0000ff"><strong>scriptEval</strong></span><br><strong>使用 appendChild/createTextNode 方法插入脚本代码时，浏览器是否执行脚本，目前在 IE 中返回 false，IE使用 .text 方法插入脚本代码以执行</strong></p>
<p><strong><span style="color: #0000ff">style</span> </strong><br><strong>如果 getAttribute("style")返回元素的行内样式，则为 true。目前 IE 中为 false，因为他用 cssText 代替</strong></p>
<p><span style="color: #0000ff"><strong>tbody</strong></span><br><strong>如果浏览器允许 table 元素不包含 tbody 元素，则返回true。目前在 IE 中会返回 false，他会自动插入缺失的tbody</strong></p>
<p><strong><span style="color: #0000ff">Ajax</span> </strong><br><strong>如果浏览器支持 ajax 操作，返回 true</strong></p>
<p>&nbsp;</p>
<div class="cnblogs_code">
<pre><span style="color: #008000">//</span><span style="color: #008000">$.support.ajax 判断是否能创建 ajax</span>
alert($.support.ajax);</pre>
</div>
<p>&nbsp;</p>
<div class="cnblogs_code">
<pre><span style="color: #008000">//</span><span style="color: #008000">$.support.opacity 设置不同浏览器的透明度</span>
<span style="color: #0000ff">if</span> ($.support.opacity == <span style="color: #0000ff">true</span><span style="color: #000000">) {
　　$(</span>'#box').css('opacity', '0.5'<span style="color: #000000">);
} </span><span style="color: #0000ff">else</span><span style="color: #000000"> {
　　$(</span>'#box').css('filter', 'alpha(opacity=50)'<span style="color: #000000">);
}</span></pre>
</div>
<p><span style="color: #0000ff"><strong>注意：由于 jQuery 越来越放弃低端的浏览器，所以检测功能在未来使用频率也越来越 低。所以，$.brower 已被废弃删除，而$.support.boxModel 检测 W3C 或 IE 盒子也被删除。 并且 http://api.jquery.com/jQuery.support/官网也不提供属性列表和解释，给出一个 Modernizr 第三方小工具来辅组检测。</strong></span></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000"><strong>六．其他操作 </strong></span></p>
<p><strong>jQuery 提供了一个预备绑定函数上下文的工具函数：$.proxy()。这个方法，可以解决诸 如外部事件触发调用对象方法时 this 的指向问题。</strong></p>
<p><span style="color: #ff0000"><strong>proxy()调整 this 指向</strong></span></p>
<div class="cnblogs_code">
<pre>    <span style="color: #0000ff">var</span> obj =<span style="color: #000000"> {
        name: </span>'Lee'<span style="color: #000000">,
        test: </span><span style="color: #0000ff">function</span><span style="color: #000000"> () {
            alert(</span><span style="color: #0000ff">this</span><span style="color: #000000">.name);
        }
    };
    $(</span>'#box').click(obj.test); <span style="color: #008000">//</span><span style="color: #008000">指向的 this 为#box 元素</span>
    $('#box').click($.proxy(obj, 'test')); <span style="color: #008000">//</span><span style="color: #008000">指向的 this 为方法属于对象 box</span></pre>
</div>
<p>&nbsp;</p></div>