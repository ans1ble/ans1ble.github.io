第二百七十九节，MySQL数据库-pymysql模块操作数据库


			<div id="cnblogs_post_body" class="blogpost-body"><p><strong>MySQL数据库-pymysql模块操作数据库</strong></p>
<p><span style="color: #ff0000"><strong><strong>pymysql模块是python操作数据库的一个模块</strong></strong></span></p>
<p>&nbsp;</p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong>connect()创建数据库链接,参数是连接数据库需要的连接参数</strong></span><br><span style="color: #ff0000"><strong>使用方式：</strong></span><br><span style="color: #ff0000"><strong>	　　模块名称.connect()</strong></span><br><span style="color: #ff0000"><strong>		　　参数：</strong></span><br><span style="color: #ff0000"><strong>		　　host=数据库ip</strong></span><br><span style="color: #ff0000"><strong>		　　port=数据库端口</strong></span><br><span style="color: #ff0000"><strong>		　　user=数据库用户名</strong></span><br><span style="color: #ff0000"><strong>		　　passwd=数据库密码</strong></span><br><span style="color: #ff0000"><strong>		　　db=数据库名称</strong></span></p>
<p><span style="color: #ff0000"><strong>　　charset=数据库编码</strong></span></p>
<p><br><span style="color: #ff0000; background-color: #ffff00"><strong>cursor()创建数据库操作游标，无参</strong></span><br><span style="color: #ff0000"><strong>使用方式：</strong></span><br><span style="color: #ff0000"><strong>	　　游标变量.cursor()</strong></span></p>
<p><br><span style="color: #ff0000; background-color: #ffff00"><strong>execute()操作数据库，参数1 sql语句，参数2 字符串占位符变量</strong></span><br><span style="color: #ff0000"><strong>使用方式：</strong></span><br><span style="color: #ff0000"><strong>	　　游标变量.execute()</strong></span></p>
<p><span style="color: #ff0000"><strong><strong>execute()操作数据库会返回，操作数据库后影响的行数，我们可以以此判断是否操作成功</strong></strong></span></p>
<p><br><span style="color: #ff0000; background-color: #ffff00"><strong>commit()提交数据到数据库，无参</strong></span><br><span style="color: #ff0000"><strong>使用方式：</strong></span><br><span style="color: #ff0000"><strong>	　　创建数据库链接变量.commit()</strong></span></p>
<p><br><span style="color: #ff0000; background-color: #ffff00"><strong>close()关闭游标</strong></span><br><span style="color: #ff0000"><strong>使用方式：</strong></span><br><span style="color: #ff0000"><strong>	　　游标变量.close()</strong></span></p>
<p><br><span style="color: #ff0000; background-color: #ffff00"><strong>close()关闭数据库</strong></span><br><span style="color: #ff0000"><strong>使用方式：</strong></span><br><span style="color: #ff0000"><strong>	　　创建数据库变量.close()</strong></span></p>
<p><span style="color: #0000ff"><strong>向数据库添加一条数据</strong></span></p>
<p>&nbsp;</p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span>
<span style="color: #0000ff">import</span><span style="color: #000000"> pymysql

</span><span style="color: #008000">#</span><span style="color: #008000"> 创建连接</span>
<span style="color: #800000">"""</span><span style="color: #800000">
host=数据库ip
port=数据库端口
user=数据库用户名
passwd=数据库密码
db=数据库名称
</span><span style="color: #800000">"""</span><span style="color: #000000">
conn </span>= pymysql.<span style="background-color: #ffff00">connect(host=<span style="color: #800000">'</span><span style="color: #800000">127.0.0.1</span><span style="color: #800000">'</span>, port=3306, user=<span style="color: #800000">'</span><span style="color: #800000">root</span><span style="color: #800000">'</span>, passwd=<span style="color: #800000">'</span><span style="color: #800000">279819</span><span style="color: #800000">'</span>, db=<span style="color: #800000">'</span><span style="color: #800000">cshi</span><span style="color: #800000">'</span><span style="color: #000000">)
</span></span><span style="color: #008000">#</span><span style="color: #008000"> 创建游标</span>
cursor =<span style="color: #000000; background-color: #ffff00"> conn.cursor()

</span><span style="color: #008000">#</span><span style="color: #008000"> 执行SQL，并返回收影响行数</span>
effect_row = <span style="background-color: #ffff00">cursor.execute(<span style="color: #800000">"</span><span style="color: #800000">INSERT INTO db1(yhm,mim) VALUES('adc8868','279819')</span><span style="color: #800000">"</span>)</span> <span style="color: #008000">#</span><span style="color: #008000">添加一条数据</span>
<span style="background-color: #ffff00"><span style="color: #0000ff">print</span>(effect_row)</span>   <span style="color: #008000">#</span><span style="color: #008000">返回影响行数</span>

<span style="color: #008000">#</span><span style="color: #008000"> 提交，不然无法保存新建或者修改的数据</span>
<span style="color: #000000; background-color: #ffff00">conn.commit()

</span><span style="color: #008000">#</span><span style="color: #008000"> 关闭游标</span>
<span style="color: #000000; background-color: #ffff00">cursor.close()
</span><span style="color: #008000">#</span><span style="color: #008000"> 关闭连接</span>
<span style="background-color: #ffff00">conn.close()</span></pre>
</div>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong>execute(sql语句%s,(<strong>占位符变量</strong>))执行sql语句时的占位符使用</strong></span></p>
<p><span style="color: #ff0000"><strong><strong>execute()</strong>操作一条数据</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span>
<span style="color: #0000ff">import</span><span style="color: #000000"> pymysql

</span><span style="color: #008000">#</span><span style="color: #008000"> 创建连接</span>
<span style="color: #800000">"""</span><span style="color: #800000">
host=数据库ip
port=数据库端口
user=数据库用户名
passwd=数据库密码
db=数据库名称
</span><span style="color: #800000">"""</span><span style="color: #000000">
conn </span>= pymysql.connect(host=<span style="color: #800000">'</span><span style="color: #800000">127.0.0.1</span><span style="color: #800000">'</span>, port=3306, user=<span style="color: #800000">'</span><span style="color: #800000">root</span><span style="color: #800000">'</span>, passwd=<span style="color: #800000">'</span><span style="color: #800000">279819</span><span style="color: #800000">'</span>, db=<span style="color: #800000">'</span><span style="color: #800000">cshi</span><span style="color: #800000">'</span><span style="color: #000000">)
</span><span style="color: #008000">#</span><span style="color: #008000"> 创建游标</span>
cursor =<span style="color: #000000"> conn.cursor()

</span><span style="color: #008000">#</span><span style="color: #008000"> 执行SQL，并返回收影响行数</span>
effect_row = cursor.execute(<span style="color: #800000">"</span><span style="color: #800000">INSERT INTO db1(yhm,mim) VALUES(<span style="background-color: #ccffcc">%s</span>,<span style="background-color: #ffff00">%s</span>)</span><span style="color: #800000">"</span>,(<span style="background-color: #ccffcc"><span style="color: #800000">'</span><span style="color: #800000">adc279819</span><span style="color: #800000">'</span></span>,<span style="background-color: #ffff00">279819</span>)) <span style="color: #008000">#</span><span style="color: #008000">添加一条数据</span>
<span style="color: #0000ff">print</span>(effect_row)   <span style="color: #008000">#</span><span style="color: #008000">返回影响行数</span>

<span style="color: #008000">#</span><span style="color: #008000"> 提交，不然无法保存新建或者修改的数据</span>
<span style="color: #000000">conn.commit()

</span><span style="color: #008000">#</span><span style="color: #008000"> 关闭游标</span>
<span style="color: #000000">cursor.close()
</span><span style="color: #008000">#</span><span style="color: #008000"> 关闭连接</span>
conn.close()</pre>
</div>
<p><img src="https://images2015.cnblogs.com/blog/955761/201706/955761-20170605142753747-667149964.png" alt=""></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong>executemany(sql语句,[(占位符变量),(占位符变量)])执行sql语句时的占位符使用</strong></span></p>
<p><span style="color: #ff0000"><strong>executemany()操作多条数据</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span>
<span style="color: #0000ff">import</span><span style="color: #000000"> pymysql

</span><span style="color: #008000">#</span><span style="color: #008000"> 创建连接</span>
<span style="color: #800000">"""</span><span style="color: #800000">
host=数据库ip
port=数据库端口
user=数据库用户名
passwd=数据库密码
db=数据库名称
</span><span style="color: #800000">"""</span><span style="color: #000000">
conn </span>= pymysql.connect(host=<span style="color: #800000">'</span><span style="color: #800000">127.0.0.1</span><span style="color: #800000">'</span>, port=3306, user=<span style="color: #800000">'</span><span style="color: #800000">root</span><span style="color: #800000">'</span>, passwd=<span style="color: #800000">'</span><span style="color: #800000">279819</span><span style="color: #800000">'</span>, db=<span style="color: #800000">'</span><span style="color: #800000">cshi</span><span style="color: #800000">'</span><span style="color: #000000">)
</span><span style="color: #008000">#</span><span style="color: #008000"> 创建游标</span>
cursor =<span style="color: #000000"> conn.cursor()

</span><span style="color: #008000">#</span><span style="color: #008000"> 执行SQL，并返回收影响行数</span>
effect_row = cursor.executemany(<span style="color: #800000">"</span><span style="color: #800000">INSERT INTO db1(<span style="background-color: #ccffcc">yhm</span>,<span style="background-color: #ffff00">mim</span>) VALUES(<span style="background-color: #ccffcc">%s</span>,<span style="background-color: #ffff00">%s</span>)</span><span style="color: #800000">"</span>,[(<span style="background-color: #ccffcc"><span style="color: #800000">'</span><span style="color: #800000">a1</span><span style="color: #800000">'</span></span>,<span style="background-color: #ffff00">123</span>),(<span style="background-color: #ccffcc"><span style="color: #800000">'</span><span style="color: #800000">a2</span><span style="color: #800000">'</span></span>,456),(<span style="background-color: #ccffcc"><span style="color: #800000">'</span><span style="color: #800000">a3</span><span style="color: #800000">'</span></span>,<span style="background-color: #ffff00">789</span><span style="color: #000000">)])
</span><span style="color: #0000ff">print</span>(effect_row)   <span style="color: #008000">#</span><span style="color: #008000">返回影响行数</span>

<span style="color: #008000">#</span><span style="color: #008000"> 提交，不然无法保存新建或者修改的数据</span>
<span style="color: #000000">conn.commit()

</span><span style="color: #008000">#</span><span style="color: #008000"> 关闭游标</span>
<span style="color: #000000">cursor.close()
</span><span style="color: #008000">#</span><span style="color: #008000"> 关闭连接</span>
conn.close()</pre>
</div>
<p><img src="https://images2015.cnblogs.com/blog/955761/201706/955761-20170605143937028-1950767479.png" alt=""></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong>查询数据库数据</strong></span></p>
<p><span style="color: #ff0000"><strong>注意：操作数据库的增、删、改都需要commit()提交数据到数据库，而查询是不需要<strong>commit()的</strong></strong></span></p>
<p><span style="color: #ff0000"><strong>fetchall()获取游标查询数据库里的数据，返回元祖</strong></span><br><span style="color: #ff0000"><strong>使用方式：</strong></span><br><span style="color: #ff0000"><strong>	　　游标变量.fetchall()</strong></span></p>
<p>&nbsp;</p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span>
<span style="color: #0000ff">import</span><span style="color: #000000"> pymysql

</span><span style="color: #008000">#</span><span style="color: #008000"> 创建连接</span>
<span style="color: #800000">"""</span><span style="color: #800000">
host=数据库ip
port=数据库端口
user=数据库用户名
passwd=数据库密码
db=数据库名称
charset=数据库编码
</span><span style="color: #800000">"""</span><span style="color: #000000">
conn </span>= pymysql.connect(host=<span style="color: #800000">'</span><span style="color: #800000">127.0.0.1</span><span style="color: #800000">'</span>, port=3306, user=<span style="color: #800000">'</span><span style="color: #800000">root</span><span style="color: #800000">'</span>, passwd=<span style="color: #800000">'</span><span style="color: #800000">279819</span><span style="color: #800000">'</span>, db=<span style="color: #800000">'</span><span style="color: #800000">cshi</span><span style="color: #800000">'</span>,charset=<span style="color: #800000">'</span><span style="color: #800000">utf8</span><span style="color: #800000">'</span><span style="color: #000000">)
</span><span style="color: #008000">#</span><span style="color: #008000"> 创建游标</span>
<span style="background-color: #ffff00">cursor =<span style="color: #000000"> conn.cursor()

</span></span><span style="color: #008000">#</span><span style="color: #008000"> 执行SQL，并返回收影响行数</span>
effect_row = cursor.execute(<span style="background-color: #ffff00"><span style="color: #800000">"</span><span style="color: #800000">SELECT id,yhm,mim FROM db1</span><span style="color: #800000">"</span></span><span style="color: #000000">)
<span style="background-color: #ffff00">shuju </span></span><span style="background-color: #ffff00">= cursor.fetchall()</span>   <span style="color: #008000">#</span><span style="color: #008000">获取游标里的数据</span>
<span style="background-color: #ffff00"><span style="color: #0000ff">print</span><span style="color: #000000">(shuju)
</span></span><span style="color: #008000">#</span><span style="color: #008000"> 提交，不然无法保存新建或者修改的数据</span><span style="color: #008000">
#</span><span style="color: #008000"> conn.commit()</span>

<span style="color: #008000">#</span><span style="color: #008000"> 关闭游标</span>
<span style="color: #000000">cursor.close()
</span><span style="color: #008000">#</span><span style="color: #008000"> 关闭连接</span>
conn.close()</pre>
</div>
<p>&nbsp;</p>
<p><img src="https://images2015.cnblogs.com/blog/955761/201706/955761-20170605151027247-782227345.png" alt=""></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong>查询数据库内容时更改游标返回字典类型数据【推荐】</strong></span></p>
<p><span style="color: #ff0000; background-color: #ffffff"><strong>返回字典类型将数据库表的列(字段)作为键返回</strong></span></p>
<p><span style="color: #ff0000"><strong>默认查询数据时游标返回的元祖类型，如果想返回字典类型就需要设置游标</strong></span></p>
<p><span style="color: #ff0000"><strong>cursor=pymysql.cursors.DictCursor设置游标返回字典类型数据，当做参数写在execute()里，execute(cursor=pymysql.cursors.DictCursor)</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span>
<span style="color: #0000ff">import</span><span style="color: #000000"> pymysql

</span><span style="color: #008000">#</span><span style="color: #008000"> 创建连接</span>
<span style="color: #800000">"""</span><span style="color: #800000">
host=数据库ip
port=数据库端口
user=数据库用户名
passwd=数据库密码
db=数据库名称
charset=数据库编码
</span><span style="color: #800000">"""</span><span style="color: #000000">
conn </span>= pymysql.connect(host=<span style="color: #800000">'</span><span style="color: #800000">127.0.0.1</span><span style="color: #800000">'</span>, port=3306, user=<span style="color: #800000">'</span><span style="color: #800000">root</span><span style="color: #800000">'</span>, passwd=<span style="color: #800000">'</span><span style="color: #800000">279819</span><span style="color: #800000">'</span>, db=<span style="color: #800000">'</span><span style="color: #800000">cshi</span><span style="color: #800000">'</span>,charset=<span style="color: #800000">'</span><span style="color: #800000">utf8</span><span style="color: #800000">'</span><span style="color: #000000">)
</span><span style="color: #008000">#</span><span style="color: #008000"> 创建游标</span>
cursor = conn.cursor(<span style="background-color: #ffff00">cursor=</span><span style="color: #000000"><span style="background-color: #ffff00">pymysql.cursors.DictCursor</span>)

</span><span style="color: #008000">#</span><span style="color: #008000"> 执行SQL，并返回收影响行数</span>
effect_row = cursor.execute(<span style="color: #800000">"</span><span style="color: #800000">SELECT id,yhm,mim FROM db1</span><span style="color: #800000">"</span><span style="color: #000000">)
shuju </span>= cursor.fetchall()   <span style="color: #008000">#</span><span style="color: #008000">获取游标里的数据</span>
<span style="color: #0000ff">print</span><span style="color: #000000">(shuju)

</span><span style="color: #008000">#</span><span style="color: #008000"> 提交，不然无法保存新建或者修改的数据</span><span style="color: #008000">
#</span><span style="color: #008000"> conn.commit()</span>

<span style="color: #008000">#</span><span style="color: #008000"> 关闭游标</span>
<span style="color: #000000">cursor.close()
</span><span style="color: #008000">#</span><span style="color: #008000"> 关闭连接</span>
conn.close()</pre>
</div>
<p><img src="https://images2015.cnblogs.com/blog/955761/201706/955761-20170605152328997-543361306.png" alt=""></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong>fetchone()获取游标里第一条数据，如果多次执行fetchone()就依次获取数据</strong></span><br><span style="color: #ff0000"><strong>使用方式：</strong></span><br><span style="color: #ff0000"><strong>	　　游标变量.fetchone()</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span>
<span style="color: #0000ff">import</span><span style="color: #000000"> pymysql

</span><span style="color: #008000">#</span><span style="color: #008000"> 创建连接</span>
<span style="color: #800000">"""</span><span style="color: #800000">
host=数据库ip
port=数据库端口
user=数据库用户名
passwd=数据库密码
db=数据库名称
charset=数据库编码
</span><span style="color: #800000">"""</span><span style="color: #000000">
conn </span>= pymysql.connect(host=<span style="color: #800000">'</span><span style="color: #800000">127.0.0.1</span><span style="color: #800000">'</span>, port=3306, user=<span style="color: #800000">'</span><span style="color: #800000">root</span><span style="color: #800000">'</span>, passwd=<span style="color: #800000">'</span><span style="color: #800000">279819</span><span style="color: #800000">'</span>, db=<span style="color: #800000">'</span><span style="color: #800000">cshi</span><span style="color: #800000">'</span>,charset=<span style="color: #800000">'</span><span style="color: #800000">utf8</span><span style="color: #800000">'</span><span style="color: #000000">)
</span><span style="color: #008000">#</span><span style="color: #008000"> 创建游标</span>
cursor = conn.cursor(cursor=<span style="color: #000000">pymysql.cursors.DictCursor)

</span><span style="color: #008000">#</span><span style="color: #008000"> 执行SQL，并返回收影响行数</span>
effect_row = cursor.execute(<span style="color: #800000">"</span><span style="color: #800000">SELECT id,yhm,mim FROM db1</span><span style="color: #800000">"</span><span style="color: #000000">)
shuju </span>= <span style="background-color: #ffff00">cursor.fetchone()</span>   <span style="color: #008000">#</span><span style="color: #008000">获取游标里第一条数据</span>
<span style="color: #0000ff">print</span><span style="color: #000000">(shuju)

</span><span style="color: #008000">#</span><span style="color: #008000"> 提交，不然无法保存新建或者修改的数据</span><span style="color: #008000">
#</span><span style="color: #008000"> conn.commit()</span>

<span style="color: #008000">#</span><span style="color: #008000"> 关闭游标</span>
<span style="color: #000000">cursor.close()
</span><span style="color: #008000">#</span><span style="color: #008000"> 关闭连接</span>
conn.close()</pre>
</div>
<p><img src="https://images2015.cnblogs.com/blog/955761/201706/955761-20170605160021262-1032646579.png" alt=""></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong>fetchmany()获取游标里,指定条数据，参数是要获取数据的条数</strong></span><br><span style="color: #ff0000"><strong>使用方式：</strong></span><br><span style="color: #ff0000"><strong>	　　游标变量.fetchmany(3)</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span>
<span style="color: #0000ff">import</span><span style="color: #000000"> pymysql

</span><span style="color: #008000">#</span><span style="color: #008000"> 创建连接</span>
<span style="color: #800000">"""</span><span style="color: #800000">
host=数据库ip
port=数据库端口
user=数据库用户名
passwd=数据库密码
db=数据库名称
charset=数据库编码
</span><span style="color: #800000">"""</span><span style="color: #000000">
conn </span>= pymysql.connect(host=<span style="color: #800000">'</span><span style="color: #800000">127.0.0.1</span><span style="color: #800000">'</span>, port=3306, user=<span style="color: #800000">'</span><span style="color: #800000">root</span><span style="color: #800000">'</span>, passwd=<span style="color: #800000">'</span><span style="color: #800000">279819</span><span style="color: #800000">'</span>, db=<span style="color: #800000">'</span><span style="color: #800000">cshi</span><span style="color: #800000">'</span>,charset=<span style="color: #800000">'</span><span style="color: #800000">utf8</span><span style="color: #800000">'</span><span style="color: #000000">)
</span><span style="color: #008000">#</span><span style="color: #008000"> 创建游标</span>
cursor = conn.cursor(cursor=<span style="color: #000000">pymysql.cursors.DictCursor)

</span><span style="color: #008000">#</span><span style="color: #008000"> 执行SQL，并返回收影响行数</span>
effect_row = cursor.execute(<span style="color: #800000">"</span><span style="color: #800000">SELECT id,yhm,mim FROM db1</span><span style="color: #800000">"</span><span style="color: #000000">)
shuju </span>= <span style="background-color: #ffff00">cursor.fetchmany(3)</span>   <span style="color: #008000">#</span><span style="color: #008000">获取游标里,指定条数据</span>
<span style="color: #0000ff">print</span><span style="color: #000000">(shuju)

</span><span style="color: #008000">#</span><span style="color: #008000"> 提交，不然无法保存新建或者修改的数据</span><span style="color: #008000">
#</span><span style="color: #008000"> conn.commit()</span>

<span style="color: #008000">#</span><span style="color: #008000"> 关闭游标</span>
<span style="color: #000000">cursor.close()
</span><span style="color: #008000">#</span><span style="color: #008000"> 关闭连接</span>
conn.close()</pre>
</div>
<p><img src="https://images2015.cnblogs.com/blog/955761/201706/955761-20170605160814793-1940863238.png" alt=""></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong>移动游标里数据指针获取对应数据</strong></span></p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong>scroll(1,mode='relative')相对当前位置移动</strong></span><br><span style="color: #ff0000"><strong>	　　使用方式：</strong></span><br><span style="color: #ff0000"><strong>	　　游标变量.scroll(1,mode='relative')</strong></span><br><span style="color: #ff0000"><strong>	　　第一个参数正数相对当前位置向下移动数值对应指针，第一个负数相对当前位置向上移动数值对应指针</strong></span></p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong>scroll(2,mode='absolute')相对绝对位置移动</strong></span><br><span style="color: #ff0000"><strong>	　　使用方式：</strong></span><br><span style="color: #ff0000"><strong>	　　游标变量.scroll(2,mode='absolute')</strong></span><br><span style="color: #ff0000"><strong>	　　将指针位置移动到第一个参数数值对应指针</strong></span></p>
<p><span style="color: #0000ff"><strong><strong>相对当前位置移动获取数据<strong>mode='relative'</strong></strong></strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span>
<span style="color: #0000ff">import</span><span style="color: #000000"> pymysql

</span><span style="color: #008000">#</span><span style="color: #008000"> 创建连接</span>
<span style="color: #800000">"""</span><span style="color: #800000">
host=数据库ip
port=数据库端口
user=数据库用户名
passwd=数据库密码
db=数据库名称
charset=数据库编码
</span><span style="color: #800000">"""</span><span style="color: #000000">
conn </span>= pymysql.connect(host=<span style="color: #800000">'</span><span style="color: #800000">127.0.0.1</span><span style="color: #800000">'</span>, port=3306, user=<span style="color: #800000">'</span><span style="color: #800000">root</span><span style="color: #800000">'</span>, passwd=<span style="color: #800000">'</span><span style="color: #800000">279819</span><span style="color: #800000">'</span>, db=<span style="color: #800000">'</span><span style="color: #800000">cshi</span><span style="color: #800000">'</span>,charset=<span style="color: #800000">'</span><span style="color: #800000">utf8</span><span style="color: #800000">'</span><span style="color: #000000">)
</span><span style="color: #008000">#</span><span style="color: #008000"> 创建游标</span>
cursor = conn.cursor(cursor=<span style="color: #000000">pymysql.cursors.DictCursor)

</span><span style="color: #008000">#</span><span style="color: #008000"> 执行SQL，并返回收影响行数</span>
effect_row = cursor.execute(<span style="color: #800000">"</span><span style="color: #800000">SELECT id,yhm,mim FROM db1</span><span style="color: #800000">"</span><span style="color: #000000">)
<span style="background-color: #ffff00">shuju </span></span><span style="background-color: #ffff00">= cursor.fetchone()   <span style="color: #008000">#</span><span style="color: #008000">获取游标里第一条数据,指针在第一个位置</span>
shuju = cursor.fetchone()   <span style="color: #008000">#</span><span style="color: #008000">指针在第二个位置</span>
shuju = cursor.fetchone()   <span style="color: #008000">#</span><span style="color: #008000">指针在第三个位置</span>
<span style="color: #0000ff">print</span>(shuju)                <span style="color: #008000">#</span><span style="color: #008000">打印应该是第三条</span>
cursor.scroll(-2,mode=<span style="color: #800000">'</span><span style="color: #800000">relative</span><span style="color: #800000">'</span>) <span style="color: #008000">#</span><span style="color: #008000">调整指针，相对当前位置向上移动2位</span>
shuju = cursor.fetchone()   <span style="color: #008000">#</span><span style="color: #008000">指针第二位</span>
<span style="color: #0000ff">print</span><span style="color: #000000">(shuju)
</span></span><span style="color: #008000">#</span><span style="color: #008000"> 提交，不然无法保存新建或者修改的数据</span><span style="color: #008000">
#</span><span style="color: #008000"> conn.commit()</span>

<span style="color: #008000">#</span><span style="color: #008000"> 关闭游标</span>
<span style="color: #000000">cursor.close()
</span><span style="color: #008000">#</span><span style="color: #008000"> 关闭连接</span>
conn.close()</pre>
</div>
<p><img src="https://images2015.cnblogs.com/blog/955761/201706/955761-20170605180955575-1863392574.png" alt=""></p>
<p>&nbsp;</p>
<p><span style="color: #0000ff"><strong>相对绝对位置移动mode='absolute'</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span>
<span style="color: #0000ff">import</span><span style="color: #000000"> pymysql

</span><span style="color: #008000">#</span><span style="color: #008000"> 创建连接</span>
<span style="color: #800000">"""</span><span style="color: #800000">
host=数据库ip
port=数据库端口
user=数据库用户名
passwd=数据库密码
db=数据库名称
charset=数据库编码
</span><span style="color: #800000">"""</span><span style="color: #000000">
conn </span>= pymysql.connect(host=<span style="color: #800000">'</span><span style="color: #800000">127.0.0.1</span><span style="color: #800000">'</span>, port=3306, user=<span style="color: #800000">'</span><span style="color: #800000">root</span><span style="color: #800000">'</span>, passwd=<span style="color: #800000">'</span><span style="color: #800000">279819</span><span style="color: #800000">'</span>, db=<span style="color: #800000">'</span><span style="color: #800000">cshi</span><span style="color: #800000">'</span>,charset=<span style="color: #800000">'</span><span style="color: #800000">utf8</span><span style="color: #800000">'</span><span style="color: #000000">)
</span><span style="color: #008000">#</span><span style="color: #008000"> 创建游标</span>
cursor = conn.cursor(cursor=<span style="color: #000000">pymysql.cursors.DictCursor)

</span><span style="color: #008000">#</span><span style="color: #008000"> 执行SQL，并返回收影响行数</span>
effect_row = cursor.execute(<span style="color: #800000">"</span><span style="color: #800000">SELECT id,yhm,mim FROM db1</span><span style="color: #800000">"</span><span style="color: #000000">)
<span style="background-color: #ffff00">shuju </span></span><span style="background-color: #ffff00">= cursor.fetchone()   <span style="color: #008000">#</span><span style="color: #008000">获取游标里第一条数据,指针在第一个位置</span>
shuju = cursor.fetchone()   <span style="color: #008000">#</span><span style="color: #008000">指针在第二个位置</span>
shuju = cursor.fetchone()   <span style="color: #008000">#</span><span style="color: #008000">指针在第三个位置</span>
<span style="color: #0000ff">print</span>(shuju)                <span style="color: #008000">#</span><span style="color: #008000">打印应该是第三条</span>
cursor.scroll(3,mode=<span style="color: #800000">'</span><span style="color: #800000">absolute</span><span style="color: #800000">'</span>) <span style="color: #008000">#</span><span style="color: #008000">调整指针，相对绝对位置移动3位</span>
shuju = cursor.fetchone()   <span style="color: #008000">#</span><span style="color: #008000">指针第四位</span>
<span style="color: #0000ff">print</span><span style="color: #000000">(shuju)
</span></span><span style="color: #008000">#</span><span style="color: #008000"> 提交，不然无法保存新建或者修改的数据</span><span style="color: #008000">
#</span><span style="color: #008000"> conn.commit()</span>

<span style="color: #008000">#</span><span style="color: #008000"> 关闭游标</span>
<span style="color: #000000">cursor.close()
</span><span style="color: #008000">#</span><span style="color: #008000"> 关闭连接</span>
conn.close()</pre>
</div>
<p><img src="https://images2015.cnblogs.com/blog/955761/201706/955761-20170605182019747-1307505324.png" alt=""></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong>添加数据库时获取到添加数据的自增id</strong></span></p>
<p><span style="color: #ff0000"><strong>lastrowid获取添加数据时的自增id</strong></span><br><span style="color: #ff0000"><strong>使用方式：</strong></span><br><span style="color: #ff0000"><strong>	　　游标变量.lastrowid</strong></span><br><span style="color: #ff0000"><strong>注意：如果是添加的多条数据，获取到的自增id是最后一条的自增id</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000">#</span><span style="color: #008000">!/usr/bin/env python</span><span style="color: #008000">
#</span><span style="color: #008000"> -*- coding:utf-8 -*-</span>
<span style="color: #0000ff">import</span><span style="color: #000000"> pymysql

</span><span style="color: #008000">#</span><span style="color: #008000"> 创建连接</span>
<span style="color: #800000">"""</span><span style="color: #800000">
host=数据库ip
port=数据库端口
user=数据库用户名
passwd=数据库密码
db=数据库名称
charset=数据库编码
</span><span style="color: #800000">"""</span><span style="color: #000000">
conn </span>= pymysql.connect(host=<span style="color: #800000">'</span><span style="color: #800000">127.0.0.1</span><span style="color: #800000">'</span>, port=3306, user=<span style="color: #800000">'</span><span style="color: #800000">root</span><span style="color: #800000">'</span>, passwd=<span style="color: #800000">'</span><span style="color: #800000">279819</span><span style="color: #800000">'</span>, db=<span style="color: #800000">'</span><span style="color: #800000">cshi</span><span style="color: #800000">'</span>,charset=<span style="color: #800000">'</span><span style="color: #800000">utf8</span><span style="color: #800000">'</span><span style="color: #000000">)
</span><span style="color: #008000">#</span><span style="color: #008000"> 创建游标</span>
cursor = conn.cursor(cursor=<span style="color: #000000">pymysql.cursors.DictCursor)

</span><span style="color: #008000">#</span><span style="color: #008000"> 执行SQL，并返回收影响行数</span>
effect_row = cursor.execute(<span style="color: #800000">"</span><span style="color: #800000">INSERT INTO db1 (yhm,mim) VALUES (%s,%s)</span><span style="color: #800000">"</span>,(<span style="color: #800000">'</span><span style="color: #800000">bb3</span><span style="color: #800000">'</span>,8889<span style="color: #000000">))
<span style="background-color: #ffff00">zzid </span></span><span style="background-color: #ffff00">= cursor.lastrowid  <span style="color: #008000">#</span><span style="color: #008000">获取添加数据时的自增id</span>
<span style="color: #0000ff">print</span>(zzid) <span style="color: #008000">#</span><span style="color: #008000">打印自增id</span></span><span style="color: #008000">
#</span><span style="color: #008000"> 提交，不然无法保存新建或者修改的数据</span>
<span style="color: #000000">conn.commit()

</span><span style="color: #008000">#</span><span style="color: #008000"> 关闭游标</span>
<span style="color: #000000">cursor.close()
</span><span style="color: #008000">#</span><span style="color: #008000"> 关闭连接</span>
conn.close()</pre>
</div>
<p><img src="https://images2015.cnblogs.com/blog/955761/201706/955761-20170605184417512-916949215.png" alt=""></p>
<p>&nbsp;</p></div>