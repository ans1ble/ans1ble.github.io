第一百五十六节，封装库--JavaScript，延迟加载


			<div id="cnblogs_post_body" class="blogpost-body"><p><span style="color: #0000ff"><strong>封装库--JavaScript，延迟加载</strong></span></p>
<p>&nbsp;</p>
<p><span style="color: #0000ff"><strong>延迟加载的好处，就是在浏览器视窗外的图片，不加载，拖动鼠标到浏览器视窗内后加载，用户不看的图片就不用加载，可以减少服务器大量流量</strong></span></p>
<p><span style="color: #0000ff"><strong>将图片的src地址用一张统一的图片，这样初始化都加载这张图片，减少流量</strong></span></p>
<p><span style="color: #0000ff"><strong>将图片正真的连接地址用另外的属性赋值</strong></span></p>
<p><span style="color: #0000ff"><strong>当用户视窗高度加上滚动条高度，大于等于，图片头部与浏览器头部的距离时，将正真的连接地址，改变到src，</strong></span></p>
<p><span style="color: #0000ff"><strong><img src="https://images2015.cnblogs.com/blog/955761/201702/955761-20170228133206282-1253409321.png" alt=""></strong></span></p>
<p>&nbsp;</p>
<p>html</p>
<div class="cnblogs_code">
<pre><span style="color: #008000">&lt;!--</span><span style="color: #008000">延迟加载</span><span style="color: #008000">--&gt;</span>
    <span style="color: #0000ff">&lt;</span><span style="color: #800000">div </span><span style="color: #ff0000">id</span><span style="color: #0000ff">="photo"</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;</span><span style="color: #800000">dl</span><span style="color: #0000ff">&gt;</span>
            <span style="color: #0000ff">&lt;</span><span style="color: #800000">dt</span><span style="color: #0000ff">&gt;&lt;</span><span style="color: #800000">img </span><span style="color: #ff0000">xsrc</span><span style="color: #0000ff">="img/p1.jpg"</span><span style="color: #ff0000"> src</span><span style="color: #0000ff">="img/wait_load.jpg"</span><span style="color: #ff0000"> class</span><span style="color: #0000ff">="wait_load"</span><span style="color: #ff0000"> alt</span><span style="color: #0000ff">=""</span> <span style="color: #0000ff">/&gt;&lt;/</span><span style="color: #800000">dt</span><span style="color: #0000ff">&gt;</span>
            <span style="color: #0000ff">&lt;</span><span style="color: #800000">dd</span><span style="color: #0000ff">&gt;</span>延迟加载图片<span style="color: #0000ff">&lt;/</span><span style="color: #800000">dd</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;/</span><span style="color: #800000">dl</span><span style="color: #0000ff">&gt;</span>

        <span style="color: #0000ff">&lt;</span><span style="color: #800000">dl</span><span style="color: #0000ff">&gt;</span>
            <span style="color: #0000ff">&lt;</span><span style="color: #800000">dt</span><span style="color: #0000ff">&gt;&lt;</span><span style="color: #800000">img </span><span style="color: #ff0000">xsrc</span><span style="color: #0000ff">="img/p2.jpg"</span><span style="color: #ff0000"> src</span><span style="color: #0000ff">="img/wait_load.jpg"</span><span style="color: #ff0000"> class</span><span style="color: #0000ff">="wait_load"</span><span style="color: #ff0000"> alt</span><span style="color: #0000ff">=""</span> <span style="color: #0000ff">/&gt;&lt;/</span><span style="color: #800000">dt</span><span style="color: #0000ff">&gt;</span>
            <span style="color: #0000ff">&lt;</span><span style="color: #800000">dd</span><span style="color: #0000ff">&gt;</span>延迟加载图片<span style="color: #0000ff">&lt;/</span><span style="color: #800000">dd</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;/</span><span style="color: #800000">dl</span><span style="color: #0000ff">&gt;</span>

        <span style="color: #0000ff">&lt;</span><span style="color: #800000">dl</span><span style="color: #0000ff">&gt;</span>
            <span style="color: #0000ff">&lt;</span><span style="color: #800000">dt</span><span style="color: #0000ff">&gt;&lt;</span><span style="color: #800000">img </span><span style="color: #ff0000">xsrc</span><span style="color: #0000ff">="img/p3.jpg"</span><span style="color: #ff0000"> src</span><span style="color: #0000ff">="img/wait_load.jpg"</span><span style="color: #ff0000"> class</span><span style="color: #0000ff">="wait_load"</span><span style="color: #ff0000"> alt</span><span style="color: #0000ff">=""</span> <span style="color: #0000ff">/&gt;&lt;/</span><span style="color: #800000">dt</span><span style="color: #0000ff">&gt;</span>
            <span style="color: #0000ff">&lt;</span><span style="color: #800000">dd</span><span style="color: #0000ff">&gt;</span>延迟加载图片<span style="color: #0000ff">&lt;/</span><span style="color: #800000">dd</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;/</span><span style="color: #800000">dl</span><span style="color: #0000ff">&gt;</span>

        <span style="color: #0000ff">&lt;</span><span style="color: #800000">dl</span><span style="color: #0000ff">&gt;</span>
            <span style="color: #0000ff">&lt;</span><span style="color: #800000">dt</span><span style="color: #0000ff">&gt;&lt;</span><span style="color: #800000">img </span><span style="color: #ff0000">xsrc</span><span style="color: #0000ff">="img/p4.jpg"</span><span style="color: #ff0000"> src</span><span style="color: #0000ff">="img/wait_load.jpg"</span><span style="color: #ff0000"> class</span><span style="color: #0000ff">="wait_load"</span><span style="color: #ff0000"> alt</span><span style="color: #0000ff">=""</span> <span style="color: #0000ff">/&gt;&lt;/</span><span style="color: #800000">dt</span><span style="color: #0000ff">&gt;</span>
            <span style="color: #0000ff">&lt;</span><span style="color: #800000">dd</span><span style="color: #0000ff">&gt;</span>延迟加载图片<span style="color: #0000ff">&lt;/</span><span style="color: #800000">dd</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;/</span><span style="color: #800000">dl</span><span style="color: #0000ff">&gt;</span>

        <span style="color: #0000ff">&lt;</span><span style="color: #800000">dl</span><span style="color: #0000ff">&gt;</span>
            <span style="color: #0000ff">&lt;</span><span style="color: #800000">dt</span><span style="color: #0000ff">&gt;&lt;</span><span style="color: #800000">img </span><span style="color: #ff0000">xsrc</span><span style="color: #0000ff">="img/p5.jpg"</span><span style="color: #ff0000"> src</span><span style="color: #0000ff">="img/wait_load.jpg"</span><span style="color: #ff0000"> class</span><span style="color: #0000ff">="wait_load"</span><span style="color: #ff0000"> alt</span><span style="color: #0000ff">=""</span> <span style="color: #0000ff">/&gt;&lt;/</span><span style="color: #800000">dt</span><span style="color: #0000ff">&gt;</span>
            <span style="color: #0000ff">&lt;</span><span style="color: #800000">dd</span><span style="color: #0000ff">&gt;</span>延迟加载图片<span style="color: #0000ff">&lt;/</span><span style="color: #800000">dd</span><span style="color: #0000ff">&gt;</span>
        <span style="color: #0000ff">&lt;/</span><span style="color: #800000">dl</span><span style="color: #0000ff">&gt;</span>
    <span style="color: #0000ff">&lt;/</span><span style="color: #800000">div</span><span style="color: #0000ff">&gt;</span></pre>
</div>
<p>css</p>
<div class="cnblogs_code">
<pre><span style="color: #008000">/*</span><span style="color: #008000">延迟加载</span><span style="color: #008000">*/</span><span style="color: #800000">
#photo </span>{<span style="color: #ff0000">
    width</span>:<span style="color: #0000ff">900px</span>;<span style="color: #ff0000">
    float</span>:<span style="color: #0000ff">left</span>;
}<span style="color: #800000">
#photo dl </span>{<span style="color: #ff0000">
    width</span>:<span style="color: #0000ff">225px</span>;<span style="color: #ff0000">
    height</span>:<span style="color: #0000ff">270px</span>;<span style="color: #ff0000">
    float</span>:<span style="color: #0000ff">left</span>;<span style="color: #ff0000">
    margin</span>:<span style="color: #0000ff">5px 0 15px 0</span>;
}<span style="color: #800000">
#photo dl dt </span>{<span style="color: #ff0000">
    width</span>:<span style="color: #0000ff">200px</span>;<span style="color: #ff0000">
    height</span>:<span style="color: #0000ff">250px</span>;<span style="color: #ff0000">
    margin</span>:<span style="color: #0000ff">0 auto</span>;
}<span style="color: #800000">
#photo dl dd </span>{<span style="color: #ff0000">
    height</span>:<span style="color: #0000ff">25px</span>;<span style="color: #ff0000">
    line-height</span>:<span style="color: #0000ff">25px</span>;<span style="color: #ff0000">
    text-align</span>:<span style="color: #0000ff">center</span>;
}</pre>
</div>
<p>前台js</p>
<div class="cnblogs_code">
<pre><span style="color: #008000">//</span><span style="color: #008000">延迟加载</span>
    <span style="color: #0000ff">var</span> wait_load = $('.wait_load');                      <span style="color: #008000">//</span><span style="color: #008000">获取所有的图片节点</span>
    wait_load.shzh_tou_ming_du(0);                        <span style="color: #008000">//</span><span style="color: #008000">将所有图片设置成透明</span>
    $(window).yuan_su_shi_jian('scroll'<span style="color: #000000">,_wait_load);
    $(window).yuan_su_shi_jian(</span>'resize'<span style="color: #000000">,_wait_load);
    </span><span style="color: #0000ff">function</span><span style="color: #000000"> _wait_load() {
        setTimeout(</span><span style="color: #0000ff">function</span> () {                          <span style="color: #008000">//</span><span style="color: #008000">延迟100毫秒</span>
            <span style="color: #0000ff">for</span> (<span style="color: #0000ff">var</span> i = 0; i &lt; wait_load.jd_length(); i++) {                        <span style="color: #008000">//</span><span style="color: #008000">根据图片的长度来循环</span>
                <span style="color: #0000ff">var</span> _this = wait_load.hq_jd(i);                                      <span style="color: #008000">//</span><span style="color: #008000">获取到每次循环对应的图片对象</span>
                <span style="color: #0000ff">if</span>(getInner().height + gun_dong_tiao_wei_zhi().top &gt;= ju_li_liu_lan_qi_tou(_this)) {      <span style="color: #008000">//</span><span style="color: #008000">判断视窗高度加上滚动条的高度，大于等于，元素头部到浏览器头部距离时</span>
                    $(_this).qh_shu_xing_zhi('src', $(_this).qh_shu_xing_zhi('xsrc')).yi_dong_tou_ming({  <span style="color: #008000">//</span><span style="color: #008000">每次循环对应的图片改变src并显示出来</span>
                        attr: 'o'<span style="color: #000000">,
                        target: </span>100<span style="color: #000000">,
                        t: </span>30<span style="color: #000000">,
                        step: </span>10<span style="color: #000000">
                    });
                }
            }
        }, </span>100<span style="color: #000000">);
    }</span></pre>
</div>
<p>&nbsp;</p>
<p>首先要引入封装库</p></div>