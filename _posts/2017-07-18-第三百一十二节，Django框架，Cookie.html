第三百一十二节，Django框架，Cookie


			<div id="cnblogs_post_body" class="blogpost-body"><p><strong>第三百一十二节，Django框架，Cookie</strong></p>
<p><span style="color: #0000ff"><strong>注意：获取<strong>Cookie是在请求对象里处理，设置<strong>Cookie是在响应对象里处理</strong></strong></strong></span></p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong>普通Cookie</strong></span><br><span style="color: #ff0000"><strong><span style="color: #0000ff">set_cookie()</span>设置普通cookie</strong></span></p>
<p><strong>    　　参数：</strong><br><strong>        　　　　key,              键</strong><br><strong>        　　　　value='',         值</strong><br><strong>        　　　　max_age=None,     超时时间，<strong>秒，也支持时间戳</strong></strong><br><strong>        　　　　expires=None,     超时时间(IE requires expires, so set it if hasn't been already.)</strong><br><strong>        　　　　path='/',         Cookie生效的路径，/ 表示根路径，特殊的：跟路径的cookie可以被任何url的页面访问</strong><br><strong>        　　　　domain=None,      Cookie生效的域名</strong><br><strong>        　　　　secure=False,     https传输</strong><br><strong>        　　　　httponly=False    只能http协议传输，无法被JavaScript获取（不是绝对，底层抓包可以获取到也可以被覆盖）</strong></p>
<p><strong><span style="color: #0000ff">COOKIES</span>获取普通cookie</strong><br><strong><span style="color: #0000ff">COOKIES['k1']</span>获取指定普通cookie，存在获取，不存在报错</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">from</span> django.shortcuts <span style="color: #0000ff">import</span><span style="color: #000000"> render
</span><span style="color: #0000ff">from</span> app1.models <span style="color: #0000ff">import</span> *    <span style="color: #008000">#</span><span style="color: #008000">导入数据库操作模块</span>
<span style="color: #0000ff">from</span> app1.biaodan <span style="color: #0000ff">import</span> *   <span style="color: #008000">#</span><span style="color: #008000">导入自定义表单验证模块</span><span style="color: #008000">
#</span><span style="color: #008000">逻辑处理模块</span>
<span style="color: #0000ff">def</span><span style="color: #000000"> special(request):
    </span><span style="background-color: #ff99cc"><span style="color: #0000ff">print</span>(request.COOKIES)</span>                      <span style="color: #008000">#</span><span style="color: #008000">获取所有cookie</span>
    <span style="background-color: #ff99cc"><span style="color: #0000ff">print</span>(request.COOKIES[<span style="color: #800000">'</span><span style="color: #800000">k1</span><span style="color: #800000">'</span>])</span>                <span style="color: #008000">#</span><span style="color: #008000">获取指定cookie</span>
<span style="color: #000000">
    rep </span>= render(request, <span style="color: #800000">'</span><span style="color: #800000">app1/index.html</span><span style="color: #800000">'</span><span style="color: #000000">)
    <span style="background-color: #ff99cc">rep.set_cookie(</span></span><span style="background-color: #ff99cc"><span style="color: #800000">'</span><span style="color: #800000">k1</span><span style="color: #800000">'</span>,123)</span>                    <span style="color: #008000">#</span><span style="color: #008000">设置cookie</span>
    <span style="color: #0000ff">return</span> rep</pre>
</div>
<p>&nbsp;</p>
<p><span style="color: #ff0000; background-color: #ffff00"><strong>加密Cookie</strong></span></p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">set_signed_cookie()</span>设置加密cookie</strong></span></p>
<p><strong> 　　参数：</strong><br><strong>        　　　　key,              键cookie名称</strong><br><strong>        　　　　value='',         值</strong><br><strong>	　　　　salt=''  	  加严</strong><br><strong>        　　　　max_age=None,     超时时间，秒，也支持时间戳</strong><br><strong>        　　　　expires=None,     超时时间(IE requires expires, so set it if hasn't been already.)</strong><br><strong>        　　　　path='/',         Cookie生效的路径，/ 表示根路径，特殊的：跟路径的cookie可以被任何url的页面访问</strong><br><strong>        　　　　domain=None,      Cookie生效的域名</strong><br><strong>        　　　　secure=False,     https传输</strong><br><strong>        　　　　httponly=False    只能http协议传输，无法被JavaScript获取（不是绝对，底层抓包可以获取到也可以被覆盖）</strong></p>
<p><span style="color: #ff0000"><strong><span style="color: #0000ff">get_signed_cookie()</span>获取加密cookie</strong></span><br><strong>	　　参数：</strong><br><strong>		　　　　key		键cookie名称</strong><br><strong>		　　　　salt=''  	加严</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff">from</span> django.shortcuts <span style="color: #0000ff">import</span><span style="color: #000000"> render
</span><span style="color: #0000ff">from</span> app1.models <span style="color: #0000ff">import</span> *    <span style="color: #008000">#</span><span style="color: #008000">导入数据库操作模块</span>
<span style="color: #0000ff">from</span> app1.biaodan <span style="color: #0000ff">import</span> *   <span style="color: #008000">#</span><span style="color: #008000">导入自定义表单验证模块</span><span style="color: #008000">
#</span><span style="color: #008000">逻辑处理模块</span>
<span style="color: #0000ff">def</span><span style="color: #000000"> special(request):
    <span style="background-color: #ff99cc">a </span></span><span style="background-color: #ff99cc">= request.get_signed_cookie(<span style="color: #800000">'</span><span style="color: #800000">k2</span><span style="color: #800000">'</span>,salt=<span style="color: #800000">'</span><span style="color: #800000">adc</span><span style="color: #800000">'</span>)</span>  <span style="color: #008000">#</span><span style="color: #008000">获取加密cookie</span>
    <span style="color: #0000ff; background-color: #ff99cc">print</span><span style="color: #000000"><span style="background-color: #ff99cc">(a)</span>

    rep </span>= render(request, <span style="color: #800000">'</span><span style="color: #800000">app1/index.html</span><span style="color: #800000">'</span><span style="color: #000000">)
    <span style="background-color: #ff99cc">rep.set_signed_cookie(</span></span><span style="background-color: #ff99cc"><span style="color: #800000">'</span><span style="color: #800000">k2</span><span style="color: #800000">'</span>,<span style="color: #800000">'</span><span style="color: #800000">v2</span><span style="color: #800000">'</span>,salt=<span style="color: #800000">'</span><span style="color: #800000">adc</span><span style="color: #800000">'</span>)</span>     <span style="color: #008000">#</span><span style="color: #008000">设置加密cookie</span>
    <span style="color: #0000ff">return</span> rep</pre>
</div>
<p>&nbsp;</p>
<p><strong>由于cookie保存在客户端的电脑上，所以，JavaScript和jquery也可以操作cookie。</strong></p></div>